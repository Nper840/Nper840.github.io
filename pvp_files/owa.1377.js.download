self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1377.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1377],{11204:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1730),i=n(2019),a=n(2098),u=n(20),c=n(1737);function s(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return 1!==(n=t.tableQuery).listViewType?[3,2]:(i={Id:e,mailboxInfo:Object(o.d)(n)},[4,a.e.importAndExecute(i,"LoadNudgedItem")]);case 1:return[2,r.sent()];case 2:return[2,d(e,t)]}}))}))}function d(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){return n=t.tableQuery,a=Object(o.d)(n),[2,i.i.importAndExecute(e,n.folderId,n.sortBy,Object(c.l)(n),n.requestShapeName,a).then((function(e){return e})).catch((function(e){return u.g.warn("loadNudgedConversation throws an exception"+e.message),null}))]}))}))}var l=n(18),f=n(222),b=n(391),w="https://outlook.office.com/FocusedInboxB2",O="https://outlook.office.com/M365.Access";function g(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,I(e,t)];case 1:return(n=r.sent())?((o=new Headers).authorization="Bearer "+n,[2,o]):[2,null]}}))}))}function I(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,i;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:return Object(f.a)()?[3,3]:(n=Object(r.__read)(Object(b.getAccessTokenforResourceAsLazy)(w,t,e),2),o=n[0],i=n[1],o?[3,2]:[4,i]);case 1:o=a.sent(),a.label=2;case 2:return[2,o];case 3:if(Object(l.i)("tri-nudge-consumer"))return[2,Object(b.getDelegationTokenForOwa)(O,t,e)];a.label=4;case 4:return[2,null]}}))}))}var v=n(161),m=n(236),h=n(129),j=n(154);function _(e){var t=parseInt(e)||-1;return-1!=t&&Object(j.a)(t)||503==t||-1==t}var N="FocusedInboxB2/api/v1/Nudges/GetNudges",y=1500;function p(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,g(e,"getNudge")];case 1:if(!(t=r.sent()))return[2,{getNudgesResponse:null,errorOrStatus:"Token Failure"}];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Object(v.b)(N,e,!0,t,!0,!1,"GetNudges")];case 3:return n=r.sent(),[3,5];case 4:return[2,{errorDetails:r.sent().message,errorOrStatus:"RequestNotComplete"}];case 5:return r.trys.push([5,13,,14]),Object(m.a)(n.status)?[4,n.json()]:[3,10];case 6:return(o=r.sent()).Nudges?[2,{getNudgesResponse:o,errorOrStatus:n.status}]:[3,7];case 7:return[4,n.text()];case 8:return[2,{errorOrStatus:"No Nudges",errorDetails:i=r.sent()}];case 9:return[3,12];case 10:return[4,n.text()];case 11:return(null==(i=r.sent())?void 0:i.toLowerCase().indexOf("html"))>-1&&(i=""),[2,{errorOrStatus:n.status,errorDetails:i}];case 12:return[3,14];case 13:return r.sent(),[2,{errorOrStatus:"Parse Error"}];case 14:return[2]}}))}))}function R(e){return function e(t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n>2?[2,o]:[4,p(t)];case 1:return _((o=r.sent()).errorOrStatus)?[4,Object(h.a)(y)]:[3,3];case 2:return r.sent(),[2,e(t,n+1,o)];case 3:return o.retryAttempt=n,[2,o]}}))}))}(e,1,null)}var S=n(1641),E=n(5),T=n(966);function C(e){switch(e){case"Received":return 0;case"Sent":return 1;default:return u.g.warn("No nudge reason returned in GetNudge server response"),0}}var K=n(3868),L=n(2213),A=n(3336),D=n(8607),V=n(2422),x=n(2200);function M(e,t){var n=t.rowKeys.indexOf(e);if(-1!=n){var r=S.b.getLastDeliveryOrRenewTimeStamp(e,t);if(Object(x.a)(e,t.id,r)){var o=Object(A.a)(r,S.b.getLastDeliveryTimeStamp(e,t),t,n+1);-1==o?Object(L.a)([e],t,"NotNudgeAnymore"):(Object(D.a)([e],t),V.a.updateRowPosition(--o,e,t))}}}var P=n(127),F=n(37),k=n(219),U=n(2567),G=n(1656),B=n(4);function Q(e,t,n){Object(P.r)("Nudge_RowRemove",{owa_1:t,owa_2:n,rKey:e},{isCore:!0})}var W=n(4898),z=n(1668);function H(e){var t,n=(null!==(t=e.IconIndex)&&void 0!==t?t:"").toString().toLowerCase();return n.indexOf("replied")>-1||n.indexOf("forwarded")>-1}function J(e,t,n){return S.b.getIsPinned(n,t)?"RowPinned":function(e,t,n){if(Object(S.Q)(e)){var r=S.b.getLatestGlobalItemId(t,e),o=S.b.getDraftItemIds(t,e);return!(!t||-1!=o.indexOf(r)||r==n)}var i=Object(G.b)().items.get(n);return!(!i||!H(i))}(t,n,e)?"NotLatestItemInRow":null}var q,X,Y=n(3),Z=!1,$={},ee=36e5,te=18e5,ne=Object(F.e)(W.a,"getNudgesOnNudgeOptionChangeClone",(function(e){ae(!0,"SettingChange")})),re=Object(F.e)(U.a,"clone_onSelectFolderComplete",(function(e){var t=e.selectedFolderId,n=e.previousFolderId,r=e.isExitingSearch;t==n||r||ae(!1,"FolderSwitch")})),oe=Object(F.e)(x.i,"clone_getNudgesOnNudgeRemoved",(function(e){Object(l.i)("tri-nudgePolling")&&(X=setTimeout((function(){return ae(!0,"NudgeRemoval")}),9e5))}));function ie(e,t){"visible"===document.visibilityState&&ae(e,t)}function ae(e,t){if(!Z&&Object(K.b)()){var n=Object(l.i)("tri-nudgePolling");!q&&n&&(q=!0,document.addEventListener("visibilitychange",(function(){return ie(!1,"VisibilityChange")})));var o=Object(S.H)(),i=o.tableQuery.folderId;if(Object(K.a)(i)){if(n){if(!e&&Date.now()-$[i]<=te)return;X&&(clearTimeout(X),X=null),X=setTimeout((function(){return ie(!1,"Timer")}),ee)}!function(e,t,n){var o;Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,s,d,l,f,b,w,O,g,I,v,m,h,j,_,N,y,p;return Object(r.__generator)(this,(function(C){switch(C.label){case 0:return Z=!0,i=Object(k.a)(),a=Date.now(),[4,R(i)];case 1:if(s=C.sent(),d=[],l=s,f=Date.now()-a,!(null===(o=null==l?void 0:l.getNudgesResponse)||void 0===o?void 0:o.Nudges))return[3,6];b=l.getNudgesResponse.Nudges,w=0,O=[],g=[],I="sentitems"==Object(z.a)(e),v=0,C.label=2;case 2:return v<b.length?(m=b[v],h=m.FolderId.Id,j=m.ItemId.Id,O.push(j),I&&h!=e?[3,4]:[4,ue(m,t,i,!I)]):[3,5];case 3:(_=C.sent())&&(d.push(_),g.push(j)),w++,C.label=4;case 4:return v++,[3,2];case 5:return ce(b.length,w,d.length,n,i,O.join(","),f,g.join(","),l.errorOrStatus,"",l.retryAttempt),[3,7];case 6:ce(0,0,0,n,i,"",f,"",l.errorOrStatus,Object(Y.I)(l.errorDetails),l.retryAttempt),C.label=7;case 7:return N=Object(E.a)("testOldNudge"),0!=decodeURIComponent(N||"").trim().length&&(d.push({rowKey:"testNudgeRowKey",itemId:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId=",conversationId:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId=",tableViewId:t.id,reason:0,daysAgo:7}),y={ConversationId:{__type:"ItemId:#Exchange",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId="},ConversationTopic:"This is a test Nudge Email that is older than the loaded rows",UniqueSenders:["Sayali Shah"],LastDeliveryTime:"2019-10-01T15:30:58-07:00",HasAttachments:!1,MessageCount:1,GlobalMessageCount:1,UnreadCount:1,GlobalUnreadCount:1,Size:1234,ItemClasses:["IPM.Note"],Importance:null,ItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],GlobalItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],LastModifiedTime:"2019-10-29T15:30:59-07:00",InstanceKey:"testNudgeRowKey",Preview:"Test nudge email for row that is not loaded",HasIrm:!1,IsLocked:!1,FamilyId:{__type:"ItemId:#Exchange",Id:"AAQkAGZjM2NmMGY1LTkzMzgtNGNhMy04ODg5LWQwMjJjMDc0YjJlMAAQAH9+ZbR0rbRFncY81mWHT1E="},LastDeliveryOrRenewTime:"2019-10-01T15:30:58-07:00",HasAttachmentPreviews:!1,LastSender:{Mailbox:{Name:"Sayali Shah",EmailAddress:"sayalis@microsoft.com",RoutingType:"SMTP"}}},t.rowKeys.indexOf("testNudgeRowKey")<0&&(p=Object(c.f)(t,0),V.a.addRow(p,y,t))),d.push.apply(d,Object(r.__spread)(function(e){var t=Object(E.a)("testNudge");if(0==decodeURIComponent(t||"").trim().length)return[];var n=[];if(e.rowKeys.length>0){var r=e.tableQuery.folderId===Object(T.a)("sentitems")?1:0,o={rowKey:e.rowKeys[4],itemId:S.b.getItemIds(e.rowKeys[0],e)[0],conversationId:S.b.getConversationId(e.rowKeys[4],e),tableViewId:e.id,reason:r,daysAgo:1};if(n.push(o),e.rowKeys.length>3){var i={rowKey:e.rowKeys[6],itemId:S.b.getItemIds(e.rowKeys[3],e)[0],conversationId:S.b.getConversationId(e.rowKeys[6],e),tableViewId:e.id,reason:r,daysAgo:0};n.push(i)}if(e.rowKeys.length>10&&1===Math.floor(2*Math.random())){var a={rowKey:e.rowKeys[10],itemId:S.b.getItemIds(e.rowKeys[10],e)[0],conversationId:S.b.getConversationId(e.rowKeys[10],e),tableViewId:e.id,reason:r,daysAgo:3};n.push(a)}}return n}(t))),Object(x.f)().nudgedRows.forEach((function(e){var n=e.rowKey;e.tableViewId!=t.id||d.some((function(t){return t.rowKey===n&&t.tableViewId===e.tableViewId}))||(M(n,t),Q(n,"NotReceivedAsNudgeAnyMore",e.reason)),e.tableViewId!=t.id&&d.push(e)})),Object(x.h)(d,t),u.g.info("Nudge: onSelectFolderCompleteOrchestrator new nudges length: "+d.length),Z=!1,[2]}}))}))}(i,o,t),$[i]=Date.now()}}}function ue(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l,f,b,w,O,g,I,v,m,h,j,_,N;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),d=void 0,l=void 0,f=e.ItemId.Id,b=e.ConversationId.Id,w=e.NudgeReason.Reason,O=Object(S.Q)(t),g=O?b:f,I=Object(S.E)([g],t),v=i?"Sent"==w:"Received"==w,0!==I.length?[3,2]:[4,s(g,t)];case 1:return m=r.sent(),(l=function(e,t,n,r){var o,i;if(!e)return"RowNotFound";if(i=n?e.LastDeliveryOrRenewTime:e.ReceivedOrRenewTime,Object(S.v)(i))return"RowPinned";if(n){var a=e,u=a.GlobalItemIds[0].Id;return 0==(a.DraftItemIds||[]).filter((function(e){return e.Id==u})).length&&u!=t?"NotLatestItemInRow":null}return H(e)?"NotLatestItemInRow":(null===(o=e.ParentFolderId)||void 0===o?void 0:o.Id)!=r.tableQuery.folderId?"ItemFromOtherTable":null}(m,f,O,t))||(d=m.InstanceKey,t.rowKeys.indexOf(d)<0&&(h=Object(c.f)(t,0),V.a.addRow(h,m,t))),[3,3];case 2:(l=J(f,t,I[0]))||(d=I[0]),r.label=3;case 3:return d?(function(e,t){if(1===e.listViewType){var n=Object(G.b)().items.get(t);n&&n.NormalizedBody||a.e.importAndExecute({Id:t,mailboxInfo:Object(o.d)(e)},"LoadNudgedItem")}else Object(G.b)().conversations.get(t)||a.d.importAndExecute({Id:t,mailboxInfo:Object(o.d)(e)},"LoadNudgedConversation")}(t.tableQuery,g),j=e.MessageReceivedOrSentTimeUTC||S.b.getLastDeliveryTimeStamp(d,t),_=Object(B.s)(Object(B.mc)(),Object(B.mc)(j)),[2,{rowKey:d,itemId:f,conversationId:b,tableViewId:t.id,reason:C(e.NudgeReason.Reason),daysAgo:_}]):(function(e,t,n,r,o,i,a){var c=a?"inbox":"sentitems";Object(P.r)("Nudge_Discarded",{owa_1:e,owa_2:o,owa_3:i,itemId:t,cId:n,crId:r},{isCore:!0}),u.g.warn("Nudge Discarded - isConversationView: "+o+" itemId: "+t+" conversationId: "+n+" folderId: "+c+" isNudgeFromOtherTable: "+i)}(l,f,b,n,O,v,i),[2,null]);case 4:return N=r.sent(),u.g.warn("Nudge: processNudgeResponse throws an exception"+N.message),[2,null];case 5:return[2]}}))}))}function ce(e,t,n,r,o,i,a,u,c,s,d){Object(P.r)("Nudge_GetNudge",{owa_1:e,owa_2:t,owa_3:n,owa_4:r,cId:o,itemId:i,latency:a,validItemId:u,error:null==c?void 0:c.toString(),errorMessage:s,retryAttempt:d})}var se="FocusedInboxB2/api/v1/Nudges/UpdateNudge",de=1500;function le(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,u,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,g(n,"updateNudge")];case 1:if(!(o=r.sent()))return[2,{errorMessage:"Token Failure"}];i={ItemId:{Id:e},NudgeAction:t},r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Object(v.d)(se,i,n,!0,o,!0,!1,!1,"UpdateNudges")];case 3:return a=r.sent(),[3,5];case 4:return[2,{errorDetails:r.sent().message,errorMessage:"RequestNotComplete"}];case 5:return r.trys.push([5,7,,8]),u=a.status,Object(m.a)(u)?[2,{status:u,errorMessage:"No error",errorDetails:""}]:[4,a.text()];case 6:return(null==(c=r.sent())?void 0:c.toLowerCase().indexOf("html"))>-1&&(c=""),[2,{status:u,errorMessage:u,errorDetails:c}];case 7:return r.sent(),[2,{errorMessage:"Parse Error"}];case 8:return[2]}}))}))}function fe(e,t,n,o){var i=Object(k.a)();return function e(t,n,o,i,a,u,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a>3?[2]:[4,le(t,n,c)];case 1:return s=r.sent(),function(e,t,n,r,o,i,a,u,c){Object(P.r)("Nudge_Update",{owa_1:e,owa_2:t,owa_3:n,owa_4:o,owa_5:a,itemId:r,errorDetails:Object(Y.I)(i),rA:u,crId:c},{isCore:!0})}(n,o,i,t,s.errorMessage,s.errorDetails,s.status,a,c),_(s.status.toString())?[4,Object(h.a)(u)]:[3,3];case 2:r.sent(),e(t,n,o,i,a+1,2*u,c),r.label=3;case 3:return[2]}}))}))}(e,t,n,o,1,de,i)}var be,we,Oe=n(1950),ge=n(3154),Ie=n(3155),ve=n(4092),me=n(5248),he=n(6330),je=n(3243),_e=n(3244),Ne=Object(F.e)(he.b,"clone_onNudgeInfoBarClicked",(function(e){var t=e.response===he.a.MarkComplete?"MarkedComplete":"DismissedOnView";Ae(e.rowKey,e.itemId,t,"ReadingPane")})),ye=Object(F.e)(me.a,"clone_onDismissNudgeClicked",(function(e){Object(x.f)().nudgedRows.filter((function(t){return t.rowKey===e.rowKey&&t.tableViewId===e.tableViewId})).forEach((function(t){Ae(e.rowKey,t.itemId,"Dismissed",e.actionSource)}))})),pe=Object(F.e)(Ie.a,"clone_markItemsAsPinnedStoreUpdate",(function(e){Le(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned)})),Re=Object(F.e)(ge.a,"clone_markConversationsAsPinnedStoreUpdate",(function(e){Le(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned)})),Se=Object(F.e)(Oe.a,"clone_deleteItemsStoreUpdate",(function(e){e.itemContexts.map((function(e){return e.itemId})).forEach((function(t){var n=Object(x.e)(t);n&&(Object(x.i)(n),Q(n,e.actionType,Ve(n)))}))})),Ee=Object(F.e)(L.a,"clone_removeRowsFromListViewStore",(function(e){De(e.rowKeys,e.tableView.id,e.actionType)})),Te=Object(F.e)(ve.a,"clone_onSendMessageSucceeded",(function(e){var t=e.operation;if(1===t||2===t||3===t){e.referenceItemId||u.g.warn("Nudge: referenceItemId should not be null for r/R/f operations");var n,r=e.referenceItemId.Id,o=e.conversationId,i=Object(x.e)(r);i||(i=Object(x.d)(o)),i?(M(i,Object(S.H)()),n=Ve(i),Object(x.i)(i)):be==r&&(i=we),i&&Object(P.r)("Nudge_Reply",{owa_1:t,owa_2:n,refId:r,cId:o,rKey:i},{isCore:!0})}})),Ce=Object(F.e)(_e.a,"clone_removeNudgeUponRowUpdate",(function(e){var t=Object(x.f)().nudgedRows.filter((function(t){return t.rowKey===e.rowKey}));if(t.length>0){var n=J(t[0].itemId,e.tableView,e.rowKey);n&&(be=t[0].itemId,we=e.rowKey,M(e.rowKey,e.tableView),De([e.rowKey],e.tableView.id,n))}})),Ke=Object(F.e)(W.a,"updateNudgesOnNudgeOptionChangeClone",(function(e){if(Object(je.a)(32)){var t=Object(x.f)().nudgedRows.map((function(e){return e.rowKey})),n=Object(S.H)();t.forEach((function(e){M(e,n),De([e],n.id,"NudgeDisabled")}))}}));function Le(e,t,n){var r=n?"Pinned":"Unpinned";e.forEach((function(e){Object(x.f)().nudgedRows.filter((function(n){return n.rowKey===e&&n.tableViewId===t})).forEach((function(e){fe(e.itemId,r,"PinUnpin",e.reason)}))})),De(e,t,"PinUnpin")}function Ae(e,t,n,r){fe(t,n,r,Ve(e)),M(e,Object(S.H)()),Object(x.i)(e)}function De(e,t,n){e.forEach((function(e){if(Object(x.g)(e,t)){var r=Ve(e);Object(x.i)(e),Q(e,n,r)}}))}function Ve(e){var t=Object(x.f)().nudgedRows.filter((function(t){return t.rowKey===e}));return t.length>0?t[0].reason:null}var xe=n(2);function Me(e,t,n){if(e.tableViewId==t.id){var r,o="Nudge_Render",i=e.rowKey,a=e.conversationId,s=e.itemId;Object(x.a)(i,t.id,S.b.getLastDeliveryOrRenewTimeStamp(i,t))?(r=Object(c.f)(t,0),V.a.updateRowPosition(r,i,t),u.g.info("Nudge: "+n+" updateNudgedRowPosition - row is inserted at "+r)):(o="Nudge_NotRender",u.g.info("Nudge: "+n+" updateNudgedRowPosition - row is pinned")),Object(P.r)(o,{owa_1:n,rKey:i,iId:s,cId:a,index:r},{isCore:!0})}}Object(xe.orchestrator)(x.h,(function(e){e.nudgedRows.forEach((function(t){return Me(t,e.tableView,"onGetNudge")}))})),Object(xe.orchestrator)(c.i,(function(e){var t=Object(x.f)().nudgedRows,n=e.tableView;t.filter((function(e){return e.tableViewId==n.id})).forEach((function(t){return Me(t,e.tableView,"onMerge")}))}));var Pe=n(71);function Fe(){Object(je.b)(!0,32),Pe.w.importAndExecute([{key:"FocusedInboxBitFlags",valuetype:"Integer32",value:[""+Object(Pe.h)().ViewStateConfiguration.FocusedInboxBitFlags]}],"OWA.ViewStateConfiguration"),Object(P.r)("TnS_SaveNudgeOption",[!1,"InlineFeedback"]),Object(W.a)()}n.d(t,"getNudgesOnSelectFolderComplete",(function(){return re})),n.d(t,"getNudgesOnNudgeOptionChange",(function(){return ne})),n.d(t,"getNudgesOnNudgeRemoved",(function(){return oe})),n.d(t,"removeNudgeOnInfoBarClickedOrchestrator",(function(){return Ne})),n.d(t,"removeNudgeOnDismissNudgeClickedOrchestrator",(function(){return ye})),n.d(t,"removeNudgeOnItemDeleteStoreUpdateOrchestrator",(function(){return Se})),n.d(t,"removeNudgeOnRowsDeleteStoreUpdateOrchestrator",(function(){return Ee})),n.d(t,"removeNudgeOnItemsPinnedStoreUpdateOrchestrator",(function(){return pe})),n.d(t,"removeNudgeOnConversationsPinnedStoreUpdateOrchestrator",(function(){return Re})),n.d(t,"removeNudgeOnReplyOrReplyAllOrForwardOrchestrator",(function(){return Te})),n.d(t,"updateNudgesOnNudgeOptionChange",(function(){return Ke})),n.d(t,"removeNudgeUponRowUpdate",(function(){return Ce})),n.d(t,"disableNudgeOption",(function(){return Fe}))},1715:function(e,t,n){"use strict";n.d(t,"q",(function(){return d})),n.d(t,"t",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"i",(function(){return w})),n.d(t,"o",(function(){return O})),n.d(t,"b",(function(){return g})),n.d(t,"m",(function(){return I})),n.d(t,"f",(function(){return v})),n.d(t,"p",(function(){return m})),n.d(t,"s",(function(){return h})),n.d(t,"r",(function(){return j})),n.d(t,"g",(function(){return _})),n.d(t,"j",(function(){return N})),n.d(t,"k",(function(){return y})),n.d(t,"n",(function(){return p})),n.d(t,"d",(function(){return R})),n.d(t,"c",(function(){return S})),n.d(t,"h",(function(){return E})),n.d(t,"l",(function(){return T}));var r=n(0),o=n(48),i=n(1641),a=n(1647),u=n(2),c=n(1696),s=n(17),d=Object(u.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(C(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(u.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(C(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(u.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,o){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:o}})),b=Object(u.action)("EXPAND_ROW_FIRST_LEVEL",(function(e,t){return{rowKey:e,latestItemIdsInForks:t}})),w=Object(u.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),O=Object(u.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",(function(e){return{rowKey:e}})),g=Object(u.action)("ITEM_PART_SELECTED",(function(e,t,n,r,o){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:o}})),I=Object(u.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),v=Object(u.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),m=Object(u.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r,o){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r,currentSelectedNodeIds:o}})),h=Object(u.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),j=Object(u.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),_=Object(u.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),N=Object(u.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),y=Object(u.action)("RESET_SELECTION",(function(e){return{tableView:e}})),p=Object(u.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(o.c)(C(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),R=Object(u.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),S=Object(u.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),E=Object(u.action)("RESET_BUS_STOP_STATE_MAP"),T=Object(u.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}}));function C(e,t,n,o){return{name:function(e,t,n,o){return!(function(e){return e===a.b.MailListItemRichPreview||e===a.b.KeyboardShiftEnter||e===a.b.MailListItemBodyDoubleClick}(e)||Object(c.c)()&&!function(e){var t;return e===a.b.KeyboardEnter||e===a.b.MailListItemBody||e===a.b.RouteHandler||e===a.b.CommandBarArrows||e===a.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(s.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,o){if(Object(c.c)())return!1;if(e===a.b.KeyboardUpDown){var u=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==u&&1===t.selectedRowKeys.size){var s=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return o===i.d.Next?s===u+1||s===t.rowKeys.length-1&&u===t.rowKeys.length-1:s===u-1||0===s&&0===u}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,o))}(e,t,n,o)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},173:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,o,a){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):r++;var c={value:n,expire:o+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){i(t),a&&a(t,n)}.bind(this),o)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var a=e[i];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return o&&t++,a.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),o=Date.now(),i=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(i)if(e[a])continue;var u=r[a],c=u.expire-o;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,u.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},3336:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var r=n(2200),o=n(1641),i=n(1737);function a(e,t,n,r){var a=new Date(o.b.getLastDeliveryTimeStamp(n,r)).getTime()-new Date(t).getTime();if(Object(i.l)(r.tableQuery)){var u=new Date(o.b.getLastDeliveryOrRenewTimeStamp(n,r)).getTime()-new Date(e).getTime();return 0!=u?u:a}return a}function u(e,t,n,o,a){return Object(r.a)(a,n.id,e)?Object(i.f)(n,0):c(e,t,n,o)}function c(e,t,n,i){var u=n.rowKeys.length;if(0==u)return 0;var c,s=Object(o.J)(n).sortDirection==o.c.DESCENDING_SORT_DIR;for(c=i;c<u;c++){var d=n.rowKeys[c];if(!Object(r.a)(d,n.id,e)){var l=a(e,t,d,n);if(s?l<=0:l>0)return c}}return u==n.totalRowsInView?u:-1}},360:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r,o=n(0);function i(e){r=e}function a(){var e,t;return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return(i=r)?[4,r()]:[3,2];case 1:i=o.sent(),o.label=2;case 2:if((n=i)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},441:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,o=t%n;return(((e-=r)/n&(t-=o)/n)>>>0)*n+((r&o)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},527:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(10),o=new r.b((function(){return Promise.all([n.e(40),n.e(46),n.e(85),n.e(105),n.e(494)]).then(n.bind(null,1279))})),i=new r.a(o,(function(e){return e.createApolloClient})),a=new r.a(o,(function(e){return e.wrapInApolloProvider})),u=new r.a(o,(function(e){return e.unblockBootResolvers})),c=new r.a(o,(function(e){return e.getApolloClient})),s=new r.c(o,(function(e){return e.ApolloProvider}))},621:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s}));var r=n(0),o=n(527),i=null,a=null;function u(){return d(i),i}function c(){return d(a),a}function s(e){var t=e.lazyResolvers,n=e.lazyLocalStateResolvers,u=e.lazyCreateManagedQueryLink,c=e.context;return i=Promise.all([o.b.import(),t,n,u]).then((function(e){var t=Object(r.__read)(e,4),n=t[0],o=t[1],i=t[2],u=t[3];return a=n({resolvers:o,localStateResolvers:i,createManagedQueryLink:u,context:c})}))}function d(e){if(!e)throw new Error("Apollo client has not been initialized yet.")}},713:function(e,t,n){"use strict";var r=n(621);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.c}));var o=n(527);n.d(t,"c",(function(){return o.a})),n.d(t,"d",(function(){return o.c})),n.d(t,"e",(function(){return o.d})),n.d(t,"f",(function(){return o.e}))},738:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=1,o=16},8607:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1715),o=n(1859);function i(e,t){var n=e[e.length-1],i=t.rowKeys.indexOf(n);i<t.rowKeys.length-1?Object(r.q)(t,t.rowKeys[i+1],!1,o.a.RowRemoval):Object(r.j)(t,o.a.Reset)}}}]);
//# sourceMappingURL=owa.1377.js.map
self.scriptsLoaded['owa.1377.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1377.js'] = (new Date()).getTime();