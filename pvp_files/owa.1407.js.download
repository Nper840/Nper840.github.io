self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1407.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1407],{17453:function(e,t,n){"use strict";n.r(t);var r=n(37),o=n(3338),a=n(3134),c=Object(r.e)(o.a,"reloadTableOnTriageActionFailClone",(function(e){var t=e.tableView;t&&Object(a.a)(t)})),i=n(0),u=n(1737),s=n(127),d=n(148),l=Object(d.action)("onLoadMoreRowsSucceeded")((function(e,t,n,r){e.isLoading=!1,r(e,t,n),e.currentLoadedIndex=e.rowKeys.length})),b=Object(d.action)("onLoadMoreRowsFailed")((function(e,t){e.isLoading=!1,Object(s.r)("TnS_LoadMoreRowsError",[e.tableQuery.listViewType,t])})),f=n(1641),j=n(1730),O=n(2019),w=n(2323);var y=n(2769),g=n(2770),v=n(2877),h=n(794),_=n(2771),I=n(6781);var p=n(18),m=n(2398);function F(e,t){var n=e.rowKeys.length-1,r=e.tableQuery;Object(p.i)("mon-messageList-useGqlForFindItem")?Object(O.h)(Object(f.i)(r),t,r.viewFilter,r.sortBy,Object(u.l)(r),r.focusedViewFilter,r.requestShapeName,Object(j.d)(r),!1,Object(j.e)(r),r.categoryName,Object(f.j)(e,!0),e.rowKeys[n]).then((function(t){var n=[];t.edges&&(n=t.edges.map((function(e){return e.node}))),l(e,n,t.totalItemRowsInView,u.b)})).catch((function(t){var n=Object(w.a)(t);b(e,n)})):function(e,t,n,r,o,a,c,i,u,s){var d=Object(v.a)({FieldURIOrConstant:Object(g.a)({Item:Object(y.a)({Value:t})}),Item:Object(h.a)({FieldURI:"InstanceKey"})}),l=Object(_.a)({Item:d}),b=Object(I.a)({BasePoint:"Beginning",Condition:l,MaxEntriesReturned:n});return Object(O.b)(e,b,r,o,a,c,i,u,Object(O.g)(r),s)}(Object(f.i)(r),e.rowKeys[n],t,r.viewFilter,Object(m.a)(r),r.focusedViewFilter,r.requestShapeName,Object(j.e)(r),r.categoryName,Object(f.j)(e,!0)).then((function(t){"Success"===t.ResponseClass?l(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView,u.b):b(e,t.ResponseCode)}),(function(t){b(e)}))}var T=n(2529),x=50;function R(e){switch(e.isLoading=!0,e.tableQuery.listViewType){case 0:!function(e,t){var n,r=e.rowKeys.length-1,o=e.tableQuery,a=null===(n=Object(f.j)(e,!0))||void 0===n?void 0:n.Id;Object(O.d)(o.folderId,t,o.viewFilter,o.sortBy,Object(u.l)(o),o.focusedViewFilter,o.requestShapeName,Object(j.d)(o),e.rowKeys[r],o.categoryName,a).then((function(t){var n=[];t.edges&&(n=t.edges.map((function(e){return e.node}))),l(e,n,t.totalConversationRowsInView,u.a)})).catch((function(t){var n=Object(w.a)(t);b(e,n)}))}(e,x);break;case 1:F(e,x)}}var L=Object(d.action)("loadMoreInTable")((function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){if(!e)throw new Error("Selected tableview must not be null if loadMoreRows is being called.");if(e.currentLoadedIndex<e.rowKeys.length){if(e.rowKeys.length-e.currentLoadedIndex>=x)return e.currentLoadedIndex+=x,[2];e.currentLoadedIndex=e.rowKeys.length}return 0!=e.tableQuery.type&&2!=e.tableQuery.type||"spotlight"===e.tableQuery.scenarioType?1===e.tableQuery.type&&("SharedFolders"===(t=e.tableQuery).searchScope.kind?K(e):"PrimaryMailbox"===t.searchScope.kind&&S(e)):R(e),[2]}))}))})),K=function(e){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,T.b.import()];case 1:return t.sent()(e.currentLoadedIndex-1,e,"loadMoreInTable",l,b),[2]}}))}))},S=function(e){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return t=e.rowKeys.length-1,n=e.tableQuery,t>n.lastIndexFetched?(n.lastIndexFetched=t,[4,T.c.import()]):[3,2];case 1:r.sent()(t,e,"loadMoreInTable",l,b),r.label=2;case 2:return[2]}}))}))},V=n(7410);function M(){setTimeout((function(){var e=Object(V.a)();Object(a.a)(e)}),3e3)}n.d(t,"reloadTableOnTriageActionFailOrchestrator",(function(){return c})),n.d(t,"loadMoreInTable",(function(){return L})),n.d(t,"reloadInboxPostBoot",(function(){return M}))},2769:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"Constant:#Exchange"},e)}},2770:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"FieldURIOrConstantType:#Exchange"},e)}},2771:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"RestrictionType:#Exchange"},e)}},2877:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"IsEqualTo:#Exchange"},e)}},6781:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"SeekToConditionPageView:#Exchange"},e)}},7410:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1723),o=n(3062);function a(){var e=Object(o.a)();return Object(r.c)(e)}}}]);
//# sourceMappingURL=owa.1407.js.map
self.scriptsLoaded['owa.1407.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1407.js'] = (new Date()).getTime();