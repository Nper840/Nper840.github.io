self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.30.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[30],{117:function(n,r,e){"use strict";var t=e(2),a=e(9),d={calendarEntryMapping:new a.ObservableMap,calendarFolderMapping:new a.ObservableMap,calendarItemIdToChangeKey:new a.ObservableMap,folderIdToCalendarId:new a.ObservableMap,validEntryMapping:new a.ObservableMap,calendarGroupsMapping:new a.ObservableMap,defaultCalendars:new a.ObservableMap};r.a=Object(t.createStore)("calendarsCacheStore",d)},130:function(n,r,e){"use strict";e.d(r,"s",(function(){return c})),e.d(r,"u",(function(){return l})),e.d(r,"g",(function(){return f})),e.d(r,"d",(function(){return I})),e.d(r,"p",(function(){return b})),e.d(r,"o",(function(){return s})),e.d(r,"q",(function(){return p})),e.d(r,"i",(function(){return O})),e.d(r,"f",(function(){return v})),e.d(r,"l",(function(){return j})),e.d(r,"h",(function(){return m})),e.d(r,"k",(function(){return g})),e.d(r,"m",(function(){return y})),e.d(r,"r",(function(){return C})),e.d(r,"n",(function(){return h})),e.d(r,"t",(function(){return M})),e.d(r,"e",(function(){return E})),e.d(r,"b",(function(){return x})),e.d(r,"v",(function(){return F})),e.d(r,"w",(function(){return T})),e.d(r,"y",(function(){return G})),e.d(r,"a",(function(){return w})),e.d(r,"j",(function(){return _})),e.d(r,"x",(function(){return K})),e.d(r,"z",(function(){return S})),e.d(r,"c",(function(){return A}));var t=e(0),a=e(117),d=e(557),u=e(235),o=e(493),i=e(409);function c(n){return n||(n=Object(u.d)().userIdentity),Object(a.a)().defaultCalendars.get(n)}function l(n,r){var e=c(r);return e&&n===e.id}function f(){var n=Object(a.a)().calendarEntryMapping;return Object(t.__spread)(n.values())}function I(){return f().map((function(n){return v(n.id.id)})).filter((function(n){return n}))}function b(){var n=Object(a.a)().calendarGroupsMapping;return Object(t.__spread)(n.values())}function s(n,r){var e=Object(a.a)().calendarGroupsMapping,t=Object(i.a)(r,n);return e.get(t)}function p(n){return Object(a.a)().folderIdToCalendarId.get(n)}function O(n){return Object(a.a)().calendarEntryMapping.get(n)}function v(n){var r=O(n);return r?{id:{id:n,mailboxInfo:Object(t.__assign)({},r.id.mailboxInfo)},calculatedFolderId:E(n),displayName:r.CalendarName,colorScheme:null}:null}function j(n){return Object(a.a)().calendarFolderMapping.get(n.id.id)}function m(n){var r;return O(null===(r=null==n?void 0:n.id)||void 0===r?void 0:r.id)}function g(n){var r=p(n);return r?O(r.id):void 0}function y(n){var r=Object(a.a)().calendarFolderMapping,e=p(n);return e?r.get(e.id):void 0}function C(n){return Object(a.a)().calendarItemIdToChangeKey.get(n)}function h(n){return M(n.id.id)}function M(n){var r=Object(a.a)().calendarFolderMapping.get(n);return r&&(r.FolderId||r.DistinguishedFolderId)?r.FolderId?r.FolderId.Id:r.DistinguishedFolderId:E(n)}function E(n){var r=Object(a.a)().calendarEntryMapping.get(n);if(r){var e=Object(d.a)(r);return e?e.Id:null}return null}function x(n){return!!O(n)}function F(n){var r=Object(a.a)(),e=r.folderIdToCalendarId,t=r.calendarEntryMapping,d=e.get(n);if(d){var u=t.get(d.id);return u&&!u.IsGroupMailboxCalendar&&null!=u.CalendarFolderId}return!1}function T(n){if(F(n)){var r=g(n);return null==r?void 0:r.IsReadOnly}return!1}function G(n){var r=Object(a.a)().validEntryMapping;return n&&r.get(n.ItemId.Id)}function w(n){return!F(M(n))&&!G(O(n))}function _(n){var r,e=Object(a.a)(),d=e.folderIdToCalendarId,u=e.calendarEntryMapping,o=d.get(n);o?r=u.get(o.id):r=Object(t.__spread)(u.values()).filter((function(r){return r.OwnerEmailAddress&&r.OwnerEmailAddress.toLowerCase()==n.toLowerCase()}))[0];return r}function K(n){var r,e;return"TeamsMailbox"==(null===(e=null===(r=null==n?void 0:n.id)||void 0===r?void 0:r.mailboxInfo)||void 0===e?void 0:e.type)}function S(n,r){return[n,r].join(o.a)}function A(n){return n.split(o.a)[0]}},385:function(n,r,e){"use strict";var t="LinkedCalendarEntry:#Exchange";function a(n){return(null==n?void 0:n.__type)==t}function d(n){return(null==n?void 0:n.__type)==t&&!(null==n?void 0:n.IsGroupMailboxCalendar)}function u(n){return n.CanViewPrivateItems||a(n)}e.d(r,"e",(function(){return a})),e.d(r,"f",(function(){return d})),e.d(r,"a",(function(){return t})),e.d(r,"b",(function(){return"LocalCacheForRemoteCalendarEntry:#Exchange"})),e.d(r,"c",(function(){return"TeamsCalendarEntry:#Exchange"})),e.d(r,"d",(function(){return u}))},409:function(n,r,e){"use strict";function t(n,r){return r+"_"+n}e.d(r,"a",(function(){return t}))},493:function(n,r,e){"use strict";e.d(r,"a",(function(){return t}));var t="_CHANNELTEAMSTYPE_"},557:function(n,r,e){"use strict";function t(n){if(void 0!==n.CalendarFolderId)return n.CalendarFolderId;var r=n;return r.IsGeneralScheduleCalendar?{Id:r.OwnerEmailAddress,ChangeKey:""}:r.SharedFolderId?{Id:r.SharedFolderId.Id,ChangeKey:null!=r.SharedFolderId.ChangeKey?r.SharedFolderId.ChangeKey:""}:null}e.d(r,"a",(function(){return t}))},83:function(n,r,e){"use strict";var t=e(117),a=e(0),d=e(2),u=Object(d.action)("initializeCalendarsCacheInStore",(function(n,r,e,t,a,d){return{defaultCalendarEntry:n,calendarEntries:r,calendarFolders:e,calendarGroups:t,folderIdMapping:a,calendarIdToChangeKeyMapping:d}})),o=Object(d.action)("updateChangeKeyByCalendarItemId",(function(n){return{itemId:n}})),i=Object(d.action)("addToCalendarsCache",(function(n,r,e){return{calendarEntry:n,folder:r,mailboxInfo:e}})),c=Object(d.action)("addCalendarGroupToCalendarsCache",(function(n){return{calendarGroup:n}})),l=Object(d.action)("updateCalendarEntry",(function(n,r){return{itemId:n,calendarEntry:r}})),f=Object(d.action)("updateCalendarFolder",(function(n,r){return{calendar:n,calendarFolder:r}})),I=Object(d.action)("removeCalendarFromCalendarsCache",(function(n){return{calendar:n}})),b=Object(d.action)("markCalendarEntryAsValid",(function(n){return{calendarEntry:n}})),s=Object(d.action)("calendarUpdated",(function(n,r){return{calendarId:n,updates:r}})),p=Object(d.action)("groupAssociationChanged",(function(n){return{payload:n}})),O=Object(d.action)("removeCalendarWithIDFromCalendarsCache",(function(n){return{calendarId:n}})),v=Object(d.action)("updateCalendarGroup",(function(n,r,e){return{groupId:n,userIdentity:r,calendarGroup:e}}));Object(d.mutator)(o,(function(n){var r=n.itemId,e=r.Id,a=r.ChangeKey;Object(t.a)().calendarItemIdToChangeKey.set(e,a)})),Object(d.mutator)(l,(function(n){var r=n.itemId.Id,e=n.calendarEntry,d=Object(t.a)().calendarEntryMapping.get(r),u=(e.ItemId,Object(a.__rest)(e,["ItemId"]));d&&Object.keys(u).forEach((function(n){d[n]=u[n]}))})),Object(d.mutator)(b,(function(n){var r=n.calendarEntry;Object(t.a)().validEntryMapping.set(r.ItemId.Id,!0)}));var j=e(130),m=e(409);function g(n,r){Object.keys(r).forEach((function(e){return n.set(e,r[e])}))}function y(n,r,e){var a=Object(t.a)();a.calendarItemIdToChangeKey.delete(n),e||(a.calendarEntryMapping.delete(n),a.validEntryMapping.delete(n)),a.calendarFolderMapping.delete(n),r&&a.folderIdToCalendarId.delete(r)}Object(d.mutator)(u,(function(n){var r=n.defaultCalendarEntry;r&&Object(t.a)().defaultCalendars.set(r.id.mailboxInfo.userIdentity,r)})),Object(d.mutator)(u,(function(n){var r=n.calendarEntries;g(Object(t.a)().calendarEntryMapping,r)})),Object(d.mutator)(u,(function(n){var r=n.calendarFolders;g(Object(t.a)().calendarFolderMapping,r)})),Object(d.mutator)(u,(function(n){var r=n.folderIdMapping;g(Object(t.a)().folderIdToCalendarId,r)})),Object(d.mutator)(u,(function(n){var r=n.calendarIdToChangeKeyMapping;g(Object(t.a)().calendarItemIdToChangeKey,r)})),Object(d.mutator)(u,(function(n){var r=n.calendarGroups;g(Object(t.a)().calendarGroupsMapping,r)})),Object(d.mutator)(i,(function(n){var r=n.calendarEntry,e=n.folder,d=n.mailboxInfo,u=Object(t.a)();u.calendarItemIdToChangeKey.set(r.ItemId.Id,r.ItemId.ChangeKey);var o=Object(a.__assign)(Object(a.__assign)({},r),{id:{id:r.ItemId.Id,mailboxInfo:d}});u.calendarEntryMapping.set(r.ItemId.Id,o),u.calendarFolderMapping.set(r.ItemId.Id,e),e.FolderId?u.folderIdToCalendarId.set(e.FolderId.Id,{id:r.ItemId.Id,mailboxInfo:d}):e.DistinguishedFolderId&&u.folderIdToCalendarId.set(e.DistinguishedFolderId,{id:r.ItemId.Id,mailboxInfo:d})})),Object(d.mutator)(c,(function(n){var r=n.calendarGroup,e=Object(t.a)(),a=Object(m.a)(r.id.mailboxInfo.userIdentity,r.GroupId);e.calendarGroupsMapping.set(a,r)})),Object(d.mutator)(I,(function(n){var r=n.calendar;y(r.id.id,r.calculatedFolderId?r.calculatedFolderId:null)})),Object(d.mutator)(O,(function(n){var r=n.calendarId;y(r,Object(j.t)(r),!0)})),Object(d.mutator)(f,(function(n){var r=n.calendar,e=n.calendarFolder,t=Object(j.l)(r);Object.keys(e).forEach((function(n){t[n]=e[n]}))})),Object(d.mutator)(v,(function(n){var r=n.groupId,e=n.userIdentity,d=n.calendarGroup,u=Object(t.a)(),o=Object(m.a)(e,r),i=u.calendarGroupsMapping.get(o),c=(d.ItemId,Object(a.__rest)(d,["ItemId"]));i&&Object.keys(c).forEach((function(n){i[n]=c[n]}))}));e(493);var C=e(557);function h(n){var r=Object(j.q)(n);return r?r.mailboxInfo:null}function M(n){if(!n)return!1;var r=Object(j.l)(n),e=Object(j.h)(n);return r&&e&&!e.IsReadOnly&&r.EffectiveRights&&r.EffectiveRights.CreateContents}var E=e(385),x=e(17);function F(n,r){var e,t=Object(j.h)(n);if(Object(E.e)(t)){var a=t;return!a.IsOwnerEmailAddressInvalid&&a.OwnerEmailAddress==r}return(null===(e=n.id)||void 0===e?void 0:e.mailboxInfo)?r.indexOf(n.id.mailboxInfo.mailboxSmtpAddress)>=0:Object(x.a)().SessionSettings.UserEmailAddress==r}function T(n){return n?n.map(j.f).filter((function(n){return!!n})):null}function G(n){var r=Object(j.h)(n);return!!r&&r.IsGroupMailboxCalendar}function w(n){var r=Object(j.h)(n);return null==r?void 0:r.IsSchoolCalendar}function _(n){var r=Object(j.h)(n);return 4==(null==r?void 0:r.CalendarFolderType)}var K,S,A=e(71),k=e(18),N=e(365);function D(n){if(n.IsGroupMailboxCalendar){var r=n.OwnerEmailAddress,e=n.id.mailboxInfo.userIdentity;return{MailboxId:Object(j.x)(n)&&Object(k.i)("cal-showAddTeamsCalendars")?Object(j.c)(r):r,MailboxType:Object(N.r)(e)?1:0}}var t=n.CalendarFolderId;if(t){e=n.id.mailboxInfo.userIdentity;return Object(A.t)(e)?{FolderId:t.Id}:Object(N.r)(e)?{FolderId:t.Id,MailboxId:e,MailboxType:Object(N.t)(e)?2:3}:null}return null}function L(n){return Object(j.p)().filter((function(r){return function(n,r){return!!n&&n.id.mailboxInfo.userIdentity===r}(r,n)})).sort(R)}function R(n,r){var e=P[n.GroupType]-P[r.GroupType];if(0!==e)return e;var t=q[n.id.mailboxInfo.type]-q[r.id.mailboxInfo.type];return 0!==t?t:n.GroupName.localeCompare(r.GroupName)}var P=((K={})[0]=0,K[2]=1,K[1]=2,K[3]=3,K),q=((S={}).UserMailbox=0,S.TeamsMailbox=1,S.GroupMailbox=2,S.PublicMailbox=3,S.SharedMailbox=4,S.ArchiveMailbox=5,S);function z(n,r){var e=Object(j.s)(n),t=Object(j.d)().filter((function(t){return function(n,r){return!!n&&n.id.mailboxInfo.userIdentity===r}(t,n)&&U(t,r)&&(d=e,!((a=t)&&d&&a.id.id===d.id.id));var a,d})).sort(V);return e&&U(e,r)&&t.unshift(e),t}function U(n,r){var e=Object(j.h)(n);return!!e&&e.ParentGroupId===r}function V(n,r){return n.displayName.localeCompare(r.displayName)}e.d(r,"F",(function(){return u})),e.d(r,"X",(function(){return o})),e.d(r,"b",(function(){return i})),e.d(r,"a",(function(){return c})),e.d(r,"U",(function(){return l})),e.d(r,"V",(function(){return f})),e.d(r,"S",(function(){return I})),e.d(r,"R",(function(){return b})),e.d(r,"e",(function(){return s})),e.d(r,"E",(function(){return p})),e.d(r,"T",(function(){return O})),e.d(r,"W",(function(){return v})),e.d(r,"x",(function(){return j.s})),e.d(r,"H",(function(){return j.u})),e.d(r,"k",(function(){return j.g})),e.d(r,"g",(function(){return j.d})),e.d(r,"u",(function(){return j.p})),e.d(r,"s",(function(){return j.o})),e.d(r,"v",(function(){return j.q})),e.d(r,"m",(function(){return j.i})),e.d(r,"j",(function(){return j.f})),e.d(r,"p",(function(){return j.l})),e.d(r,"l",(function(){return j.h})),e.d(r,"o",(function(){return j.k})),e.d(r,"q",(function(){return j.m})),e.d(r,"w",(function(){return j.r})),e.d(r,"r",(function(){return j.n})),e.d(r,"y",(function(){return j.t})),e.d(r,"i",(function(){return j.e})),e.d(r,"d",(function(){return j.b})),e.d(r,"K",(function(){return j.v})),e.d(r,"L",(function(){return j.w})),e.d(r,"O",(function(){return j.y})),e.d(r,"c",(function(){return j.a})),e.d(r,"n",(function(){return j.j})),e.d(r,"N",(function(){return j.x})),e.d(r,"Q",(function(){return j.z})),e.d(r,"f",(function(){return j.c})),e.d(r,"h",(function(){return C.a})),e.d(r,"z",(function(){return h})),e.d(r,"t",(function(){return m.a})),e.d(r,"P",(function(){return M})),e.d(r,"G",(function(){return F})),e.d(r,"A",(function(){return T})),e.d(r,"I",(function(){return G})),e.d(r,"M",(function(){return w})),e.d(r,"J",(function(){return _})),e.d(r,"D",(function(){return D})),e.d(r,"B",(function(){return L})),e.d(r,"C",(function(){return z}))}}]);
//# sourceMappingURL=owa.30.js.map
self.scriptsLoaded['owa.30.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.30.js'] = (new Date()).getTime();