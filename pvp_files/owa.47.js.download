self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.47.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[47],{1738:function(e,t,n){"use strict";var r=n(2),i=n(48),c=Object(r.action)("UserInteractionAction",(function(e,t,n,r,c){var a=c&&c.length>0?c.join():"";return Object(i.c)({name:"userInteractionAction",customData:{interactionType:e,viewType:t,propertyNamesList:a,isOrganizer:n,isMeeting:r},options:{isCore:!0}},{interactionType:e,viewType:t,isOrganizer:n,propertyNames:c})})),a=Object(r.action)("setItemUnavailable"),o=n(2343),s=Object(r.action)("dismissUndoNotification");n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o.a})),n.d(t,"a",(function(){return s}))},1768:function(e,t,n){"use strict";var r=n(0),i=n(7093),c=n(5858),a=n(369),o=n(649);function s(e,t){void 0===t&&(t=!1);var n,r=Object(c.a)({ItemId:t?(n=e,Object(o.a)({ChangeKey:n.ChangeKey,OccurrenceId:n.Id})):e});return Object(i.a)({request:r},Object(a.a)(e.mailboxInfo))}var u=n(2),d=n(48);function l(e){switch(e){case 0:return"Default";case 1:return"ThisInstanceOnly";case 2:return"ThisAndFollowingInstances";case 3:return"AllInstancesInSeries"}}function b(e){var t,n={containsLocation:!1,containsRichLocation:!1};return null===(t=e.Locations)||void 0===t||t.forEach((function(e){var t,r;n.containsLocation=!0,null!=(null===(t=e.PostalAddress)||void 0===t?void 0:t.Latitude)&&null!=(null===(r=e.PostalAddress)||void 0===r?void 0:r.Longitude)&&(n.containsRichLocation=!0)})),n}var v=Object(u.action)("ADD_CALENDAR_EVENT_TO_MY_CALENDAR",(function(e,t,n){return void 0===n&&(n=!1),Object(d.c)({name:"addToMyCalendar",customData:{ActionSource:t}},{itemId:e,actionSource:t,addSeries:n})})),f=Object(u.action)("CANCEL_CALENDAR_EVENT",(function(e,t,n,r,i,c){return Object(d.c)({name:"CancelEvent",customData:{actionSource:t,eventScope:l(n),component:r}},{itemId:e,actionSource:t,eventScope:n,cancellationMessage:i,onCancel:c})})),O=Object(u.action)("DELETE_CALENDAR_EVENT",(function(e,t,n,r){return void 0===n&&(n=0),Object(d.c)({name:"DeleteEvent",customData:{actionSource:t,eventScope:l(n),isFocusTimeEvent_2:e.IsBookedFreeBlocks},options:{isCore:!0}},{item:e,actionSource:t,eventScope:n,onDelete:r})})),j=Object(u.action)("RESPOND_TO_CALENDAR_EVENT",(function(e,t,n,r,i,c,a,o,s,u,l,b){var v={itemId:e,currentResponseType:t,newResponseType:n,currentFreeBusyType:r,eventScope:i,sendResponse:c,actionSource:a,responseMessage:o,proposeNewTime:s,showingDeclinedEvents:u,meetingMessageId:l,skipLoggingDatapoint:b};return b?v:Object(d.c)({name:"RespondToEvent",options:{isCore:!0}},v)})),_=Object(u.action)("UPDATE_CALENDAR_EVENT",(function(e,t,n,r,i,c,a,o){return void 0===r&&(r=0),void 0===i&&(i=function(){}),void 0===c&&(c=function(){}),void 0===a&&(a=!1),void 0===o&&(o=!1),Object(d.c)({name:"UpdateEvent"},{event:e,calendarItemUpdates:t,actionSource:n,eventScope:r,onSuccess:i,onError:c,showNotification:a,updateAsCoOrganizer:o})})),p=Object(u.action)("NEW_CALENDAR_EVENT",(function(e,t,n,r){return void 0===n&&(n=function(){}),void 0===r&&(r=function(){}),Object(d.c)({name:"CreateEvent",customData:b(e)},{event:e,actionSource:t,onSuccess:n,onError:r})})),I=Object(u.action)("SHARE_TXP_CALENDAR_EVENT",(function(e,t,n,r,i,c,a){return void 0===c&&(c=function(){}),void 0===a&&(a=function(){}),{itemId:e,requestBody:t,actionSource:n,isOrganizer:r,isMeeting:i,onSuccess:c,onError:a}})),m=Object(u.action)("selectCalendarFromEvent",(function(e){return{parentFolderId:e}}));Object(u.orchestrator)(v,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.itemId,n=e.addSeries,[4,s(t,n)];case 1:return r.sent(),[2]}}))}))}));var g=n(1126),h=n(6),E=n(1919),y=n(3830),S=n(3707),R=n(168);var C=n(127),w=n(1738),T=n(701),x=n(2439),D=n(497),A=n(3974);function M(e,t,n,i,c,a,o,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u=this;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:return i=i||0,s&&s.addCustomData({CancelSeries:i.toString(),CancellationMessageLength:o?o.length.toString():"n/a"}),[4,new Promise((function(o,d){Object(T.s)(e,i,s,(function(e){return Object(r.__awaiter)(u,void 0,void 0,(function(){var i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,t(e)];case 1:return i=r.sent(),(o="Success"==i.ResponseClass)&&Object(w.d)("Cancel",n,c,a),[2,{isSuccessful:o}]}}))}))}),o,(function(e,t,n){Object(A.b)(e,t,n),d(e)}),n,Object(h.b)(g.a),void 0,A.g)}))];case 1:return d.sent(),[2]}}))}))}Object(u.orchestrator)(f,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,o,s,u,d,l;return Object(r.__generator)(this,(function(b){switch(b.label){case 0:return t=e.itemId,n=e.actionSource,i=e.cancellationMessage,c=e.eventScope,o=e.onCancel,s=Object(C.t)(),[4,x.b.import()];case 1:return b.sent()("MeetingCanceled"),u=Object(T.k)(t.Id),d=u.IsOrganizer,l=u.IsMeeting,o&&o(),s&&s.addCustomData({CalendarItemType:u.CalendarItemType}),[4,M(t,(function(e){return function(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c={Header:Object(R.b)(),Body:Object(S.a)({EventId:e,EventScope:t})},i&&(c.Body.Notes=Object(E.a)({BodyType:"HTML",Value:i})),[4,Object(y.a)(c,Object(a.a)(n))];case 1:return[2,r.sent().Body]}}))}))}(e,c,t.mailboxInfo,i)}),n,c,d,l,i,s)];case 2:return b.sent(),Object(D.v)()&&window.opener&&window.close(),[2]}}))}))}));var B=n(2963),P=n(2899);function F(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=t?Object(P.a)({EventId:e,EventScope:t}):Object(P.a)({EventId:e}),[4,Object(B.a)({Header:Object(R.b)(),Body:i},Object(a.a)(n))];case 1:return[2,r.sent().Body]}}))}))}var U=n(30),N=n(390);function q(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,(r=e,i=Object(a.a)(t),void 0===r||r.__type||(r=Object(N.a)(r)),Object(U.a)("RemoveBirthdayEvent",r,i))];case 1:return n.sent().WasSuccessful?[2,{ResponseClass:"Success"}]:[2,{ResponseClass:"Error"}]}var r,i}))}))}var k=n(370),L=n(37),H=new L.c((function(){return Promise.all([n.e(3),n.e(5),n.e(7),n.e(25),n.e(183),n.e(680)]).then(n.bind(null,17531))})),V=new L.a(H,(function(e){return e.deleteEventTravelBookends})),Z=new L.a(H,(function(e){return e.updateEventTravelBookends})),J=(Object(L.d)(H,(function(e){return e.MobilityDropdown})),n(18));Object(u.orchestrator)(O,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return t=e.item,n=e.eventScope,i=e.actionSource,c=e.onDelete,(a=Object(C.t)())&&a.addCustomData({isGroupMailbox:"GroupMailbox"==t.ItemId.mailboxInfo.type,CalendarItemType:t.CalendarItemType}),o=Object(k.x)(t)?function(e){return q(e,t.ItemId.mailboxInfo)}:function(e){return F(e,n,t.ItemId.mailboxInfo)},c&&c(),[4,new Promise((function(e,c){Object(T.s)(t.ItemId,n,a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var c,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,o(e)];case 1:return c=r.sent(),(a="Success"==c.ResponseClass)&&(Object(w.d)("Delete",i,t.IsOrganizer,t.IsMeeting),!Object(J.i)("cal-mf-mobility")||1!=n&&0!=n||V.importAndExecute(t)),[2,{isSuccessful:a}]}}))}))}),e,(function(e,t,n){Object(A.b)(e,t,n),c(e)}),i,void 0,void 0,A.g)}))];case 1:return s.sent(),Object(D.v)()&&window.opener&&window.close(),[2]}}))}))}));var z=n(1125),G=n(2606);var K=n(2607),W=n(563),$=n(799),X=n(801),Y=n(442),Q=n(2344);function ee(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,c,o;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return t=Object($.a)({BaseShape:"IdOnly"}),(n=Object(Y.c)(e)).InstanceKey=void 0,i=Object(X.a)({BaseFolderId:Object(W.a)({Id:e.ParentFolderId.Id})}),c=Object(K.a)(Object(r.__assign)({Items:[n],SavedItemFolderId:i,ClientSupportsIrm:!0,UnpromotedInlineImageCount:0,ItemShape:t,SendMeetingInvitations:"SendToNone"},Object(Q.a)())),(o=Object(R.b)()).TimeZoneContext.TimeZoneDefinition.Id=e.StartTimeZoneId,[4,(u={Header:o,Body:c},d=Object(a.a)(e.ParentFolderId.mailboxInfo),void 0===u||u.__type||(u=Object(G.a)(u)),Object(U.a)("CreateCalendarEvent",u,d))];case 1:return[2,s.sent().Body.ResponseMessages.Items[0]]}var u,d}))}))}Object(u.orchestrator)(p,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o,s,u,d,l;return Object(r.__generator)(this,(function(b){switch(b.label){case 0:t=e.event,n=e.actionSource,i=e.onSuccess,c=e.onError,(a=Object(C.t)())&&a.addCustomData({isRecurrence:!!t.Recurrence}),b.label=1;case 1:return b.trys.push([1,3,,4]),o=function(e){var t={};t.FreeBusyType=e.FreeBusyType,t.ParentFolderId=e.ParentFolderId,t.Sensitivity=e.Sensitivity,t.Subject=e.Subject,t.Body=e.Body,t.Start=e.Start,t.End=e.End,t.IsAllDayEvent=e.IsAllDayEvent,t.IsRoomRequested=e.IsRoomRequested,t.ReminderMinutesBeforeStart=e.ReminderMinutesBeforeStart,t.ReminderIsSet=e.ReminderIsSet,t.CharmId=e.CharmId,t.Resources=e.Resources,t.Locations=e.Locations,t.IsDraft=e.IsDraft,t.DoNotForwardMeeting=e.DoNotForwardMeeting,t.IsResponseRequested=e.IsResponseRequested,t.StartTimeZoneId=e.StartTimeZoneId,t.EndTimeZoneId=e.EndTimeZoneId,t.HideAttendees=e.HideAttendees,t.MeetingNotesWebUrl=e.MeetingNotesWebUrl,t.SkypeTeamsProperties=e.SkypeTeamsProperties,t.AppendOnSend=e.AppendOnSend,t.IsBookedFreeBlocks=e.IsBookedFreeBlocks,t.AssociatedTasks=e.AssociatedTasks,t.CollabSpace=e.CollabSpace,t.TravelTimeEventsLinked=e.TravelTimeEventsLinked,t.FlexEventsMetadata=e.FlexEventsMetadata,e.Recurrence&&(t.Recurrence=e.Recurrence);e.IsOnlineMeeting&&(t.IsOnlineMeeting=e.IsDraft?void 0:e.IsOnlineMeeting);e.OnlineMeetingProvider&&(t.OnlineMeetingProvider=e.IsDraft?void 0:e.OnlineMeetingProvider);e.DocLinks&&(t.DocLinks=e.DocLinks);e.RequiredAttendees&&e.RequiredAttendees.length>0&&(t.RequiredAttendees=e.RequiredAttendees);e.OptionalAttendees&&e.OptionalAttendees.length>0&&(t.OptionalAttendees=e.OptionalAttendees);e.InboxReminders&&e.InboxReminders.length>0&&(t.InboxReminders=e.InboxReminders);e.Categories&&e.Categories.length>0&&(t.Categories=e.Categories);return t}(t),[4,new Promise((function(e,r){Object(T.r)(o,(function(e){var n=ee(e);return a&&a.markUserPerceivedTime(),n.then((function(n){var r="Success"==n.ResponseClass&&n.Items&&n.Items.length>0;return r&&m(e.ParentFolderId.Id),{isSuccessful:r,createdItem:r?Object(Y.a)(n.Items[0],t.ParentFolderId.mailboxInfo):null}}))}),e,(function(e,t,n){Object(A.a)(e,t,n),r(e)}),n,Object(h.b)(z.a),A.c)}))];case 2:return s=b.sent(),u=s.ItemId.Id,d=Object(r.__assign)(Object(r.__assign)({},t),{ItemId:{Id:u,mailboxInfo:s.ParentFolderId.mailboxInfo},UID:s.UID}),i(d),[3,4];case 3:throw l=b.sent(),c(l),l;case 4:return[2]}}))}))}));var te=n(1116);function ne(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"RespondToCalendarEventJsonRequest:#Exchange"},n)),Object(U.a)("RespondToCalendarEvent",e,t)}var re=n(626);function ie(e,t,n,i,c,o,s,u){return void 0===c&&(c=""),void 0===o&&(o=""),void 0===s&&(s=""),void 0===u&&(u=""),Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l;return Object(r.__generator)(this,(function(b){switch(b.label){case 0:d={Header:Object(R.b)(),Body:(v={EventId:e,Response:n,SendResponse:i,Notes:Object(E.a)({BodyType:"HTML",Value:c}),ProposedStartTime:o,ProposedEndTime:s,MeetingRequestIdToBeDeleted:u},Object(r.__assign)({__type:"RespondToCalendarEventRequest:#Exchange"},v))},b.label=1;case 1:return b.trys.push([1,,3,4]),[4,ne(d,Object(a.a)(t))];case 2:return l=b.sent(),[3,4];case 3:return Object(J.i)("cal-mf-diagnostics")&&Object(re.a)({action:"RespondToCalendarEvent",status:l?l.Body.ResponseCode:"Error",response:null==l?void 0:l.Body,request:d}),[7];case 4:return[2,null==l?void 0:l.Body]}var v}))}))}var ce=n(4),ae="Accept",oe="Decline";function se(e,t,n,i,c,a,o,s,u,d,l,b,v,f){return Object(r.__awaiter)(this,void 0,void 0,(function(){var O,j=this;return Object(r.__generator)(this,(function(_){switch(_.label){case 0:return f&&f.addCustomData({ResponseType:n,SendResponse:o.toString(),ResponseMessageLength:b?b.length:"n/a",ShowingDeclinedEvents:v,IsEditRSVP:["Accept","Tentative","Decline"].includes(t),IsProposeNewTime:!!l}),n!=oe||Object(J.i)("cal-surface-declinedMeetings")?[3,2]:[4,new Promise((function(t,i){Object(T.s)(e,c,f,(function(e){return Object(r.__awaiter)(j,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,ue(e,a,null)];case 1:return(t=r.sent()).isSuccessful&&(l?Object(w.d)("ProposeNewTime",s,u,d,[n]):Object(w.d)("Decline",s,u,d),Object(A.e)(s,n,!!l)),[2,t]}}))}))}),t,(function(e,t,n){Object(A.b)(e,t,n),i(e)}),s,Object(h.b)(te.a),o,A.g)}))];case 1:return _.sent(),[3,4];case 2:return O=Object(T.j)(i,t,n),[4,new Promise((function(t,i){Object(T.t)(e,O,c,(function(e){return Object(r.__awaiter)(j,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,ue(e,a,f)];case 1:return(t=r.sent()).isSuccessful&&(l?Object(w.d)("ProposeNewTime",s,u,d,[n]):n==ae?Object(w.d)("Accept",s,u,d):n==oe?Object(w.d)("Decline",s,u,d):Object(w.d)("Tentative",s,u,d),Object(A.e)(s,n,!!l)),[2,t]}}))}))}),t,(function(e,t,n){Object(A.f)(e,t,n),i(e)}),s)}))];case 3:_.sent(),_.label=4;case 4:return[2]}}))}))}function ue(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=t(e),n&&n.markUserPerceivedTime(),[4,i];case 1:return[2,{isSuccessful:"Success"==r.sent().ResponseClass}]}}))}))}Object(u.orchestrator)(j,(function(e){var t=e.actionSource,n=e.itemId,r=e.proposeNewTime,i=e.eventScope,c=e.responseMessage,a=e.currentResponseType,o=e.newResponseType,s=e.currentFreeBusyType,u=e.sendResponse,d=e.showingDeclinedEvents,l=e.meetingMessageId,b=Object(C.t)((function(e){return"RespondToEvent"==e.eventName})),v=Object(T.k)(n.Id),f=v.IsOrganizer,O=v.IsMeeting,j="Exception"==v.CalendarItemType,_=[];_.push(se(n,a,o,s,i,(function(e){return ie(e,n.mailboxInfo,o,u,c,r?Object(ce.rb)(r.Start):"",r?Object(ce.rb)(r.End):"",l)}),u,t,f,O,r,c,d,b)),!j||3!==i||o!=ae&&"Tentative"!=o||_.push(se(n,a,o,s,0,(function(e){return ie(e,n.mailboxInfo,o,!1,null,r?Object(ce.rb)(r.Start):"",r?Object(ce.rb)(r.End):"",l)}),!1,t,f,O,r,null,d,null)),Promise.all(_).then((function(e){Object(D.v)()&&window.opener&&window.close()}))}));function de(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ShareTailoredExperienceEventJsonRequest:#Exchange"},n)),Object(U.a)("ShareTailoredExperienceEvent",e,t)}function le(e,t){var n;return de({Header:Object(R.b)(),Body:(n=Object(r.__assign)({EventId:Object(T.o)(e.Id,0)},t),Object(r.__assign)({__type:"ShareTailoredExperienceEventRequest:#Exchange"},n))},Object(a.a)(e.mailboxInfo)).catch((function(e){return null}))}Object(u.orchestrator)(I,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o,s,u,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=e.itemId,n=e.requestBody,i=e.actionSource,c=e.isOrganizer,a=e.isMeeting,o=e.onSuccess,s=e.onError,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,le(t,n)];case 2:return(null==(u=r.sent())?void 0:u.Body)&&"Success"===u.Body.ResponseClass?(Object(w.d)("TxpEventShared",i,c,a),o()):s(new Error('Failure response from server for shareTxtCalendarEvent for item "'+t.Id+'"')),[3,4];case 3:return d=r.sent(),s(d),[3,4];case 4:return[2]}}))}))}));var be=n(4855),ve=n(3226),fe=n(794),Oe=n(440),je=n(678),_e=n(2154),pe=n(1927),Ie=n(9),me={Start:{getEwsValue:ge},End:{getEwsValue:ge},Subject:{},Body:{},IsAllDayEvent:{},IsRoomRequested:{},IsDraft:{},Locations:{},Recurrence:{getEwsValue:function(e,t){var n=Object(Ie.toJS)(e);if(n){var r=n.RecurrenceRange,i=r.StartDate,c=r.EndDate;i&&(r.StartDate=Object(ce.nb)(Object(ce.Rb)(t,i))),c&&(r.EndDate=Object(ce.nb)(Object(ce.Rb)(t,c)))}return n},useDeleteItemField:!0},FreeBusyType:{fieldUri:"LegacyFreeBusyStatus"},ReminderMinutesBeforeStart:{},ReminderIsSet:{},CharmId:{fieldUri:"Charm",useDeleteItemField:!0},Sensitivity:{},Categories:{fieldUri:"Categories"},IsResponseRequested:{fieldUri:"CalendarIsResponseRequested"},DoNotForwardMeeting:{},RequiredAttendees:{},IsOnlineMeeting:{},OnlineMeetingProvider:{},OptionalAttendees:{},InboxReminders:{getEwsValue:function(e){return e&&0!==e.length?e:null},useDeleteItemField:!0},Resources:{},StartTimeZoneId:{},EndTimeZoneId:{},InReplyTo:{},HideAttendees:{},MeetingNotesWebUrl:{useDeleteItemField:!0},SkypeTeamsProperties:{},DocLinks:{},CollabSpace:{extendedPropertyUri:{DistinguishedPropertySetId:"PublicStrings",PropertyName:"MeetingAgenda",PropertyType:"String"}}};function ge(e,t){return e?Object(ce.rb)(Object(ce.Rb)(t,e)):null}var he=n(71),Ee=n(5163),ye=n(4856);function Se(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(Ee.a)({Header:Object(R.b)(),Body:Object(ye.a)({ToFolderId:Object(X.a)({BaseFolderId:Object(W.a)({Id:t.Id})}),ItemIds:[Object(N.a)({Id:e.Id})]})},Object(a.a)(t.mailboxInfo))];case 1:return[2,n.sent().Body.ResponseMessages.Items[0]]}}))}))}function Re(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"UpdateBirthdayEventJsonRequest:#Exchange"},n)),Object(U.a)("UpdateBirthdayEvent",e,t)}var Ce=n(5201);function we(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c;return Object(r.__generator)(this,(function(o){switch(o.label){case 0:return i&&(i=i.map((function(e){return Object(Ce.a)(e)}))),c=function(e){return Object(r.__assign)({__type:"UpdateBirthdayEventRequest:#Exchange"},e)}({PopupReminderSettings:n?[(s=n,Object(r.__assign)({__type:"PopupReminderSetting:#Exchange"},s))]:void 0,EmailReminderSettings:i,Id:e}),[4,Re({Header:Object(R.b)(),Body:c},Object(a.a)(t))];case 1:return[2,o.sent().Body]}var s}))}))}function Te(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"UpdateCalendarEventJsonRequest:#Exchange"},n)),Object(U.a)("UpdateCalendarEvent",e,t)}function xe(e,t,n,i,c,o,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,d;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return b={EventId:t,ItemChange:i,EventScope:c},u=Object(r.__assign)({__type:"UpdateCalendarEventRequest:#Exchange"},b),o&&(u.ShouldSendUpdateToAttendees=!0),s&&(u.UpdateAsCoOrganizer=s),(d=Object(R.b)()).TimeZoneContext.TimeZoneDefinition.Id=e,[4,Te({Header:d,Body:u},Object(a.a)(n))];case 1:return[2,l.sent().Body.ResponseMessages.Items[0]]}var b}))}))}var De=n(1703),Ae=n(2100);function Me(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ForwardCalendarEventJsonRequest:#Exchange"},n)),Object(U.a)("ForwardCalendarEvent",e,t)}function Be(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,o;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return c={Header:Object(R.b)(),Body:(u={Forwardees:t.map((function(e){return Object(r.__assign)(Object(r.__assign)({},e.Mailbox),{RelevanceScore:0})})),Importance:"Normal",EventId:Object(T.o)(e.Id,i)},Object(r.__assign)({__type:"ForwardCalendarEventRequest:#Exchange"},u))},n&&(c.Body.Notes=Object(E.a)({BodyType:"HTML",Value:n})),[4,Me(c,Object(a.a)(e.mailboxInfo))];case 1:return[2,"Success"===(o=s.sent()).Body.ResponseClass?o:null]}var u}))}))}Object(u.orchestrator)(_,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o,s,u,d,l,b,v,f,O,j,_;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:if(t=e.event,n=e.calendarItemUpdates,i=e.actionSource,c=e.eventScope,a=e.onSuccess,o=e.onError,s=e.showNotification,u=e.updateAsCoOrganizer,!n)return a(),[2];d=Object(k.x)(t),(l=Object(C.t)())&&l.addCustomData({updateRecurrence:c&&(!!n.Start||!!n.End)||!!n.Recurrence,isBirthdayEvent:d}),p.label=1;case 1:return p.trys.push([1,3,,4]),b=n.StartTimeZoneId||t.StartTimeZoneId,v=n.EndTimeZoneId||t.EndTimeZoneId,f=d?Object(he.p)():b,O=Object.keys(n).map((function(e){return function(e,t,n){var r,i=me[e];if(i){if(i.extendedPropertyUri){var c={ExtendedFieldURI:i.extendedPropertyUri,Value:t};return Object(_e.a)({Path:Object(Oe.a)(c.ExtendedFieldURI),Item:Object(pe.a)({ExtendedProperty:[Object(je.a)(c)]})})}var a=i.fieldUri,o=void 0===a?e:a,s=i.getEwsValue,u=i.useDeleteItemField,d=Object(fe.a)({FieldURI:o}),l=s?s(t,n):t;return!u||l?Object(_e.a)({Path:d,Item:Object(be.a)((r={},r[e]=l,r))}):Object(ve.a)({Path:d})}return null}(e,n[e],"End"===e?v:f)})).filter((function(e){return!!e})),Object(w.d)("EventEdited",i,t.IsOrganizer,t.IsMeeting,O.map((function(e){return e.Path.FieldURI}))),j=d?function(e,t,n){var i=this;return function(c){return Object(r.__awaiter)(i,void 0,void 0,(function(){var i,a,o,s,u,d,l,b,v,f,O;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i="Success",e&&e.markUserPerceivedTime(),(a=Object(De.a)(n,(function(e){return"ReminderIsSet"==e.Path.FieldURI})))&&(o=n[a.index].Item.ReminderIsSet),(s=Object(De.a)(n,(function(e){return"ReminderMinutesBeforeStart"==e.Path.FieldURI})))&&(u=n[s.index].Item.ReminderMinutesBeforeStart),(d=Object(De.a)(n,(function(e){return"InboxReminders"==e.Path.FieldURI})))&&(l=null!==(O=null===(f=null===(v=d.item)||void 0===v?void 0:v.Item)||void 0===f?void 0:f.InboxReminders)&&void 0!==O?O:null),n.length>0&&(a&&s||d)?[4,we(c,t.mailboxInfo,a&&s?{IsReminderSet:o,ReminderMinutesBeforeStart:u}:void 0,l)]:[3,2];case 1:return[2,{isSuccessful:(b=r.sent()).ResponseClass==i&&null!=b.BirthdayEvent}];case 2:return[2,{isSuccessful:!0}]}}))}))}}(l,t.ItemId,O):function(e,t,n,i,c,a,o){var s=this,u=!!c.Attachments;return function(d){return Object(r.__awaiter)(s,void 0,void 0,(function(){var s,l,b,v,f,O,j;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s="Success",l=d,t&&t.markUserPerceivedTime(),c.ParentFolderId?[4,Se(n,c.ParentFolderId)]:[3,2];case 1:if((null==(b=r.sent())?void 0:b.ResponseClass)!=s||0==(null===(O=null==b?void 0:b.Items)||void 0===O?void 0:O.length))return[2,{isSuccessful:!1}];l=(null==b?void 0:b.Items)?null===(j=null==b?void 0:b.Items[0])||void 0===j?void 0:j.ItemId:d,r.label=2;case 2:return a.length||u?(v=u,[4,xe(e,l,n.mailboxInfo,Object(Ae.a)({Updates:a,ItemId:l}),i,v,o)]):[3,4];case 3:return[2,{isSuccessful:(f=r.sent()).ResponseClass==s&&f.Items.length>0}];case 4:return[2,{isSuccessful:!0}]}}))}))}}(f,l,t.ItemId,c,n,O,u),[4,new Promise((function(e,r){Object(T.t)(t.ItemId,n,c,j,e,(function(e,t,n){Object(A.f)(e,t,n),r(e)}),i,Object(h.b)(te.a),s?function(){return Object(A.d)(t,i)}:function(){})}))];case 2:return p.sent(),Object(J.i)("cal-mf-mobility")&&Z.importAndExecute(t,n),a(),[3,4];case 3:throw _=p.sent(),o(_),_;case 4:return[2]}}))}))})),n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return O})),n.d(t,"j",(function(){return j})),n.d(t,"k",(function(){return _})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return ee})),n.d(t,"e",(function(){return Be})),n.d(t,"d",(function(){return F})),n.d(t,"i",(function(){return q}))},1927:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},2100:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},2154:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},2343:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.action)("setIsDeepLinkAction",(function(e){return{isDeepLink:e}}))},2344:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(17);function i(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},2439:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}));var r=n(37),i=new r.c((function(){return Promise.all([n.e(22),n.e(23),n.e(590)]).then(n.bind(null,4305))})),c=new r.a(i,(function(e){return e.loadAndInitializeFloodgateEngine})),a=new r.b(i,(function(e){return e.logFloodgateActivity}))},2606:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CreateItemJsonRequest:#Exchange"},e)}},2607:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CreateItemRequest:#Exchange"},e)}},3226:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemField:#Exchange"},e)}},3707:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CancelCalendarEventRequest:#Exchange"},e)}},3830:function(e,t,n){"use strict";var r=n(30),i=n(0);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"CancelCalendarEventJsonRequest:#Exchange"},n)),Object(r.a)("CancelCalendarEvent",e,t)}n.d(t,"a",(function(){return c}))},3974:function(e,t,n){"use strict";var r=n(6),i=n(1873),c=n(7905);function a(e){i.f.import().then((function(t){t("instantCalendarEventCreate",e,Object(r.b)(c.a),{icon:"CheckMark"})}))}var o=n(2033),s=n(1126);function u(e){var t=typeof e;return"object"===t&&e.message?e.message:"string"==t?e:null}function d(e,t,n){t&&i.g.import().then((function(c){c("instantCalendarEventDeleteFailed",n,function(e){var t=u(e);return t||Object(r.b)(s.a)}(e),Object(r.b)(o.a),(function(){return t()}),"Delete",i.a.Retry)}))}var l=n(1125);function b(e,t,n){i.g.import().then((function(c){c("instantCalendarEventCreateFailed",n,function(e){var t=u(e);return t||Object(r.b)(l.a)}(e),Object(r.b)(o.a),(function(){return null==t?void 0:t()}),"Error",i.a.Retry)}))}var v=n(1116);function f(e,t,n){t&&i.g.import().then((function(c){c("updateCalendarEventFailed",n,function(e){var t=u(e);return t||Object(r.b)(v.a)}(e),Object(r.b)(o.a),(function(){return t()}),"Error",i.a.Retry)}))}var O=n(7906);function j(e,t){var n=e.IsMeeting||e.RequiredAttendees.length>0||e.OptionalAttendees.length>0,c=n?Object(r.b)(O.b):Object(r.b)(O.a),a={icon:n?"Send":"Save"};setTimeout((function(){i.f.import().then((function(e){e("instantCalendarEventUpdate",t,c,a)}))}),0)}var _=n(7907),p=n(111);function I(e,t,n){var c=function(e,t){var n;switch(e){case"Accept":n=Object(r.b)(_.a);break;case"Tentative":n=t?Object(r.b)(_.e):Object(r.b)(_.d);break;case"Decline":n=t?Object(r.b)(_.c):Object(r.b)(_.b);break;default:Object(p.a)(e)}return n}(t,n);i.f.import().then((function(t){t("respondToEvent",e,c,{icon:"CalendarReply"})}))}var m=n(2646),g=n(7908);function h(e,t,n){var c=Object(r.b)(g.c);return e.IsMeeting&&t&&!e.IsCancelled&&(c=e.IsOrganizer?Object(r.b)(g.a):Object(r.b)(g.b)),new Promise((function(e,t){i.f.import().then((function(t){t("instantCalendarEventDelete",n,c,{icon:"Error",primaryActionHotKeyCommand:i.a.Undo},{primaryActionText:Object(r.b)(m.a),notificationCallback:function(t){t===i.b.PrimaryActionClicked?e(!0):e(!1)}})}))}))}n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return b})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return I})),n.d(t,"g",(function(){return h}))},4855:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CalendarItem:#Exchange"},e)}},4856:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"MoveItemRequest:#Exchange"},e)}},5163:function(e,t,n){"use strict";var r=n(30),i=n(0);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"MoveItemJsonRequest:#Exchange"},n)),Object(r.a)("MoveItem",e,t)}n.d(t,"a",(function(){return c}))},5201:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"InboxReminderType:#Exchange"},e)}},5858:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"AddEventToMyCalendarRequest:#Exchange"},e)}},7093:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(30),i=n(5858);function c(e,t){return void 0===e.request||e.request.__type||(e.request=Object(i.a)(e.request)),Object(r.a)("AddEventToMyCalendar",e,t)}},7905:function(e){e.exports=JSON.parse('{"a":"xra"}')},7906:function(e){e.exports=JSON.parse('{"b":"Gra","a":"Hra"}')},7907:function(e){e.exports=JSON.parse('{"a":"Ira","d":"Jra","e":"Kra","b":"Lra","c":"Mra"}')},7908:function(e){e.exports=JSON.parse('{"c":"Cra","a":"Dra","b":"Era"}')}}]);
//# sourceMappingURL=owa.47.js.map
self.scriptsLoaded['owa.47.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.47.js'] = (new Date()).getTime();