self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.61.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[61],{11492:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,'.CN8b_H-vp26NxjABwwT7a{white-space:nowrap;color:"[theme:redDark, default:#a80000]";font-weight:400}html[dir=ltr] .rK3aivbMQMOCkH0WcMu-q{margin-right:10px}html[dir=rtl] .rK3aivbMQMOCkH0WcMu-q{margin-left:10px}',""]),t.locals={couponRow:"CN8b_H-vp26NxjABwwT7a",icon:"rK3aivbMQMOCkH0WcMu-q"}},1737:function(e,t,n){"use strict";var r=n(0);function o(e,t){var n,r;switch(t){case 0:n=e.LastDeliveryOrRenewTime,r=e.LastDeliveryTime;break;case 1:n=e.ReceivedOrRenewTime,r=e.DateTimeReceived}return{lastDeliveryOrRenewTimeStamp:n,lastDeliveryTimeStamp:r}}var i=n(1974);function a(e,t){var n=o(e,t.tableQuery.listViewType);return!!(t.lastEmptiedTime&&t.lastEmptiedTime>new Date(n.lastDeliveryTimeStamp))||i.a.getTombstonedReasons(e.InstanceKey,t.serverFolderId).indexOf(3)>-1}var u=n(18),s=n(3408),c=n(5817),d=n(2982),l=n(1730),f=n(7965),v=n(6298),b=n(17);function m(e){var t=e.tableQuery.listViewType,n=Object(l.b)(e);Object(b.a)().UserOptions.ShowInlinePreviews&&s.b.importAndExecute(n,t),Object(u.i)("tri-coupon-peek")&&c.d.import().then((function(e){e(n.mailboxSmtpAddress,t)}));var r=e.id!==Object(d.a)();f.b.importAndExecute(n,t,r),Object(u.i)("tri-txpButtonInLV")&&v.d.importAndExecute(n,t,r)}var w=n(1641),p=n(4886),I=n(2422),y=n(2200),O=n(148),h=Object(O.action)("appendRowResponse")((function(e,t,n,o,i,s,c){var d,l;void 0===o&&(o=""),void 0===c&&(c=!1);var f=t||[],v=0;try{for(var b=Object(r.__values)(f),O=b.next();!O.done;O=b.next()){var h=O.value;if(!a(h,e)){var R=!0,g=h.InstanceKey;if(I.a.containsRowKey(e,Object(w.D)(h,e.tableQuery.listViewType))){var j=Object(y.a)(g,e.id,w.b.getLastDeliveryOrRenewTimeStamp(g,e))?e.rowKeys.indexOf(g):e.rowKeys.length-1;I.a.updateRow(j,h,e,o,c)}else R=I.a.appendRow(h,e,o,c);if(Object(u.i)("tri-handleTableAddFailures")&&!R&&v++,i){var T={referenceKey:h.ReferenceKey,index:e.rowKeys.length-1,traceId:i,logicalId:s};Object(p.a)(g,e,T)}}}}catch(e){d={error:e}}finally{try{O&&!O.done&&(l=b.return)&&l.call(b)}finally{if(d)throw d.error}}e.totalRowsInView=n-v,m(e)})),R=n(1709),g=n(966);function j(e){if(Object(R.e)(e))return!1;if(0==e.type){var t=e.sortBy,n=w.c.getSortBySupportingPin();return t.sortColumn==n.sortColumn&&t.sortDirection==n.sortDirection&&function(e){if(!e)throw new Error("Current folder id should not be null");return Object(g.a)("sentitems")!=e&&Object(g.a)("deleteditems")!=e&&Object(g.a)("drafts")!=e&&Object(g.a)("junkemail")!=e&&Object(g.a)("archive")!=e}(e.folderId)}return 1==e.type}var T=n(20),x=n(2610),C=n(1647);function S(e,t){var n=!1;switch(t.tableQuery.listViewType){case 0:n=K(t.tableQuery,Object(x.a)(e.InstanceKey,t.id),e);break;case 1:n=D(t.tableQuery,e,C.u.items.get(e.ItemId.Id))}return n}var K=Object(O.select)({listViewStore:function(){return w.Y}})((function(e,t,n,r){if(0!==e.type&&2!==e.type)return T.d("isConversationSortKeyEqual should not be called on non MailFolderTableQuery type"),!1;var o=e.sortBy;if(!o)throw new Error("SortBy should not be null");var i=t.instanceKey===n.InstanceKey,a=function(e,t,n){var r=new Date(t.lastDeliveryTimeStamp).getTime()===new Date(n.LastDeliveryTime).getTime();if(j(e)){return new Date(t.lastDeliveryOrRenewTimeStamp).getTime()===new Date(n.LastDeliveryOrRenewTime).getTime()&&r}return r}(e,t,n);if(!i||!a)return!1;var u=r.listViewStore.conversationItems.get(t.id);switch(o.sortColumn){case 1:case 3:return!0;case 5:return u.subject===n.ConversationTopic;case 8:return t.importance===n.Importance;case 7:return u.size===n.Size;default:return T.g.warn("isSortKeyEqual: sortColumn not supported "+o.sortColumn),!1}}));function D(e,t,n){if(0!=e.type&&2!==e.type)return T.d("isItemSortKeyEqual should not be called on non MailFolderTableQuery type"),!1;var r=e.sortBy;if(!r)throw new Error("SortBy should not be null");var o=t.InstanceKey===n.InstanceKey,i=function(e,t,n){var r=new Date(t.DateTimeReceived).getTime()===new Date(n.DateTimeReceived).getTime();if(j(e)){return new Date(t.ReceivedOrRenewTime).getTime()===new Date(n.ReceivedOrRenewTime).getTime()&&r}return r}(e,t,n);if(!o||!i)return!1;switch(r.sortColumn){case 1:return!0;case 5:return t.Importance===n.Importance;case 8:return t.Subject===n.Subject;case 3:var a=M(t),u=M(n);return!a||!u||(a.From&&a.From.Mailbox.EmailAddress)===(u.From&&u.From.Mailbox.EmailAddress);case 7:return t.Size===n.Size;default:return T.g.warn("isSortKeyEqual: sortColumn not supported "+r.sortColumn),!1}}function M(e){return-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.Note")?e:null}var F=n(127),E=n(2),V=Object(E.action)("ON_MERGE_ROW_COMPLETED",(function(e){return{tableView:e}})),A=Object(O.action)("mergeRowResponseFromTop")((function(e,t,n,o,i,s){var c,d;if(e){if(i){for(var l=!0,f=0;f<Math.min(t.rowKeys.length,2,e.length);f++)if(t.rowKeys[f]!=e[f].InstanceKey||!S(e[f],t)){l=!1;break}Object(F.s)("TnS_MergeFindResponse",[l])}var v=0,b=0,p=t.tableQuery.listViewType;try{for(var O=Object(r.__values)(e),h=O.next();!h.done;h=O.next()){var R=h.value;if(!a(R,t)){var g=Object(w.D)(R,p),j=!0;I.a.containsRowKey(t,g)?Object(u.i)("tri-smartMergeFindResponse")&&w.b.getLastModifiedTimeStamp(g,t)===R.LastModifiedTime?I.a.updateRowPosition(v,g,t,s):I.a.updateRow(v,R,t,s):j=I.a.addRow(v,R,t,s),!Object(u.i)("tri-handleTableAddFailures")||j?v++:b++}}}catch(e){c={error:e}}finally{try{h&&!h.done&&(d=O.return)&&d.call(O)}finally{if(c)throw c.error}}if(o){var x=v;for(f=t.rowKeys.length-1;f>=x;f--){g=t.rowKeys[f];Object(y.a)(g,t.id,w.b.getLastDeliveryOrRenewTimeStamp(g,t))||I.a.removeRow(g,t,s+"_RemoveAfterMerge")}}V(t),t.totalRowsInView=n-b,m(t)}else T.d("We need to have a valid list of rows")}));function P(e,t,n){if(t&&0!=t.length){var r=t[0].InstanceKey,o=Object(x.a)(r,e.id);o&&K(e.tableQuery,o,t[0])&&h(e,t,n,"AppendOnLoadMore")}}function Q(e,t,n){if(t&&0!=t.length){var r=t[0].ItemId.Id;C.u.items.has(r)&&(1==e.tableQuery.type||D(e.tableQuery,C.u.items.get(r),t[0]))&&h(e,t,n,"AppendOnLoadMore")}}function L(e,t){var n;for(n=t;n<e.rowKeys.length&&w.b.getIsPinned(e.rowKeys[n],e);n++);return n}var k=n(7133),_=new Map;function U(e,t){var n,r=Object(w.Q)(t);n=r?e.LastDeliveryOrRenewTime:e.ReceivedOrRenewTime;var o=w.b.getLastDeliveryOrRenewTimeStamp(e.InstanceKey,t),i=new Date(n).toString()===new Date(o).toString();return i||(r?e.LastDeliveryOrRenewTime=o:e.ReceivedOrRenewTime=o),i}function q(e,t,n){return(0,_[n])(e,t)}function B(e,t){return!a(e,t)&&(function(e,t){var n,o,a=e.InstanceKey,u=t.serverFolderId,s=i.a.getTombstonedReasons(a,u).slice(0);if(s)try{for(var c=Object(r.__values)(s),d=c.next();!d.done;d=c.next()){var l=d.value;if(3==l)throw new Error("syncTombstonedProperties should not be called for Remove reason");q(e,t,l)&&i.a.remove(a,u,l)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}}(e,t),!0)}function N(e,t){var n=e.InstanceKey,r=t.serverFolderId,o=i.a.getTombstonedReasons(n,r);return o.indexOf(3)>-1?(i.a.remove(n,r,3),!0):!("Unread"===Object(w.P)(t)&&Object(w.f)(t)&&o.indexOf(2)>-1)||(i.a.remove(n,r,2),!1)}_[1]=U,_[0]=function(e,t){var n=w.b.getCategories(e.InstanceKey,t),r=n?n.slice().sort():[],o=e.Categories?e.Categories.slice().sort():[],i=k(r,o);i||(e.Categories=n);return i},_[2]=function(e,t){var n,r,o,i=w.b.getUnreadCount(e.InstanceKey,t);Object(w.Q)(t)?(r=(n=e).UnreadCount,(o=i==r)||(n.UnreadCount=i),Object(w.e)(t)&&(!function(e,t){var n=e,r=n.LastDeliveryTime,o=w.b.getLastDeliveryTimeStamp(e.InstanceKey,t);new Date(r).toString()!==new Date(o).toString()&&(n.LastDeliveryTime=o)}(e,t),U(e,t))):Object(w.W)(e)?(r=(n=e).IsRead?0:1,(o=i==r)||(n.IsRead=0==i)):o=!0;return o},_[4]=function(){},n.d(t,"c",(function(){return h})),n.d(t,"h",(function(){return A})),n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return Q})),n.d(t,"l",(function(){return j})),n.d(t,"f",(function(){return L})),n.d(t,"d",(function(){return m})),n.d(t,"k",(function(){return B})),n.d(t,"j",(function(){return N})),n.d(t,"g",(function(){return S})),n.d(t,"e",(function(){return o})),n.d(t,"i",(function(){return V}))},1974:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",(function(){return c})),n.d(r,"remove",(function(){return d})),n.d(r,"removeAll",(function(){return l})),n.d(r,"getCount",(function(){return f})),n.d(r,"getTombstonedReasons",(function(){return v})),n.d(r,"clearMapForFolder",(function(){return b})),n.d(r,"removeRowsFromTombstone",(function(){return m}));var o=n(0),i=n(2),a=Object(i.createStore)("tombstone",{folderTombstoneMap:{}}),u=(a(),n(127)),s=n(148),c=Object(s.action)("tombstoneOperations.add")((function(e,t,n){if(1!=t.tableQuery.type&&"spotlight"!==t.tableQuery.scenarioType){var r=t.serverFolderId,o=a().folderTombstoneMap;r in o||(o[r]={});var i=o[r];e.forEach((function(e){var t=i[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):i[e]=[3]:i[e]=[n]}))}})),d=Object(s.action)("tombstoneOperations.remove")((function(e,t,n){var r=a().folderTombstoneMap;if(t in r){var o=r[t],i=o[e],u=i?i.indexOf(n):-1;if(-1==u)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");i.splice(u,1),0==i.length&&delete o[e],0==Object.keys(o).length&&delete r[t]}})),l=Object(s.action)("tombstoneOperations.removeAll")((function(){a().folderTombstoneMap={},Object(u.s)("TnS_RemoveAllFromTombstone")})),f=function(e,t){var n=a().folderTombstoneMap;if(!(e in n))return 0;var r=0,o=n[e];return Object.values(o).forEach((function(e){e==t&&r++})),r},v=function(e,t){var n=a().folderTombstoneMap;if(t in n){var r=n[t][e];if(r)return r}return[]},b=Object(s.action)("tombstoneOperations.clearMapForFolder")((function(e){var t=a().folderTombstoneMap;t[e]&&(Object(u.s)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])})),m=Object(s.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,t){var n,r,i=a().folderTombstoneMap;if(t in i){var u=i[t];try{for(var s=Object(o.__values)(e),c=s.next();!c.done;c=s.next()){var d=c.value;d in u&&delete u[d]}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}0==Object.keys(u).length&&delete i[t]}}));t.a=r},2422:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"addRow",(function(){return G})),n.d(r,"appendRow",(function(){return W})),n.d(r,"removeRow",(function(){return Y})),n.d(r,"updateRowPosition",(function(){return $})),n.d(r,"updateRow",(function(){return Z})),n.d(r,"updateRowData",(function(){return J})),n.d(r,"clear",(function(){return X})),n.d(r,"containsRowKey",(function(){return ee}));var o=n(0),i=n(3408),a=n(5817),u=n(1730),s=n(71),c=n(18),d=n(1709),l=n(738),f=n(441);var v=n(1641),b=n(6298);function m(e,t,n,r){return!!(e>0&&Object(c.i)("tri-txpButtonInLV")&&!Object(d.e)(r.tableQuery)&&function(e){return e>0&&(Object(f.a)(e,l.b)==l.b||Object(f.a)(e,l.a)==l.a)}(e))&&(Object(v.K)().txpActionButtonData.get(n)||b.b.importAndExecute(r,t,n),!0)}function w(e,t){return{Id:e.ConversationId.Id,mailboxInfo:Object(u.b)(t)}}function p(e,t){var n=function(e){var t,n,r=[];try{for(var i=Object(o.__values)(e),a=i.next();!a.done;a=i.next()){var u=a.value,s=Object(o.__assign)({},u);r.push(s.Id)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e.GlobalItemIds),r=e.ItemIds[0].Id;return{id:e.ConversationId.Id,subject:e.ConversationTopic,globalItemIds:n,shouldShowAttachmentPreviews:Object(s.h)().UserOptions.ShowInlinePreviews&&Object(i.e)(e,t.tableQuery),validCouponIndexes:Object(a.b)(e,t.tableQuery),globalUnreadCount:e.GlobalUnreadCount,size:e.Size,clientId:w(e,t),globalMessageCount:e.GlobalMessageCount,shouldShowTxpButton:m(e.EntityNamesMap,e.InstanceKey,r,t),hasExternalEmails:e.HasExternalEmails,hasSharepointLink:e.HasProcessedSharepointLink}}var I=n(9601),y=n(2046),O=n(794),h=n(1668),R=n(1974),g=[Object(O.a)({FieldURI:"Start"}),Object(O.a)({FieldURI:"End"}),Object(O.a)({FieldURI:"CalendarItemType"})],j=[Object(O.a)({FieldURI:"ConflictingMeetings"}),Object(O.a)({FieldURI:"IsResponseRequested"}),Object(O.a)({FieldURI:"Organizer"})];function T(e,t,n,r){if(R.a.getTombstonedReasons(e,r.serverFolderId).indexOf(4)>-1)return!1;var o=r.tableQuery.folderId?Object(h.a)(r.tableQuery.folderId):null;return!(!t||Object(d.e)(r.tableQuery)||!n||!(o||"deleteditems"!==o&&"sentitems"!==o)||!Object(y.q)(n)&&!Object(y.l)(n))}function x(e,t,n,r){T(e,t,n,r)&&function(e,t){var n=Object(v.K)().meetingMessageItems.get(e);if(!n)return!0;var r=g;Object(y.q)(t)&&(r=r.concat(j));return r.some((function(e){return void 0===n[e.FieldURI]}))}(t,n)&&I.a(r,e,t)}function C(e,t){if(!e.ItemClasses||0===e.ItemClasses.length)return!1;var n=e.ItemIds[0].Id,r=e.ItemClasses[0];return!!T(e.InstanceKey,n,r,t)&&(x(e.InstanceKey,n,r,t),!0)}function S(e){return e.GlobalMentionedMe||e.GlobalAtAllMention}function K(e){return Object(c.i)("tri-flagStatusV2")&&e.FlagStatusV2?e.FlagStatusV2:e.FlagStatus}var D=n(1739),M=n(3860),F=n(148),E=n(20),V=Object(F.select)({conversationItems:function(){return D.a.conversationItems},tableViewConversationRelations:function(){return D.a.tableViewConversationRelations}})(Object(F.action)("addOrUpdateConversationData")((function(e,t,n,r){void 0===n&&(n=!1);var o=r.conversationItems,i=r.tableViewConversationRelations;e.ConversationId||E.d("addOrUpdateConversationData: ConversationId is undefined");var a=e.ConversationId.Id,u=Object(M.a)(e.InstanceKey,t.id);if(A(n,a,o)){var s=p(e,t);o.set(a,s)}var c=function(e,t){return{categories:e.Categories,draftItemIds:e.DraftItemIds?e.DraftItemIds.map((function(e){return e.Id})):[],effectiveMentioned:S(e),executeSearchSortOrder:e.SortOrderSource,flagStatus:K(e),hasAttachments:e.HasAttachments,hasIrm:e.HasIrm,iconIndex:e.IconIndex,id:e.ConversationId.Id,importance:e.Importance,instanceKey:e.InstanceKey,itemClasses:e.ItemClasses,itemIds:e.ItemIds.map((function(e){return e.Id})),lastDeliveryOrRenewTimeStamp:e.LastDeliveryOrRenewTime,lastDeliveryTimeStamp:e.LastDeliveryTime,lastModifiedTimeStamp:e.LastModifiedTime,lastSender:e.LastSender?e.LastSender:e.From,parentFolderId:e.ParentFolderId?e.ParentFolderId.Id:null,previewText:e.Preview,returnTime:e.ReturnTime?e.ReturnTime:null,uniqueRecipients:e.UniqueRecipients,uniqueSenders:e.UniqueSenders,unreadCount:e.UnreadCount,globalLikeCount:e.GlobalLikeCount?e.GlobalLikeCount:null,shouldShowRSVP:C(e,t)}}(e,t);i.set(u,c)}))),A=function(e,t,n){return!n.get(t)||!e},P=n(5887),Q=n(1647);function L(e,t){var n=e.ItemId.Id,r=e.ItemClass;return!!T(e.InstanceKey,n,r,t)&&(x(e.InstanceKey,n,r,t),!0)}var k=Object(F.select)({items:function(){return Q.u.items},tableViewItemRelations:function(){return v.Y.tableViewItemRelations}})(Object(F.action)("addOrUpdateItemData")((function(e,t,n){var r=e.ItemId.Id,c=Object(o.__assign)(Object(o.__assign)({},e),{MailboxInfo:Object(u.b)(t),validCouponIndexes:Object(a.c)(e,t.tableQuery),shouldShowAttachmentPreviews:Object(s.h)().UserOptions.ShowInlinePreviews&&Object(i.f)(e,t.tableQuery),shouldShowRSVP:L(e,t),shouldShowTxpButton:m(e.EntityNamesMap,e.InstanceKey,e.ItemId.Id,t)});n.items.has(r)?function(e,t,n){var r,o="spotlight"==(null===(r=null==n?void 0:n.tableQuery)||void 0===r?void 0:r.scenarioType);if(1===n.tableQuery.type||o||(e.ItemId=t.ItemId,e.ReceivedOrRenewTime=t.ReceivedOrRenewTime,e.validCouponIndexes=t.validCouponIndexes,e.shouldShowRSVP=t.shouldShowRSVP,e.shouldShowTxpButton=t.shouldShowTxpButton),e.Subject=t.Subject,e.Importance=t.Importance,e.Sensitivity=t.Sensitivity,e.HasAttachments=t.HasAttachments,e.ItemClass=t.ItemClass,e.Flag=t.Flag,e.Categories=t.Categories,e.SystemCategories=t.SystemCategories,e.ParentFolderId=t.ParentFolderId,e.ConversationId=t.ConversationId,e.DateTimeReceived=t.DateTimeReceived,e.IsDraft=t.IsDraft,e.Size=t.Size,e.IsClutter=t.IsClutter,e.Preview=t.Preview,e.DisplayTo=t.DisplayTo,e.IconIndex=t.IconIndex,t.ReturnTime&&(e.ReturnTime=t.ReturnTime),-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.Note")){var i=e,a=t;i.IsRead=a.IsRead,1!==n.tableQuery.type&&(i.IsReadReceiptRequested=a.IsReadReceiptRequested,i.IsDeliveryReceiptRequested=a.IsDeliveryReceiptRequested)}}(n.items.get(r),c,t):(n.items.set(r,c),c.ConversationId||E.d("addOrUpdateItemData: item.ConversationId is null."));var d=Object(M.a)(e.InstanceKey,t.id),l=Object(P.a)(e,t);n.tableViewItemRelations.set(d,l)}))),_=Object(F.action)("addOrUpdateRowData")((function(e,t,n){switch(void 0===n&&(n=!1),t.tableQuery.listViewType){case 0:V(e,t,n);break;case 1:k(e,t)}})),U=n(2176),q=n(7965),B=Object(F.select)({tableViewConversationRelations:function(){return D.a.tableViewConversationRelations},tableViews:function(){return D.a.tableViews},conversationItems:function(){return D.a.conversationItems},conversationCache:function(){return U.a}})(Object(F.action)("removeConversationData")((function(e,t,n){var r,u,s=Object(M.a)(e,t.id),d=n.tableViewConversationRelations,l=d.get(s).id,f=d.get(s).itemIds;if(!d.has(s))throw new Error("Conversation not found in store");d.delete(s);var v=!1;try{for(var m=Object(o.__values)(n.tableViews.values()),w=m.next();!w.done;w=m.next()){var p=w.value;if(p.id!=t.id&&p.rowIdToRowKeyMap.get(l)){v=!0;break}}}catch(e){r={error:e}}finally{try{w&&!w.done&&(u=m.return)&&u.call(m)}finally{if(r)throw r.error}}v||(n.conversationItems.delete(l),i.d.importAndExecute(l),Object(c.i)("tri-coupon-peek")&&a.e.import().then((function(e){e(l)})),q.a.importAndExecute(f),Object(c.i)("tri-txpButtonInLV")&&b.c.importAndExecute(f),n.conversationCache.remove(l))}))),N=n(2229);var H=n(2760),z=Object(F.action)("removeRowData")((function(e,t){switch(t.selectedRowKeys.has(e)&&Object(H.a)(e,t.id,!1),t.tableQuery.listViewType){case 0:B(e,t);break;case 1:!function(e,t){var n=Object(v.C)([e],t.id)[0],r=Object(v.N)(e,t.id);if(!v.Y.tableViewItemRelations.has(r))throw new Error("Item not found in list view store");v.Y.tableViewItemRelations.delete(r),q.a.importAndExecute([n]),Object(c.i)("tri-txpButtonInLV")&&b.c.importAndExecute([n]),Object(N.a)(n,0)}(e,t)}}));function G(e,t,n,r,o){return void 0===r&&(r=""),void 0===o&&(o=!1),_(t,n,o),te(n,e,Object(v.D)(t,n.tableQuery.listViewType),r)}function W(e,t,n,r){return void 0===n&&(n=""),void 0===r&&(r=!1),G(t.rowKeys.length,e,t,n,r)}var Y=Object(F.action)("tableOperations.removeRow")((function(e,t,n){void 0===n&&(n=""),re(t,e,n),z(e,t)})),$=Object(F.action)("tableOperations.updateRowPosition")((function(e,t,n,r){void 0===r&&(r="");var o=n.rowKeys.indexOf(t);if(o<0){var i=new Error("updateRowPosition: Row not found in table, source: "+r);return i.diagnosticInfo="tableLength: "+n.rowKeys.length+" rowKey: "+t,void E.d(i)}o!=e&&(re(n,t,r),te(n,e,t,r))})),Z=Object(F.action)("tableOperations.updateRow")((function(e,t,n,r,o){void 0===r&&(r=""),void 0===o&&(o=!1),$(e,Object(v.D)(t,n.tableQuery.listViewType),n,r),_(t,n,o)})),J=Object(F.action)("tableOperations.updateRowData")((function(e,t){_(e,t)})),X=Object(F.action)("tableOperations.clear")((function(e,t,n,r){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r="");for(var o=e.rowKeys.length-1;o>=0;o--){var i=e.rowKeys[o];if(-1==n.indexOf(i))if(t){var a=v.b.getLastDeliveryTimeStamp(i,e);new Date(a)<t&&Y(i,e,r)}else Y(i,e,r)}}));function ee(e,t){return e.rowKeys.indexOf(t)>=0}function te(e,t,n,r){if(void 0===r&&(r=""),t<0||t>e.rowKeys.length)return ue("addToTableRowKeys: Invalid add index",r,oe(e,t)),!1;if(ee(e,n))return ue("addToTableRowKeys: RowKey already exists",r,oe(e,t)),!1;try{var o=v.b.getRowIdString(n,e);return ne(e,o,n,t),!0}catch(n){return ue("addToTableRowKeys: exception when adding row at valid index",r,oe(e,t)+" exp: "+(null==n?void 0:n.message)),!1}}var ne=Object(F.action)("tableOperations.addRowKeyToTableRowKeysAndMap")((function(e,t,n,r){var o=e.rowIdToRowKeyMap.get(t);o||(o=[]),-1==o.indexOf(n)&&o.push(n),e.rowIdToRowKeyMap.set(t,o),e.rowKeys.splice(r,0,n)}));function re(e,t,n){void 0===n&&(n="");var r=e.rowKeys.indexOf(t);if(r<0)ue("removeFromTableRowKeys: RowKey not found in tableView.rowKeys",n,ie(e));else{var o=v.b.getRowIdString(t,e),i=e.rowIdToRowKeyMap.get(o);if(i){var a=i.indexOf(t);-1!=a?(1==i.length?e.rowIdToRowKeyMap.delete(o):i.splice(a,1),e.rowKeys.splice(r,1)):ue("removeFromTableRowKeys: RowKey should be present in rowIdToRowKey map",n,ie(e,o))}else ue("removeFromTableRowKeys: invalid rowKeysForRowId",n,ie(e,o))}}function oe(e,t){return"addAtIndex: "+t+ae(e)}function ie(e,t){return(t?"rowId: "+t:"")+ae(e)}function ae(e){return" tableLength: "+e.rowKeys.length+" tableType: "+e.tableQuery.type+" lvType: "+e.tableQuery.listViewType}function ue(e,t,n){var r=new Error(e+": source: "+t);r.diagnosticInfo=n,E.d(r)}t.a=r},2760:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("SET_SELECTION_ON_ROW",(function(e,t,n){return{rowKey:e,tableViewId:t,shouldSelect:n}}))},4886:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2610),o=n(4878);function i(e,t,n){switch(t.tableQuery.listViewType){case 0:Object(r.a)(e,t.id).instrumentationContext=n;break;case 1:Object(o.a)(e,t.id).instrumentationContext=n}}},5817:function(e,t,n){"use strict";var r=n(37),o=n(9597),i=n(9600);function a(e,t){return new Date(e)>new Date(t)}var u=n(18),s=n(1730),c=n(1647),d=n(1668),l=n(1641);function f(e,t){var n=e.ConversationId.Id;if(Object(l.K)().couponPeekPreviews.get(n)){var r=Object(l.Z)(n);if(r)return r.validCouponIndexes}return b(e.ItemIds[0].Id,e.CouponRanks,e.CouponExpiryDates,t)}function v(e,t){if(!Object(l.W)(e))return null;var n=e,r=e.ItemId.Id;if(Object(l.K)().couponPeekPreviews.get(r)){var o=Object(c.g)().items.get(r);if(o)return o.validCouponIndexes}return b(e.ItemId.Id,n.CouponRanks,n.CouponExpiryDates,t)}function b(e,t,n,r){if(1==r.type)return null;if("junkemail"==Object(d.a)(r.folderId))return null;if(!t||!n||t.length!=n.length)return null;for(var o=[],c=0;c<n.length;c++){a(n[c],Date.now())&&o.push({index:c,rank:t[c]})}return o.sort((function(e,t){return t.rank-e.rank})),o.length>0&&Object(u.i)("tri-coupon-peek")&&i.a(Object(s.d)(r).mailboxSmtpAddress,e),o.map((function(e){return e.index}))}n.d(t,"d",(function(){return w})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return v}));var m=new r.c((function(){return n.e(381).then(n.bind(null,17454))})),w=new r.b(m,(function(e){return e.fetchCouponData})),p=new r.b(m,(function(e){return e.removeCouponFromStore})),I=Object(r.d)(m,(function(e){return e.CouponPreviewWell}),(function(e){return Object(o.a)(e)}))},5887:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(1730);function o(e,t){return{Id:e,mailboxInfo:Object(r.b)(t)}}function i(e,t){return{executeSearchSortOrder:e.SortOrderSource,clientId:o(e.ItemId.Id,t),instanceKey:e.InstanceKey}}},6298:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s}));var r=n(37),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(22),n.e(63),n.e(102),n.e(814)]).then(n.bind(null,16857))})),i=new r.a(o,(function(e){return e.tryGetTxpAdditionalData})),a=new r.a(o,(function(e){return e.removeTxpFromStoreAction})),u=new r.a(o,(function(e){return e.addToTxpItemIdMap})),s=Object(r.d)(o,(function(e){return e.TxpListViewButton}))},7133:function(e,t){e.exports=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},7965:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(37),o=new r.c((function(){return n.e(732).then(n.bind(null,16869))})),i=new r.a(o,(function(e){return e.tryPrefetchMeetingMessage})),a=new r.a(o,(function(e){return e.removeMeetingMessagesFromStore}))},9597:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(9598),o=n(366),i=n(1),a=n(9599);function u(e){var t=Math.min(r.a,e.validCouponIndexes.length);return Array.apply(null,Array(t)).map((function(e){return i.createElement("div",{key:e},i.createElement(o.a,{iconName:"",className:a.icon}))}))}},9598:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=1},9599:function(e,t,n){var r=n(11492),o=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},9600:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(20),o={},i=function(e,t){a(e,t)?r.g.warn("couponPeekOperations: duplicate itemId should not be fetched again"):o[e]?o[e].push(t):o[e]=[t]},a=function(e,t){var n=o[e];return n&&n.indexOf(t)>0},u=function(e){delete o[e]},s=function(e){return o[e]}},9601:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(1730),o={},i=function(e,t,n){var i=Object(r.d)(e.tableQuery).mailboxSmtpAddress;a(i,n)||(o[i]?o[i].push({rowKey:t,itemId:n,tableViewId:e.id}):o[i]=[{rowKey:t,itemId:n,tableViewId:e.id}])},a=function(e,t){var n=o[e];return n&&n.some((function(e){return e.itemId===t}))},u=function(e){delete o[e]},s=function(e){return o[e]}}}]);
//# sourceMappingURL=owa.61.js.map
self.scriptsLoaded['owa.61.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.61.js'] = (new Date()).getTime();