self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentModelStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[325,469],{1026:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},t)}},1060:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(30),i=n(1026);function c(t,e){return void 0===t||t.__type||(t=Object(i.a)(t)),Object(r.a)("FindItem",t,e)}},1066:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},t)}},1648:function(t,e,n){"use strict";function r(t){if(!t)return null;var e=t.lastIndexOf(".");return e>0?t.substr(e).toLowerCase():null}function i(t){var e=r(t);return e?e.replace(".",""):null}function c(t){var e;return(null===(e=i(t))||void 0===e?void 0:e.substring(0,4))||""}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return c}))},165:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(33);function i(){var t=Object(r.a)(),e=t.origin;return e||(e=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),e}},1662:function(t,e,n){"use strict";var r=n(0),i=n(1705),c=n(365),u=n(614),o=n(127),a=n(4),s="X-AnchorMailbox",d="Authorization",f="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function b(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,b,v,O,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(c.k)(t)){if(b.accountState==c.b.AccessRevoked)return[2,null];if(b.accountState==c.b.AccountDeprovisioned||b.accountState==c.b.AccountNotFound)return Object(c.c)(b.accountState,b.accountProviderType),[2,null]}return e?(n[s]=e,n[l]=e):b&&(n[s]=b.anchorMailbox),b?(v=b.token,!(O=Object(u.g)(b.tokenExpiry))&&v?[3,2]:(Object(o.r)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(b.tokenExpiry,Object(a.Qb)()),isTokenExpired_1:O,isTokenInvalid_2:!v},{isCore:!0}),[4,i.a.importAndExecute(b.accountId,t,v)])):[3,3];case 1:(v=r.sent())||(v=""),r.label=2;case 2:p=void 0,"Outlook"==b.accountProviderType?(p='MSAuth1.0 usertoken="'+v+'", type="MSACT"',n[f]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(p="Bearer "+v,n[f]=2..toString()),n[d]=p,r.label=3;case 3:return[2,n]}}))}))}var v=n(1663),O=n(20);function p(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(v.a)(),i=n,[4,m(t,e)];case 1:return i.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function m(t,e){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,[4,b(t.mailboxInfo.userIdentity,h(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return c=r.sent(),Object(v.b)(i,c),[2,i]}}))}))}function h(t,e){var n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&O.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return h}))},1663:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach((function(n){return t.set(n,e[n])}))}function i(t){var e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},1665:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2),i=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1682:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(256);function i(t){var e;return null===(e=Object(r.a)(t))||void 0===e?void 0:e.AttachmentPolicy}},1693:function(t,e,n){"use strict";var r,i,c;n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return c})),function(t){t[t.Compose=0]="Compose",t[t.Extensibility=1]="Extensibility",t[t.ReadingPane=2]="ReadingPane",t[t.Fileshub=3]="Fileshub",t[t.Txp=4]="Txp",t[t.Peek=5]="Peek",t[t.CalendarCard=6]="CalendarCard"}(r||(r={})),function(t){t[t.SmimeSignature=0]="SmimeSignature",t[t.Safety=1]="Safety",t[t.Error=2]="Error",t[t.Info=3]="Info",t[t.Encryption=4]="Encryption",t[t.Translation=5]="Translation",t[t.Sensitivity=6]="Sensitivity",t[t.InsightMessage=7]="InsightMessage",t[t.External=8]="External",t[t.Spotlight=9]="Spotlight"}(i||(i={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow",t[t.Orange=4]="Orange",t[t.Green20=5]="Green20"}(c||(c={}))},1705:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(37),i=n(1665);n.d(e,"b",(function(){return i.a}));var c=new r.c((function(){return n.e(1302).then(n.bind(null,1915))})),u=new r.a(c,(function(t){return t.getAndUpdateAccessToken}))},173:function(t,e,n){"use strict";function r(){var t=Object.create(null),e=0,n=0,r=0,i=!1;function c(e){r--,delete t[e]}this.put=function(e,n,i,u){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var o=t[e];o?clearTimeout(o.timeout):r++;var a={value:n,expire:i+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){c(e),u&&u(e,n)}.bind(this),i)),t[e]=a,n},this.del=function(e){var n=!0,r=t[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&c(e),n},this.clear=function(){for(var c in t)clearTimeout(t[c].timeout);r=0,t=Object.create(null),i&&(e=0,n=0)},this.get=function(c){var u=t[c];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return i&&e++,u.value;i&&n++,r--,delete t[c]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){i=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),i=Date.now(),c=n&&n.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(c)if(t[u])continue;var o=r[u],a=o.expire-i;if(a<=0){this.del(u);continue}a=a>0?a:void 0,this.put(u,o.value,a)}return this.size()}}t.exports=new r,t.exports.Cache=r},1733:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return o}));var r="FileAttachment:#Exchange",i="ItemAttachment:#Exchange",c="ItemIdAttachment:#Exchange",u="ReferenceAttachment:#Exchange",o="LinkAttachment:#Exchange"},1766:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},t)}},1801:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1733);function i(t){return(t.__type||t.OwsTypeName)===r.e}},1840:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(111);function i(t){switch(t){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(t)}}},1852:function(t,e){t.exports=function(t){return t instanceof Date}},1876:function(t,e,n){"use strict";var r=n(1733),i=n(6),c=function(t){return t&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(t)};function u(t){var e=t.__type||t.OwsTypeName;switch(e){case r.a:return 0;case r.e:return t.IsLink?3:1;case r.d:return 3;case r.b:return 2;case r.c:var n=t,u=t.EmbeddedItemClass;return u&&c(u)||Object(i.f)(n.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+e)}}n.d(e,"a",(function(){return u}))},1923:function(t,e,n){var r=n(1852),i=36e5,c=6e4,u=2,o=/[T ]/,a=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],f=/^(\d{4})/,l=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,v=/^-?(\d{3})$/,O=/^-?(\d{2})-?(\d{2})$/,p=/^-?W(\d{2})$/,m=/^-?W(\d{2})-?(\d{1})$/,h=/^(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,y=/^(Z)$/,A=/^([+-])(\d{2})$/,I=/^([+-])(\d{2}):?(\d{2})$/;function x(t,e,n){e=e||0,n=n||0;var r=new Date(0);r.setUTCFullYear(t,0,4);var i=7*e+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}t.exports=function(t,e){if(r(t))return new Date(t.getTime());if("string"!=typeof t)return new Date(t);var n=(e||{}).additionalDigits;n=null==n?u:Number(n);var w=function(t){var e,n={},r=t.split(o);a.test(r[0])?(n.date=null,e=r[0]):(n.date=r[0],e=r[1]);if(e){var i=S.exec(e);i?(n.time=e.replace(i[1],""),n.timezone=i[1]):n.time=e}return n}(t),T=function(t,e){var n,r=d[e],i=l[e];if(n=f.exec(t)||i.exec(t)){var c=n[1];return{year:parseInt(c,10),restDateString:t.slice(c.length)}}if(n=s.exec(t)||r.exec(t)){var u=n[1];return{year:100*parseInt(u,10),restDateString:t.slice(u.length)}}return{year:null}}(w.date,n),k=T.year,_=function(t,e){if(null===e)return null;var n,r,i,c;if(0===t.length)return(r=new Date(0)).setUTCFullYear(e),r;if(n=b.exec(t))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(e,i),r;if(n=v.exec(t)){r=new Date(0);var u=parseInt(n[1],10);return r.setUTCFullYear(e,0,u),r}if(n=O.exec(t)){r=new Date(0),i=parseInt(n[1],10)-1;var o=parseInt(n[2],10);return r.setUTCFullYear(e,i,o),r}if(n=p.exec(t))return c=parseInt(n[1],10)-1,x(e,c);if(n=m.exec(t)){c=parseInt(n[1],10)-1;var a=parseInt(n[2],10)-1;return x(e,c,a)}return null}(T.restDateString,k);if(_){var E,C=_.getTime(),P=0;return w.time&&(P=function(t){var e,n,r;if(e=h.exec(t))return(n=parseFloat(e[1].replace(",",".")))%24*i;if(e=g.exec(t))return n=parseInt(e[1],10),r=parseFloat(e[2].replace(",",".")),n%24*i+r*c;if(e=j.exec(t)){n=parseInt(e[1],10),r=parseInt(e[2],10);var u=parseFloat(e[3].replace(",","."));return n%24*i+r*c+1e3*u}return null}(w.time)),w.timezone?E=function(t){var e,n;if(e=y.exec(t))return 0;if(e=A.exec(t))return n=60*parseInt(e[2],10),"+"===e[1]?-n:n;if(e=I.exec(t))return n=60*parseInt(e[2],10)+parseInt(e[3],10),"+"===e[1]?-n:n;return 0}(w.timezone):(E=new Date(C+P).getTimezoneOffset(),E=new Date(C+P+E*c).getTimezoneOffset()),new Date(C+P+E*c)}return new Date(t)}},1955:function(t,e,n){"use strict";var r=n(1682);function i(){var t=Object(r.a)();return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var c=n(1840),u=n(1801);function o(){return i()}function a(t){return(t&&t.length>0&&function(t){return t.some((function(t){return!((e=t).IsInline&&!Object(u.a)(e));var e}))}(t)?i():[]).map(c.a)}n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a}))},219:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function c(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}function u(t){return r.test(t)}},2201:function(t,e,n){"use strict";var r=n(37),i=[0,1],c=n(2276),u=n(2215),o=n(6),a=n(111),s=n(1693);function d(t){switch(t){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(u.a),messageParts:[Object(o.b)(u.a),f()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(c.b),messageParts:[Object(o.b)(c.b),f()],color:s.a.Red};default:return Object(a.a)(t)}}function f(){return{text:Object(o.b)(c.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var l=n(1955),b=n(1840),v=n(0),O=n(18),p=n(1682);function m(){var t=Object(p.a)();if(Object(O.i)("fwk-devTools")){if(Object(O.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(v.__assign)(Object(v.__assign)({},t),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(O.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(v.__assign)(Object(v.__assign)({},t),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return t}function h(){var t=m();return t.DirectFileAccessOnPrivateComputersEnabled&&t.DirectFileAccessOnPublicComputersEnabled?2:t.WacViewingOnPrivateComputersEnabled&&t.WacViewingOnPublicComputersEnabled?0:1}n.d(e,"g",(function(){return j})),n.d(e,"a",(function(){return i})),n.d(e,"f",(function(){return d})),n.d(e,"b",(function(){return l.a})),n.d(e,"e",(function(){return b.a})),n.d(e,"d",(function(){return h})),n.d(e,"c",(function(){return m}));var g=new r.c((function(){return n.e(1721).then(n.bind(null,17036))})),j=new r.b(g,(function(t){return t.getAccessIssuesForAttachments}))},2215:function(t){t.exports=JSON.parse('{"a":"Wda"}')},2276:function(t){t.exports=JSON.parse('{"a":"Uda","b":"Vda"}')},235:function(t,e,n){"use strict";var r=n(17),i=n(0),c=n(71),u=n(18);function o(t){var e=Object(c.i)(t);return e&&e.SessionSettings?0===e.SessionSettings.WebSessionType?Object(u.i)("doc-attachment-routingKeyAadSmtp")?"SMTP:":"":"MSA:":"no-routing-key:"}var a=n(20);function s(t,e,n){var r,c;if(n)try{for(var u=Object(i.__values)(n),o=u.next();!o.done;o=u.next()){var a=o.value;if(!d(t,a))return a}}catch(t){r={error:t}}finally{try{o&&!o.done&&(c=u.return)&&c.call(u)}finally{if(r)throw r.error}}return e&&e.length>0?e[0]:"NoResolvableAddress@invalid.outlook.com"}function d(t,e){return("outlook_"+t+"@outlook.com").toLowerCase()===e.toLowerCase()}function f(){var t=function(){var t=Object(r.a)();if(!t||!t.SessionSettings)return a.d("SessionSettings not available"),"no-routing-key";var e=t.SessionSettings.UserEmailAddress;if(0===t.SessionSettings.WebSessionType)return o()+e;if(Object(u.i)("doc-attachment-routingKeyPuid"))return"PUID:"+t.SessionSettings.UserPuid+"@"+t.SessionSettings.TenantGuid;if(t.SessionSettings.IsShadowMailbox)return o()+t.SessionSettings.LogonEmailAddress;if(d(t.HexCID,t.SessionSettings.UserEmailAddress))return o()+s(t.HexCID,t.SessionSettings.NotManagedEmailAddresses,t.SessionSettings.UserProxyAddresses);return o()+e}();return t=encodeURIComponent(t)}function l(){var t=Object(r.a)();if(!t||!t.SessionSettings)return a.d("SessionSettings not available"),"no-mailbox-id";var e=t.SessionSettings.UserEmailAddress;return Object(u.i)("doc-attachment-usePrimarySmtpAddressForMailboxId")?e:(t.SessionSettings.IsShadowMailbox?e=t.SessionSettings.LogonEmailAddress:d(t.HexCID,t.SessionSettings.UserEmailAddress)&&(e=s(t.HexCID,t.SessionSettings.NotManagedEmailAddresses,t.SessionSettings.UserProxyAddresses)),e)}var b=n(714),v=n(528);function O(t){var e=Object(v.a)().userMailboxInfoMap;e&&e.delete(t)}function p(t,e){return t===e||null!=t&&null!=e&&t.Id===e.Id}n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return b.a})),n.d(e,"f",(function(){return O})),n.d(e,"e",(function(){return p})),n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return o}))},236:function(t,e,n){"use strict";var r=n(699);n.d(e,"a",(function(){return r.a}))},2660:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1733);function i(t){return(t.__type||t.OwsTypeName)===r.d}},360:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u}));var r,i=n(0);function c(t){r=t}function u(){var t,e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(c=r)?[4,r()]:[3,2];case 1:c=i.sent(),i.label=2;case 2:if((n=c)&&n.length>0){if("bearer"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},365:function(t,e,n){"use strict";var r,i=n(2);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var c,u=n(48),o=Object(i.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),a=Object(i.action)("removeAccount",(function(t){return{userIdentity:t}})),s=Object(i.action)("updateAccount",(function(t,e,n){return{userIdentity:t,accountToken:e,accountTokenExpiresIn:n}})),d=Object(i.action)("updateOWAConnectedAccountStatus",(function(t,e){return{userIdentity:t,accountState:e}})),f=Object(i.action)("accountIsInErrorState",(function(t,e){return Object(u.c)({name:"accountIsInErrorState",customData:{accountState_1:r[t],accountProvider_2:e}},{accountState:t})})),l=Object(i.action)("retryAccountUpdateToken",(function(t,e,n){return{accountId:t,userIdentity:e,currentToken:n}})),b=Object(i.action)("connectedAccountsListRequested",(function(t){return{isSuccess:t}})),v=Object(i.action)("setAccountsStoreState",(function(t){return{state:t}})),O=n(0),p=n(9);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(c||(c={}));var m=Object(i.createStore)("OWAAccountsStore",{accountsMap:new p.ObservableMap({}),accountsLoadedState:c.None}),h=n(111),g=n(71);function j(t){return t!=Object(g.b)()&&void 0!==y(t)}function S(){return Object(O.__spread)(m().accountsMap.values())}function y(t){return m().accountsMap.get(t)}function A(){var t;return(null===(t=S())||void 0===t?void 0:t.length)>0?S()[0]:null}function I(){return S().filter((function(t){return t.accountState!=r.Valid}))}function x(t){return S().filter((function(e){return t.includes(e.accountState)}))}function w(t){return S().filter((function(e){return e.accountProviderType==t}))}function T(t){return j(t)?y(t).accountProviderType:null}function k(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(h.a)(t.accountProviderType)}function _(t,e){return function(n){var r=y(n);return r?r[t]:e}}_("accountUniqueId","0");var E=_("accountState",r.Valid),C=function(){return S().some((function(t){return!M(t.userIdentity)}))},P=_("accountProviderType",null),D=function(t){return"Outlook"==P(t)},M=function(t){return E(t)==r.Valid},N=function(){return S().length>0};function L(){return m().accountsLoadedState}var F=n(4),R=n(127);Object(i.mutator)(o,(function(t){var e=t.account;Object(R.r)("owaAccountAdded",{accountStatus_1:r[e.accountState]}),m().accountsMap.set(e.userIdentity,e)})),Object(i.mutator)(a,(function(t){var e=t.userIdentity;m().accountsMap.delete(e)})),Object(i.mutator)(s,(function(t){var e=t.userIdentity,n=t.accountToken,r=t.accountTokenExpiresIn,i=m().accountsMap.get(e);i.token=n,i.tokenExpiry=Object(F.j)(Object(F.Qb)(),parseInt(r))})),Object(i.mutator)(d,(function(t){var e=t.userIdentity,n=t.accountState,i=m().accountsMap.get(e);i.accountState==r.Valid&&n!=r.Valid&&Object(R.r)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[n]}),i.accountState=n})),Object(i.mutator)(b,(function(t){var e=t.isSuccess?c.AccountsLoadSuccessful:c.AccountsLoadError;m().accountsLoadedState=e})),Object(i.mutator)(v,(function(t){m().accountsLoadedState=t.state})),n.d(e,"d",(function(){return o})),n.d(e,"u",(function(){return a})),n.d(e,"y",(function(){return s})),n.d(e,"x",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"v",(function(){return l})),n.d(e,"e",(function(){return b})),n.d(e,"w",(function(){return v})),n.d(e,"n",(function(){return S})),n.d(e,"k",(function(){return y})),n.d(e,"i",(function(){return A})),n.d(e,"f",(function(){return I})),n.d(e,"g",(function(){return x})),n.d(e,"o",(function(){return w})),n.d(e,"j",(function(){return T})),n.d(e,"m",(function(){return k})),n.d(e,"l",(function(){return E})),n.d(e,"q",(function(){return C})),n.d(e,"t",(function(){return D})),n.d(e,"s",(function(){return M})),n.d(e,"p",(function(){return N})),n.d(e,"h",(function(){return L})),n.d(e,"r",(function(){return j})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return c}))},369:function(t,e,n){"use strict";var r=n(0);function i(t,e){return t?Object(r.__assign)({mailboxInfo:t},e):null!=e?e:void 0}n.d(e,"a",(function(){return i}))},421:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(82);function i(t){return Object(r.a)(t,[r.c])}},439:function(t,e,n){"use strict";var r=function(){function t(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();n.d(e,"a",(function(){return r}))},528:function(t,e,n){"use strict";var r=n(2),i=n(9);e.a=Object(r.createStore)("OWAClientIdStore",{userMailboxInfoMap:new i.ObservableMap})},563:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"FolderId:#Exchange"},t)}},614:function(t,e,n){"use strict";var r=n(2),i=Object(r.action)("initializeOwaObservableDateTime"),c=Object(r.action)("observableNowChanged"),u=Object(r.action)("observableTodayChanged"),o=n(4),a=n(9),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(a.computed)((function(){return Object(o.mc)(s().now)})),f=function(){return d.get()},l=Object(a.computed)((function(){return Object(o.mc)(s().today)})),b=function(){return l.get()},v=function(t){return Object(o.Hb)(t,f())},O=function(t){return Object(o.Fb)(t,f())},p=function(t){return h(t,o.Hb)},m=function(t){return h(t,o.Ib)},h=function(t,e){return e(Object(o.Xb)(Object(o.mc)(t)),b())};function g(t){if(!t)return"";var e=Object(o.mc)(t);return function(t,e){var n=Object(o.Xb)(t);if(Object(o.Jb)(n,e))return o.ab;var r=function(t){return Object(o.Nb)(n,Object(o.e)(e,-t),e)};if(r(3))return o.ib;if(r(30))return o.hb;return o.Y}(e,b())(e)}function j(t){if(!t)return"";var e=Object(o.mc)(t);return function(t,e){var n=Object(o.Xb)(t);if(Object(o.Jb)(n,e))return o.T;return o.U}(e,b())(e)}function S(t){return t?function(t,e){var n=Object(o.Xb)(t);return Object(o.Jb)(n,e)?Object(o.ab)(t):y(n,e,2)?Object(o.lb)(t):y(n,e,7)?Object(o.H)(Object(o.bb)(t),Object(o.ab)(t)):Object(o.H)(Object(o.J)(t),Object(o.ab)(t))}(Object(o.mc)(t),b()):""}function y(t,e,n){return Object(o.Nb)(t,Object(o.e)(e,-n),e)}var A=Object(r.action)("updateTimes"),I=Object(r.action)("setNow"),x=Object(r.action)("setToday",(function(t){return{today:t}}));Object(r.mutator)(I,(function(){s().now=Object(o.kc)()})),Object(r.mutator)(x,(function(t){var e=t.today;s().today=e}));var w=n(32),T=n(126),k=!1;Object(r.orchestrator)(i,(function(){if(A(),!k){var t=Object(o.Qb)(),e=Object(o.Zb)(Object(o.h)(t,1)),n=Object(o.w)(e,t);setTimeout((function(){return setInterval(A,w.g)}),n),document&&document.addEventListener("visibilitychange",A),k=!0}})),Object(r.orchestrator)(T.l,(function(){A()})),Object(r.orchestrator)(A,(function(){I();var t=Object(o.Ab)(Object(o.lc)()),e=s().today!=t;e&&x(t),c(),e&&u()})),n.d(e,"d",(function(){return i})),n.d(e,"j",(function(){return c})),n.d(e,"l",(function(){return u})),n.d(e,"i",(function(){return f})),n.d(e,"k",(function(){return b})),n.d(e,"g",(function(){return v})),n.d(e,"e",(function(){return O})),n.d(e,"f",(function(){return p})),n.d(e,"h",(function(){return m})),n.d(e,"a",(function(){return g})),n.d(e,"b",(function(){return j})),n.d(e,"c",(function(){return S}))},699:function(t,e,n){"use strict";function r(t){return t>=200&&t<300}n.d(e,"a",(function(){return r}))},714:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(71),i=n(528);function c(t){var e=Object(i.a)().userMailboxInfoMap;if(!e||!e.get(t)){var n=!1;t&&(n=t!=Object(r.b)());var c={type:"UserMailbox",userIdentity:n?t:Object(r.b)(),mailboxSmtpAddress:n?t:Object(r.c)()};return e.set(t,c),c}return e.get(t)}},7204:function(t,e,n){"use strict";var r=n(0),i=n(1684),c=n(1958),u=n(4937),o=n(1997),a=n(2519),s=n(148);e.a=Object(s.action)("refreshThumbnailImageUrl")((function(t,e,n){return void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(s=Object(i.a)(t),!Object(o.b)(s.model))return[3,7];switch(s.model.ProviderType){case c.e:return[3,1]}return[3,5];case 1:return r.trys.push([1,3,,4]),[4,Object(u.a)(s.model)];case 2:return d=r.sent(),s.thumbnailImage.url=d,[3,4];case 3:return r.sent(),s.thumbnailImage.url=null,[3,4];case 4:case 5:return[3,6];case 6:return[3,8];case 7:d=Object(a.a)(t,s.model,2,Object(o.b)(s.model),e,n),s.thumbnailImage.url=d,r.label=8;case 8:return[2]}}))}))}))},7440:function(t,e,n){"use strict";var r=n(2124),i=n(1684),c=n(6741),u=n(18),o=n(148);e.a=Object(o.action)("setAttachmentPermissionLevel")((function(t,e,n,o){var a=Object(i.a)(t),s=a.model;s.PermissionType=e,n&&(s.AttachLongPathName=n,a.openUrl=Object(c.a)(s)),Object(u.i)("doc-attachment-referenceAttachmentExpiration")&&a.info&&a.info.sharingInfo&&(a.info.sharingInfo.expirationDate=o),Object(r.a)(t)}))},7791:function(t,e,n){"use strict";var r=n(0),i=n(148),c=n(4),u=n(7440);function o(t){return Object(r.__assign)({__type:"SetAttachmentPermissionsRequest:#Exchange"},t)}var a=n(30);function s(t,e,n,r){void 0===n&&(n=null),void 0===r&&(r=!1);var i,c,u=function(t,e,n,r){return void 0===n&&(n=null),void 0===r&&(r=!1),o({AttachmentIds:t,PermissionLevel:e,NewAttachLongPathNames:n,SetToOriginalPermissionLevel:r})}(t,e,n,r);return void 0===(i={request:u}).request||i.request.__type||(i.request=o(i.request)),Object(a.a)("SetAttachmentPermissionsV2",i,c)}e.a=Object(i.action)("changeAttachmentPermission")((function(t,e,n,i){return void 0===n&&(n=null),void 0===i&&(i=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,s(t.map((function(t){return t.Id})),e,n,i)];case 1:if(!(o=r.sent()).OperationSucceeded||!o.NewAttachLongPathNames||o.NewAttachLongPathNames.length!==t.length)throw new Error("Error setting attachment permissions");return t.forEach((function(t,n){var r,i=null;(null===(r=o.ExpirationDates)||void 0===r?void 0:r[n])&&(i=Object(c.mc)(o.ExpirationDates[n])),Object(u.a)(t,e,o.NewAttachLongPathNames[n],i)})),[2]}}))}))}))},799:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},t)}},966:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(35);function i(t){if(!t)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(t)}}}]);
//# sourceMappingURL=owa.AttachmentModelStore.js.map
self.scriptsLoaded['owa.AttachmentModelStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentModelStore.js'] = (new Date()).getTime();