self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.HelpCharm.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[448],{11780:function(e){e.exports=JSON.parse('{"a":"ANb"}')},219:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var i=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function a(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function s(e){return i.test(e)}},236:function(e,t,n){"use strict";var i=n(699);n.d(t,"a",(function(){return i.a}))},4336:function(e,t,n){"use strict";var i=n(30),o=n(0);function a(e,t){if(void 0!==e.datapoints)for(var n=0;n<e.datapoints.length;n++)void 0===e.datapoints[n]||e.datapoints[n].__type||(e.datapoints[n]=(a=e.datapoints[n],Object(o.__assign)({__type:"Datapoint:#Exchange"},a)));var a;return Object(i.a)("LogDatapoint",e,t)}n.d(t,"a",(function(){return a}))},699:function(e,t,n){"use strict";function i(e){return e>=200&&e<300}n.d(t,"a",(function(){return i}))},9386:function(e,t,n){"use strict";n.r(t);var i=n(2836),o="resources/scripts/osefo.js",a="RXOWA",s={bottom:"0",left:"0",height:"100%",width:"100%",position:"absolute"},r="https://concierge.live.com",d="OsefoLoadWidget",c="OsefoDismissWidget",u="TicketCreated",p="N/A",g="MiniMavenDataPoint",m=3e4,S="Owa Mail",l="https://api.diagnostics.office.com/v1/diagnosticsession",f="OWAHelpshift",v=1048576,b=n(17),O=n(222),I=n(3),w=n(71);function T(){var e,t,n=Object(b.a)();if(window.performance){var i=new Date;i.setTime(window.performance.timing.fetchStart),e=String(i),t=String(((new Date).getTime()-window.performance.timing.fetchStart)/6e4)}var o=p,a=p,s=p,r=p,d=p,c={},u={},g=window.performance.memory;return g&&(o=String(g.jsHeapSizeLimit/v|0),a=String(g.totalJSHeapSize/v|0),s=String(g.usedJSHeapSize/v|0),r=String(g.usedJSHeapSize/g.jsHeapSizeLimit),d=String(g.usedJSHeapSize%1e3!=0)),c.IsFocusedInboxEnabled=String(n.UserOptions.IsFocusedInboxEnabled),c.IsFocusedInboxCapable=String(n.UserOptions.IsFocusedInboxCapable),c.FocusedInboxServerOverride=String(n.UserOptions.FocusedInboxServerOverride),c.IsFocusedInboxOnAdminLastUpdateTime=n.UserOptions.IsFocusedInboxOnAdminLastUpdateTime,c.IsFocusedInboxOnLastUpdateTime=n.UserOptions.IsFocusedInboxOnLastUpdateTime,u.Name=n.SessionSettings.UserDisplayName,u.Country=n.UserOptions.TimeZone,u["Premium Consumer"]=String(Object(w.u)()),u["Memory usage ratio [0,1]"]=String(r),u["Memory.IsHighPrecision"]=d,u["Memory.JSHeapSizeLimit (MB)"]=o,u["Memory.TotalJSHeapSize (MB)"]=a,u["Memory.UsedJSHeapSize (MB)"]=s,u.Platform=window.navigator.platform,u["Browser language"]=window.navigator.language,u["Cookie enabled"]=String(window.navigator.cookieEnabled),u["User agent"]=window.navigator.userAgent,u["Document.Cookie"]=document.cookie,u["Mailbox culture"]=n.SessionSettings.UserCulture,u["OWA layout"]=Object(I.h)(),u["OWA UTC Start Time"]=e,u["Session length"]=t,u["Focused Inbox settings"]=JSON.stringify(c),u.Versioning=Object(I.p)(),u.Ring=Object(I.v)(),u.UserType=Object(O.a)()?"Consumer":"Business",JSON.stringify(u)}var h=n(20),D=n(6),j=n(4336);function k(e){var t=[e.sessionId,e.eventId,e.loadTime,e.eventData,e.isDeeplinkScenario],n={Id:g,Consumers:1,Time:new Date(Date.now()).toString(),Keys:["mmsid","mmeid","mmlt","mmed","mmidl"],Values:t};return Object(j.a)({datapoints:[n]})}var y=n(46);var U=n(236);function x(e,t){var n=e.split("-");if(n.length>1){var i=Object(b.a)();(function(e){var t=new Headers;t.append("Content-Type","application/json"),t.append("Accept","text/plain"),t.append("X-MS-SARA-API-Version","schema-v1"),t.append("Host","api.diagnostics.office.com"),t.append("SaraSessionId",e.SessionId);var n={method:"POST",credentials:"same-origin"};return n.body=JSON.stringify(e),n.headers=t,fetch(l,n)})({TenantId:i.SessionSettings.TenantGuid,TicketId:n[1],TicketTier:f,UserPuid:i.SessionSettings.UserPuid,SessionId:t}).then((function(e){if(!Object(U.a)(e.status)){var t="POST request to "+l+" failed, http error:"+e.status;throw new Error(t)}e.json().then((function(e){y.b.info(Object(D.c)("ODS SessionId {0} TicketId {1}",e.DiagnosticSessionId,e.TicketId))}))})).catch((function(e){var o={Error:e.message,TenantId:i.SessionSettings.TenantGuid,TicketId:n[1],UserPuid:i.SessionSettings.UserPuid};k({sessionId:t,eventId:"ODSFailEvent",eventData:JSON.stringify(o),loadTime:"",isDeeplinkScenario:""})}))}}var M=n(219),C="InvokeFeedback",H="RequestMetadata";function A(e){var t=Object(w.s)()?"https://support.office.live.com":"https://support.office.com";if(e.origin==t)if(h.g.info("Soc post message event: "+e.data),e.data==C)i.e.importAndExecute();else if(e.data==H){var n=T();e.source.postMessage(n,t)}else"string"==typeof e.data&&e.data.indexOf(u)>-1&&x(e.data,Object(M.a)())}var F,z,E,L,P,J,W=n(11780),N=n(179),_=n(276),B=n(18);function R(e,t){if(e){F=t,P=e,z=Object(M.a)(),(J=document.createElement("script")).src=Object(_.resolve)(Object(I.z)(),o);var n=!!Object(B.i)("help-disableTicketFlow"),i=T();J.onload=function(){var t,o,d,c,u={sessionId:z,appId:a,locale:Object(b.a)().SessionSettings.UserCulture,hideHeader:!0,disableTicketFlow:n,theme:(t=Object(N.i)(),o=t.themePrimary,d=t.themeDark,c={button:{bgColor:{onActive:o,onHover:d},borderColor:{onActive:o,onHover:d}},link:{color:{onActive:o,onHover:d}}},c),metadata:i},p={hostingDiv:e,baseUrl:r,clientContext:u,widgetStyle:s,widgetEventListenerCallback:V};L=window.setTimeout($,m),k({sessionId:z,eventId:"LaunchWidget",eventData:S,loadTime:"",isDeeplinkScenario:""}),E=(new Date).getTime(),window.Osefo.CreateWidget(p)},document.head.appendChild(J)}}function V(e){e==c?(k({sessionId:z,eventId:"OnWidgetDismissEvent",eventData:S,loadTime:"",isDeeplinkScenario:""}),F()):e==d?(window.clearTimeout(L),k({sessionId:z,eventId:"OnWidgetLoadEvent",eventData:S,loadTime:String((new Date).getTime()-E),isDeeplinkScenario:""})):e.indexOf(u)>-1&&x(e,z)}function $(){P.innerText=Object(D.b)(W.a),k({sessionId:z,eventId:"OnWidgetLoadFailEvent",eventData:S,loadTime:String((new Date).getTime()-E),isDeeplinkScenario:""})}n.d(t,"handleSocPostMessageEvents",(function(){return A})),n.d(t,"loadMiniMavenHelpWidget",(function(){return R}))}}]);
//# sourceMappingURL=owa.HelpCharm.js.map
self.scriptsLoaded['owa.HelpCharm.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.HelpCharm.js'] = (new Date()).getTime();