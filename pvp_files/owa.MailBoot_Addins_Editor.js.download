self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Addins~Editor.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[210],{1010:function(e,t,n){"use strict";var r=n(667),i=n(666),a=n(803),o=n(368);t.a=function(e,t,n){if(!Object(o.a)(n))return!1;var s=typeof t;return!!("number"==s?Object(i.a)(n)&&Object(a.a)(t,n.length):"string"==s&&t in n)&&Object(r.a)(n[t],e)}},1032:function(e,t,n){"use strict";var r=n(1002),i=n(1010);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,a=n.length,o=a>1?n[a-1]:void 0,s=a>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(a--,o):void 0,s&&Object(i.a)(n[0],n[1],s)&&(o=a<3?void 0:o,a=1),t=Object(t);++r<a;){var c=n[r];c&&e(t,c,r,o)}return t}))}},1747:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(0),i=n(1900);function a(e){var t=Object(i.b)(e.EmailAddress,e.DisplayName);return Object(r.__assign)(Object(r.__assign)({},t),{isPendingResolution:!1,persona:e})}t.a=a},1785:function(e,t,n){"use strict";var r=n(9),i=n(2),a={folderTable:new r.ObservableMap,rootFolder:null},o=Object(i.createStore)("publicFolderFavoriteStore",a)();t.a=o},1791:function(e,t,n){"use strict";function r(e){var t;if("SMTP"===e.RoutingType||void 0===e.RoutingType)return e.EmailAddress;var n="MAPIPDL"===e.RoutingType&&(null===(t=e.ItemId)||void 0===t?void 0:t.Id)||e.EmailAddress;return e.RoutingType+":"+n}n.d(t,"a",(function(){return r}))},1841:function(e,t,n){"use strict";var r=n(2),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{},usedFindPeopleFallback:!1})();t.a=i},1849:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(235);function i(e){return{type:"PublicMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e}}},1850:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=["\t","\n","\v","\f","\r"," ",""," "," "," "," "," "," "," "," "," "," "," "," "," ","\u2028","\u2029"," "," ","　","؜","​","‌","‍","‎","‏","\u2028","\u2029","‪","‫","‬","‭","‮"," ","⁠","⁦","⁧","⁨","⁩"],i=null,a=function(e){return null===i&&(i=new Set,r.forEach((function(e){return i.add(e)}))),e.split("").every((function(e){return i.has(e)}))}},1862:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n(37),i=new r.c((function(){return n.e(482).then(n.bind(null,2634))})),a=new r.b(i,(function(e){return e.searchCacheTrie})),o=new r.b(i,(function(e){return e.compareFeatureData})),s=new r.a(i,(function(e){return e.initializeSuggestionTrie})),c=new r.a(i,(function(e){return e.isSuggestionTrieEmpty}))},1893:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(1841),i=n(1862);function a(e,t,n,r){return c(d(e),t,n,r)}function o(e,t,n,r){return i.d.import().then((function(i){return i(e,t,(function(e){return u(n,e,r)}))}))}function s(e,t,n,r){return c(e,t,n,r)}function c(e,t,n,i){for(var a=[],o=0;a.length<t&&r.a.recipientCache&&o<r.a.recipientCache.length;){var s=r.a.recipientCache[o];if(e(s))u(n,s.EmailAddress,i)||a.push(s);o++}return a}function u(e,t,n){var r=!1;return e&&function(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}(t,e)&&(r=!0),n&&n.indexOf(t.MailboxType)>=0&&(r=!0),r}var d=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),i=0;i<r.length;i++)if(0==r[i].indexOf(e))return!0}return!1}}},1900:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(0),i=n(1940),a=n(1934),o={isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:i.a.None,members:[]};function s(e,t){return Object(r.__assign)(Object(r.__assign)({},o),{isValid:!0,displayText:Object(a.a)(e,t)})}},1919:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"BodyContentType:#Exchange"},e)}},1927:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},1934:function(e,t,n){"use strict";var r=n(1850),i=n(1791),a=n(222);var o=function(e,t){var n=t||e.Name;if(!n)return!0;var i,o,s=Object(r.a)(n),c=(i=n,o=e.EmailAddress,i==o||i&&o&&i.toLowerCase()==o.toLowerCase()),u=-1!==n.indexOf("@"),d=!Object(a.a)()&&("ExternalMailbox"===e.MailboxType||"LinkedIn"===e.MailboxType),l="OneOff"===e.MailboxType||"Unknown"===e.MailboxType;return e.EmailAddress&&!("SMTP"===e.RoutingType&&c)&&(s||u||d||l)};t.a=function(e,t){var n=t||e.Name,a=!n||Object(r.a)(n);return o(e,t)?a?Object(i.a)(e):n+" <"+Object(i.a)(e)+">":n}},1940:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),t.b=r},2100:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},2154:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},2168:function(e,t,n){"use strict";var r=n(1664),i=n(1695),a=n(0),o=n(2053);var s=0;n.d(t,"a",(function(){return u}));var c=0;function u(e,t){return{userIdentity:t,recipientWellId:"rw-"+ ++c,queryString:"",recipients:[],isDirty:!1,shouldShowContactPicker:!1,findResultSet:[],findResultType:i.b.None,isSearching:!1,directorySearchType:i.a.None,dropViewState:Object(r.a)(),findPeopleFeedbackManager:e,numberOfCacheResults:0,recipientEditorViewState:(n="Hello World!",u=!1,void 0===n&&(n=null),void 0===u&&(u=!1),{editorId:(s++).toString(),content:n,isDirty:u,textDirection:null,recipientPickerPluginViewState:Object(a.__assign)(Object(a.__assign)({},Object(o.a)()),{queryString:"",wordBeforeCursor:"",findResultSet:[],isSearching:!1,directorySearchType:i.a.None})})};var n,u}},2203:function(e,t,n){"use strict";var r=n(18),i=n(1747),a=n(1893),o=function(e){var t=Object(a.c)((function(t){return"SMTP"===t.EmailAddress.RoutingType&&t.EmailAddress.EmailAddress&&t.EmailAddress.EmailAddress.toLowerCase()===e.toLowerCase()}),1);return t.length?t[0]:null},s=n(20),c=function(e){var t=void 0!==e.EmailAddress;return t||s.g.warn("Recipient cache contained a persona that had no EmailAddress"),t};function u(e){if(Object(r.i)("cmp-resolveRecipsFromCache")&&"SMTP"===e.RoutingType&&e.EmailAddress){var t=o(e.EmailAddress);if(t&&c(t))return Object(i.b)(t)}return null}n.d(t,"a",(function(){return u}))},2206:function(e,t,n){"use strict";var r=n(30),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return a}))},2217:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"UpdateItemRequest:#Exchange"},e)}},2239:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(9),i=n(2),a={clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap},o=Object(i.createStore)("protection",a),s=o()},2332:function(e,t,n){"use strict";n.d(t,"c",(function(){return I})),n.d(t,"e",(function(){return j})),n.d(t,"f",(function(){return h})),n.d(t,"d",(function(){return E})),n.d(t,"a",(function(){return M}));var r=n(0),i=n(1856),a=n(1882),o=n(3825),s=n(3278),c=n(4650),u=n(5508),d=n(5793),l=n(3102),m=n(3914),p=n(17),f=n(48),b=n(3371),v=n(3166),g=n(18),O={};function y(e){var t=O[e.composeId];return t||(t={activeSaveAction:null,hasPendingSaveAction:!1},O[e.composeId]=t),t}function I(e){var t=O[e.composeId];return t&&!!t.activeSaveAction}function S(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=y(e)).activeSaveAction?[3,1]:[2,Promise.resolve(!0)];case 1:return t.hasPendingSaveAction?[4,t.activeSaveAction]:[3,3];case 2:return n.sent(),[2,Promise.resolve(!1)];case 3:return t.hasPendingSaveAction=!0,[4,t.activeSaveAction];case 4:return n.sent(),t.hasPendingSaveAction=!1,[2,Promise.resolve(!0)]}}))}))}function j(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=y(e)).activeSaveAction=t,[4,t.then((function(e){return n.activeSaveAction=null,Promise.resolve(e)})).catch((function(e){return n.activeSaveAction=null,Promise.reject(e)}))];case 1:return r.sent(),[2]}}))}))}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(null==(t=O[e.composeId])?void 0:t.activeSaveAction)?[4,t.activeSaveAction]:[3,2];case 1:return n.sent(),[2,Promise.resolve(!0)];case 2:return[2,Promise.resolve(!1)]}}))}))}function E(e){var t=O[e.composeId];return t&&!!t.activeSaveAction}function M(e){O[e.composeId]&&delete O[e.composeId]}t.b=Object(f.d)("trySaveMessage",s.b.MailComposeSave)((function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,S(e)];case 1:return r.sent()?e?e.isSending||E(e)?[2,Promise.resolve()]:(t||(Object(a.a)(e,c.a),e.isManuallySaved=!0),Object(a.a)(e,"warningMessageMaxRecipientsExceed"),function(e){return Object(l.a)(e)<=Object(p.a)().MaxRecipientsPerMessage}(e)?[2,j(e,Object(d.b)(e).then((function(n){return e.isSending||(Object(d.a)(n,e),Object(m.a)()&&Object(o.a)(e,t?2:4),Object(b.a)()&&Object(g.i)("cmp-clp-auto-labeling")&&v.g.import().then((function(t){t(e,e.protectionViewState.clpViewState,e.itemId,e.content)}))),Promise.resolve()})).catch((function(r){if(!t&&!e.isSending){var a=Object(u.a)(r?r.message:null,!1);Object(i.a)(e,a)}return n&&!e.isSending?Promise.reject(r):Promise.resolve()})))]:(Object(i.a)(e,"warningMessageMaxRecipientsExceed"),[2,Promise.resolve()])):[2,Promise.reject("could not save message if view state does not exist")]:[2,Promise.resolve()]}}))}))}))},2344:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(17);function i(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},2352:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),i=n(2458),a=n(2168),o=n(9);function s(e,t,n,s){var c,u,d=Object(a.a)(e,n);if(s&&(d.recipients=Object(o.toJS)(s)),t)try{for(var l=Object(r.__values)(t),m=l.next();!m.done;m=l.next()){var p=m.value;d.recipients.push(Object(i.a)(p))}}catch(e){c={error:e}}finally{try{m&&!m.done&&(u=l.return)&&u.call(l)}finally{if(c)throw c.error}}return d}},2437:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),i=n(249),a=n(510),o=0;function s(e,t){var n=(t||window).document,s=n.createElement("div");s.id="owa-modal-"+o++,n.body.appendChild(s);var c,u=!1,d=function(){u||(u=!0,i.unmountComponentAtNode(s),n.body.removeChild(s))};return[new Promise((function(t,n){c=n,i.render(r.createElement(a.a,{type:a.b.None,onError:function(){d(),n()}},r.createElement(e,{onDismiss:function(e){d(),t(e)}})),s)})),function(){d(),c()}]}},2458:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(1900),a=n(2203);function o(e){var t=Object(a.a)(e);if(t)return t;var n=Object(i.b)(e);return Object(r.__assign)(Object(r.__assign)({},n),{isPendingResolution:!0,persona:{EmailAddress:e,PersonaId:e.ItemId}})}},2489:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(9),i=n(2),a={legacySignature:{html:null,txt:null},roamingSignatureMap:new r.ObservableMap,defaultSignatureName:"",defaultReplySignatureName:""},o=Object(i.createStore)("signature",a),s=o()},2606:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CreateItemJsonRequest:#Exchange"},e)}},2607:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CreateItemRequest:#Exchange"},e)}},2645:function(e,t,n){"use strict";var r=n(2437);n.d(t,"a",(function(){return r.a}))},2675:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(5507),i=function(e){return[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]},a=function(e){var t=i(e);return Object(r.a)(t).map((function(e){return e.persona.EmailAddress.EmailAddress}))},o=function(e){var t=i(e);return Object(r.a)(t).map((function(e){return e.persona.EmailAddress}))}},2709:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(17),i=n(18);function a(){var e;return(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(i.i)("cmp-proxy-address")}},2710:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(30),i=n(2606);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("CreateItem",e,t)}},3102:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(5511);function i(e){var t,n,r;return e.isDirty||(null===(t=e.toRecipientWell)||void 0===t?void 0:t.isDirty)||(null===(n=e.ccRecipientWell)||void 0===n?void 0:n.isDirty)||(null===(r=e.bccRecipientWell)||void 0===r?void 0:r.isDirty)}function a(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}},3166:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return m}));var r=n(37),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(8),n.e(11),n.e(20),n.e(727)]).then(n.bind(null,6161))})),a=new r.a(i,(function(e){return e.loadCLPUserLabels})),o=(new r.a(i,(function(e){return e.addAuditActionToViewState})),new r.b(i,(function(e){return e.showJustificationModal}))),s=new r.a(i,(function(e){return e.loadItemCLPInfo})),c=new r.b(i,(function(e){return e.updateItemCLPInfo})),u=new r.b(i,(function(e){return e.logReadCLPLabel})),d=new r.b(i,(function(e){return e.triggerCLPAutoLabeling})),l=(new r.b(i,(function(e){return e.constructCLPAuditAction})),Object(r.d)(i,(function(e){return e.CLPSubjectHeaderLabel}))),m=Object(r.d)(i,(function(e){return e.CLPMandatoryLabelModal}))},3183:function(e,t,n){"use strict";function r(e){return void 0!==e.publicFolderId}n.d(t,"a",(function(){return r}))},3226:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemField:#Exchange"},e)}},3278:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4649),i=n(3370),a="MailComposeSend";t.b={MailComposeReply:{name:"MailComposeReply",options:{},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeReplyAll:{name:"MailComposeReplyAll",options:{},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeForward:{name:"MailComposeForward",options:{},customData:function(e,t,n,r){return[t]},actionSource:function(e,t,n,r){return t},cosmosOnlyData:function(e,t,n,r){return e&&e.toString()}},MailComposeSendE2E:{name:"MailComposeSendE2E",customData:function(e){return{composeTraceId:e.logTraceId,operation:e.operation,isGroupScenario:Object(i.b)(e)}}},MailComposeSave:{name:"MailComposeSave"},MailComposeUpConvert:{name:"MailComposeUpConvert"},ComposeCommandDiscardCompose:{name:"ComposeCommandDiscardCompose",customData:function(e){return{composeTraceId:e.logTraceId}},options:{isCore:!0},cosmosOnlyData:function(e){return JSON.stringify({smartReplyExtractionId:Object(r.a)(e,"smartReply"),smartDocExtractionId:Object(r.a)(e,"smartDoc")})}},ComposeCommandShowFrom:{name:"ComposeCommandShowFrom"},ComposeCommandSetImportance:{name:"ComposeCommmandSetImportance",customData:function(e,t){return[t]}}}},3348:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(17),i=n(18);function a(){var e;return Object(i.i)("cmp-roaming-signature")&&!(null===(e=Object(r.a)().SessionSettings)||void 0===e?void 0:e.IsExplicitLogon)}},3370:function(e,t,n){"use strict";function r(e){return i(e)&&(2==(t=e).operation||t.toRecipientWell.recipients.some((function(e){return e.persona.EmailAddress.EmailAddress.toLowerCase()===t.groupId.toLowerCase()})));var t}function i(e){return!!e.groupId}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},3371:function(e,t,n){"use strict";var r=n(18),i=n(2239),a=n(222);t.a=function(){var e=i.b.clpLabels;return Object(r.i)("cmp-clp")&&e.length>0&&e.some((function(e){return e.isLabelEnabled}))&&!Object(a.a)()}},3525:function(e,t,n){"use strict";n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return m})),n.d(t,"g",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"k",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return g}));var r=n(0),i=n(127),a=n(4),o=n(17);function s(e,t){var n=O(e.selectedCLPLabel,"Change"),a=e.originalCLPLabel,o=e.selectedCLPLabel,s=Object(r.__assign)(Object(r.__assign)({},n),{IsLabelChanged:!0,LabelIdBefore:a?a.id:null,IsProtectionChanged:!(!a||!o)&&a.isEncryptingLabel!=o.isEncryptingLabel,ProtectedBefore:null==a?void 0:a.isEncryptingLabel,UserJustification:t});i.m.importAndExecute(s)}function c(e){var t=O(e,"Discover");i.m.importAndExecute(t)}function u(e){(null==e?void 0:e.value)&&e.value.length>0&&Object(i.r)("LoadCLPLabelOnBoot",{labelCount:e.value.length})}function d(e){e&&Object(i.r)("LoadCLPLabelComposeUsage",{isDefaultLabel:e.isDefault,isEncryptingLabel:e.isEncryptingLabel})}function l(e,t){t&&e?Object(i.r)("LoadCLPLabelChange",{isDowngrade:e.settingOrder>t.settingOrder,isOriginalLabelDefault:e.isDefault}):e&&Object(i.r)("LoadCLPLabelUnselect",{isOriginalLabelDefault:e.isDefault,isOriginalLabelEncrypting:e.isEncryptingLabel})}function m(e){401!=e.status&&Object(i.r)("CLPAutoLabelEnabled")}function p(){Object(i.r)("CLPMandatoryLabelDialogShown")}function f(){Object(i.r)("CLPAutoLabelAutomaticApplied")}function b(){Object(i.r)("CLPAutoLabelRecommendedShown")}function v(){Object(i.r)("CLPAutoLabelRecommendedApplied")}function g(){Object(i.r)("CLPAutoLabelRecommendedDismissed")}function O(e,t){var n=Object(o.a)().SessionSettings,r=n.ExternalDirectoryTenantGuid,i=n.UserEmailAddress;return{CreationTime:Object(a.ub)(Object(a.Qb)()),Version:"1.1",Operation:t,OrganizationId:r,UserId:i,ApplicationId:"00000002-0000-0ff1-ce00-000000000000",ApplicationName:"Outlook Web",DataState:"Use",LabelId:e?e.id:null,Protected:e?e.isEncryptingLabel:null}}},3627:function(e,t,n){"use strict";function r(e){return e.policyMatchDetails.slice().sort((function(e,t){var n=i(t.Action)-i(e.Action);return 0==n?null==e.MatchPriority?null==t.MatchPriority?n:1:null==t.MatchPriority?-1:e.MatchPriority-t.MatchPriority:n}))[0]}function i(e){switch(e){case 1:return 0;case 4:case 2:case 3:return 1;case 5:return 2;default:return 3}}n.d(t,"a",(function(){return r}))},3628:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Manual="manual",e.Automatic="automatic",e.Default="default"}(r||(r={}))},3629:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1927),i=n(794),a=n(2154);function o(e,t){var n;return Object(a.a)({Path:Object(i.a)({FieldURI:e}),Item:Object(r.a)((n={},n[e]=t,n))})}},3757:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(17);function i(){return Object(r.a)().SessionSettings.UserEmailAddress}},3758:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){var t,n,i=[];if(null==e?void 0:e.recipients)try{for(var a=Object(r.__values)(e.recipients),o=a.next();!o.done;o=a.next()){var s=o.value,c=s.persona.EmailAddress;(null==c?void 0:c.ItemId)&&"PrivateDL"==c.MailboxType?i.push({Name:c.Name,RoutingType:c.RoutingType,MailboxType:c.MailboxType,ItemId:{Id:c.ItemId.Id,ChangeKey:null},EmailAddressIndex:c.EmailAddressIndex,RelevanceScore:c.RelevanceScore||0}):i.push(s.persona.EmailAddress)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}},3759:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1774),i=n(2060),a=n(18);function o(e){var t=[];return null==e||e.forEach((function(e){var n=Object(r.a)(e);if(n){var o=function(e){switch(e){case 4:return 4;case 3:return 3;case 6:return 6;case 5:return 5;case 2:return 2;case 1:return 1;default:return 0}}(n.permissionLevel),s=Object(a.i)("cmp-prague")&&function(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}(o)&&Object(i.a)(n.fileName);if(1===o||2===o||s){var c={ProviderType:"OneDrivePro",Url:n.url,PermissionType:o};t.push(c)}}})),t}},3760:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(17);function i(e){return e===Object(r.a)().SessionSettings.UserEmailAddress}},3825:function(e,t,n){"use strict";var r=n(6),i=n(5506),a=n(1856),o=n(919),s=n(30),c=n(0);function u(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(c.__assign)({__type:"GetDlpPolicyTipsRequest:#Exchange"},n)),Object(s.a)("GetDlpPolicyTips",e,t)}var d=n(222),l=n(1882),m=n(148),p=n(2675),f=n(3627),b=n(20);n.d(t,"b",(function(){return y}));var v=Object(m.action)("triggerPolicyTips")((function(e,t,n,r,a){var o,s=e.policyTipsViewState;if(!(s.handlerDisabled||(null===(o=e.protectionViewState)||void 0===o?void 0:o.IRMData))){var c,d=s.inProgressPolicyMatch,m=s.succeededPolicyMatch,f=s.pendingPolicyMatch;if(n||(n=I(e.subject)),r||(r=I(e.content)),a||(a=Object(i.a)(e)),s.isRequestInProgress)s.pendingRequests=!0,f.itemId=e.itemId,f.subjectChecksum=n,f.contentChecksum=r,f.eventTrigger=t,f.attachmentIds=a;else{if(s.pendingRequests=!1,d.itemId=e.itemId,d.subjectChecksum=n,d.contentChecksum=r,d.eventTrigger=t,d.attachmentIds=a,0==(c=d).subjectChecksum&&0==c.contentChecksum&&0==c.attachmentIds.length)return m.policyMatchDetails=[],m.subjectChecksum=0,m.contentChecksum=0,m.attachmentIds=[],void Object(l.a)(e,"dlpPolicyTips");(S(d,m)||function(e,t){if(e.attachmentIds.length!=t.attachmentIds.length)return!0;for(var n=0;n<e.attachmentIds.length;n++)if(null!=e.attachmentIds[n]&&null!=t.attachmentIds[n]&&e.attachmentIds[n].Id!=t.attachmentIds[n].Id)return!0;return!1}(d,m)||1==t)&&function(e){var t=e.policyTipsViewState,n=t.succeededPolicyMatch,r=t.inProgressPolicyMatch,i=e.itemId;if(null==i?void 0:i.Id){var a={ItemId:i,ClientSupportsScanResultData:!0,ScanResultData:n.scanResultData,ScanResultMetadata:n.scanResultMetaData,BodyOrSubjectChanged:S(r,n),NeedToReclassify:!n.itemId,CustomizedStringsNeeded:!0,Recipients:Object(p.a)(e),EventTrigger:r.eventTrigger};e.policyTipsViewState.isRequestInProgress=!0,u(a).then((function(t){!function(e,t,n,r){var i=t.policyTipsViewState,a=i.pendingPolicyMatch;i.isRequestInProgress=!1,i.pendingRequests&&a&&v(t,a.eventTrigger,a.subjectChecksum,a.contentChecksum,a.attachmentIds);0==e.EvaluationResult||1==e.OptimizationResult||2==e.EvaluationResult?n(t,e):r(t,e)}(t,e,g,O)}))}}(e)}}}));t.a=v;function g(e,t){var n=e.policyTipsViewState,r=n.succeededPolicyMatch,i=n.inProgressPolicyMatch;r.itemId=i.itemId,r.attachmentIds=i.attachmentIds,r.subjectChecksum=i.subjectChecksum,r.contentChecksum=i.contentChecksum,r.policyMatchDetails=t.Matches,t.ScanResultData&&(r.scanResultData=t.ScanResultData),t.ScanResultMetadata&&(r.scanResultMetaData=t.ScanResultMetadata),1==t.OptimizationResult&&(n.handlerDisabled=!0),function(e,t){if(t){var n=e.policyTipsViewState,r={complianceUrl:t.ComplianceURL,blockString:t.PolicyTipMessageBlockString,notifyString:t.PolicyTipMessageNotifyString,overrideString:t.PolicyTipMessageOverrideString};Object(o.a)(n,r,(function(e,t){return t||e}))}}(e,t.CustomizedStrings),y(e)}function O(e,t){var n=e.policyTipsViewState;t?(b.g.warn(Object(r.c)("PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult)+" Diagnostic: "+t.DiagnosticData),4!=t.EvaluationResult&&7!=t.EvaluationResult&&1!=t.EvaluationResult&&6!=t.EvaluationResult&&8!=t.EvaluationResult||(b.g.warn("Disabling further PolicyTips requests because of the failure"),n.handlerDisabled=!0)):(b.g.warn("PolicyTipsResponse is null (PolicyTipsRequest is timed out)"),n.handlerDisabled=!0),Object(l.a)(e,"dlpPolicyTips")}function y(e){Object(l.a)(e,["consumerDlpPolicyTips","enterpriseDlpPolicyTips"]),Object(f.a)(e.policyTipsViewState.succeededPolicyMatch)&&(Object(d.a)()?Object(a.a)(e,"consumerDlpPolicyTips"):Object(a.a)(e,"enterpriseDlpPolicyTips"))}function I(e){var t=0;if(e)for(var n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function S(e,t){return e.subjectChecksum!=t.subjectChecksum||e.contentChecksum!=t.contentChecksum}},3913:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(799),i=n(897),a=n(794),o=n(998),s=n(910),c=n(18),u=n(4653);function d(e){var t=Object(r.a)({BaseShape:"IdOnly",ClientSupportsIrm:!0,FilterHtmlContent:!0,InlineImageCustomDataTemplate:i.e,InlineImageUrlOnLoadTemplate:"",InlineImageUrlTemplate:i.f,AdditionalProperties:[Object(a.a)({FieldURI:"ItemLastModifiedTime"})]});return Object(u.a)(t),e&&(t.BodyType=e),t.ImageProxyCapability=Object(c.i)("rp-replyImageProxy")&&Object(o.a)()?s.a.OwaConnectorsProxyAndCompose:s.a.None,t}},3914:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(17);function i(){return Object(r.a)().PolicyTipsEnabled}},3986:function(e,t,n){"use strict";var r=n(4651),i=n(3757),a=n(996),o=n(17),s=n(222);var c=n(4947);function u(){var e,t,n=(e=Object(o.a)(),t=Object(s.a)()?e.SessionSettings.DefaultFromAddress:e.UserOptions.SendAddressDefault,Object(a.c)(t)?t:Object(i.a)()),u=Object(i.a)();if(u===n&&Object(c.a)(n)){var d=Object(r.b)(u,!0);if(d&&d.length>0)return d[0]}return n}var d=n(5936),l=n(1647);function m(e){var t;if(e){var n=Object(l.g)(),r=null==n?void 0:n.items,i=r&&r.has(e.Id)&&r.get(e.Id);t=i&&Object(d.a)(i.ToRecipients,i.CcRecipients)}return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:t||u(),Name:Object(o.a)().SessionSettings.UserDisplayName}}n.d(t,"a",(function(){return m}))},4404:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(17);function i(e,t){return e===t||e&&t&&e.toLowerCase()==t.toLowerCase()}function a(e){return e&&i(e.EmailAddress,Object(r.a)().SessionSettings.UserEmailAddress)}},4405:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r="<div id=appendonsend></div>";function i(e){var t="";return"HTML"==e&&(t+=r),t}},4406:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s}));var r="msip_labels",i="X-MS-Exchange-Organization-ModifySensitivityLabel",a="00000000-0000-0000-0000-000000000000",o="Standard",s="Privileged"},4407:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r={Name:{id:34230,propertyType:"String"},Description:{id:34231,propertyType:"String"},Id:{id:34232,propertyType:"String"},IsClassified:{id:34229,propertyType:"Boolean"}},i="messageClassification"},4649:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1647);function i(e,t){var n,i,a,o="";if(e){var s=r.u.items.get(null===(n=e.referenceItemId)||void 0===n?void 0:n.Id);switch(t){case"smartReply":(null===(i=null==s?void 0:s.SmartReplyData)||void 0===i?void 0:i.ExtractionID)&&(o=s.SmartReplyData.ExtractionID);break;case"smartDoc":(null===(a=null==s?void 0:s.SmartDocData)||void 0===a?void 0:a.EntityId)&&(o=s.SmartDocData.EntityId)}}return o}},4650:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade","errorMessageExceededHourlyMessageLimit","errorMessageExceededMaxRecipientLimit","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimit","errorMessageExceededMessageLimitShowTierUpgrade","errorMessageMessageSubmissionBlocked","errorMessageMessageBlocked","errorMessageTimeout","errorMessageThrottled","errorMessageTransientError","errorMessageItemNoLongerExistToSave","errorMessageItemNoLongerExistToSend","errorMessageQuotaExceededMessageCanNotBeSaved","errorMessageQuotaExceededMessageCanNotBeSent","errorMessageSubmissionQuotaExceededMessageCanNotBeSent","errorMessageMessageCanNotBeSaved","errorMessageMessageCanNotBeSent","errorMessageNoPermissionToSendAs","errorMessageNoRecipentsMailCanNotBeSend","errorMessageInvalidSenderMailCanNotBeSend","warningMessageNoPermissionToPerformAction","error500","error503","errorFailedToFetch","errorSessionTimeout","errorMailboxStoreUnavailable","errorMessageErrorWithDetail","smimeEncodeError","smimeBccForkingFailedError"]},4651:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(3757),i=n(4947),a=n(17),o=n(222);function s(e){var t=[],n=Object(r.a)();Object(i.a)(n)||t.push(n);var o=c(n,e);return t=function(e){var t=Object(a.a)().SessionSettings.ConnectedAccountInfos;t&&t.length>0&&t.forEach((function(t){-1==e.lastIndexOf(t.EmailAddress)&&e.push(t.EmailAddress)}));return e}(t=t.concat(o))}function c(e,t){var n=[];if(Object(o.a)()||t){var r=function(e){return u(e,Object(a.a)().SessionSettings.UserProxyAddresses)}(e);n=n.concat(r)}if(Object(o.a)()){var i=function(e){return u(e,Object(a.a)().SessionSettings.NotManagedEmailAddresses)}(e);n=n.concat(i)}return n}function u(e,t){var n=[];return t&&t.length>0&&t.forEach((function(t){e==t||Object(i.a)(t)||n.push(t)})),n}},4653:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(18),i=n(440);function a(e){var t;Object(r.i)("cmp-clp")&&(null===(t=e.AdditionalProperties)||void 0===t||t.push(Object(i.a)({PropertyName:"msip_labels",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})))}},4654:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(678),i=n(440),a=n(1927),o=n(2154);function s(e){return Object(o.a)({Path:Object(i.a)(e.ExtendedFieldURI),Item:Object(a.a)({ExtendedProperty:[Object(r.a)(e)]})})}},4947:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(17),i=n(222);function a(e){var t=!1;if(Object(i.a)()){var n=Object(r.a)();t=0==(e=e.toLowerCase()).indexOf("outlook_"+n.HexCID)||-1!=e.indexOf("@shadow.outlook.com")}return t}},4948:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(1837),i=n(37),a=new i.c((function(){return Promise.all([n.e(0),n.e(6),n.e(27),n.e(38),n.e(39),n.e(250),n.e(625)]).then(n.bind(null,7757))})),o=Object(r.a)(a,(function(e){return e.AtMentionPickerPlugin}),"AtMentionsPicker",(function(e){return 11==e.eventType})),s=new i.b(a,(function(e){return e.loadAtMentionsData}))},510:function(e,t,n){"use strict";var r,i=n(0),a=n(1),o=n(698),s=n(20);!function(e){e[e.Full=0]="Full",e[e.Simple=1]="Simple",e[e.None=2]="None"}(r||(r={}));var c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return Object(i.__extends)(t,e),t.prototype.componentDidCatch=function(e,t){var n,r;null===(r=(n=this.props).onError)||void 0===r||r.call(n,e,t),this.props.suppressErrorReport||(e.component=!0,e.diagnosticInfo=(e.diagnosticInfo||"")+t.componentStack,Object(s.d)(e)),this.setState({error:e})},t.prototype.render=function(){var e=this.state.error,t=this.props,n=t.children,o=t.type,s=t.windowIcons;if(e){if(o==r.None)return null;if(o==r.Simple||!this.props.fullErrorComponent)return a.createElement("div",null,e);var c=this.props.fullErrorComponent;return a.createElement(c,Object(i.__assign)({error:e,windowIcons:s},this.props.fullErrorComponentProps))}return n},t=Object(i.__decorate)([o.observer],t)}(a.Component);n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return r}))},5158:function(e,t,n){"use strict";var r=n(0),i=n(3913),a=n(18),o=n(1849),s=n(1785),c=n(17),u=n(2607),d=n(563),l=n(799),m=n(794),p=n(801),f=n(2710),b=n(168),v=n(2344),g=n(369);function O(e,t,n,O,y,I,S,j,h){var E,M,R=function(e,t,n,o,s,c,f,b,g){var O="PostItem:#Exchange"==e.__type?"newPost":"newMail",y=f?Object(p.a)({BaseFolderId:Object(d.a)({Id:f})}):null,I=Object(u.a)(Object(r.__assign)({ClientSupportsIrm:!0,ComposeOperation:O,MessageDisposition:n?"SendAndSaveCopy":"SaveOnly",Items:[e],TimeFormat:o,SendOnNotFoundError:!0,RemoteExecute:b,ItemShape:Object(l.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(m.a)({FieldURI:"ItemLastModifiedTime"})]}),SavedItemFolderId:null!=y?y:void 0,SuppressMarkAsReadOnReplyOrForward:Object(a.i)("tri-suppressMarkReadBehaviorOnRF")&&g},Object(v.a)()));return(null==c?void 0:c.IsOwner)&&(I.ComplianceId=c.RmsTemplateId?c.RmsTemplateId.toUpperCase():"0"),n?s&&I.ItemShape&&(I.ItemShape.ReturnOnlyInternetMessageId=!0):(I.ItemShape=Object(i.a)(t),I.ShapeName="MailCompose"),I}(e,t,n,O,y,I,S,j,h);if("PostItem:#Exchange"==e.__type&&S){var P=s.a.folderTable.get(S);if(P){var C=P.ReplicaList?P.ReplicaList[0]:null===(E=Object(c.a)().SessionSettings)||void 0===E?void 0:E.DefaultPublicFolderMailbox;if(C){var T=Object(o.a)(C);M=Object(g.a)(T)}}}return Object(f.a)({Header:Object(b.b)(),Body:R},M).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}n.d(t,"a",(function(){return O}))},5506:function(e,t,n){"use strict";function r(e){var t=[],n=e.attachmentWell;return n&&(n.docViewAttachments.forEach((function(e){t.push(e.attachmentId)})),n.inlineAttachments.forEach((function(e){t.push(e.attachmentId)})),n.imageViewAttachments.forEach((function(e){t.push(e.attachmentId)}))),t}n.d(t,"a",(function(){return r}))},5507:function(e,t,n){"use strict";var r=n(0);t.a=function(e){return e&&0!==e.length?e.filter((function(e){return!!e})).reduce((function(e,t){return Object(r.__spread)(e,(null==(n=t)?void 0:n.recipients)?n.recipients.slice():[]);var n}),[]):[]}},5508:function(e,t,n){"use strict";function r(e,t){if(e){if(e.indexOf("500")>=0)return"error500";if(e.indexOf("503")>=0)return"error503";if(e.indexOf("Failed to fetch")>=0)return"errorFailedToFetch"}switch(e){case"ErrorSessionTimeout":return"errorSessionTimeout";case"ErrorMailboxStoreUnavaiable":return"errorMailboxStoreUnavailable";case"ErrorSendAsDenied":return"errorMessageNoPermissionToSendAs";case"ErrorRightsManagementPermanentException":return null;case"ErrorSubmissionQuotaExceeded":return"errorMessageSubmissionQuotaExceededMessageCanNotBeSent";case"ErrorAccountSuspend":return"errorMessageAccountSuspend";case"ErrorExceededMaxRecipientLimit":return"errorMessageExceededMaxRecipientLimit";case"ErrorExceededMessageLimit":return"errorMessageExceededMessageLimit";case"ErrorExceededHourlyMessageLimit":return"errorMessageExceededHourlyMessageLimit";case"ErrorMessageBlocked":return"errorMessageMessageBlocked";case"ErrorMessageSubmissionBlocked":return"errorMessageMessageSubmissionBlocked";case"ErrorAccountSuspendShowTierUpgrade":return"errorMessageAccountSuspendShowTierUpgrade";case"ErrorExceededMaxRecipientLimitShowTierUpgrade":return"errorMessageExceededMaxRecipientLimitShowTierUpgrade";case"ErrorExceededMessageLimitShowTierUpgrade":return"errorMessageExceededMessageLimitShowTierUpgrade";case"ErrorMessageTimeout":return"errorMessageTimeout";case"ErrorMessageThrottled":return"errorMessageThrottled";case"ErrorMessageTransientError":return"errorMessageTransientError";case"ErrorItemNotFound":return t?"errorMessageItemNoLongerExistToSend":"errorMessageItemNoLongerExistToSave";case"ErrorAccessDenied":return"warningMessageNoPermissionToPerformAction";case"SmimeEncodeError":return"smimeEncodeError";case"ErrorQuotaExceeded":return t?"errorMessageQuotaExceededMessageCanNotBeSent":"errorMessageQuotaExceededMessageCanNotBeSaved";default:return t?"errorMessageMessageCanNotBeSent":"errorMessageMessageCanNotBeSaved"}}n.d(t,"a",(function(){return r}))},5509:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(390);function i(e){return e?Object(r.a)({Id:e.Id,ChangeKey:e.ChangeKey}):null}},5510:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(37),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(705)]).then(n.bind(null,9388))})),a=Object(r.d)(i,(function(e){return e.HipCheckModal}))},5511:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.recipients)?e.recipients.length:0}n.d(t,"a",(function(){return r}))},5520:function(e,t,n){"use strict";var r=n(2352),i=n(2);t.a=Object(i.mutatorAction)("showCcWell",(function(e){e.ccRecipientWell||(e.ccRecipientWell=Object(r.a)(e.toRecipientWell.findPeopleFeedbackManager,[]))}))},5793:function(e,t,n){"use strict";var r=n(0),i=n(5509),a=n(2709),o=n(3986),s=n(3758),c=n(4652),u=n(5937);var d=new RegExp("<img[^>]*\\s+src=[\"']data:image\\/[^<]+;base64,\\s*[a-zA-Z0-9+\\/=&#;]+[\"'][^>]*>","gi");function l(e){var t=0;if(e){var n=e.match(d);t=n?n.length:0}return t}var m=new RegExp('<IMG[^>]+?ORIGINALSRC\\s*=\\s*"[\\s\\S]+?"[\\s\\S]*?>',"gim"),p=new RegExp('\\sSRC\\s*=\\s*"DATA:[\\s\\S]+?"',"im"),f=new RegExp('\\sORIGINALSRC\\s*=\\s*"',"im");function b(e,t){return e?e.replace(m,(function(e){return e=e.replace(p,""),t&&(e=e.replace(f,' src="')),e})):e}var v=n(17),g=n(3077),O=n(678),y=n(440),I=35356;var S=n(4),j="0x3FEF";function h(e,t){if(t.ExtendedProperty)for(var n=e.length;n--&&t.ExtendedProperty.length>0;)for(var r=t.ExtendedProperty.length;r--;)if(e[n]===t.ExtendedProperty[r].ExtendedFieldURI.PropertyName){t.ExtendedProperty.splice(r,1);break}}function E(e,t,n){var r,i;n?h(["AppendOnSend"],t):e.appendOnSend&&e.appendOnSend.length>0&&(r=e.appendOnSend,(i=t).ExtendedProperty||(i.ExtendedProperty=[]),i.ExtendedProperty.push(Object(O.a)({Value:JSON.stringify(r),ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})})))}function M(e,t){e.internetHeaders.size>0&&function(e,t){var n,i;t.ExtendedProperty||(t.ExtendedProperty=[]);try{for(var a=Object(r.__values)(e.keys()),o=a.next();!o.done;o=a.next()){var s=o.value;t.ExtendedProperty.push(Object(O.a)({Value:e.get(s),ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"InternetHeaders",PropertyName:s,PropertyType:"String"})}))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}(e.internetHeaders,t),e.keysOfInternetHeadersToBeRemoved.length>0&&h(e.keysOfInternetHeadersToBeRemoved,t)}function R(e,t,n){n?h(["ComposeType"],t):null!==e.draftComposeType&&function(e,t){t.ExtendedProperty||(t.ExtendedProperty=[]);t.ExtendedProperty.push(Object(O.a)({Value:e,ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"Common",PropertyName:"ComposeType",PropertyType:"String"})}))}(e.draftComposeType,t)}var P=n(3370),C=n(5938),T=n(2),x=Object(T.mutatorAction)("clearKeysOfInternetHeadersToBeRemoved",(function(e){e.keysOfInternetHeadersToBeRemoved=[]})),_=n(390),w=n(148);function k(e){e&&(e.isDirty=!1)}var A=Object(w.action)("updateComposeItemId")((function(e,t,n,r){e&&(e.itemId?e.itemId.ChangeKey=n:e.itemId=Object(_.a)({Id:t,ChangeKey:n}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,k(e.toRecipientWell),k(e.ccRecipientWell),k(e.bccRecipientWell)))})),D=n(2302),N=n(4405),L=n(1786),F=n(18),V=n(1667),B=n(1967),U=n(3759),W=n(6),q=n(3628),G=n(4406),H=function(e){switch(e.labelApplyMethod){case q.a.Manual:return G.d;case q.a.Default:case q.a.Automatic:default:return G.e}},z=n(3525),J="MSIP_Label";function Q(e){var t=e.selectedCLPLabel,n=e.nonTenantLabelString,r=Object(v.a)().SessionSettings.ExternalDirectoryTenantGuid,i="";t&&(i=function(e,t){return Object.keys(e).map((function(n){return J+"_"+t.id+"_"+n+"="+e[n]+";"})).join("")}({Enabled:"True",SiteId:r,SetDate:Object(S.ub)(Object(S.Qb)()),Name:t.displayName,ContentBits:0,Method:H(e)},t));return n?n+i:i}function K(e){var t=e.selectedCLPLabel,n=e.originalCLPLabel;if(t||n){var r=t&&!n&&t.isDefault;if(!t||!n||t.id!=n.id||n.isDefault)return(n&&!r?n.id:G.a)+";"+(t?t.id:G.a)}}function $(e,t,n){var r=Object(O.a)({ExtendedFieldURI:Object(y.a)({PropertyName:e,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:t});n.ExtendedProperty?n.ExtendedProperty.push(r):n.ExtendedProperty=[r]}var X=n(3183),Z=n(1778),Y=n(4407);var ee=n(5158),te=n(6180),ne=n(1699),re=n(799);var ie=n(794),ae=n(30);function oe(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"PostGroupItemJsonRequest:#Exchange"},n)),Object(ae.a)("PostGroupItem",e,t)}var se=n(168),ce=n(2344);function ue(e,t,n,i,a,o){var s,c=(s=Object(r.__assign)({ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:"SendAndSaveCopy",Items:[t],TimeFormat:i,ItemShape:Object(re.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ie.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(ce.a)()),Object(r.__assign)({__type:"PostGroupItemRequest:#Exchange"},s));return o&&(c.ItemShape.ReturnOnlyInternetMessageId=!0),(null==a?void 0:a.IsOwner)&&(c.ComplianceId=a.RmsTemplateId?a.RmsTemplateId.toUpperCase():"0"),c}function de(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"PostUnifiedGroupItemJsonRequest:#Exchange"},n)),Object(ae.a)("PostUnifiedGroupItem",e,t)}function le(e,t,n,i,a){var o,s=(o={ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},SkipGroupSyncDelivery:!0,ClientSupportsIrm:!0,Item:t,ItemShape:Object(re.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ie.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(r.__assign)({__type:"PostUnifiedGroupItemRequest:#Exchange"},o));return a&&(s.ItemShape.ReturnOnlyInternetMessageId=!0),s}var me=n(4654),pe=n(3629),fe=n(3226);function be(e,t){return Object(fe.a)({Path:Object(y.a)({DistinguishedPropertySetId:e,PropertyName:t,PropertyType:"String"})})}var ve=n(2100),ge=n(2217),Oe=n(2206);function ye(e,t,n,i){var a=function(e,t,n,i){var a,o=[];e.MimeContent&&o.push(Object(pe.a)("MimeContent",e.MimeContent));var s=[Object(pe.a)("ToRecipients",e.ToRecipients),Object(pe.a)("CcRecipients",e.CcRecipients),Object(pe.a)("BccRecipients",e.BccRecipients),Object(pe.a)("Subject",e.Subject),Object(pe.a)("Body",e.Body),Object(pe.a)("Importance",e.Importance),Object(pe.a)("IsReadReceiptRequested",e.IsReadReceiptRequested),Object(pe.a)("IsDeliveryReceiptRequested",e.IsDeliveryReceiptRequested)];(null===(a=e.Attachments)||void 0===a?void 0:a.length)&&s.push(Object(pe.a)("Attachments",e.Attachments)),e.ItemClass&&s.push(Object(pe.a)("ItemClass",e.ItemClass)),e.From&&s.push(Object(pe.a)("From",e.From)),i.length>0&&i.map((function(e){s.push(be("InternetHeaders",e))})),t&&s.push(be("Common","AppendOnSend")),e.MentionsEx&&s.push(Object(pe.a)("MentionsEx",e.MentionsEx)),e.Sensitivity&&s.push(Object(pe.a)("Sensitivity",e.Sensitivity)),e.ExtendedProperty&&e.ExtendedProperty.map((function(e){s.push(Object(me.a)(e))})),t&&e.DocLinks&&e.DocLinks.length>0&&s.push(Object(pe.a)("DocLinks",e.DocLinks));var c=Object(ve.a)({Updates:Object(r.__spread)(o,s),ItemId:Object(_.a)({Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey})}),u=Object(ge.a)(Object(r.__assign)({ItemChanges:[c],ConflictResolution:"AlwaysOverwrite",ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone",MessageDisposition:t?"SendAndSaveCopy":"SaveOnly",SuppressReadReceipts:!1,ComposeOperation:"newMail",PromoteInlineAttachments:!1,SendOnNotFoundError:!0,ItemShape:Object(re.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ie.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(ce.a)()));return(null==n?void 0:n.IsOwner)&&(u.ComplianceId=n.RmsTemplateId?n.RmsTemplateId.toUpperCase():"0"),u}(e,t,n,i);return Object(Oe.a)({Header:Object(se.b)(),Body:a}).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}var Ie=n(1800),Se=n(1656),je="InternetHeaders",he="X-Ms-Exchange-Organization-Dlp-SenderOverrideJustification",Ee="X-Ms-Exchange-Organization-Dlp-FalsePositive";var Me=n(2239);function Re(e){if(!e)return null;var t=e.IRMData;return!t||t.RmsTemplateId&&!Me.b.rmsTemplates.get(t.RmsTemplateId)?null:t}function Pe(e){return Object(r.__assign)({__type:"ApproveRequestItem:#Exchange"},e)}var Ce=n(1919),Te=n(1927);function xe(e){return Object(r.__assign)({__type:"RejectRequestItem:#Exchange"},e)}var _e=n(5939),we=n(5940),ke=n(222),Ae=n(2934),De=n(2935),Ne=n(2086),Le=n(4948),Fe=n(3760),Ve="X-MS-Exchange-Organization-ClientSubmitSmtp-OriginalFrom";var Be=n(2280),Ue={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timeFormat"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"timeFormat"},value:{kind:"Variable",name:{kind:"Name",value:"timeFormat"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"Body"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"},arguments:[],directives:[]}]}}]}}]}}]},We=n(713),qe=n(111),Ge=n(9);function He(e,t){return{ToRecipients:e.ToRecipients,CcRecipients:e.CcRecipients,BccRecipients:e.BccRecipients,Subject:e.Subject,Body:e.Body?{Value:e.Body.Value,DataUriCount:e.Body.DataUriCount,BodyType:e.Body.BodyType}:void 0,NewBodyContent:e.NewBodyContent?{Value:e.NewBodyContent.Value,DataUriCount:e.NewBodyContent.DataUriCount,BodyType:e.NewBodyContent.BodyType}:void 0,Importance:e.Importance,IsReadReceiptRequested:e.IsReadReceiptRequested,IsDeliveryReceiptRequested:e.IsDeliveryReceiptRequested,UpdateResponseItemId:e.UpdateResponseItemId,ReferenceItemId:e.ReferenceItemId,ReferenceItemDocumentId:e.ReferenceItemDocumentId,atMentionedRecipients:Je(t),recipientsAddedViaAtMention:t.mentionsPicker.mentionsAddedRecipients?Object(Ge.toJS)(t.mentionsPicker.mentionsAddedRecipients):void 0,connectedAccountSharingGuid:Qe(t),deferredSendTime:t.deferredSendTime?Object(S.ub)(t.deferredSendTime):void 0,clpLabelModifificationHeader:K(t.protectionViewState.clpViewState),clpLabelProperty:Q(t.protectionViewState.clpViewState),messageClassification:Ke(t),originalSmtpFromAddress:$e(t),operation:ze(t.operation)}}function ze(e){switch(e){case 0:return"New";case 1:return"Reply";case 2:return"ReplyAll";case 3:return"Forward";case 4:return"EditDraft";case 5:case 6:return Object(qe.a)(e)}}function Je(e){var t=e.mentionsPicker.atMentionTuples;return t?Object.keys(t).map((function(e){return{key:e,emailAddress:t[e].EmailAddress}})):[]}function Qe(e){var t=e.fromViewState.from,n=Object(v.a)().SessionSettings.ConnectedAccountInfos;if(n)for(var r=0;r<n.length;r++){var i=n[r];if(i.EmailAddress==t.email.EmailAddress)return i.SubscriptionGuid}}function Ke(e){var t=e.protectionViewState.classificationViewState;return t.messageClassification?Object(r.__assign)(Object(r.__assign)({},t.messageClassification),{isClassified:!0}):void 0}function $e(e){var t,n,r,i=null===(r=null===(n=null===(t=e.fromViewState)||void 0===t?void 0:t.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(i&&!Object(Fe.a)(i))return i}var Xe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SaveDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"Body"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"},arguments:[],directives:[]}]}}]}}]}}]},Ze={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SendDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"Body"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"},arguments:[],directives:[]}]}}]}}]}}]};var Ye=n(369);n.d(t,"c",(function(){return st})),n.d(t,"b",(function(){return ct})),n.d(t,"a",(function(){return ut}));var et='<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" style="display:none;"> P {{margin-top:0;margin-bottom:0;}} </style></head><body dir="{0}">{1}</body></html>',tt="IPM.Note";function nt(e){var t=e.content,n=0;if("HTML"==e.bodyType){var i=dt(e);n=l(t=b(t)),t=Object(W.c)(et,i,t)}var a,o=Object(Ce.a)({BodyType:e.bodyType,Value:t});o.DataUriCount=n;var s,c={Subject:e.subject||"",Importance:e.importance,Sensitivity:e.sensitivity};return s=Object(r.__assign)(Object(r.__assign)({},c),{Body:o}),a=Object(r.__assign)({__type:"PostItem:#Exchange"},s),e.itemId&&(a.ItemId=e.itemId),e.fromViewState&&function(e,t){var n=e.from;t.From=Object(g.a)({Mailbox:n.email})}(e.fromViewState,a),a}var rt=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(De.a)(e.smimeViewState)?[2,null]:[4,L.h.import()];case 1:return(null==(t=r.sent()(e.attachmentWell,e.content,e.bodyType,!0))?void 0:t.length)?[4,Be.i.import()]:[3,3];case 2:return n=r.sent()(t),[3,4];case 3:n=null,r.label=4;case 4:return[2,n]}}))}))};function it(e){var t=e.content,n=0,a=Object(De.a)(e.smimeViewState);if(e.useSmartResponse&&(t+=Object(N.a)(e.bodyType)),"HTML"==e.bodyType){var o=dt(e);n=l(t=b(t,a)),t=Object(W.c)(et,o,t)}var c=Object(Ce.a)({BodyType:e.bodyType,Value:t});c.DataUriCount=n;var u,d=Object(i.a)(e.itemId),m=Object(i.a)(e.referenceItemId),p=[],f=[],h=[];if(e.smimeViewState&&0!=e.smimeViewState.smimeBccForkingMode)switch(e.smimeViewState.smimeBccForkingMode){case 1:p=Object(s.a)(e.toRecipientWell),f=Object(s.a)(e.ccRecipientWell);break;case 2:if(e.bccRecipientWell){var E=e.smimeViewState.currentBccRecipientIndex;h=[Object(s.a)(e.bccRecipientWell)[E]]}break;case 3:e.bccRecipientWell&&(h=Object(s.a)(e.bccRecipientWell))}else p=Object(s.a)(e.toRecipientWell),f=Object(s.a)(e.ccRecipientWell),h=Object(s.a)(e.bccRecipientWell);var M={Subject:e.subject||"",Importance:e.importance,IsReadReceiptRequested:e.isReadReceiptRequested,IsDeliveryReceiptRequested:e.isDeliveryReceiptRequested,ToRecipients:p,CcRecipients:f,BccRecipients:h,Sensitivity:e.sensitivity};return e.useSmartResponse?u=(2==e.operation?_e.a:we.a)(Object(r.__assign)(Object(r.__assign)({},M),{UpdateResponseItemId:d,ReferenceItemId:m,ReferenceItemDocumentId:e.referenceItemDocumentId||0,NewBodyContent:c})):5==e.operation||6==e.operation?u=(5==e.operation?Pe:xe)(Object(r.__assign)(Object(r.__assign)({},M),{ReferenceItemId:m,ItemId:d,Body:c})):(u=Object(Te.a)(Object(r.__assign)(Object(r.__assign)({},M),{Body:c})),e.itemId&&(u.ItemId=e.itemId)),e.fromViewState&&function(e,t){var n=e.from;if(n){var r=!1,i=Object(v.a)().SessionSettings.ConnectedAccountInfos;if(i)for(var a=0;a<i.length;a++){var o=i[a];if(o.EmailAddress==n.email.EmailAddress){r=!0;var s=Object(O.a)({Value:o.SubscriptionGuid,ExtendedFieldURI:Object(y.a)({PropertyId:I,DistinguishedPropertySetId:"Sharing",PropertyType:"CLSID"})});t.ExtendedProperty?t.ExtendedProperty.push(s):t.ExtendedProperty=[s],t.From=Object(g.a)({Mailbox:{MailboxType:n.email.MailboxType,RoutingType:"SMTP",EmailAddress:n.email.EmailAddress,Name:o.DisplayName}});break}}r||(t.From=Object(g.a)({Mailbox:n.email}))}}(e.fromViewState,u),e.deferredSendTime&&function(e,t){if(e){var n=Object(O.a)({Value:Object(S.ub)(e),ExtendedFieldURI:Object(y.a)({PropertyTag:j,PropertyType:"SystemTime"})});t.ExtendedProperty?t.ExtendedProperty.push(n):t.ExtendedProperty=[n]}}(e.deferredSendTime,u),u}function at(e,t){var n,i;return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l,m,p,f,b,g,I,S,j,h,T,_;return Object(r.__generator)(this,(function(w){switch(w.label){case 0:return m=Object(v.a)().UserOptions.TimeFormat,Object(X.a)(e)?(p=e,d=nt(e),[4,Object(ee.a)(d,e.bodyType,t,m,e.isInlineCompose,Re(e.protectionViewState),p.publicFolderId)]):[3,2];case 1:return l=w.sent(),[3,14];case 2:return d=it(e),f=d,[4,rt(e)];case 3:return f.Attachments=w.sent(),M(e.addin,d),E(e.addin,d,t),R(e.addin,d,t),b=e.protectionViewState,Object(F.i)("cmp-clp")&&!Object(P.a)(e)&&function(e,t){var n=e.selectedCLPLabel,r=e.nonTenantLabelString,i=K(e);if(i&&$(G.b,i,t),n||r){var a=Q(e);$(G.c,a,t),Object(z.c)(n)}}(b.clpViewState,d),(null==b?void 0:b.classificationViewState)&&function(e,t){var n=e.messageClassification;if(n){t.ExtendedProperty||(t.ExtendedProperty=[]),Object.keys(n).forEach((function(e){var r=Y.b[e];r&&t.ExtendedProperty.push(Object(O.a)({ExtendedFieldURI:Object(y.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:n[e]}))}));var r=Y.b.IsClassified;t.ExtendedProperty.push(Object(O.a)({ExtendedFieldURI:Object(y.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:"true"}))}}(b.classificationViewState,d),Object(a.a)()&&function(e,t){var n,r,i=null===(r=null===(n=null==e?void 0:e.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(i&&!Object(Fe.a)(i)){var a=Object(O.a)({ExtendedFieldURI:Object(y.a)({PropertyName:Ve,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:i});t.ExtendedProperty?t.ExtendedProperty.push(a):t.ExtendedProperty=[a]}}(e.fromViewState,d),(null===(n=e.mentionsPicker)||void 0===n?void 0:n.atMentionTuples)&&Object.keys(e.mentionsPicker.atMentionTuples).length>0?[4,Le.b.import()]:[3,5];case 4:return I=w.sent(),[3,6];case 5:I=null,w.label=6;case 6:if(null==(g=I)||g(e.mentionsPicker,t,d),!Object(De.a)(e.smimeViewState))return[3,11];w.label=7;case 7:return w.trys.push([7,9,,10]),S=function(e,t,n){var i,a=e.smimeViewState||Object(c.a)(),d=e.attachmentWell,l=d.docViewAttachments,m=d.inlineAttachments,p=Object(u.a)(a);return(i=l.slice(0)).push.apply(i,Object(r.__spread)(m)),{smimeViewState:a,message:t,fromAddress:Object(o.a)(),isSend:n,composeId:e.composeId,toRecipients:p?Object(s.a)(e.toRecipientWell):[],ccRecipients:p?Object(s.a)(e.ccRecipientWell):[],attachments:i}}(e,d,t),[4,Be.p.import().then((function(e){return e(S)}))];case 8:return w.sent(),[3,10];case 9:return j=w.sent(),(_=new Error).message=j.message==Ae.a?Ae.a:"SmimeEncodeError: "+j.message,[2,Promise.reject(_)];case 10:return[3,12];case 11:e.itemId&&(h=Object(Se.b)().items.get(e.itemId.Id))&&Object(Ne.b)(h.ItemClass)&&(d.ItemClass=tt),w.label=12;case 12:return t&&function(e){var t=[];if(e.isReportedFalsePositive){var n={ExtendedFieldURI:{PropertyName:Ee,PropertyType:"String",DistinguishedPropertySetId:je},Value:""};t.push(n)}if(e.isOverridden){n={ExtendedFieldURI:{PropertyName:he,PropertyType:"String",DistinguishedPropertySetId:je},Value:e.overrideJustification};t.push(n)}return t}(e.policyTipsViewState).map((function(e){return function(e,t){null==e.ExtendedProperty?e.ExtendedProperty=[t]:e.ExtendedProperty.push(t)}(d,e)})),[4,ot(e,d,m,t)];case 13:l=w.sent(),w.label=14;case 14:return x(e.addin),(T=(null===(i=null==l?void 0:l.ResponseMessages)||void 0===i?void 0:i.Items)?l.ResponseMessages.Items[0]:l&&!l.ResponseMessages?l:null)&&"Success"==T.ResponseClass?[2,Promise.resolve(T)]:(Object(C.d)(l,e),_=void 0,T?(_=new Error(T.ResponseCode)).messageText=T.MessageText:_=new Error("Unrecognized response"),[2,Promise.reject(_)])}}))}))}function ot(e,t,n,i){var a,o,s,c,u,d,l;if(Object(P.a)(e)){if(i&&3!=e.operation){if(Object(ke.a)()||e.itemId||t.RightsManagementLicenseData||(null===(a=e.protectionViewState)||void 0===a?void 0:a.IRMData))return function(e,t,n,r,i,a){var o=ue(e,t,0,r,i,a),s={headers:Object(ne.e)(null,"GroupMailbox")};return oe({Header:Object(se.b)(),Body:o},s).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}(e.groupId,t,e.bodyType,n,Re(e.protectionViewState),e.isInlineCompose);var m=Object(B.m)(e.groupId);return s=e.groupId,c=t,e.bodyType,u=Object(Ye.a)(m),d=e.isInlineCompose,l=le(s,c,0,0,d),de({Header:Object(se.b)(),Body:l},u).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}var p=1==e.operation||2==e.operation;if(!e.itemId&&p||e.useSmartResponse)return Object(te.a)(e.groupId,t,e.bodyType,!1,n,e.isInlineCompose)}var f=Object(Z.c)(),b=!(!f||f.treeType!==V.k&&f.treeType!==V.c);if(i){var v=Object(U.a)(null===(o=e.attachmentWell)||void 0===o?void 0:o.sharingLinkIds);v&&v.length>0&&(t.DocLinks=v)}return e.useSmartResponse||!e.itemId?Object(F.i)("mon-cmp-experimentalGraphQLCompose")&&!i&&function(e){switch(e){case 0:case 1:case 2:case 3:case 4:return!0;case 5:case 6:return!1}}(e.operation)?function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,o;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return[4,Object(We.a)()];case 1:return i=s.sent(),a=He(e,n),[4,i.mutate({variables:{draft:a,timeFormat:t},mutation:Ue})];case 2:return o=s.sent(),[2,{ResponseMessages:{Items:[{Items:[Object(r.__assign)({},o.data.createDraft.draft)],ResponseClass:"Success"}]}}]}}))}))}(t,n,e):Object(ee.a)(t,e.bodyType,i,n,e.isInlineCompose,Re(e.protectionViewState),null,b):Object(F.i)("mon-cmp-experimentalGraphQLCompose")?function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,o,s,c;return Object(r.__generator)(this,(function(u){switch(u.label){case 0:return[4,Object(We.a)()];case 1:return i=u.sent(),a=He(e,n),[4,i.mutate({variables:{draft:a,itemId:e.ItemId},mutation:t?Ze:Xe})];case 2:return o=u.sent(),s=o.data,c=t?s.sendDraft:s.saveDraft,[2,{ResponseMessages:{Items:[{Items:c.draft?[Object(r.__assign)({},c.draft)]:null,ResponseClass:"Success"}]}}]}}))}))}(t,i,e):ye(t,i,Re(e.protectionViewState),e.addin.keysOfInternetHeadersToBeRemoved)}function st(e){return at(e,!0)}function ct(e){return at(e,!1)}function ut(e,t){if(Object(Ie.a)(e)){var n=function(e){var t;if(null==e?void 0:e.Items)return e.Items[0];if(null===(t=e)||void 0===t?void 0:t.Item)return e.Item;return null}(e);return n&&(Object(De.a)(t.smimeViewState)||L.h.import().then((function(e){var r=e(t.attachmentWell,t.content,t.bodyType,!0);r.length&&Be.r.import().then((function(e){return e(r,n.Attachments,Object(_.a)({Id:t.composeId}))}))})),n.ItemId&&(A(t,n.ItemId.Id,n.ItemId.ChangeKey,n.LastModifiedTime),n.Body&&Object(P.a)(t)&&(t.lastSavedMessageBody=n.Body.Value)),n.InternetMessageId&&Object(D.a)(t.conversationId,t.itemId?t.itemId.Id:null,n.InternetMessageId)),!0}return!1}function dt(e){return e.textDirection||(Object(v.a)().SessionSettings.IsUserCultureRightToLeft?"rtl":"ltr")}},5936:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(4651),a=n(4404);function o(e,t){return function(e,t){for(var n=0;n<t.length;n++)if(s(t[n],e))return t[n];return null}((e||[]).concat(t||[]),Object(i.a)(!0))}function s(e,t){var n,i;if(t&&t.length>0)try{for(var o=Object(r.__values)(t),s=o.next();!s.done;s=o.next()){var c=s.value;if(c&&Object(a.a)(e,c.EmailAddress))return!0}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return!1}},5938:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return v}));var r=n(0),i=n(6456),a=n(6),o=n(1882),s=n(2332),c=n(5510),u=n(2645),d="",l="";function m(e,t){var n;if(e){e.WasclUpgradeToPremiumUrl&&(d=e.WasclUpgradeToPremiumUrl),e.AccountRecoveryFlowUrl&&(l=e.AccountRecoveryFlowUrl);var r=(null===(n=e.ResponseMessages)||void 0===n?void 0:n.Items)?e.ResponseMessages.Items[0]:null;!r||"ErrorExceededMessageLimit"!=r.ResponseCode&&"ErrorExceededHourlyMessageLimit"!=r.ResponseCode&&"ErrorExceededMessageLimitShowTierUpgrade"!=r.ResponseCode||Object(s.b)(t,!0)}}function p(e){return{text:Object(a.b)(i.a),action:function(){Object(o.a)(e,["errorMessageExceededMessageLimit","errorMessageExceededMaxRecipientLimit"]),window.open(d)}}}var f=null;function b(e,t){return{text:Object(a.b)(i.b),action:function(){var n;null===f&&(n=Object(r.__read)(Object(u.a)(c.a,t),1),(f=n[0]).then((function(t){var n=t.success;f=null,n&&function(e){Object(o.a)(e,["errorMessageMessageSubmissionBlocked","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimitShowTierUpgrade"])}(e)}),(function(e){f=null})))}}}function v(e){return{text:Object(a.b)(i.b),action:function(){Object(o.a)(e,["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade"]),window.open(l)}}}},5939:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ReplyAllToItem:#Exchange"},e)}},5940:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ReplyToItem:#Exchange"},e)}},6180:function(e,t,n){"use strict";var r=n(0),i=n(3913);var a=n(799),o=n(794),s=n(30);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"CreateResponseFromModernGroupJsonRequest:#Exchange"},n)),Object(s.a)("CreateResponseFromModernGroup",e,t)}var u=n(168),d=n(2344);function l(e,t,n,s,c,u){var l,m=(l=Object(r.__assign)({ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:s?"SendAndSaveCopy":"SaveOnly",Items:[t],TimeFormat:c,ItemShape:Object(a.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(o.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(d.a)()),Object(r.__assign)({__type:"CreateResponseFromModernGroupRequest:#Exchange"},l));return s?u&&(m.ItemShape.ReturnOnlyInternetMessageId=!0):(m.ItemShape=Object(i.a)(n),m.ShapeName="MailCompose"),m.GroupSmtpAddress=e,m}function m(e,t,n,r,i,a){var o=l(e,t,n,r,i,a);return c({Header:Object(u.b)(),Body:o}).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}n.d(t,"a",(function(){return m}))},6456:function(e){e.exports=JSON.parse('{"a":"Llb","b":"Mlb"}')},678:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ExtendedPropertyType:#Exchange"},e)}},897:function(e,t,n){"use strict";n.d(t,"e",(function(){return"{id}"})),n.d(t,"f",(function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"})),n.d(t,"a",(function(){return"data-custom"})),n.d(t,"c",(function(){return"originalsrc"})),n.d(t,"b",(function(){return"data-loadstatus"})),n.d(t,"d",(function(){return"pending"}))},910:function(e,t,n){"use strict";var r;!function(e){e.None="None",e.OwaProxy="OwaProxy",e.ConnectorsProxy="ConnectorsProxy",e.Compose="Compose",e.OwaAndConnectorsProxy="OwaAndConnectorsProxy",e.OwaConnectorsProxyAndCompose="OwaConnectorsProxyAndCompose"}(r||(r={})),t.a=r},919:function(e,t,n){"use strict";var r=n(507),i=n(1032),a=n(576),o=Object(i.a)((function(e,t,n,i){Object(r.a)(t,Object(a.a)(t),e,i)}));t.a=o},996:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return m}));var r="A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴऀ-५ॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９",i=new RegExp("^(["+r+"!#$%&'*+/=?^_`{|}~-](?:["+r+".!#$%&'*+/=?^_`{|}~-]*["+r+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),a=new RegExp('^("['+r+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),o=new RegExp("^["+r+"-]+(?:\\.["+r+"-]+)*$"),s=/[^\\]"/,c=/^[A-Za-z0-9_-]+:.*$/,u=function(e){var t=e.match(i);if(t)return-1!==t[0].indexOf("..")?null:t[0];var n=e.match(a);if(n){var r=s.exec(n[0]);return r&&r.index!==n[0].length-2?null:n[0]}return null};function d(e){if(!e)return!1;var t=u(e);return!!t&&!!e.substring(t.length+1).match(o)}function l(e){return c.test(e)}function m(e){return d(e)||l(e)}},998:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(883),i=n(71);function a(){var e=!0;if(Object(i.s)()){var t=Object(r.e)(r.b.ExternalImages);e=null===t.externalImagesSelectedOption||0===t.externalImagesSelectedOption}else{var n=Object(i.h)().PolicySettings;e=void 0===n.ExternalImageProxyEnabled||n.ExternalImageProxyEnabled}return e}}}]);
//# sourceMappingURL=owa.MailBoot~Addins~Editor.js.map
self.scriptsLoaded['owa.MailBoot~Addins~Editor.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Addins~Editor.js'] = (new Date()).getTime();