self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~9a34f7e7.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[34],{2099:function(e,t,r){"use strict";var n=r(2781),o=r(4385);function i(e){var t;try{t=btoa(e)}catch(r){t=btoa(unescape(encodeURIComponent(e)))}finally{return"u!"+t.replace(/=+$/,"").replace("/","_").replace("+","-")}}r.d(t,"d",(function(){return n.d})),r.d(t,"a",(function(){return n.a})),r.d(t,"b",(function(){return n.b})),r.d(t,"e",(function(){return n.e})),r.d(t,"c",(function(){return n.c})),r.d(t,"f",(function(){return o.a})),r.d(t,"g",(function(){return i}))},2496:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},2781:function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"e",(function(){return a})),r.d(t,"c",(function(){return s}));var n="POST",o="cors",i="GET",a="PUT",s="PATCH"},2819:function(e,t,r){"use strict";var n=r(0),o="https://www.googleapis.com/drive/v3/files",i=r(3122);function a(e,t,r){return void 0===r&&(r={forceTokenRefresh:!1,requestInit:{}}),Object(n.__awaiter)(this,void 0,void 0,(function(){var o,a,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return o=r.forceTokenRefresh,a=r.requestInit||{},[4,Object(i.d)(t,o,e)];case 1:return s=n.sent(),a.headers||(a.headers=new Headers),a.headers.set("Authorization",s),[4,fetch(e,a)];case 2:return[2,n.sent()]}}))}))}function s(e,t){return void 0===t&&(t=!1),Object(n.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,a(o+"?"+e,5,{forceTokenRefresh:t})];case 1:return(r=n.sent()).ok?[4,r.text()]:[3,3];case 2:return i=n.sent(),[2,{errorResponse:null,result:JSON.parse(i)}];case 3:return[2,{errorResponse:r,result:null}]}}))}))}function u(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,a(o+"/"+e+"?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension",5)];case 1:return(t=n.sent()).ok?[4,t.text()]:[3,3];case 2:return r=n.sent(),[2,{errorResponse:null,result:JSON.parse(r)}];case 3:return[2,{errorResponse:t,result:null}]}}))}))}var c=r(111),l=r(2099),d=r(276),f=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package",shared:"shared"});function h(){return Object.keys(f).map((function(e){return f[e]})).join(",")}var b,p="_api/v2.0",v="/v1.0",O="root";function m(e){switch(e){case 1:return v;case 0:return p;default:return Object(c.a)(e)}}function _(e){return m(e)+"/drive"}function w(e){return m(e)+"/shares"}function j(e){return _(e)+"/items"}function g(e,t,r,o,i,a,s){return void 0===a&&(a=b.None),Object(n.__awaiter)(this,void 0,void 0,(function(){var u,p,v,m,_,w,g,y,k;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return i=i||O,u=function(e){switch(e){case 0:return f.name;case 1:return f.size;default:return f.lastModifiedDateTime}}(r),p=function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(c.a)(e)}}(o),v=function(e,t,r){switch(e){case 0:return"folder,"+t+" "+r;case 1:return t+" "+r;default:return Object(c.a)(e)}}(t,u,p),m="expand=thumbnails(select=medium)&orderby="+v+"&select="+h(),a!==b.None&&(m=m+"&filter="+function(e){switch(e){case b.None:return"";case b.Folder:return"("+f.folder+" ne null)";default:return Object(c.a)(e)}}(a)),s&&(m=m+"&$top="+s.maxEntries,s.skipToken&&(m=m+"&$skiptoken="+s.skipToken)),_=e+"/"+j(t)+"/"+i+"/children?"+m,w={Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"},[4,Object(l.f)(t,encodeURI(_),_,{method:l.b,mode:l.a,datapointNamePrefix:"getOneDriveItems"},w)];case 1:return g=n.sent(),y=JSON.parse(g),k=y["@odata.nextLink"]?function(e){var t=Object(d.parse)(e,!0);return t.query?t.query.$skiptoken:null}(decodeURI(y["@odata.nextLink"])):null,[2,{errorResponse:null,result:{items:y.value,skipToken:k}}]}}))}))}function y(e,t,r,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,a,s,u,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:o=o||O,i="expand=thumbnails(select=medium)&select="+h(),a=t+"/"+j(e)+"/"+o+"/children?"+i,s={name:r,folder:{}},(u=new Headers).append("Content-Type","application/json"),u.append("Accept","application/json"),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Object(l.f)(e,encodeURI(a),a,{method:l.d,mode:l.a,body:JSON.stringify(s),datapointNamePrefix:"createNewFolder"},null)];case 2:return c=n.sent(),[2,{errorResponse:null,result:JSON.parse(c)}];case 3:return[2,{errorResponse:n.sent(),result:null}];case 4:return[2]}}))}))}!function(e){e[e.None=0]="None",e[e.Folder=1]="Folder"}(b||(b={}));var k=r(7784),S=r(4385),T=r(236);var R=Object.freeze({folderInfo:{type:0,identifier:O},sliceSize:10485760,conflictBehavior:"rename",onProgress:function(){}});function P(e,t,r){var o=this,i=function(){return Promise.resolve({errorResponse:null,result:null})};return{uploadPromise:Object(n.__awaiter)(o,void 0,void 0,(function(){var o,a,s,u,d,f,h,b,p,v,O,m,w,g,y;return Object(n.__generator)(this,(function(P){switch(P.label){case 0:switch(function(e){Object.keys(R).forEach((function(t){e[t]=e[t]||R[t]}))}(r),o=r.fileToUpload,a=o.fileName,s=o.fileBlob,u=r.folderInfo,d=u.type,f=u.identifier,h=r.conflictBehavior,b=r.sliceSize,p=r.onProgress,d){case 0:v=t+"/"+j(e)+"/"+f+":/"+encodeURI(a)+":/createUploadSession";break;case 1:v=t+"/"+_(e)+"/"+f+":/"+encodeURI(a)+":/createUploadSession";break;default:Object(c.a)(d)}return O={item:{"@name.conflictBehavior":h}},[4,Object(S.a)(e,v,v,{method:l.d,mode:l.a,body:JSON.stringify(O),datapointNamePrefix:"createUploadSession"},null)];case 1:return m=P.sent(),w=function(e,t,r,o){var i=this,a=e.uploadUrl,s=t.size,u=null,l=null,d=function(e,t,r,o,i,a){var s=this;return function(u,c){return Object(n.__awaiter)(s,void 0,void 0,(function(){var s,l,d,f,h;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return s=function(e,t,r){var n=x(e,t,r),o=n.rangeStart,i=n.rangeEnd;return new Headers({"Content-Range":"bytes "+o+"-"+i+"/"+r,Accept:"application/json"})}(c,t,r),l=function(e){var n=x(e,t,r).rangeStart;return function(e){var t=e.loaded;o({loaded:n+t,total:r})}}(c),[4,(b=e,p=l,v={method:"PUT",body:u,headers:s},void 0===v&&(v={method:"POST"}),new Promise((function(e,t){var r=v.method,n=v.body,o=v.headers,i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&e({status:i.status,text:function(){return Promise.resolve(i.responseText)}})},i.ontimeout=function(){t(new Error("Request timed out"))},i.onerror=function(){t(new Error("Request failed"))},i.onabort=function(){t(new Error("Request aborted"))},p&&(i.upload.onprogress=p),i.open(r,b,!0),new Headers(o).forEach((function(e,t){i.setRequestHeader(t,e)})),n?i.send(n):i.send()})))];case 1:return 201!==(d=n.sent()).status&&200!==d.status?[3,3]:[4,d.text()];case 2:f=n.sent(),h=JSON.parse(f),i(h),n.label=3;case 3:if(!Object(T.a)(d.status))throw a(d),new Error("Unable to upload file");return[2]}var b,p,v}))}))}}(a,r,s,o,(function(e){u=e}),(function(e){l=e})),f=Object(k.a)(t,d,{sliceSize:r,numberOfSlicesToParallelize:1}),h=f.onCompletePromise,b=f.cancel,p=Object(n.__awaiter)(i,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:e=null,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,h];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[2,{errorResponse:l,result:null}];case 4:switch(e){case 0:return u?[2,{errorResponse:null,result:u}]:[2,{errorResponse:l,result:null}];case 1:throw new Error("Upload was cancelled");default:return[2,Object(c.a)(e)]}return[2]}}))}));return{uploadPromise:p,cancel:function(){return Object(n.__awaiter)(i,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:b(),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,p];case 2:return e.sent(),[3,4];case 3:return[2,N(a)];case 4:return[2]}}))}))}}}(JSON.parse(m),s,b,p),g=w.uploadPromise,y=w.cancel,i=y,[2,g]}}))})),cancel:function(){return i()}}}function x(e,t,r){var n=e*t;return{rangeStart:n,rangeEnd:Math.min(n+t,r)-1}}function N(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,fetch(e,{method:"DELETE"})];case 1:return t=r.sent(),Object(T.a)(t.status)?[2,{errorResponse:null,result:null}]:[2,{errorResponse:t,result:null}]}}))}))}var D="https://api.dropboxapi.com/2/files";function E(e,t){switch(e){case 0:return t;case 1:return null;default:Object(c.a)(e)}return null}function A(e,t,r){return void 0===r&&(r=!1),Object(n.__awaiter)(this,void 0,void 0,(function(){var o,i,a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:switch(t){case 1:o="https://api.onedrive.com/v2.1/drive/recent?top=50";break;case 0:o=e+"/_api/v2.1/drive/recent?top=50";break;default:throw Error("OneDriveMRUItems only supports OneDrive providers!")}n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Object(l.f)(t,o,o,{method:l.b,mode:l.a,datapointNamePrefix:"getOneDriveMRUItems"},null,r)];case 2:return a=n.sent(),i=JSON.parse(a),[3,4];case 3:return n.sent(),[3,4];case 4:return i?[2,{errorResponse:null,result:i}]:[2,{errorResponse:null,result:null}]}}))}))}function z(e){return"file"===e[".tag"]}function I(e){return"folder"===e[".tag"]}function C(e){return"deleted"===e[".tag"]}function U(e){return"folder"===e.type}function F(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,o,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return e.path=e.path||"",t=D+"/list_folder",r={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},[4,a(t,2,{requestInit:r})];case 1:return(o=n.sent()).ok?[4,o.text()]:[3,3];case 2:return i=n.sent(),[2,{errorResponse:null,result:JSON.parse(i).entries}];case 3:return[2,{errorResponse:o,result:null}]}}))}))}var J,M="https://api.box.com/2.0",B=2e3;function q(e,t){return void 0===t&&(t=B),Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,a(M+"/folders/"+(e=e||"0")+"/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit="+t+"&offset=0",3)];case 1:return(r=n.sent()).ok?[4,r.text()]:[3,3];case 2:return o=n.sent(),[2,{errorResponse:null,result:JSON.parse(o).entries}];case 3:return[2,{errorResponse:r,result:null}]}}))}))}!function(e){e.Uploaded="uploaded",e.Tagged="tagged"}(J||(J={}));var H=J,L="https://graph.facebook.com/v2.7",V=200;function W(e,t){return void 0===t&&(t=V),Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,a(L+"/me/photos/?fields=id,name,images,from,link,album,place,created_time&type="+e.toString()+"&limit="+t,6)];case 1:return(r=n.sent()).ok?[4,r.text()]:[3,3];case 2:return o=n.sent(),[2,{errorResponse:null,result:JSON.parse(o).data}];case 3:return[2,{errorResponse:r,result:null}]}}))}))}var G=r(1060),$=r(1066),X=r(563),Q=r(966),K=r(1766),Y=r(799),Z=r(168),ee=r(20);function te(e,t){var r=function(e,t){return Object($.a)({ParentFolderIds:[Object(X.a)({Id:e})],ItemShape:Object(Y.a)({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null})}(e,t);return Object(G.a)({Header:Object(Z.b)(),Body:r})}function re(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r=Object(K.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),[4,te(e=e||Object(Q.a)("inbox"),r)];case 1:return o=n.sent(),(i=o.Body.ResponseMessages.Items[0])&&"Success"===i.ResponseClass&&i.RootFolder.Items?[2,{errorResponse:null,result:i.RootFolder.Items}]:(ee.g.warn("Find Item Response of get mail messages failed with "+i),[2,{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},result:null}])}}))}))}r.d(t,"m",(function(){return s})),r.d(t,"l",(function(){return u})),r.d(t,"o",(function(){return g})),r.d(t,"f",(function(){return b})),r.d(t,"g",(function(){return y})),r.d(t,"w",(function(){return P})),r.d(t,"i",(function(){return _})),r.d(t,"r",(function(){return w})),r.d(t,"e",(function(){return"https://api.onedrive.com"})),r.d(t,"b",(function(){return"https://api.dropboxapi.com/2/sharing"})),r.d(t,"d",(function(){return o})),r.d(t,"q",(function(){return E})),r.d(t,"p",(function(){return A})),r.d(t,"u",(function(){return z})),r.d(t,"v",(function(){return I})),r.d(t,"t",(function(){return C})),r.d(t,"j",(function(){return F})),r.d(t,"s",(function(){return U})),r.d(t,"h",(function(){return q})),r.d(t,"a",(function(){return M})),r.d(t,"c",(function(){return H})),r.d(t,"k",(function(){return W})),r.d(t,"n",(function(){return re}))},2869:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(30),o=r(2496);function i(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(n.a)("FetchDataProviderResource",e,t)}},3122:function(e,t,r){"use strict";var n=r(0),o=r(4605),i=r.n(o),a=r(6),s=r(222),u=r(391),c=r(276),l=r(30);function d(e){return Object(n.__assign)({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}function f(e,t){return void 0===e||e.__type||(e=d(e)),Object(l.a)("GetAccessTokenforDataProvider",e,t)}function h(e,t,r,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,a,s,u;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return i=d({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1,ClaimsChallenge:o?atob(o):null}),a=r?"getAccessTokenForDataProvider_"+r:"getAccessTokenForDataProvider",(s=new Headers).append("X-OWA-ActionName",a),[4,f(i,{headers:s,datapoint:{customData:{actionSource:r},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0})];case 1:return[4,(u=n.sent()).json()];case 2:return[2,{token:n.sent(),response:u}]}}))}))}var b="onedrive_implicit.access",p="Bearer ",v=r(18),O=function(e,t,r){return Object(n.__assign)({resultCode:t,isAdalException:r,_typeSpec:"TokenRetrievalError"},e)},m=function(e){return"TokenRetrievalError"===e._typeSpec},_=[],w={},j=1,g=30,y="",k="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function S(e){w[e]=null}function T(e,t,r,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,h(e,t,r,o)];case 1:return i=n.sent(),function(e,t,r){_=_.filter((function(e){return e!==t}));var n=r.token;if(0!==n.TokenResultCode||!n.AccessToken||""===n.AccessToken){var o="Access token request failed for token key "+e+" with response code "+n.TokenResultCode,i=r.response.headers.get("x-tokenresult"),a=null!=i&&i.indexOf(k)>0;throw O(new Error(o),n.TokenResultCode,a)}var s=w[e]||{};s[t]=n,w[e]=s}(e,t,i),[2,i.token]}}))}))}function R(e,t,r,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,s;return Object(n.__generator)(this,(function(n){return i=y,0===e&&r&&(s=Object(c.parse)(r),i=Object(a.c)("{0}//{1}/",s.protocol,s.hostname)),Object(v.i)("doc-attachment-testAuthFallback")?[2,""]:[2,x(e,i,t,null,o)]}))}))}function P(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(n){return[2,x(0,e,t,r)]}))}))}function x(e,t,r,o,a){return Object(n.__awaiter)(this,void 0,void 0,(function(){var s,u;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r||!function(e,t){var r=w[e];if(!r)return!1;var n=r[t];if(!n||!n.AccessTokenExpiry)return!1;var o=new Date(n.AccessTokenExpiry),a=i()(new Date(Date.now()),j);return null!=o&&a<o}(e,t)?[3,1]:(s=w[e],u=s[t],i()(new Date(Date.now()),g)>new Date(u.AccessTokenExpiry)&&-1===_.indexOf(t)&&(_.push(t),T(e,t,o)),[2,u.AccessToken]);case 1:return[4,T(e,t,o,a)];case 2:return[2,(u=n.sent()).AccessToken]}}))}))}function N(e,t,r,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return Object(s.a)()&&1===e?[4,Object(u.getDelegationTokenForOwa)(b)]:[3,2];case 1:return i=n.sent(),[3,4];case 2:return[4,R(e,t,r,o)];case 3:i=n.sent(),n.label=4;case 4:return[2,p+i]}}))}))}r.d(t,"d",(function(){return N})),r.d(t,"c",(function(){return R})),r.d(t,"e",(function(){return P})),r.d(t,"b",(function(){return S})),r.d(t,"f",(function(){return m})),r.d(t,"a",(function(){return p}))},4134:function(e,t,r){var n=r(1923);e.exports=function(e,t){var r=n(e).getTime(),o=Number(t);return new Date(r+o)}},4385:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(0),o=r(127),i=r(3122),a=r(236),s=r(2496),u=r(2869),c=r(18),l=r(20),d=r(5315),f=r(2781);function h(e,t,r,a,s,u){return void 0===u&&(u=!1),Object(n.__awaiter)(this,void 0,void 0,(function(){var d;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(i.d)(e,!1,r)];case 1:return d=n.sent(),[3,3];case 2:return n.sent(),[3,3];case 3:if(Object(c.i)("doc-authContext")&&0===e&&(s?s["x-ms-cc"]="t":s={"x-ms-cc":"t"}),d&&d.split(i.a)[1])return Object(o.r)("fetchServiceViaDataProvider",[e]),l.g.info("fetchServiceViaDataProvider"),[2,b(e,t,r,d,a,u,s)];if(Object(o.r)("fetchServiceFailedToGetToken",[e]),0===e)return Object(o.r)("fetchServiceViaOWAServer"),l.g.info("fetchServiceViaOWAServer"),[2,p(e,t,a,s)];throw new Error("Fetch service has failed to retrieve client token.")}}))}))}function b(e,t,r,s,u,l,f){return Object(n.__awaiter)(this,void 0,void 0,(function(){var h,p,v,O,m,_,w,j,g;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return h=u.datapointNamePrefix+"DataProvider",(p=new o.b(h)).addCustomData({dataProviderType:e}),v={Authorization:s,"Content-Type":"application/json",Accept:"application/json"},f&&Object.keys(f).forEach((function(e){v[e]=f[e]})),[4,fetch(t,{method:u.method,mode:u.mode,headers:v,body:u.body})];case 1:return O=n.sent(),Object(a.a)(O.status)?(p.end(),[4,O.json()]):[3,3];case 2:return m=n.sent(),[2,JSON.stringify(m)];case 3:if(_=new Error(h+" : Response status = "+O.status+", body = "+O.body),p.endWithError("ServerError",_),w={datapointName:h,responseStatus:O.status,responseBody:O.body,headers:O.headers,claims:null},!Object(c.i)("doc-authContext")||0!==e||l)return[3,12];if(!(j=O.headers.get("www-authenticate")))return[3,12];g=void 0,n.label=4;case 4:return n.trys.push([4,7,,8]),[4,d.a.import()];case 5:return[4,n.sent()(j)];case 6:return g=n.sent(),[3,8];case 7:throw n.sent(),JSON.stringify(w);case 8:return n.trys.push([8,10,,11]),[4,Object(i.d)(e,!0,r,g)];case 9:return s=n.sent(),[3,11];case 10:return n.sent(),[3,11];case 11:return[2,b(e,t,r,s,u,!0,f)];case 12:throw JSON.stringify(w)}}))}))}function p(e,t,r,i){return Object(n.__awaiter)(this,void 0,void 0,(function(){var c,l,d,h,b,p;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return c=r.datapointNamePrefix+"OWA",l=new o.b(c),d=Object(s.a)({ProviderType:e,Url:t,Method:r.method,Body:r.body?r.body:JSON.stringify({}),Headers:JSON.stringify(i),IsJsonPost:r.method===f.d}),[4,Object(u.a)(d)];case 1:if(h=n.sent(),Object(a.a)(h.Status))return l.end(),[2,h.Body];throw b=new Error(c+" : Response status = "+h.Status+", ServerTraceLog = "+h.ServerTraceLog),l.endWithError("ServerError",b),p={datapointName:c,responseStatus:h.Status,responseServerTraceLog:h.ServerTraceLog},JSON.stringify(p)}}))}))}},4605:function(e,t,r){var n=r(4134),o=6e4;e.exports=function(e,t){var r=Number(t);return n(e,r*o)}},5315:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(37),o=new n.c((function(){return r.e(328).then(r.bind(null,9432))})),i=(new n.b(o,(function(e){return e.launchRemediateAuthDialogAndRefresh})),new n.b(o,(function(e){return e.remediateAuth})))},7784:function(e,t,r){"use strict";function n(e,t,r,n,o,i){var a=!1;return{task:function(){return new Promise((function(s,u){for(var c=0,l=0,d=0,f=function(){var h,b,p,v,O;a&&s(1),c<r&&d<t.length&&((h=d,b=t[h],p=b.start,v=b.end,O=e.slice(p,v),n(O,i(h),o)).then((function(){return c-=1,(l+=1)===t.length&&s(0),void f()})).catch(u),d+=1,c+=1)},h=0;h<r;h++)f()}))},cancelTask:function(){return a=!0}}}var o=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function i(e,t,r){void 0===r&&(r=o),function(e){e.sliceSize=e.sliceSize||o.sliceSize,e.numberOfSlicesToParallelize=e.numberOfSlicesToParallelize||o.numberOfSlicesToParallelize}(r);var i=r.sliceSize,u=r.numberOfSlicesToParallelize,c=Math.ceil(e.size/i),l=function(e,t,r){for(var n=[],o=0,i=0;i<e;i++){var a=Math.min(o+t,r);n.push({start:o,end:a}),o=a}return n}(c,i,e.size),d=n(e,[l[0]],1,t,c,(function(){return 0})),f=l.length>2?n(e,l.slice(1,l.length-1),u,t,c,(function(e){return e+1})):s(),h=l.length>1?n(e,[l[l.length-1]],1,t,c,(function(){return l.length-1})):s();return{onCompletePromise:d.task().then(a(f.task)).then(a(h.task)),cancel:function(){d.cancelTask(),f.cancelTask(),h.cancelTask()}}}function a(e){return function(t){return 0===t?e():Promise.resolve(t)}}function s(){var e=!1;return{task:function(){return e?Promise.resolve(1):Promise.resolve(0)},cancelTask:function(){return e=!0}}}r.d(t,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~9a34f7e7.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~9a34f7e7.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~9a34f7e7.js'] = (new Date()).getTime();