self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[502],{15911:function(e){e.exports=JSON.parse('{"a":"hqb"}')},1662:function(e,t,n){"use strict";var r=n(0),a=n(1705),i=n(365),o=n(614),c=n(127),u=n(4),s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",b="X-OWA-ExplicitLogonUser";function f(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,f,p,v,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},f=Object(i.k)(e)){if(f.accountState==i.b.AccessRevoked)return[2,null];if(f.accountState==i.b.AccountDeprovisioned||f.accountState==i.b.AccountNotFound)return Object(i.c)(f.accountState,f.accountProviderType),[2,null]}return t?(n[s]=t,n[b]=t):f&&(n[s]=f.anchorMailbox),f?(p=f.token,!(v=Object(o.g)(f.tokenExpiry))&&p?[3,2]:(Object(c.r)("getAndUpdateAccessToken",{tokenExpiry:Object(u.y)(f.tokenExpiry,Object(u.Qb)()),isTokenExpired_1:v,isTokenInvalid_2:!p},{isCore:!0}),[4,a.a.importAndExecute(f.accountId,e,p)])):[3,3];case 1:(p=r.sent())||(p=""),r.label=2;case 2:m=void 0,"Outlook"==f.accountProviderType?(m='MSAuth1.0 usertoken="'+p+'", type="MSACT"',n[l]=1..toString()):"Google"!=f.accountProviderType&&"ICloud"!=f.accountProviderType||(m="Bearer "+p,n[l]=2..toString()),n[d]=m,r.label=3;case 3:return[2,n]}}))}))}var p=n(1663),v=n(20);function m(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(p.a)(),a=n,[4,h(e,t)];case 1:return a.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function h(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,[4,f(e.mailboxInfo.userIdentity,w(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(p.b)(a,i),[2,a]}}))}))}function w(e,t){var n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&v.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return w}))},1663:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function a(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},1665:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),a=Object(r.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},1684:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1839);function a(e){return Object(r.a)().attachments.get(e.Id)}},1705:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(37),a=n(1665);n.d(t,"b",(function(){return a.a}));var i=new r.c((function(){return n.e(1302).then(n.bind(null,1915))})),o=new r.a(i,(function(e){return e.getAndUpdateAccessToken}))},1764:function(e,t,n){"use strict";var r=n(9),a=n(2),i={viewStates:new r.ObservableMap,primaryComposeId:null,newMessageCreationInProgress:!1},o=Object(a.createStore)("compose",i),c=o();n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}))},1766:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},e)}},1803:function(e,t,n){"use strict";var r;function a(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1852:function(e,t){e.exports=function(e){return e instanceof Date}},1866:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"UnifiedGroupIdentity:#Exchange"},e)}},1888:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(0);function a(e){return Object(r.__assign)({},e)}function i(e){return Object(r.__assign)({},e)}function o(e){return Object(r.__assign)({},e)}function c(e){return Object(r.__assign)({},e)}function u(e){return Object(r.__assign)({},e)}},1923:function(e,t,n){var r=n(1852),a=36e5,i=6e4,o=2,c=/[T ]/,u=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,b=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],f=/^-(\d{2})$/,p=/^-?(\d{3})$/,v=/^-?(\d{2})-?(\d{2})$/,m=/^-?W(\d{2})$/,h=/^-?W(\d{2})-?(\d{1})$/,w=/^(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,j=/^(Z)$/,I=/^([+-])(\d{2})$/,y=/^([+-])(\d{2}):?(\d{2})$/;function x(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var P=function(e){var t,n={},r=e.split(c);u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var a=S.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),T=function(e,t){var n,r=d[t],a=b[t];if(n=l.exec(e)||a.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=s.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(P.date,n),_=T.year,A=function(e,t){if(null===t)return null;var n,r,a,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=f.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=p.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=v.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,a,c),r}if(n=m.exec(e))return i=parseInt(n[1],10)-1,x(t,i);if(n=h.exec(e)){i=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return x(t,i,u)}return null}(T.restDateString,_);if(A){var C,k=A.getTime(),E=0;return P.time&&(E=function(e){var t,n,r;if(t=w.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=g.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*i;if(t=O.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*a+r*i+1e3*o}return null}(P.time)),P.timezone?C=function(e){var t,n;if(t=j.exec(e))return 0;if(t=I.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=y.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(P.timezone):(C=new Date(k+E).getTimezoneOffset(),C=new Date(k+E+C*i).getTimezoneOffset()),new Date(k+E+C*i)}return new Date(e)}},1941:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1961:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),a=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1962:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1973:function(e,t,n){"use strict";var r=n(710),a=n(563),i=n(0);function o(e){return Object(i.__assign)({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function c(e){return Object(i.__assign)({__type:"SearchFolderScopeType:#Exchange"},e)}var u=n(1866),s=n(1668);var d=n(17),l=n(966),b=n(1888),f=n(1667),p=n(2178);n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return I})),n.d(t,"c",(function(){return y}));var v={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){var e,t,n=[];n.push(Object(b.b)({folderId:Object(l.a)(f.j),kind:"PrimaryMailbox"}));var r=Object(p.b)("UserMailbox");try{for(var a=Object(i.__values)(r),o=a.next();!o.done;o=a.next()){var c=o.value;n.push(Object(b.b)({folderId:c,kind:"PrimaryMailbox"}))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return n},getSearchScopeType:function(e){var t,n,o=Object(s.a)(e.folderId);return t="none"!=o?Object(r.a)({Id:o}):Object(a.a)({Id:e.folderId}),[(n={FolderScope:c({BaseFolderId:t}),IsDeepTraversal:!0},Object(i.__assign)({__type:"PrimaryMailboxSearchScopeType:#Exchange"},n))]}},m={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){var e,t=[],n=Object(d.a)();return(null===(e=null==n?void 0:n.SessionSettings)||void 0===e?void 0:e.IsExplicitLogon)||t.push(Object(b.a)({folderId:Object(l.a)(f.d),kind:"ArchiveMailbox"})),t.push(Object(b.a)({folderId:Object(l.a)(f.a),kind:"ArchiveMailbox"})),t},getSearchScopeType:function(e){var t,n,u=Object(s.a)(e.folderId);return t="none"!=u?Object(r.a)({Id:u}):Object(a.a)({Id:e.folderId}),"archivemsgfolderroot"==u?[(n={ArchiveTypes:16777215},Object(i.__assign)({__type:"LargeArchiveSearchScopeType:#Exchange"},n))]:[o({FolderScope:c({BaseFolderId:t})})]}},h={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},w={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(u.a)({Type:0,Value:e.groupId})},Object(i.__assign)({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},g={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},O={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},S=function(e){switch(e.kind){case"PrimaryMailbox":return v;case"ArchiveMailbox":return m;case"SharedFolders":return h;case"Group":return w;case"Calendar":return g;case"PublicFolder":return O;default:throw new Error("Unregistered search scope")}},j=function(e){return S(e).getKey(e)},I=function(e){return S(e).getSearchScopeList()},y=function(e){return S(e).getSearchScopeType(e)}},1997:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1876);function a(e){return o(e.type)}function i(e){return o(Object(r.a)(e))}function o(e){return 1===e||3===e}},2042:function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return b})),n.d(t,"m",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return v})),n.d(t,"j",(function(){return m})),n.d(t,"l",(function(){return h}));var r=n(37),a=n(1961);n.d(t,"n",(function(){return a.a}));var i=n(1941);n.d(t,"a",(function(){return i.a}));var o=n(1803);n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return o.a}));var c=n(1962);n.d(t,"b",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(3),n.e(34),n.e(72),n.e(766)]).then(n.bind(null,3198))})),s=new r.b(u,(function(e){return e.getSharingInformation})),d=new r.b(u,(function(e){return e.getSharingIssuesForSharingData})),l=new r.b(u,(function(e){return e.getInfoBarCreator})),b=new r.b(u,(function(e){return e.hasLargeDLRecipient})),f=new r.b(u,(function(e){return e.hasRecipientExpansionFailure})),p=new r.b(u,(function(e){return e.getGroupsAndSmallDLs})),v=new r.b(u,(function(e){return e.getInvididualRecipients})),m=new r.b(u,(function(e){return e.hasGetRecipientPermissionFailed})),h=new r.b(u,(function(e){return e.logSharingTipChangesForLinkRemoval}))},2280:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"n",(function(){return v})),n.d(t,"r",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return w})),n.d(t,"j",(function(){return g})),n.d(t,"f",(function(){return O})),n.d(t,"i",(function(){return S})),n.d(t,"a",(function(){return j}));var r=n(37),a=new r.c((function(){return Promise.all([n.e(3),n.e(20),n.e(27),n.e(34),n.e(38),n.e(64),n.e(65),n.e(70),n.e(154),n.e(160),n.e(855)]).then(n.bind(null,3971))})),i=new r.a(a,(function(e){return e.onSmimeItemAttachmentOpened})),o=new r.a(a,(function(e){return e.mergeSmimeDecodedMessageProperties})),c=(new r.b(a,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(a,(function(e){return e.setSmimePropertiesInDraftMessage}))),u=new r.b(a,(function(e){return e.trySetSmimeProperties})),s=new r.b(a,(function(e){return e.tryAddSmimeProperties})),d=new r.b(a,(function(e){return e.createMailResponseBodyContent})),l=new r.b(a,(function(e){return e.downloadSmimeAttachment})),b=new r.b(a,(function(e){return e.getMergedSmimeViewState})),f=new r.b(a,(function(e){return e.getMergedSmimeViewStateForDraft})),p=new r.b(a,(function(e){return e.isSmimeItemDecoding})),v=new r.b(a,(function(e){return e.previewSmimeAttachment})),m=new r.b(a,(function(e){return e.updateSmimeAttachmentIds})),h=new r.b(a,(function(e){return e.createSmimeAttachmentsFromFiles})),w=new r.b(a,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),g=new r.b(a,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),O=new r.b(a,(function(e){return e.getAttachmentsForSmimeResponse})),S=new r.b(a,(function(e){return e.getSmimeAttachmentsForRequest})),j=Object(r.d)(a,(function(e){return e.SignatureDetails}))},2298:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1973);function a(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},2302:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("updateInternetMessageId",(function(e,t,n){return{conversationId:e,itemId:t,internetMessageId:n}}))},236:function(e,t,n){"use strict";var r=n(699);n.d(t,"a",(function(){return r.a}))},3035:function(e,t,n){"use strict";var r=n(0);function a(e,t,n,a,i,o,c,u,s,d){return{folderId:null,type:1,listViewType:i,searchNumber:e,queryString:t,searchScope:n,pillSuggestions:Object(r.__spread)(a.values()),includeAttachments:o,fromDate:c,toDate:u,scenarioType:"mail",lastIndexFetched:0,searchProvider:s,viewFilter:d||"All"}}function i(e){var t=e;return 1==e.type?t.scenarioType:void 0}var o=n(1667),c=n(1647),u=n(966),s=n(1888),d=n(2298);function l(e){var t=e;return Object(c.m)(t.folderId)?Object(d.a)(t.searchScope,Object(s.a)({folderId:Object(u.a)(o.b),kind:"ArchiveMailbox"})):Object(d.a)(t.searchScope,Object(s.b)({folderId:Object(u.a)(o.h),kind:"PrimaryMailbox"}))}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return l}))},365:function(e,t,n){"use strict";var r,a=n(2);!function(e){e[e.Valid=0]="Valid",e[e.AccountDeprovisioned=1]="AccountDeprovisioned",e[e.AccessRevoked=2]="AccessRevoked",e[e.TransientTokenError=3]="TransientTokenError",e[e.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",e[e.AccountNotFound=5]="AccountNotFound",e[e.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var i,o=n(48),c=Object(a.action)("addAccount",(function(e){return{userIdentity:e.userIdentity,account:e}})),u=Object(a.action)("removeAccount",(function(e){return{userIdentity:e}})),s=Object(a.action)("updateAccount",(function(e,t,n){return{userIdentity:e,accountToken:t,accountTokenExpiresIn:n}})),d=Object(a.action)("updateOWAConnectedAccountStatus",(function(e,t){return{userIdentity:e,accountState:t}})),l=Object(a.action)("accountIsInErrorState",(function(e,t){return Object(o.c)({name:"accountIsInErrorState",customData:{accountState_1:r[e],accountProvider_2:t}},{accountState:e})})),b=Object(a.action)("retryAccountUpdateToken",(function(e,t,n){return{accountId:e,userIdentity:t,currentToken:n}})),f=Object(a.action)("connectedAccountsListRequested",(function(e){return{isSuccess:e}})),p=Object(a.action)("setAccountsStoreState",(function(e){return{state:e}})),v=n(0),m=n(9);!function(e){e[e.None=0]="None",e[e.Loading=1]="Loading",e[e.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",e[e.AccountsLoadError=3]="AccountsLoadError"}(i||(i={}));var h=Object(a.createStore)("OWAAccountsStore",{accountsMap:new m.ObservableMap({}),accountsLoadedState:i.None}),w=n(111),g=n(71);function O(e){return e!=Object(g.b)()&&void 0!==j(e)}function S(){return Object(v.__spread)(h().accountsMap.values())}function j(e){return h().accountsMap.get(e)}function I(){var e;return(null===(e=S())||void 0===e?void 0:e.length)>0?S()[0]:null}function y(){return S().filter((function(e){return e.accountState!=r.Valid}))}function x(e){return S().filter((function(t){return e.includes(t.accountState)}))}function P(e){return S().filter((function(t){return t.accountProviderType==e}))}function T(e){return O(e)?j(e).accountProviderType:null}function _(e){return"Outlook"==e.accountProviderType?'MSAuth1.0 usertoken="'+e.token+'", type="MSACT"':"Google"==e.accountProviderType||"ICloud"==e.accountProviderType?"Bearer "+e.token:Object(w.a)(e.accountProviderType)}function A(e,t){return function(n){var r=j(n);return r?r[e]:t}}A("accountUniqueId","0");var C=A("accountState",r.Valid),k=function(){return S().some((function(e){return!M(e.userIdentity)}))},E=A("accountProviderType",null),D=function(e){return"Outlook"==E(e)},M=function(e){return C(e)==r.Valid},L=function(){return S().length>0};function R(){return h().accountsLoadedState}var F=n(4),N=n(127);Object(a.mutator)(c,(function(e){var t=e.account;Object(N.r)("owaAccountAdded",{accountStatus_1:r[t.accountState]}),h().accountsMap.set(t.userIdentity,t)})),Object(a.mutator)(u,(function(e){var t=e.userIdentity;h().accountsMap.delete(t)})),Object(a.mutator)(s,(function(e){var t=e.userIdentity,n=e.accountToken,r=e.accountTokenExpiresIn,a=h().accountsMap.get(t);a.token=n,a.tokenExpiry=Object(F.j)(Object(F.Qb)(),parseInt(r))})),Object(a.mutator)(d,(function(e){var t=e.userIdentity,n=e.accountState,a=h().accountsMap.get(t);a.accountState==r.Valid&&n!=r.Valid&&Object(N.r)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[n]}),a.accountState=n})),Object(a.mutator)(f,(function(e){var t=e.isSuccess?i.AccountsLoadSuccessful:i.AccountsLoadError;h().accountsLoadedState=t})),Object(a.mutator)(p,(function(e){h().accountsLoadedState=e.state})),n.d(t,"d",(function(){return c})),n.d(t,"u",(function(){return u})),n.d(t,"y",(function(){return s})),n.d(t,"x",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"v",(function(){return b})),n.d(t,"e",(function(){return f})),n.d(t,"w",(function(){return p})),n.d(t,"n",(function(){return S})),n.d(t,"k",(function(){return j})),n.d(t,"i",(function(){return I})),n.d(t,"f",(function(){return y})),n.d(t,"g",(function(){return x})),n.d(t,"o",(function(){return P})),n.d(t,"j",(function(){return T})),n.d(t,"m",(function(){return _})),n.d(t,"l",(function(){return C})),n.d(t,"q",(function(){return k})),n.d(t,"t",(function(){return D})),n.d(t,"s",(function(){return M})),n.d(t,"p",(function(){return L})),n.d(t,"h",(function(){return R})),n.d(t,"r",(function(){return O})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},439:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();n.d(t,"a",(function(){return r}))},4732:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(5059),a=n(5665),i=n(3290),o=n(6);function c(e){switch(e){case 2:return Object(o.b)(a.d);case 3:return Object(o.b)(a.e);case 5:return Object(o.b)(a.c);case 6:return Object(o.b)(r.a);case 7:return Object(o.b)(a.g);case 4:return Object(o.b)(a.f);case 10:return Object(o.b)(a.a);case 11:return Object(o.b)(a.b);default:return Object(o.b)(i.a)}}},4741:function(e,t,n){"use strict";function r(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return r}))},4778:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(2),i=Object(a.action)("initializeReadingPaneInSxS",(function(e,t,n,r,a,i){return{readingPaneStrategy:e,attachmentSelectionSource:t,parentItemId:n,instrumentationContext:r,sxsId:a,isProjectionPopout:i}})),o=Object(a.action)("initializeConversationReadingPaneInSxS",(function(e,t,n,r,a){return{readingPaneStrategy:e,attachmentSelectionSource:t,parentItemId:n,instrumentationContext:r,sxsId:a}})),c=Object(a.action)("initializeReadingPaneInSxSByCopyingMailReadingPane",(function(e,t,n,r,a){return{attachmentSelectionSource:e,parentItemId:t,instrumentationContext:n,sxsId:r,isProjectionPopout:a}})),u=n(111),s=n(1993),d=n(1745);Object(a.orchestrator)(o,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.attachmentSelectionSource,a=e.parentItemId,i=e.instrumentationContext,o=e.sxsId,t&&t.conversationId?(c=Object(d.l)(o)).readingPaneState&&c.readingPaneState.mode===d.h.ConversationReadingPane&&c.readingPaneState.conversationId&&c.readingPaneState.conversationId.Id===t.conversationId.Id?(a&&function(e){switch(e){case d.b.MailList:case d.b.ConversationAttachmentWell:return!0;case d.b.ReadingPane:case d.b.FilesHub:case d.b.PhotoHub:case d.b.GroupFilesHub:case d.b.ConsumerGroupFilesHub:case d.b.Deeplink:case d.b.FileSuggestion:case d.b.LinkSuggestion:case d.b.ComposeDocLink:case d.b.ReadingPaneDocLink:case d.b.FolderTree:return!1;default:return Object(u.a)(e)}}(n)&&s.s.importAndExecute(t.conversationId.Id,a.Id),[2]):(Object(d.I)(t.conversationId.Id),[4,s.l.importAndExecute(t.conversationId,i,t.conversationSubject,t.conversationCategories,t.itemIdToScrollTo)]):[2];case 1:return r.sent(),Object(d.M)({mode:d.h.ConversationReadingPane,conversationId:t.conversationId,conversationCategories:t.conversationCategories,conversationSubject:t.conversationSubject},o),a&&s.s.importAndExecute(t.conversationId.Id,a.Id),[2]}}))}))}));var l=Object(a.action)("initializeItemReadingPaneInSxS",(function(e,t,n){return{readingPaneStrategy:e,sxsId:t,instrumentationContext:n}}));Object(a.orchestrator)(l,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.instrumentationContext,a=e.sxsId,t&&t.itemId?(i=Object(d.l)(a)).readingPaneState&&i.readingPaneState.mode===d.h.ItemReadingPane&&i.readingPaneState.itemId&&i.readingPaneState.itemId.Id===t.itemId.Id?[2]:(o=Object(s.c)(t.itemId.Id))&&o.itemId==t.itemId.Id?(Object(d.M)({mode:d.h.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:o},a),[3,4]):[3,1]:[2];case 1:return[4,s.n.import()];case 2:return[4,r.sent()(t.itemId,n,(function(e){Object(d.M)({mode:d.h.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:e},a)}))];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}));var b=n(2461),f=n(1764),p=n(3035),v=n(1697),m=n(1756),h=n(1721),w=n(497),g=n(1757),O=n(7132),S=n(2510),j=n(1641),I=n(1979);Object(a.orchestrator)(c,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,c,u,s,y,x,P,T,_,A,C,k,E,D,M,L,R;return Object(r.__generator)(this,(function(F){switch(F.label){case 0:return e.isProjectionPopout?[2]:(t=Object(d.l)(e.sxsId)).shouldShow&&(t.readingPaneState||t.composeId)?[2]:(n=e.attachmentSelectionSource,a=e.parentItemId,i=e.instrumentationContext,c=null===(R=j.Y.tableViews.get(j.Y.selectedTableViewId))||void 0===R?void 0:R.tableQuery,u=c&&(Object(j.R)(c)||Object(p.c)(c)),s=Object(h.d)(),(y=Object(O.a)())?Object(w.v)()&&window.opener?[2]:y.composeId!==f.a.primaryComposeId?[3,2]:[4,g.k.import()]:[3,4]);case 1:F.sent()(y,!0,!1),s=Object(h.d)(),F.label=2;case 2:return[4,d.B.import()];case 3:return F.sent()(y.composeId,e.sxsId),[2];case 4:return x=v.a.deeplinkId,P=Object(m.a)(),x?l({method:b.a.LoadItemReadingPane,itemId:{mailboxInfo:x.mailboxInfo,Id:x.id}},e.sxsId,i):s&&s.type===h.a.SecondaryReadingPane?1===(T=s.data).listViewType||Object(I.a)()?l({method:b.a.LoadItemReadingPane,itemId:T.id},e.sxsId,i):0===T.listViewType&&o({method:b.a.LoadConversationReadingPane,conversationId:T.id,conversationSubject:T.subject,conversationCategories:T.categories},n,a,i,e.sxsId):P&&Object(S.a)(P.conversationId.Id)?o({method:b.a.LoadConversationReadingPane,conversationId:P.conversationId,conversationSubject:P.conversationSubject,conversationCategories:P.conversationCategories},n,a,i,e.sxsId):(_=Object(j.H)(),A=_&&Object(r.__spread)(_.selectedRowKeys.keys()),C=null==_?void 0:_.isInVirtualSelectAllMode,k=j.Y.expandedConversationViewState.selectedNodeIds.length,1==A.length&&k<=1&&!C&&!u&&(E=j.b.getRowIdToShowInReadingPane(A[0],_),1===(D=_&&_.tableQuery.listViewType)||Object(I.a)()?l({method:b.a.LoadItemReadingPane,itemId:E},e.sxsId,i):0===D&&(M=j.b.getSubject(A[0],_),L=j.b.getCategories(A[0],_),o({method:b.a.LoadConversationReadingPane,conversationId:E,conversationSubject:M,conversationCategories:L},n,a,i,e.sxsId)))),[2]}}))}))})),Object(a.orchestrator)(i,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,u,s;return Object(r.__generator)(this,(function(r){if(t=e.readingPaneStrategy,n=e.attachmentSelectionSource,a=e.parentItemId,i=e.instrumentationContext,u=e.sxsId,s=e.isProjectionPopout,!t)return[2];switch(t.method){case b.a.NoOp:return[2];case b.a.AlwaysHidden:return Object(d.M)(null,u),[2];case b.a.CopyMailReadingPaneContainer:return c(n,a,i,u,s),[2];case b.a.LoadConversationReadingPane:return o(t,n,a,i,u),[2];case b.a.LoadItemReadingPane:return l(t,u,i),[2];default:return[2]}return[2]}))}))}));var y=n(127),x=n(1805),P=n(2004),T=n(1750),_=n(2819),A=n(5927),C="download",k="open";function E(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(A.a)(e.AttachLongPathName),[4,Object(_.l)(n)];case 1:return a=r.sent(),[2,(null===(t=a.result)||void 0===t?void 0:t.webContentLink)&&(i=a.result.webContentLink,i.lastIndexOf(C,i.length-C.length)>-1)?D(a.result.webContentLink):null]}var i}))}))}function D(e){return e.slice(0,-C.length)+k}var M=n(1997),L=n(2292),R=n(10582),F=n(2519),N=n(3648),U=n(9021),W=n(18),V=n(1669),B=n(4741),H=n(219),G=n(6),z=n(3290),J=n(5059),$=n(4975),q=n(1647),K=n(9179),Y=n(5),X=n(1953),Q=n(20);function Z(e){switch(e){case x.b.Unsupported:return"Unsupported";case x.b.Image:return"Image";case x.b.MailItem:return"MailItem";case x.b.CalendarEvent:return"CalendarEvent";case x.b.Wac:return"Wac";case x.b.SuiteExtensions:return"SuiteExtensions";case x.b.Audio:return"Audio";case x.b.Text:return"Text";case x.b.NativeView:return"NativeView";case x.b.GoogleDoc:return"GoogleDoc";case x.b.PdfJs:return"PdfJs";case x.b.ItemAttachment:return"ItemAttachment";case x.b.Video:return"Video";default:return Object(u.a)(e)}}var ee="/owa/{0}/service.svc/s/GetAttachmentPdfPreview?id={1}";function te(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(G.c)(ee,e,encodeURIComponent(t)),[4,fetch(n,{credentials:"same-origin"})];case 1:return[2,r.sent()]}}))}))}var ne=n(2220);function re(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a,i,o,c,u,s,d,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.mailboxInfo?[4,te(Object(ne.d)(e.mailboxInfo),e.Id)]:[2,null];case 1:return(t=r.sent()).ok?[4,t.text()]:[3,3];case 2:for(n=r.sent(),a=n.replace(/\s/gi,""),i=atob(a),o=i.length,c=new Uint8Array(new ArrayBuffer(o)),u=0;u<o;u++)c[u]=i.charCodeAt(u);return s=t.headers.get("PrintAllowed"),d=t.headers.get("CopyAllowed"),l=t.headers.get("ExportAllowed"),[2,{data:c,printAllowed:!s||"true"===s.toLowerCase(),copyAllowed:!d||"true"===d.toLowerCase(),exportAllowed:!l||"true"===l.toLowerCase()}];case 3:throw t.statusText}}))}))}var ae=n(3);function ie(e,t){var n=Object(ae.G)()?"OWA-PWA":"OWA-WEB",r=t?"SXS-EDIT":"SXS-VIEW",a="";switch(e){case d.b.MailList:a="ML";break;case d.b.ConversationAttachmentWell:a="CAW";break;case d.b.ReadingPane:a="RP";break;case d.b.FilesHub:a="FH";break;case d.b.PhotoHub:a="PH";break;case d.b.GroupFilesHub:a="GFH";break;case d.b.ConsumerGroupFilesHub:a="CGF";break;case d.b.Deeplink:a="DL";break;case d.b.FileSuggestion:a="FS";break;case d.b.LinkSuggestion:a="LS";break;case d.b.ComposeDocLink:a="CDL";break;case d.b.ReadingPaneDocLink:a="RPDL";break;case d.b.FolderTree:a="FT";break;default:a="UNKNOWN"}return n+"."+a+"."+r}var oe=n(2511);function ce(e){var t=new Error(e);throw t.isUserError=!0,t}function ue(e){if(null!=e&&e.isUserError)return!0;return!1}var se=n(15911),de=n(2589),le=n(369),be=[".odp",".pot",".potm",".potx",".pps",".ppsm",".ppsx",".ppt",".pptm",".pptx"];function fe(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,g.j.import()];case 1:return r.sent()(e.Id,t,3,{forceInsertSignatureOperation:n}),[2]}}))}))}function pe(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return t=e.mailboxInfo,n=t&&"GroupMailbox"==t.type?t.mailboxSmtpAddress:null,[4,g.d.import()];case 1:return[4,i.sent()(e.Id,!0,n,!1)];case 2:return a=i.sent(),[2,Object(r.__assign)(Object(r.__assign)({},a.ItemId),{mailboxInfo:e.mailboxInfo})]}}))}))}function ve(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=Object(S.a)(e))?[4,g.s.import()]:[3,3];case 1:return[4,n.sent()(t)];case 2:return n.sent(),[2,t.itemId];case 3:return[2,null]}}))}))}function me(e,t,n,a,o,c,u,s,l,b,f){var m,w;return void 0===b&&(b=d.f.Mail),Object(r.__awaiter)(this,void 0,void 0,(function(){function g(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c?[3,1]:(n=null,[3,3]);case 1:return[4,c()];case 2:n=r.sent(),r.label=3;case 3:return t=n,te(),je.setImagePreviewState(xe,Te.previewImage.url,t,ke,!ke&&!Object(L.e)().printWithoutDownloadEnabled,Le),[4,T.j.import()];case 4:return[4,r.sent()(e.attachmentId,e.isReadOnly)];case 5:return r.sent(),te(),je.setImagePreviewState(xe,Pe(e.attachmentId).previewImage.url,t,ke,!ke&&!Object(L.e)().printWithoutDownloadEnabled,Le),[2]}}))}))}function I(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=Te.model.ProviderType,Object(P.b)(e.isCloudy,t,Te.model.Name)&&t===T.a.providers.ONE_DRIVE_PRO?[4,A()]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,_()];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))}function _(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a,i,c,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=!1,[4,Object(U.a)(e.attachmentId,t,x.c[o])];case 1:return n=r.sent(),Te.model.Name&&(a=Te.model.Name.lastIndexOf("."))>=0&&(i=Te.model.Name.substr(a).toLowerCase(),Le.useHighContrastCommandBar=be.indexOf(i)>=0),te(),je.setWacPreviewState(xe,n.wacUrl,null,n.accessToken,n.accessTokenTtl,n.additionalParameters,n.deprecatedTokenAndParameters,ne.getTime(),!t,Le),[3,3];case 2:if(c=r.sent(),null==(u=c)?void 0:u.errorMessage)throw Q.g.warn("Something went wrong while getting the attachment state: "+u),e.isCloudy&&(s=Te,Le.openInNewTabUrl=Object(W.i)("doc-unwrap-safelinks")?s.originalUrl:s.openUrl),je.setPreviewError(xe,u.errorMessage,Le),u.error;throw c;case 3:return[2]}}))}))}function A(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,a,i,c,u,s;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:e=Te,t=Object(W.i)("doc-unwrap-safelinks")?e.originalUrl:e.openUrl,d.label=1;case 1:if(d.trys.push([1,3,,4]),We.addCustomData({useJsApi:"true"}),null==t)throw new Error("openUrl is null");return n=Te.model.Name,a=n&&n.substring(n.lastIndexOf(".")),l=a,i=!Object(W.i)("doc-SxS-jsApi-ODB-Readonly")&&".xls"!==l,[4,Object(N.a)(0,t,i,!0)];case 2:if(!(c=d.sent()))throw new Error("Vroom API call failed");return te(),u=Object(H.a)(),je.setWacPreviewState(xe,c.openWith.wac.applicationUrl,{bootScriptUrl:c.openWith.wac.bootstrapperUrl,wopiSrcUrl:c.openWith.wac.wopiSrc,accessToken:c.openWith.wac.accessToken,accessTokenExpiry:c.openWith.wac.accessTokenExpiry,fileSize:Te.model.Size,fileGetUrl:c.openWith.wac.fileGetUrl,bundleInfo:c.officeBundle,fetchStartTime:c.fetchStartTime,responseStartTime:c.responseStartTime,openUrl:t,owaSessionId:u,userId:c.openWith.wac.userId,sessionOrigin:ie(o,i),clientThrottlingProtection:c.openWith.wac.clientThrottlingProtection,requestedCallThrottling:c.openWith.wac.requestedCallThrottling},null,null,null,null,ne.getTime(),c.currentUserRole.readOnly,Le),We.addCustomData({owaSessionId:u}),[3,4];case 3:throw s=d.sent(),Q.g.warn("Something went wrong while getting the attachment state: "+s.message),je.setPreviewError(xe,Object(G.b)(z.a),Object(r.__assign)(Object(r.__assign)({},Le),{openInNewTabUrl:t})),s;case 4:return[2]}var l}))}))}function C(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return Object(M.b)(Te.model)&&Te.model.ProviderType===T.a.providers.GDRIVE?[4,k()]:[3,2];case 1:return n.sent(),[3,3];case 2:t=Object(F.a)(e.attachmentId,Te.model,3,Object(M.b)(Te.model),e.isReadOnly),je.setNativePdfPreviewState(xe,Te.download.url+"&isDocumentPreview=True#toolbar=0",t,"application/pdf",Le),n.label=3;case 3:return[2]}}))}))}function k(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,E(Te.model)];case 2:return(t=r.sent())?(te(),je.setNativePdfPreviewState(xe,t,null,"application/pdf",Le),[2]):[3,4];case 3:return n=r.sent(),e=n,[3,4];case 4:throw te(),je.setPreviewError(xe,Object(G.b)(J.a)),e||new Error("Unexpected error in handleNativeViewPreviewForGDrive")}}))}))}function D(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(L.c)(Te.model,!0),ke&&t.directFileAccessEnabled&&!Fe?(je.setPdfJsPreviewState(xe,Te.download.url+"&isDocumentPreview=True",!1,Le),[3,3]):[3,1];case 1:return[4,re(e.attachmentId)];case 2:n=r.sent(),te(),je.setPdfJsPreviewStateByData(xe,n.data,!ke&&!Object(L.e)().printWithoutDownloadEnabled||!n.printAllowed,n.copyAllowed,n.exportAllowed,Le),r.label=3;case 3:return[2]}}))}))}function V(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(R.a)(e.attachmentId.Id,Object(le.a)(e.attachmentId.mailboxInfo),0,x.c[o])];case 1:return t=r.sent(),te(),je.setTextPreviewState(xe,t,ke,Le),[3,3];case 2:if(n=r.sent(),null==(a=n)?void 0:a.errorMessage)throw te(),je.setPreviewError(xe,a.errorMessage),a.error;throw n;case 3:return[2]}}))}))}function ee(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t={calendarItem:null,isIcsAttachmentLoading:!0,icsCalendarEventType:K.a.UNKNOWN,attachmentId:e.attachmentId,addToCalendarStatus:1,errorMessage:null},[4,K.d.import()];case 1:return n=r.sent(),a=null,[4,n({attachmentId:e.attachmentId,size:Te.model.Size,showSizeLimitExceedsError:function(){a=Object(G.b)(se.a)},errorCallback:function(){a=Object(G.b)($.a)},state:t})];case 2:if(r.sent(),te(),a)throw je.setPreviewError(xe,a),new Error(a);return ae.onShowCustomPreview(t,Oe),je.setCustomPreviewState(xe,Le),[2]}}))}))}function te(){Object(d.l)(Oe).pendingPreviewOperation&&He.id===Object(d.l)(Oe).pendingPreviewOperation.id||ce("Preview changed before loading finished")}var ne,ae,me,Oe,Se,je,Ie,ye,xe,Pe,Te,_e,Ae,Ce,ke,Ee,De,Me,Le,Re,Fe,Ne,Ue,We,Ve,Be,He,Ge,ze,Je,$e,qe,Ke,Ye;return Object(r.__generator)(this,(function(c){switch(c.label){case 0:return ne=new Date,[4,d.G.import()];case 1:return ae=c.sent(),oe.a.available()?(l=l||window,me=l!==window,Oe=Object(d.k)(l),oe.a.run(l,Oe),f&&o==x.c.Deeplink&&(Se=(new Date).getTime()-f,Object(y.r)("PopOutSxSUsage",{PopOutType:"DeepLink",TimeElapsed:Se})),[4,X.u.import()]):(ae.openSxSInANewWindow(t,e.attachmentId.Id,null),[2]);case 2:return je=c.sent(),Ie=ae.onPreviewOperationStart,ye=ae.onPreviewOperationFinished,xe=Object(d.l)(Oe).viewState,[4,T.h.import()];case 3:Pe=c.sent(),Te=Pe(e.attachmentId),_e=e.strategy,Ae=-1!==_e.supportedOpenActions.indexOf(x.a.Download),Ce=Ae&&(null==Te?void 0:Te.download)?Te.download.url:null,ke=Te.info.allowDownload,Ee=0,Object(W.i)("wvn-productizeSTCChicletAndPreview")||Object(W.i)("wvn-sxsEditButtonSplit")?Ee=_e.isSaveToCloudSupported?Object(G.f)(Te.model.AttachmentOriginalUrl)?1:3:0:(De=_e.isSaveToCloudSupported&&Object(G.f)(Te.model.AttachmentOriginalUrl),Ee=De?1:0),Me=_e.previewMethod===x.b.Wac,Le={downloadUrl:Ce,downloadShouldOpenNewTab:Me,fileName:Te.model.Name,useHighContrastCommandBar:!1,id:e.attachmentId,isCloudy:e.isCloudy,openInNewTabUrl:null},Re=_e.previewMethod,Fe=!1,_e.previewMethod!==x.b.NativeView&&_e.previewMethod!==x.b.PdfJs||(Ne=q.u.items.get(t.Id))&&Ne.RightsManagementLicenseData&&(Re=x.b.PdfJs,Fe=!0),Ue=function(e,t,n,r,a,i,o,c){var u,s,d=ge(e),l=new y.b("PreviewAttachmentInSxSE2E",{timeout:he}),b=Date.now(),f=!1;c&&(f=!!we&&we===c,we=c);var p={previewMethod:Z(t),isCloudy:n?"cloudy":"classic",isChangingFromEditing:r?"changingFromEdit":"",officeFileType:Object(B.a)(d),actionSource:x.c[a],attachmentFileType:i,isRepeat:o,downloadAllowed:!!e.download.url,fromSameReadingPane:f},v="";Object(W.i)("doc-SxS-jsApi-ODB-Base")&&(v+="doc-SxS-jsApi-ODB-Base;");Object(W.i)("doc-SxS-jsApi-ODB-BaseNoEditString")&&(v+="doc-SxS-jsApi-ODB-BaseNoEditString;");Object(W.i)("doc-SxS-jsApi-ODB-Readonly")&&(v+="doc-SxS-jsApi-ODB-Readonly;");Object(W.i)("doc-SxS-jsApi-ODB-Basecf")&&(v+="doc-SxS-jsApi-ODB-Basecf;");return p.associatedFlights=v,p.hostName=window.location.hostname,p.hideEmailOption=null===(u=X.u.tryImportForRender())||void 0===u?void 0:u.getHideReadingPaneOption(),l.addCustomData(p),l.addCosmosOnlyData(JSON.stringify({attachmentId:null===(s=null==e?void 0:e.id)||void 0===s?void 0:s.Id,fileType:(null==d?void 0:d.substring(0,4))||"",fileSize:e.model.Size})),Object(y.r)("PreviewAttachmentInSxSUsage",p,{excludeFromKusto:!0}),{perfDatapoint:l,perfDatapointCreatedTime:b}}(Te,Re,e.isCloudy,Object(d.l)(Oe).editState.mode!==d.c.View,o,e.fileType,ae.repeatTracker.contains(e.attachmentId.Id),!Object(d.l)(Oe).shouldShow&&function(){var e,t,n,a,i,o=null===(e=j.Y.tableViews.get(j.Y.selectedTableViewId))||void 0===e?void 0:e.tableQuery,c=o&&(Object(j.R)(o)||Object(p.c)(o)),u=Object(h.d)(),s=Object(O.a)(),d=null===(t=null==s?void 0:s.itemId)||void 0===t?void 0:t.Id;if(d)return d;var l=Object(v.b)(),b=l.conversationReadingPaneViewState,f=l.deeplinkId;if(f)return f.id;if(u&&u.type===h.a.SecondaryReadingPane){var m=u.data;return null===(n=null==m?void 0:m.id)||void 0===n?void 0:n.Id}if(b&&Object(S.a)(b.conversationId.Id))return b.conversationId.Id;var w=Object(j.H)(),g=w&&Object(r.__spread)(w.selectedRowKeys.keys()),I=null==w?void 0:w.isInVirtualSelectAllMode,y=null===(i=null===(a=j.Y.expandedConversationViewState)||void 0===a?void 0:a.selectedNodeIds)||void 0===i?void 0:i.length;return 1===(null==g?void 0:g.length)&&y<=1&&!I&&!c?j.b.getRowClientItemId(g[0],w).Id:null}()),We=Ue.perfDatapoint,Ve=Ue.perfDatapointCreatedTime,Be=function(){We.addCustomData({autoHide:!0})},xe.eventManager.on(X.a,Be),He={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.attachmentId},Ie(He,Oe),c.label=4;case 4:return c.trys.push([4,30,31,32]),[4,ae.canCloseSxS(Oe)];case 5:if(c.sent()||We.addCustomData({exitEditMode:"notSaved"}),te(),a&&!n||i(u,o,t,s,Oe,me),Ge=null==t?void 0:t.Id,ze=Ge&&Object(q.v)(Ge),je.setPreviewLoading(xe,"",Le),ae.showSxS(Object(d.l)(Oe).shouldShow?null:b,{previewMode:Re,attachmentId:e.attachmentId,selectionSource:o,isCloudy:e.isCloudy,saveToCloudStatus:Ee,textPreviewReadMode:0},{editAllowed:_e.allowEdit&&!(Object(Y.d)("sxsHideEdit")&&(Object(d.l)(Oe).shouldShow?Object(d.l)(Oe).customization:b)===d.f.DeepLink),itemId:t,isDraft:n},null,Oe,{itemId:Ge,fileId:e.attachmentId.Id,fileType:ge(Te),sender:null===(w=null===(m=(null==ze?void 0:ze.From)||(null==ze?void 0:ze.Sender))||void 0===m?void 0:m.Mailbox)||void 0===w?void 0:w.EmailAddress,startTime:(new Date).getTime()}),Object(d.L)(null),Je=void 0,a)return[3,25];switch(Re){case x.b.Image:return[3,6];case x.b.Wac:return[3,8];case x.b.GoogleDoc:return[3,10];case x.b.NativeView:return[3,11];case x.b.PdfJs:return[3,13];case x.b.Audio:return[3,15];case x.b.Video:return[3,16];case x.b.Text:return[3,17];case x.b.ItemAttachment:return[3,19];case x.b.CalendarEvent:return[3,20]}return[3,22];case 6:return[4,g()];case 7:return c.sent(),[3,23];case 8:return[4,I()];case 9:return c.sent(),[3,23];case 10:return je.setIframePreviewState(xe,Te.model.AttachLongPathName,Le),[3,23];case 11:return[4,C()];case 12:return c.sent(),[3,23];case 13:return[4,D()];case 14:return c.sent(),[3,23];case 15:return je.setAudioPreviewState(xe,Te.download.url,Le),[3,23];case 16:return je.setVideoPreviewState(xe,Te.download.url,Le),[3,23];case 17:return[4,V()];case 18:return c.sent(),[3,23];case 19:return Object(de.a)(e.attachmentId,We),je.setCustomPreviewState(xe,Le),[3,23];case 20:return[4,ee()];case 21:return c.sent(),[3,23];case 22:throw new Error("Unsupported preview method");case 23:return[4,ae.waitForPreviewLoadOrThrowError(Oe)];case 24:Je=c.sent(),c.label=25;case 25:return te(),ye(Oe),a?n?[4,d.t.import()]:[3,27]:[3,29];case 26:return c.sent()(fe,Oe),[3,29];case 27:return[4,d.s.import()];case 28:c.sent()(fe,pe,ve,Oe),c.label=29;case 29:return $e=null==Je?void 0:Je.errorObject,qe=null==Je?void 0:Je.loadedTime,$e&&We.addCustomData({errorObject:$e}),qe?(Ke=qe-Ve,We.end(Ke)):We.end(),ae.repeatTracker.add(e.attachmentId.Id),[3,32];case 30:return Ye=c.sent(),We.endWithError(ue(Ye)?"UserError":"ServerError",Ye),[3,32];case 31:return xe.eventManager.off(X.a,Be),[7];case 32:return[2]}}))}))}var he=18e4,we=null;function ge(e){return 8!==e.attachmentClass&&9!==e.attachmentClass&&Object(V.c)(e.model.Name||"")||e.model.ContentType||""}var Oe=n(1684),Se=n(2280);function je(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=e.viewState&&Object(Oe.a)(e.viewState.attachmentId))&&Object(T.d)(t.model)?[4,Se.n.import()]:[3,2];case 1:return n.sent()(t.model,e.parentItemId),[2];case 2:return e.onBeforePreview&&e.onBeforePreview(),[4,me(e.viewState,e.parentItemId,e.isDraft,e.isEdit,e.attachmentSelectionSource,e.createImageGallery,{method:b.a.CopyMailReadingPaneContainer},e.instrumentationContext,e.targetWindow)];case 3:return n.sent(),[2]}}))}))}var Ie=n(9180);function ye(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=null,Object(W.i)("rp-projectionPopout")?"IMG"!==(null===(n=null===(t=e)||void 0===t?void 0:t.tagName)||void 0===n?void 0:n.toUpperCase())?[3,2]:[4,Ie.b.import()]:[3,4];case 1:return i=r.sent(),a=i(e),[3,3];case 2:a=e,r.label=3;case 3:return[3,7];case 4:return e instanceof HTMLElement?[4,Ie.b.import()]:[3,6];case 5:return i=r.sent(),a=i(e),[3,7];case 6:a=e,r.label=7;case 7:return[2,a]}}))}))}function xe(e,t,n,a){var o,c,u;return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l,f,p,v,m,w,g,O,S,j,I,y;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s=(null===(c=null===(o=a)||void 0===o?void 0:o.ownerDocument)||void 0===c?void 0:c.defaultView)||window,l=s===window?"primaryTab":Object(h.f)(s),f=s!==window,oe.a.run(s,l),p=Object(d.l)(l),[4,d.A.import()];case 1:return v=r.sent(),[4,d.z.import()];case 2:return m=r.sent(),[4,ye(a)];case 3:(w=r.sent())||(w=p.viewState),g={downloadUrl:e.downloadUrl,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:e.id},O={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.id},v(O,l),r.label=4;case 4:return r.trys.push([4,8,,9]),[4,d.F.import()];case 5:return S=r.sent(),[4,X.k.import()];case 6:return j=r.sent(),[4,T.h.import()];case 7:return I=r.sent(),y=null===(u=I(e.id))||void 0===u?void 0:u.info.allowDownload,p.pendingPreviewOperation&&O.id===p.pendingPreviewOperation.id||ce("Preview changed before loading finished"),i({method:b.a.CopyMailReadingPaneContainer},d.b.ReadingPane,null,null,l,f),j(w,e.previewUrl,t,y,!y&&!Object(L.e)().printWithoutDownloadEnabled,g),S(p.shouldShow?null:d.f.Mail,{previewMode:x.b.Image,attachmentId:e.id,selectionSource:d.b.ReadingPane,isCloudy:!1,saveToCloudStatus:0,textPreviewReadMode:0},{editAllowed:!1,itemId:n,isDraft:!1},null,l),Object(d.L)(null),m(l),[3,9];case 8:return r.sent(),[3,9];case 9:return[2]}}))}))}function Pe(e,t,n,a,o,c,u,s,l,b,f){return void 0===l&&(l=null),void 0===b&&(b=null),void 0===f&&(f=d.f.Mail),Object(r.__awaiter)(this,void 0,void 0,(function(){function p(){j.pendingPreviewOperation&&A.id===j.pendingPreviewOperation.id||ce("Preview changed before loading finished")}var v,m,h,w,g,O,S,j,I,P,T,_,A,C,k,E,D,M,L;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s=s||window,v=s!==window,m=Object(d.k)(s),oe.a.run(s,m),h=e(),[4,X.u.import()];case 1:return w=r.sent(),[4,d.G.import()];case 2:g=r.sent(),O=g.onPreviewOperationStart,S=g.onPreviewOperationFinished,j=Object(d.l)(m),I=j.viewState,P={downloadUrl:null,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:null,fileName:l,openInNewTabUrl:b},T=function(e,t){var n=new y.b("PreviewLinkInSxSE2E");return n.addCustomData({previewMethod:Z(e),actionSource:d.b[t]}),n}(x.b.Wac,n),_=function(){T.addCustomData({autoHide:!0})},I.eventManager.on(X.a,_),A={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:null},O(A,m),r.label=3;case 3:return r.trys.push([3,10,11,12]),[4,g.canCloseSxS(m)];case 4:r.sent(),p(),i(a,n,t,o,m,v),w.setPreviewLoading(I,"",P),g.showSxS(j.shouldShow?null:f,{previewMode:x.b.Wac,attachmentId:null,selectionSource:n,isCloudy:!0,saveToCloudStatus:0,textPreviewReadMode:0},{editAllowed:!1,itemId:t,isDraft:!1},c,m),Object(d.L)(c,u),r.label=5;case 5:return r.trys.push([5,7,,8]),[4,h];case 6:return C=r.sent(),p(),C.jsApiInfo&&(k=Object(H.a)(),C.jsApiInfo.owaSessionId=k,E=ie(n,!0),C.jsApiInfo.sessionOrigin=E,P.fileName=C.jsApiInfo.fileName,function(e,t,n){var r=Object(V.c)(t.fileName);e.addCustomData({useJsApi:"true",officeFileType:Object(B.a)(r),owaSessionId:t.owaSessionId,extraInfo:n}),e.addCosmosOnlyData(JSON.stringify({fileType:(null==r?void 0:r.substring(0,4))||""}))}(T,C.jsApiInfo,C.extraInfo)),w.setWacPreviewState(I,C.wacUrl,C.jsApiInfo,C.accessToken,C.accessTokenTtl,C.additionalParameters,C.deprecatedTokenAndParameters,(new Date).getTime(),u,P),[3,8];case 7:throw D=r.sent(),(null==(M=D)?void 0:M.errorMessage)?(w.setPreviewError(I,M.errorMessage),M.error):(w.setPreviewError(I,D.message||""+D),D);case 8:return[4,g.waitForPreviewLoadOrThrowError(m)];case 9:return r.sent(),p(),S(m),T.end(),[3,12];case 10:return L=r.sent(),T.endWithError(ue(L)?"UserError":"ServerError",L),[3,12];case 11:return I.eventManager.off(X.a,_),[7];case 12:return[2]}}))}))}n.d(t,"previewAttachment",(function(){return je})),n.d(t,"previewAttachmentInSxS",(function(){return me})),n.d(t,"previewImageInSxS",(function(){return xe})),n.d(t,"previewLinkInSxS",(function(){return Pe})),n.d(t,"initializeItemReadingPaneInSxS",(function(){return l}))},4975:function(e){e.exports=JSON.parse('{"a":"Qqb"}')},5059:function(e){e.exports=JSON.parse('{"a":"olb"}')},5665:function(e){e.exports=JSON.parse('{"d":"qlb","e":"rlb","c":"slb","g":"tlb","f":"ulb","a":"vlb","b":"wlb"}')},614:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("initializeOwaObservableDateTime"),i=Object(r.action)("observableNowChanged"),o=Object(r.action)("observableTodayChanged"),c=n(4),u=n(9),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(u.computed)((function(){return Object(c.mc)(s().now)})),l=function(){return d.get()},b=Object(u.computed)((function(){return Object(c.mc)(s().today)})),f=function(){return b.get()},p=function(e){return Object(c.Hb)(e,l())},v=function(e){return Object(c.Fb)(e,l())},m=function(e){return w(e,c.Hb)},h=function(e){return w(e,c.Ib)},w=function(e,t){return t(Object(c.Xb)(Object(c.mc)(e)),f())};function g(e){if(!e)return"";var t=Object(c.mc)(e);return function(e,t){var n=Object(c.Xb)(e);if(Object(c.Jb)(n,t))return c.ab;var r=function(e){return Object(c.Nb)(n,Object(c.e)(t,-e),t)};if(r(3))return c.ib;if(r(30))return c.hb;return c.Y}(t,f())(t)}function O(e){if(!e)return"";var t=Object(c.mc)(e);return function(e,t){var n=Object(c.Xb)(e);if(Object(c.Jb)(n,t))return c.T;return c.U}(t,f())(t)}function S(e){return e?function(e,t){var n=Object(c.Xb)(e);return Object(c.Jb)(n,t)?Object(c.ab)(e):j(n,t,2)?Object(c.lb)(e):j(n,t,7)?Object(c.H)(Object(c.bb)(e),Object(c.ab)(e)):Object(c.H)(Object(c.J)(e),Object(c.ab)(e))}(Object(c.mc)(e),f()):""}function j(e,t,n){return Object(c.Nb)(e,Object(c.e)(t,-n),t)}var I=Object(r.action)("updateTimes"),y=Object(r.action)("setNow"),x=Object(r.action)("setToday",(function(e){return{today:e}}));Object(r.mutator)(y,(function(){s().now=Object(c.kc)()})),Object(r.mutator)(x,(function(e){var t=e.today;s().today=t}));var P=n(32),T=n(126),_=!1;Object(r.orchestrator)(a,(function(){if(I(),!_){var e=Object(c.Qb)(),t=Object(c.Zb)(Object(c.h)(e,1)),n=Object(c.w)(t,e);setTimeout((function(){return setInterval(I,P.g)}),n),document&&document.addEventListener("visibilitychange",I),_=!0}})),Object(r.orchestrator)(T.l,(function(){I()})),Object(r.orchestrator)(I,(function(){y();var e=Object(c.Ab)(Object(c.lc)()),t=s().today!=e;t&&x(e),i(),t&&o()})),n.d(t,"d",(function(){return a})),n.d(t,"j",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"g",(function(){return p})),n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return m})),n.d(t,"h",(function(){return h})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return S}))},699:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},7132:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1764),a=n(1721);function i(){var e=Object(a.d)(),t=Object(r.b)(),n=e?function(e,t){switch(e.type){case a.a.Primary:return t.primaryComposeId;case a.a.Compose:return e.data;default:return null}}(e,t):t.primaryComposeId,i=n?t.viewStates.get(n):null;return i&&!i.isInlineCompose?i:null}},717:function(e,t,n){"use strict";var r=n(37),a={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return a}));var i=new r.c((function(){return Promise.all([n.e(3),n.e(22),n.e(688)]).then(n.bind(null,17340))})),o=new r.a(i,(function(e){return e.subscribe})),c=new r.a(i,(function(e){return e.unsubscribe})),u=new r.b(i,(function(e){return e.getChannelId})),s=(new r.b(i,(function(e){return e.getChannelReady})),new r.a(i,(function(e){return e.setup}))),d=new r.a(i,(function(e){return e.initializeNotificationManager})),l=new r.b(i,(function(e){return e.getNotificationEmitter}))},801:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"TargetFolderId:#Exchange"},e)}},9021:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(3290),i=n(6),o=n(4732),c=n(5049);function u(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(c.a)(e,t,n,!0)];case 1:return u=r.sent(),[3,3];case 2:throw s=r.sent(),{errorMessage:Object(i.b)(a.a),error:s};case 3:if(0===u.Status)return[2,{wacUrl:u.WacUrl,bootScriptUrl:u.BootScriptUrl,wopiSrcUrl:u.WopiSrcUrl,accessToken:u.AccessToken,accessTokenTtl:u.AccessTokenTtl,additionalParameters:u.AdditionalParameters,deprecatedTokenAndParameters:u.Token}];throw{errorMessage:Object(o.a)(u.Status),error:new Error("GetWacAttachmentInfo failed with status: "+u.Status)}}}))}))}}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxS.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxS.js'] = (new Date()).getTime();