self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxSInitialize~Attachments~HtmlEditorLinkPlugin~OwaFluidLink~OwaInsertLink~~78567fbf.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[94],{1014:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n(0),a=n(1),i=n(394),o=n(238),u=n(182),c=n(724);function s(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=e;return o.isSlot?0===(n=a.Children.toArray(n)).length?o(t):o(Object(r.__assign)(Object(r.__assign)({},t),{children:n})):a.createElement.apply(a,Object(r.__spreadArrays)([e,t],n))}function d(e,t){void 0===t&&(t={});var n=t.defaultProp,o=void 0===n?"children":n;return function(t,n,s,d,l){if(a.isValidElement(n))return n;var f=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];for(var a={},o=[],s=0,d=n;s<d.length;s++){var l=d[s];o.push(l&&l.className),Object(c.a)(a,l)}return a.className=Object(i.a)([e,o],{rtl:Object(u.a)(t)}),a}(d,l,t,function(e,t){var n,r;"string"==typeof t||"number"==typeof t||"boolean"==typeof t?((n={})[e]=t,r=n):r=t;return r}(o,n));if(s){if(s.component){var b=s.component;return a.createElement(b,Object(r.__assign)({},f))}if(s.render)return s.render(f,e)}return a.createElement(e,Object(r.__assign)({},f))}}var l=Object(o.c)((function(e){return d(e)}));function f(e,t){var n={},r=e,a=function(e){if(t.hasOwnProperty(e)){var a=function(n){for(var a=[],i=1;i<arguments.length;i++)a[i-1]=arguments[i];if(a.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return b(t[e],n,r[e],r.slots&&r.slots[e],r._defaultStyles&&r._defaultStyles[e],r.theme)};a.isSlot=!0,n[e]=a}};for(var i in t)a(i);return n}function b(e,t,n,r,a,i){return void 0!==e.create?e.create(t,n,r,a):l(e)(t,n,r,a,i)}},1026:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},10464:function(e){e.exports=JSON.parse('{"a":"cea"}')},10468:function(e){e.exports=JSON.parse('{"a":"Yda"}')},10469:function(e){e.exports=JSON.parse('{"a":"bea"}')},1060:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(30),a=n(1026);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("FindItem",e,t)}},1066:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},e)}},1111:function(e){e.exports=JSON.parse('{"a":"Oda"}')},1264:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},1583:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),a=n(1),i=n(12),o=n(357),u=n(167),c=n(1014),s=n(724);function d(e,t){void 0===t&&(t={});var n=t.factoryOptions,d=(void 0===n?{}:n).defaultProp,l=function(n){var c,d,l,f=(c=t.displayName,d=a.useContext(o.a),l=t.fields,u.a.getSettings(l||["theme","styles","tokens"],c,d.customizations)),b=t.state;b&&(n=Object(r.__assign)(Object(r.__assign)({},n),b(n)));var v=n.theme||f.theme,p=function e(t,n){for(var a=[],i=2;i<arguments.length;i++)a[i-2]=arguments[i];for(var o={},u=0,c=a;u<c.length;u++){var d=c[u];d&&(d="function"==typeof d?d(t,n):d,Array.isArray(d)&&(d=e.apply(void 0,Object(r.__spreadArrays)([t,n],d))),Object(s.a)(o,d))}return o}(n,v,t.tokens,f.tokens,n.tokens),m=function(e,t,n){for(var r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];return i.concatStyleSets.apply(void 0,r.map((function(r){return"function"==typeof r?r(e,t,n):r})))}(n,v,p,t.styles,f.styles,n.styles),h=Object(r.__assign)(Object(r.__assign)({},n),{styles:m,tokens:p,_defaultStyles:m,theme:v});return e(h)};return l.displayName=t.displayName||e.name,d&&(l.create=Object(c.a)(l,{defaultProp:d})),Object(s.a)(l,t.statics),l}},1653:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1669:function(e,t,n){"use strict";var r=n(1648),a=n(1838),i=n(6);function o(e){var t;return e>=1073741824?(e/=1073741824,t=Object(i.b)(a.b)):e>=1048576?(e/=1048576,t=Object(i.b)(a.d)):e>=1024?(e/=1024,t=Object(i.b)(a.c)):t=Object(i.b)(a.a),Object(i.c)(t,Math.round(e))}var u,c=n(1713),s=n(18),d=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function l(e){if(!Object(s.i)("doc-attachment-documentThumbnail"))return!1;var t=Object(r.a)(e);return!!t&&d.indexOf(t.toLowerCase())>=0}function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return u.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return u.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return u.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(u||(u={}));var b=n(1683);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return c.a})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return b.b})),n.d(t,"a",(function(){return u}))},1683:function(e,t,n){"use strict";function r(e){return t=e||"",(n=i.exec(t))&&n.length>1&&a[n[1].toLowerCase()];var t,n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},i=/^\s*([^;\s]*)(?:;|\s|$)/;function o(e){var t="";return Object.entries(a).forEach((function(n){n[1]===e&&(t=n[0])})),t}},1713:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(1648),a=n(1683),i=n(105),o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],u=[".tiff",".tif"];function c(e,t,n){return void 0===n&&(n=!0),s(Object(r.a)(e)||Object(a.a)(t),n)}function s(e,t){return void 0===t&&(t=!0),!!e&&(o.indexOf(e.toLowerCase())>=0||t&&u.indexOf(e.toLowerCase())>=0&&(Object(i.e)()||Object(i.d)()||Object(i.h)()||Object(i.g)()&&!Object(i.l)()))}},1724:function(e,t,n){"use strict";var r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function a(e){var t=null,n=r.exec(e);if(n){var a=n[1],i=n[2],o=null;try{o=atob(i)}catch(e){}if(o){for(var u=new ArrayBuffer(o.length),c=new Uint8Array(u),s=0;s<o.length;s++)c[s]=o.charCodeAt(s);t=new File([u],"image.png",{type:a})}}return t}var i=n(1653),o=n(1669);function u(e){return e.map((function(e){return{fileType:i.a.Uri,name:e.name,type:Object(o.b)(e.url)||"",size:0,uri:e.url}}))}var c=n(20);function s(e,t,n){if(e.length!=t.length)return c.d("The sizes of subjects and latestItemIds are different"),null;for(var r=[],a=0;a<e.length;a++){var o={fileType:i.a.MailItem,name:e[a],size:(null==n?void 0:n[a])||0,itemId:t[a]};r.push(o)}return r}function d(e,t,n){var r=[],a={fileType:i.a.MailItem,name:e,size:n||0,mimeContent:t};return r.push(a),r}function l(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],a={fileType:i.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(a)}return t}function f(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],a={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(a)}return t}function b(e){var t,n;return null===e?null:{fileType:i.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function v(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:i.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var p={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function m(e){switch(e?e.toLowerCase():null){case p.ONE_DRIVE_PRO.toLowerCase():return 0;case p.GDRIVE.toLowerCase():return 5;case p.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case p.DROPBOX.toLowerCase():return 2;case p.BOX.toLowerCase():return 3;case p.WOPI_BOX.toLowerCase():return 7;case p.WOPI_EGNYTE.toLowerCase():return 8;case p.MAILBOX.toLowerCase():return 4;case p.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"f",(function(){return a})),n.d(t,"j",(function(){return u})),n.d(t,"i",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return i.a}))},1759:function(e,t,n){"use strict";var r=n(2),a=n(9),i=n(1834),o={providers:new a.ObservableMap,loadState:i.a.NotLoaded,removalPending:new a.ObservableMap},u=Object(r.createStore)("fileProviderStore",o);t.a=u},1760:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o}));var r=n(2),a=Object(r.action)("FILE_PROVIDER_ADDED",(function(e){return{providerViewState:e}})),i=Object(r.action)("FILE_PROVIDER_REMOVED",(function(e){return{providerType:e}})),o=Object(r.action)("PROVIDERS_LOADED",(function(e){return{providers:e}}))},1782:function(e,t,n){"use strict";n.d(t,"l",(function(){return b})),n.d(t,"n",(function(){return v})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return m}));var r=n(37),a=n(1960);n.d(t,"b",(function(){return a.a}));var i=n(1924);n.d(t,"i",(function(){return i.a}));n(1759);var o=n(1760);n.d(t,"d",(function(){return o.a})),n.d(t,"e",(function(){return o.b})),n.d(t,"o",(function(){return o.c}));var u=n(1925);n.d(t,"a",(function(){return u.b}));var c=n(1817);n.d(t,"g",(function(){return c.a})),n.d(t,"h",(function(){return c.b}));var s=n(1908);n.d(t,"j",(function(){return s.a}));var d=n(1834);n.d(t,"c",(function(){return d.a}));var l=n(1902);n.d(t,"f",(function(){return l.b}));var f=new r.c((function(){return Promise.all([n.e(3),n.e(584)]).then(n.bind(null,3200))})),b=new r.b(f,(function(e){return e.loadProviders})),v=new r.b(f,(function(e){return e.removeFileProvider})),p=new r.b(f,(function(e){return e.addFileProvider})),m=new r.b(f,(function(e){return e.removeAndAddFileProvider}))},1817:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(0),a=n(1759),i=function(){return Object(r.__spread)(Object(a.a)().providers.values())},o=function(e){return Object(a.a)().providers.get(e)||null}},1834:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded",e[e.Throttled=3]="Throttled"}(r||(r={}))},1838:function(e){e.exports=JSON.parse('{"b":"tba","d":"uba","c":"vba","a":"wba"}')},1902:function(e,t,n){"use strict";var r=n(0),a=n(30);function i(e){return Object(r.__assign)({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function o(e){var t,n,r=i({ProviderType:e});return void 0===(t=r)||t.__type||(t=i(t)),Object(a.a)("GetNewAttachmentDataProviderCreationInfo",t,n)}function u(e){return Object(r.__assign)({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function c(e){var t,n,r=u({ProviderType:e});return void 0===(t=r)||t.__type||(t=u(t)),Object(a.a)("GetAttachmentDataProviderCreator",t,n)}var s=n(2244),d=n(2185);n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return w}));var l="code",f="token",b=3e3,v=3;function p(e){return{state:e}}function m(e){return e.state}function h(e){return e.code}function O(e,t,n,a,i){var u={providerType:e,getAuthUrlInfo:null,getCSRFToken:m,getOAuthCode:h};return function e(t,n,a,i,u,d,l){return Object(r.__awaiter)(this,void 0,void 0,(function(){var f,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),f=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,c(t)];case 1:return v=r.sent(),f=v.AttachmentDataProviderCreator.ProviderAppKey,a=v.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,o(t)];case 3:v=r.sent(),f=v.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(s.d)(t,a,i,f,u,d),[3,6];case 5:return r.sent(),l>0&&setTimeout((function(){return e(t,n,a,i,u,d,--l)}),b),[3,6];case 6:return[2]}}))}))}(e,u,t,n,a,i,v),u}var g=null;function j(){if(!g){if(g={},Object(d.a)(3)&&(g[3]=O(3,"https://app.box.com/api/oauth2/authorize",Object(s.c)(3),l,p)),Object(d.a)(2)&&(g[2]=O(2,"https://www.dropbox.com/oauth2/authorize",Object(s.b)(2),l,p)),Object(d.a)(6)){var e=O(6,"https://www.facebook.com/dialog/oauth",Object(s.b)(6),f,(function(e){return{state:e,scope:"user_photos,email"}}));e.getCSRFToken=m,e.getOAuthCode=function(e){return e.access_token},g[6]=e}if(Object(d.a)(5)){var t=O(5,"https://accounts.google.com/o/oauth2/auth",s.a+"/ADPRedirect.aspx",l,(function(e){var t={state:e,provider:5..toString(),url:Object(s.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));t.getCSRFToken=function(e){return JSON.parse(e.state).state},g[5]=t}Object(d.a)(1)&&(g[1]=O(1,"https://login.live.com/oauth20_authorize.srf",Object(s.c)(1),l,(function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(d.a)(7)&&(g[7]=O(7,"",Object(s.c)(7),l,p)),Object(d.a)(8)&&(g[8]=O(8,"",Object(s.c)(8),l,p)),Object(d.a)(9)&&(g[9]=O(9,"",Object(s.c)(9),l,p))}return g}function w(e){var t=j();return e in t?t[e]:null}},1908:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1759);function a(){return Object(r.a)().loadState}},1924:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2282),a=n(2218),i=n(2258),o=n(6),u=n(111);function c(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(o.b)(i.b);case 1:return Object(o.b)(i.a);case 2:case 9:return Object(o.b)(r.b);case 3:case 7:return Object(o.b)(r.a);case 5:return Object(o.b)(r.e);case 6:return Object(o.b)(r.d);case 4:return Object(o.b)(r.f);case 10:return Object(o.b)(a.b);case 8:return Object(o.b)(r.c);default:return Object(u.a)(e)}}},1925:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var r,a=n(0);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze(Object(a.__spread)(i,[0,4,10]))},1960:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},2017:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(235),a=n(365);function i(e){if("ArchiveMailbox"==e.type)return Object(r.a)();var t=e.userIdentity&&Object(a.r)(e.userIdentity),n="GroupMailbox"===e.type;return t&&!n?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},2021:function(e,t,n){"use strict";var r=n(365),a=n(0),i={};function o(e){return i[e]}function u(e,t){var n=i[e];i[e]=Object(a.__assign)(Object(a.__assign)({},n),t)}var c=n(71),s=n(30);var d=n(127),l=n(20),f=n(622),b=n(1662),v=n(1663);function p(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return(t={}).headers=new Headers,[4,Object(b.a)(e)];case 1:return n=r.sent(),Object(v.b)(t.headers,n),[2,t]}}))}))}var m=Object(f.b)({timeBetweenRetryInMS:function(){return 3e4}});function h(e,t){t=t<1?1:t,setInterval((function(){!function(e){Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,i,c,f,b,v=this;return Object(a.__generator)(this,(function(h){switch(h.label){case 0:if(t=function(){return Object(a.__awaiter)(v,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),t={},Object(r.r)(e.userIdentity)?[4,p(e.userIdentity)]:[3,2];case 1:t=a.sent(),a.label=2;case 2:return[2,(i=t,Object(s.a)("GetAttachmentDownloadToken",{},i))];case 3:throw n=a.sent(),l.g.warn("Unable to get the download token "+n),n.networkError=!0,n;case 4:return[2]}var i}))}))},null==(n=o(e.userIdentity))?void 0:n.isRefreshingDownloadToken)return[3,4];u(e.userIdentity,{isRefreshingDownloadToken:!0}),i=0,c=m((function(){return Object(a.__awaiter)(v,void 0,void 0,(function(){var n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return i++,[4,t()];case 1:return n=r.sent(),l.g.info("update new token"),u(e.userIdentity,{downloadToken:n,isRefreshingDownloadToken:!1}),[2]}}))}))})).retriableFunc,f=new d.c("AttachmentRefreshDownloadToken"),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,c()];case 2:return h.sent(),f.addCustomData([i]),f.end(),[3,4];case 3:return b=h.sent(),l.g.warn("Retry to refresh token failed: "+b),f.addCustomData([i]),f.endWithError("ServerError",b),u(e.userIdentity,{isRefreshingDownloadToken:!1}),[3,4];case 4:return[2]}}))}))}(e)}),6e4*t)}var O=n(111);function g(e){var t=Object(r.j)(null==e?void 0:e.userIdentity),n=o(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Outlook":!function(e){var t=Object(r.r)(e.userIdentity)?Object(c.i)(e.userIdentity):Object(c.h)(),n=null==t?void 0:t.ApplicationSettings;if(n){var a=n.DownloadUrlBase;u(e.userIdentity,{downloadUrlBase:a,downloadToken:n.FirstDownloadToken}),a&&h(e,n.DownloadTokenRefreshMinutes)}}(e);break;case"Google":case"ICloud":break;default:Object(O.a)(t)}var a=o(e.userIdentity);return a||(Object(d.r)("FilesUrlDataNotFound",{accountProviderType:t}),l.g.warn("Unable to get the url data")),a}function j(e){if(!e)return null;var t=g(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return j}))},2108:function(e,t,n){"use strict";var r=n(1),a=r.createContext(window);t.a=a},2185:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1682),a=n(222),i=n(111),o=n(18);function u(e){var t=Object(r.a)();switch(e){case 5:return(null==t?void 0:t.GoogleDriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==t?void 0:t.BoxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-box");case 2:return(null==t?void 0:t.DropboxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-dropbox");case 6:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-facebook");case 1:return!!Object(a.a)()||(null==t?void 0:t.OnedriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled);case 10:return Object(o.i)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},2218:function(e){e.exports=JSON.parse('{"a":"Sca","b":"Tca"}')},2220:function(e,t,n){"use strict";var r=n(2243);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var a=n(2021);n.d(t,"c",(function(){return a.a}));var i=n(2017);n.d(t,"d",(function(){return i.a}))},2243:function(e,t,n){"use strict";var r=n(111),a=n(6),i=n(55),o="/owa/",u="service.svc/s/GetFileAttachment?id={0}",c="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",l="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",b="pdfprint.aspx?id={0}&location={1}",v=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var p=n(222),m=n(64),h=n(3),O=n(29),g=n(2021),j=n(2017);function w(e,t,n,r,u){if(void 0===r&&(r=!1),void 0===u&&(u=null),!e||!e.Id||!e.mailboxInfo)return null;var c=Object(g.b)(e.mailboxInfo),s=null==c?void 0:c.downloadUrlBase,d=Object(j.a)(e.mailboxInfo);if(u=u||Object(a.c)(t,encodeURIComponent(e.Id)),!s||r&&"Firefox"===Object(m.a)().browser){var l=o+u+"&X-OWA-CANARY="+Object(i.a)();return Object(O.a)(l)}var f="{0}{1}/{2}";Object(p.a)()&&(f+="&isc=1");var b=Object(a.c)(f,s,d,u);return n&&(b+="&token="+(null==c?void 0:c.downloadToken),b+="&X-OWA-CANARY="+Object(i.a)()),Object(m.i)()||(b+="&owa="+window.location.hostname,b+="&scriptVer="+Object(h.p)()||!1),b}function y(e,t,n,u,s,l,f,p,m){var h;switch(void 0===s&&(s=0),void 0===l&&(l=0),void 0===f&&(f=!0),void 0===p&&(p=null),void 0===m&&(m=null),n){case 0:h=c;break;case 3:h=b;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&v.indexOf(t.toLowerCase())>=0}(p))return null;h=d;break;default:Object(r.a)(n)}var g=u?l:s;!g&&s&&(g=s);var j=Object(a.c)("{0}&permissionLevel={1}",Object(a.c)(h,encodeURIComponent(e.Id),encodeURIComponent(t)),g),y=w(e,h,!0,3===n,j);if(y)return y;var x=Object(a.c)("{0}{1}{2}",o,m,j);f&&(x=x+"&X-OWA-CANARY="+Object(i.a)());return Object(O.a)(x)}function x(e,t,n,i){var o;switch(void 0===n&&(n=!1),void 0===i&&(i=!0),t){case 0:o=u;break;case 1:o=s;break;case 2:o=l;break;case 3:o=f;break;default:return Object(r.a)(t)}if(!Object(a.f)(o)){var c=w(e,o,i,3===t);return Object(a.c)("{0}{1}{2}",c,n?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return x}))},2244:function(e,t,n){"use strict";var r=n(497),a=n(3);function i(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s}));var o=Object(a.H)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function u(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.l)()+"/mail/"+n+t}function c(e){var t=Object(r.l)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return o+"/ADPRedirect.aspx?"+n}function s(e,t,n,r,a,o){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),u=i(t,"client_id",r);if(u=i(u,"redirect_uri",n),u=i(u,"response_type",a),o){var c=o(e);u=Object.keys(c).reduce((function(e,t){return i(e,t,c[t])}),u)}return{authUrl:u,redirectUrl:n,csrfToken:e}}}},2258:function(e){e.exports=JSON.parse('{"b":"vda","a":"wda"}')},2282:function(e){e.exports=JSON.parse('{"b":"pda","a":"qda","e":"rda","d":"sda","f":"tda","c":"uda"}')},2519:function(e,t,n){"use strict";var r=n(111),a=n(2220),i=n(55),o=n(2916);function u(e,t,n,i,u){var c;void 0===u&&(u=!0);var s=t,d=s.Name,l=s.OriginalPermissionType,f=s.PermissionType,b=Object(o.a)(t),v="GroupMailbox"===(null===(c=null==e?void 0:e.mailboxInfo)||void 0===c?void 0:c.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return a.b(e,b,n,i,f,l,u,d,v);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:a.b(e,b,1,i,f,l,u,d,v);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function c(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),a.a(e,t,n,r)}function s(e,t,n,r,o){void 0===o&&(o=!1);var s=n?u(e,t,1,r,!1):c(e,1,o,!1);if(n)return{url:s,init:{credentials:"include"}};var d=Object(a.c)(e.mailboxInfo),l=new Headers;return l.set("X-Token",d),l.set("X-OWA-CANARY",Object(i.a)()),{url:s,init:{headers:l}}}function d(e,t,n,r,a,i){return void 0===i&&(i=!1),r?u(e,t,n,a):c(e,n,i)}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s}))},2916:function(e,t,n){"use strict";function r(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},3305:function(e,t,n){"use strict";var r="OLK_Beautified_",a="olkBeautifulLink",i="true",o=n(1111),u=n(6),c=n(18);function s(e,t,n){return{name:Object(u.b)(o.a),key:"OpenInNewTab",iconProps:Object(c.i)("wvn-chicletEditOptions")||Object(c.i)("wvn-chicletEditOptionsNoDownload")?{iconName:"TabCenter"}:void 0,onClick:function(){(t||window).open(e,"_blank"),n&&n()}}}function d(e){var t;return"a"===e.tagName.toLowerCase()&&0===(null===(t=e.id)||void 0===t?void 0:t.indexOf(r))}function l(e,t,n){return d(t)&&t.setAttribute(a,i),null}n.d(t,"a",(function(){return"owaAttachmentRemoveOnSend"})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return"OWA"})),n.d(t,"f",(function(){return"OWAInsertLinkPlaceHolder"})),n.d(t,"g",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"h",(function(){return d}))},6029:function(e){e.exports=JSON.parse('{"a":"_da"}')},6030:function(e){e.exports=JSON.parse('{"a":"Zda"}')},622:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(o,u){a?u(new Error("The function retry was cancelled")):(r++,e().then((function(e){return o(e)})).catch((function(e){t&&r>=t?u(e):setTimeout((function(){return i(o,u)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return i(e,t)}))},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},724:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=n(0).__assign},7345:function(e){e.exports=JSON.parse('{"a":"Tda"}')},7346:function(e){e.exports=JSON.parse('{"a":"Rda"}')},902:function(e,t,n){"use strict";var r=n(0),a=n(1),i=n(1014),o=n(1583),u=n(53),c=n(12),s={root:"ms-StackItem"},d={start:"flex-start",end:"flex-end"};n.d(t,"a",(function(){return l}));var l=Object(o.a)((function(e){var t=e.children,n=Object(u.j)(e,u.k);if(a.Children.count(t)<1)return null;var o=Object(i.b)(e,{root:"div"});return Object(i.c)(o.root,Object(r.__assign)({},n),t)}),{displayName:"StackItem",styles:function(e,t,n){var r=e.grow,a=e.shrink,i=e.disableShrink,o=e.align,u=e.verticalFill,l=e.order,f=e.className,b=Object(c.getGlobalClassNames)(s,t);return{root:[t.fonts.medium,b.root,{margin:n.margin,padding:n.padding,height:u?"100%":"auto",width:"auto"},r&&{flexGrow:!0===r?1:r},(i||!r&&!a)&&{flexShrink:0},a&&!i&&{flexShrink:1},o&&{alignSelf:d[o]||o},l&&{order:l},f]}}})},911:function(e,t,n){"use strict";var r=n(0),a=n(1),i=n(1014),o=n(1583),u=n(453),c=n(53),s=function(e,t){return t.spacing.hasOwnProperty(e)?t.spacing[e]:e},d=function(e){var t=parseFloat(e),n=isNaN(t)?0:t,r=isNaN(t)?"":t.toString();return{value:n,unit:e.substring(r.toString().length)||"px"}},l=function(e,t){if(void 0===e||"number"==typeof e||""===e)return e;var n=e.split(" ");return n.length<2?s(e,t):n.reduce((function(e,n){return s(e,t)+" "+s(n,t)}))},f=n(12),b={start:"flex-start",end:"flex-end"},v={root:"ms-Stack",inner:"ms-Stack-inner"},p=n(902);n.d(t,"a",(function(){return h}));var m={Item:p.a},h=Object(o.a)((function(e){var t=e.as,n=void 0===t?"div":t,o=e.disableShrink,s=e.wrap,d=Object(r.__rest)(e,["as","disableShrink","wrap"]);Object(u.a)("Stack",e,{gap:"tokens.childrenGap",maxHeight:"tokens.maxHeight",maxWidth:"tokens.maxWidth",padding:"tokens.padding"});var l=a.Children.map(e.children,(function(e,t){if(!e)return null;if((i=e)&&"object"==typeof i&&i.type&&i.type.displayName===p.a.displayName){var n={shrink:!o};return a.cloneElement(e,Object(r.__assign)(Object(r.__assign)({},n),e.props))}var i;return e})),f=Object(c.j)(d,c.k),b=Object(i.b)(e,{root:n,inner:"div"});return s?Object(i.c)(b.root,Object(r.__assign)({},f),Object(i.c)(b.inner,null,l)):Object(i.c)(b.root,Object(r.__assign)({},f),l)}),{displayName:"Stack",styles:function(e,t,n){var a,i,o,u,c,p,m,h=e.verticalFill,O=e.horizontal,g=e.reversed,j=e.grow,w=e.wrap,y=e.horizontalAlign,x=e.verticalAlign,_=e.disableShrink,I=e.className,A=Object(f.getGlobalClassNames)(v,t),S=n&&n.childrenGap?n.childrenGap:e.gap,k=n&&n.maxHeight?n.maxHeight:e.maxHeight,P=n&&n.maxWidth?n.maxWidth:e.maxWidth,C=n&&n.padding?n.padding:e.padding,E=function(e,t){if(void 0===e||""===e)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if("number"==typeof e)return{rowGap:{value:e,unit:"px"},columnGap:{value:e,unit:"px"}};var n=e.split(" ");if(n.length>2)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if(2===n.length)return{rowGap:d(s(n[0],t)),columnGap:d(s(n[1],t))};var r=d(s(e,t));return{rowGap:r,columnGap:r}}(S,t),T=E.rowGap,N=E.columnGap,R=""+-.5*N.value+N.unit,D=""+-.5*T.value+T.unit,G={textOverflow:"ellipsis"},L={"> *:not(.ms-StackItem)":{flexShrink:_?0:1}};return w?{root:[A.root,{flexWrap:"wrap",maxWidth:P,maxHeight:k,width:"auto",overflow:"visible",height:"100%"},y&&(a={},a[O?"justifyContent":"alignItems"]=b[y]||y,a),x&&(i={},i[O?"alignItems":"justifyContent"]=b[x]||x,i),I,{display:"flex"},O&&{height:h?"100%":"auto"}],inner:[A.inner,{display:"flex",flexWrap:"wrap",marginLeft:R,marginRight:R,marginTop:D,marginBottom:D,overflow:"visible",boxSizing:"border-box",padding:l(C,t),width:0===N.value?"100%":"calc(100% + "+N.value+N.unit+")",maxWidth:"100vw",selectors:Object(r.__assign)({"> *":Object(r.__assign)({margin:""+.5*T.value+T.unit+" "+.5*N.value+N.unit},G)},L)},y&&(o={},o[O?"justifyContent":"alignItems"]=b[y]||y,o),x&&(u={},u[O?"alignItems":"justifyContent"]=b[x]||x,u),O&&{flexDirection:g?"row-reverse":"row",height:0===T.value?"100%":"calc(100% + "+T.value+T.unit+")",selectors:{"> *":{maxWidth:0===N.value?"100%":"calc(100% - "+N.value+N.unit+")"}}},!O&&{flexDirection:g?"column-reverse":"column",height:"calc(100% + "+T.value+T.unit+")",selectors:{"> *":{maxHeight:0===T.value?"100%":"calc(100% - "+T.value+T.unit+")"}}}]}:{root:[A.root,{display:"flex",flexDirection:O?g?"row-reverse":"row":g?"column-reverse":"column",flexWrap:"nowrap",width:"auto",height:h?"100%":"auto",maxWidth:P,maxHeight:k,padding:l(C,t),boxSizing:"border-box",selectors:Object(r.__assign)((c={"> *":G},c[g?"> *:not(:last-child)":"> *:not(:first-child)"]=[O&&{marginLeft:""+N.value+N.unit},!O&&{marginTop:""+T.value+T.unit}],c),L)},j&&{flexGrow:!0===j?1:j},y&&(p={},p[O?"justifyContent":"alignItems"]=b[y]||y,p),x&&(m={},m[O?"alignItems":"justifyContent"]=b[x]||x,m),I]}},statics:m})}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxSInitialize~Attachments~HtmlEditorLinkPlugin~OwaFluidLink~OwaInsertLink~~78567fbf.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxSInitialize~Attachments~HtmlEditorLinkPlugin~OwaFluidLink~OwaInsertLink~~78567fbf.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxSInitialize~Attachments~HtmlEditorLinkPlugin~OwaFluidLink~OwaInsertLink~~78567fbf.js'] = (new Date()).getTime();