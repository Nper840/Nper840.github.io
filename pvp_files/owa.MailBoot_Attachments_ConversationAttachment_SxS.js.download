self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Attachments~ConversationAttachment~SxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[159],{10791:function(e,t,n){"use strict";var r=n(148);t.a=Object(r.action)("setShouldShowActionsContainer")((function(e,t){e.shouldShowActionsContainer=t}))},10792:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1750),a=n(1684);function i(e){var t=Object(a.a)(e.attachmentId);return!!t&&(!!Object(r.d)(t.model)||t.download.url&&t.info&&t.info.allowDownload)}},10793:function(e,t,n){"use strict";t.a={SurfaceAction:"Surface action",ContextMenu:"Context menu"}},10794:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n(8995),a=n(6),i=n(127),o=n(2004),c=n(7340),u=n(2630),d=n(10793),s=n(1684),l=n(3343),f=n(3342);function m(e,t){var n=Object(s.a)(e.attachmentId),r=Object(l.a)(n);Object(i.r)("AddToCalendar",[t],{cosmosOnlyData:JSON.stringify({size:n.model.Size,fileType:r})}),n.model.Size>10485760||!e.attachmentId||!e.attachmentId.Id?Object(u.a)(e,0,15):(Object(o.B)(Object(o.j)(n.model.Size),.1,(function(t){Object(o.x)(e,t)}),e.attachmentId),Object(c.a)(e,0))}function b(e){var t=Object(s.a)(e.attachmentId);return Object(f.a)(o.a.ImportCalendarEventAttachment,e)&&t&&13===t.attachmentClass?{name:Object(a.b)(r.a),key:"AddToCalendar",onClick:function(){m(e,d.a.ContextMenu)}}:null}},10944:function(e){e.exports=JSON.parse('{"a":"Cub"}')},10945:function(e){e.exports=JSON.parse('{"a":"cvb"}')},15324:function(e){e.exports=JSON.parse('{"a":"Fub","c":"Gub","d":"Hub","b":"Iub","e":"Jub"}')},15325:function(e,t,n){var r=n(15326),a=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},15326:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,'._2KRgryadS8K-_TLdBoNKmd{font-size:14px;color:"[theme:neutralSecondary, default:#605e5c]";height:25px;width:26px}html[dir] ._2KRgryadS8K-_TLdBoNKmd{padding:4px;text-align:center}._2KRgryadS8K-_TLdBoNKmd:focus,._2KRgryadS8K-_TLdBoNKmd:hover,._1eq1P1PoHUzBriyfNWVd1T{color:"[theme:neutralSecondary, default:#605e5c]"}._1eq1P1PoHUzBriyfNWVd1T{display:block}.HDG8P1QaVRBOeSU0W5zmW{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW{right:26px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW{left:26px}.HDG8P1QaVRBOeSU0W5zmW:focus,.HDG8P1QaVRBOeSU0W5zmW:hover{color:"[theme:white, default:#ffffff]"}html[dir] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir] .HDG8P1QaVRBOeSU0W5zmW:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-right-radius:2px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-left-radius:2px}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{right:52px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{left:52px}._2ebptdF8eCnt_2-FT7dzaH{font-size:14px}html[dir] ._2ebptdF8eCnt_2-FT7dzaH{margin:0}html[dir] .IPPU7NtLHAzlPwHTIXmXp:focus,html[dir] .IPPU7NtLHAzlPwHTIXmXp:hover{background:"[theme:neutralTertiaryAlt, default:#c8c6c4]"}html[dir] .rPIl3tr-13EegQ4JcXUy_,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq,html[dir] ._17q1sDoo-1SD8o99_vx_Wl,html[dir] ._1H8nRWpPKM9iogJAm6ze6p,html[dir] ._3bO0ii_CywH_7ysZAUsxkB,html[dir] ._1E-xlZkNQ0oWd42XQohXqv{margin:0;background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .rPIl3tr-13EegQ4JcXUy_:focus,html[dir] .rPIl3tr-13EegQ4JcXUy_:hover,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:focus,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:hover,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:focus,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:hover,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:focus,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:hover,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:focus,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:hover,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:focus,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:hover{background:"[theme:themeTertiary, default:#71AFE5]"}html[dir] .rPIl3tr-13EegQ4JcXUy_{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}',""]),t.locals={actionButton:"_2KRgryadS8K-_TLdBoNKmd",actionButtonForDocViewInCompose:"_1eq1P1PoHUzBriyfNWVd1T",actionButtonForImageView:"HDG8P1QaVRBOeSU0W5zmW",extraRightPadding:"_2RdXhaKvBvt2MX9AyW7pcR",icon:"_2ebptdF8eCnt_2-FT7dzaH",default:"IPPU7NtLHAzlPwHTIXmXp",edit:"rPIl3tr-13EegQ4JcXUy_",notSelectedAndSaving:"_3vsJWDG9Ae71RWCd-gnOXq",selected:"_17q1sDoo-1SD8o99_vx_Wl",selectedAndPending:"_1H8nRWpPKM9iogJAm6ze6p",selectedAndSaving:"_3bO0ii_CywH_7ysZAUsxkB",thematic:"_1E-xlZkNQ0oWd42XQohXqv"}},1684:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1839);function a(e){return Object(r.a)().attachments.get(e.Id)}},1766:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},e)}},1803:function(e,t,n){"use strict";var r;function a(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1852:function(e,t){e.exports=function(e){return e instanceof Date}},1923:function(e,t,n){var r=n(1852),a=36e5,i=6e4,o=2,c=/[T ]/,u=/:/,d=/^(\d{2})$/,s=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],m=/^-(\d{2})$/,b=/^-?(\d{3})$/,h=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,p=/^-?W(\d{2})-?(\d{1})$/,O=/^(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/([Z+-].*)$/,S=/^(Z)$/,I=/^([+-])(\d{2})$/,A=/^([+-])(\d{2}):?(\d{2})$/;function C(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var x=function(e){var t,n={},r=e.split(c);u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var a=j.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),T=function(e,t){var n,r=s[t],a=f[t];if(n=l.exec(e)||a.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=d.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(x.date,n),y=T.year,_=function(e,t){if(null===t)return null;var n,r,a,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=m.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=b.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=h.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,a,c),r}if(n=v.exec(e))return i=parseInt(n[1],10)-1,C(t,i);if(n=p.exec(e)){i=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return C(t,i,u)}return null}(T.restDateString,y);if(_){var W,P=_.getTime(),D=0;return x.time&&(D=function(e){var t,n,r;if(t=O.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=w.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*i;if(t=g.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*a+r*i+1e3*o}return null}(x.time)),x.timezone?W=function(e){var t,n;if(t=S.exec(e))return 0;if(t=I.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=A.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(x.timezone):(W=new Date(P+D).getTimezoneOffset(),W=new Date(P+D+W*i).getTimezoneOffset()),new Date(P+D+W*i)}return new Date(e)}},1941:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1961:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),a=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1962:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1997:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1876);function a(e){return o(e.type)}function i(e){return o(Object(r.a)(e))}function o(e){return 1===e||3===e}},2042:function(e,t,n){"use strict";n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"l",(function(){return p}));var r=n(37),a=n(1961);n.d(t,"n",(function(){return a.a}));var i=n(1941);n.d(t,"a",(function(){return i.a}));var o=n(1803);n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return o.a}));var c=n(1962);n.d(t,"b",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(3),n.e(34),n.e(72),n.e(766)]).then(n.bind(null,3198))})),d=new r.b(u,(function(e){return e.getSharingInformation})),s=new r.b(u,(function(e){return e.getSharingIssuesForSharingData})),l=new r.b(u,(function(e){return e.getInfoBarCreator})),f=new r.b(u,(function(e){return e.hasLargeDLRecipient})),m=new r.b(u,(function(e){return e.hasRecipientExpansionFailure})),b=new r.b(u,(function(e){return e.getGroupsAndSmallDLs})),h=new r.b(u,(function(e){return e.getInvididualRecipients})),v=new r.b(u,(function(e){return e.hasGetRecipientPermissionFailed})),p=new r.b(u,(function(e){return e.logSharingTipChangesForLinkRemoval}))},2532:function(e,t,n){"use strict";function r(e,t){(t||window).open(e,"_blank")}n.d(t,"a",(function(){return r}))},2661:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2532),a=n(127),i=n(105);function o(e,t,n,o){var c;if(Object(a.r)("downloadFileFromUrl",{isBrowserIE:Object(i.g)(),urlLength:e.length}),t||Object(i.g)())Object(r.a)(e);else{var u=document.createElement("a");u.style.display="none",u.href=e,u.download=o||"",n||(n=(null===(c=document.activeElement)||void 0===c?void 0:c.parentElement)||document.body),n.appendChild(u),u.click(),n.removeChild(u)}}},3342:function(e,t,n){"use strict";function r(e,t){return-1!==t.strategy.supportedMenuActions.indexOf(e)}n.d(t,"a",(function(){return r}))},3415:function(e,t,n){"use strict";var r=n(37),a=n(1805),i=n(0),o=n(1750),c=n(1684),u=n(2661),d=n(321),s=n(2280),l=n(4263),f=n(18);function m(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(r=Object(c.a)(e))?Object(d.a)("nativeHostAttachmentHijack")&&Object(f.i)("mon-rp-downloadAttachmentsOverHx")?[4,l.c.import()]:[3,3]:[2];case 1:return i.sent()(e)?[4,l.a.import()]:[3,3];case 2:return i.sent()(e.Id),[2];case 3:return Object(o.d)(r.model)?[4,s.e.import()]:[3,5];case 4:return i.sent()(r.model),[3,6];case 5:(a=r.download.url)&&Object(u.a)(a,t,n),i.label=6;case 6:return[2]}}))}))}n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return a.c})),n.d(t,"b",(function(){return m}));var b=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(20),n.e(22),n.e(26),n.e(31),n.e(34),n.e(41),n.e(44),n.e(45),n.e(56),n.e(64),n.e(65),n.e(70),n.e(94),n.e(107),n.e(159),n.e(160),n.e(219),n.e(218),n.e(217),n.e(205),n.e(326)]).then(n.bind(null,17642))})),h=new r.a(b,(function(e){return e.clickAttachment})).importAndExecute,v=new r.a(b,(function(e){return e.previewAttachment}))},4263:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(10),a=new r.d((function(){return Promise.all([n.e(9),n.e(10),n.e(14),n.e(18),n.e(19),n.e(506)]).then(n.bind(null,6192))})),i=new r.a(a,(function(e){return e.isHxAttachment})),o=new r.a(a,(function(e){return e.downloadAttachmentFromHx})),c=new r.a(a,(function(e){return e.getHxAttachmentUri}))},4741:function(e,t,n){"use strict";function r(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return r}))},4758:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.saveToCloud=0]="saveToCloud",e[e.download=1]="download",e[e.addToCalendar=2]="addToCalendar",e[e.editAndReply=3]="editAndReply",e[e.openNewTabAndSaveToCloud=4]="openNewTabAndSaveToCloud",e[e.openAndEdit=5]="openAndEdit"}(r||(r={}))},4975:function(e){e.exports=JSON.parse('{"a":"Qqb"}')},5082:function(e){e.exports=JSON.parse('{"f":"fub","a":"gub","e":"hub","d":"iub","c":"jub","b":"kub"}')},717:function(e,t,n){"use strict";var r=n(37),a={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return a}));var i=new r.c((function(){return Promise.all([n.e(3),n.e(22),n.e(688)]).then(n.bind(null,17340))})),o=new r.a(i,(function(e){return e.subscribe})),c=new r.a(i,(function(e){return e.unsubscribe})),u=new r.b(i,(function(e){return e.getChannelId})),d=(new r.b(i,(function(e){return e.getChannelReady})),new r.a(i,(function(e){return e.setup}))),s=new r.a(i,(function(e){return e.initializeNotificationManager})),l=new r.b(i,(function(e){return e.getNotificationEmitter}))},7624:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l}));var r=n(10791),a=n(5047),i=n(5048),o={},c=null;function u(e,t){o[e.attachmentId.Id]&&(clearTimeout(o[e.attachmentId.Id]),o[e.attachmentId.Id]=null),c=e.attachmentId.Id,Object(r.a)(e,!0),t&&!Object(i.a)(e)&&Object(a.a)(e,!0)}function d(e,t){o[e.attachmentId.Id]&&clearTimeout(o[e.attachmentId.Id]),o[e.attachmentId.Id]=setTimeout((function(){Object(r.a)(e,!1),t&&!Object(i.a)(e)&&Object(a.a)(e,!1),e.attachmentId.Id===c&&(c=null),o[e.attachmentId.Id]=null}),40)}function s(e,t){Object(r.a)(e,!0),t&&!Object(i.a)(e)&&Object(a.a)(e,!0)}function l(e,t){e.attachmentId.Id!==c&&(Object(r.a)(e,!1),t&&!Object(i.a)(e)&&Object(a.a)(e,!1))}},7625:function(e){e.exports=JSON.parse('{"a":"frb"}')},7626:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1684),a=n(1669),i=n(4741);function o(e){var t=Object(r.a)(e),n=Object(a.c)(t.model.Name||"");return""!==Object(i.a)(n)&&"Visio"!==Object(i.a)(n)}},7627:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(111),a=n(2004),i=n(10792),o=n(18),c=n(222),u=n(4758),d=n(3342),s=n(7626),l=n(7628);function f(e,t){if(0!==t.ongoingAction||!t.strategy.showActionsMenu)return!0;switch(e){case u.a.addToCalendar:return!1;case u.a.download:return!Object(d.a)(a.a.Download,t)||!Object(i.a)(t);case u.a.saveToCloud:case u.a.openNewTabAndSaveToCloud:return!t.isReadOnly||!function(e,t){var n,r=Object(c.a)()&&"GroupMailbox"===(null===(n=e.attachmentId.mailboxInfo)||void 0===n?void 0:n.type),i=!1;i=t===u.a.openNewTabAndSaveToCloud?Object(l.a)()&&Object(s.a)(e.attachmentId):Object(o.i)("woven-saveToCloud2-viewInOneDrive")||Object(o.i)("woven-saveToCloud2-editInOneDrive")||Object(o.i)("woven-saveToCloud2-editInApp")||Object(o.i)("woven-saveToCloud2-editOnline")||Object(o.i)("woven-saveToCloud2-openFolder")||Object(o.i)("wvn-productizeSTCHoverActionOnly")||m()||Object(o.i)("wvn-productizeSTCHoverAndCloudWithTeaching")||Object(o.i)("wvn-productizeSTCChicletAndPreview")||Object(l.a)();return i&&Object(d.a)(a.a.SaveToCloud,e)&&Object(a.t)(e)&&!r}(t,e);case u.a.editAndReply:return!t.isReadOnly||!Object(s.a)(t.attachmentId);case u.a.openAndEdit:return!t.isReadOnly||!(m()||Object(o.i)("wvn-productizeSTCHoverAndCloudWithTeaching")||Object(o.i)("wvn-productizeSTCChicletAndPreview"))||2!==t.actionMessage&&3!==t.actionMessage;default:return Object(r.a)(e)}}function m(){var e=Object(o.i)("wvn-chicletEditOptions")||Object(o.i)("wvn-chicletEditOptionsNoDownload");return Object(o.i)("wvn-productizeSTCHoverAndCloud")&&!e}},7628:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(719),a=n(18);function i(){return Object(a.i)("woven-newTabExperiment")&&Object(r.d)()}},8993:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"g",(function(){return s}));var r=n(37),a=n(8994);n.d(t,"f",(function(){return a.a}));var i=n(4758);n.d(t,"e",(function(){return i.a}));var o=n(9430);n.d(t,"a",(function(){return o.a}));var c=n(5082);n.d(t,"c",(function(){return c.a})),n.d(t,"d",(function(){return c.e}));var u=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(20),n.e(22),n.e(26),n.e(31),n.e(34),n.e(41),n.e(44),n.e(45),n.e(56),n.e(64),n.e(65),n.e(70),n.e(94),n.e(107),n.e(159),n.e(160),n.e(219),n.e(218),n.e(217),n.e(205),n.e(326)]).then(n.bind(null,16843))})),d=Object(r.d)(u,(function(e){return e.AttachmentView})),s=new r.b(u,(function(e){return e.getContextMenus}))},8994:function(e,t,n){"use strict";t.a={OnClick:{name:"AttachmentOnClick",customData:function(e){return[e]}}}},8995:function(e){e.exports=JSON.parse('{"a":"zub"}')},8996:function(e,t,n){"use strict";var r=n(1647);t.a=function(e){var t,n,a=e&&Object(r.v)(e);return null===(n=null===(t=(null==a?void 0:a.From)||(null==a?void 0:a.Sender))||void 0===t?void 0:t.Mailbox)||void 0===n?void 0:n.EmailAddress}},9430:function(e,t,n){"use strict";var r=n(25),a=n(711),i=n(58),o=n(1745),c=n(20),u=n(1),d=n(4758),s=n(7624),l=n(111),f=n(6),m=n(8995),b=n(7625),h=n(15324),v=n(7626);var p=n(7627),O=n(0),w=n(127),g=n(2004),j=n(10793),S=n(10794),I=n(1684),A=n(3343),C=n(3415),x=n(219),T=n(4441),y=n(578),_=n(33),W="/"+Object(O.__spread)(["mail"],Object(y.a)().split("/").slice(1)).join("/")+"deeplink/saveAndEdit/";var P=n(8996);function D(e,t,n,r){var a,i,u,s=Object(o.k)(r);switch(e){case d.a.addToCalendar:Object(S.a)(t,j.a.SurfaceAction);break;case d.a.download:!function(e,t){var n,r;Object(O.__awaiter)(this,void 0,void 0,(function(){var a,i,o,u,d,s,l,f;return Object(O.__generator)(this,(function(m){switch(m.label){case 0:return(a=Object(I.a)(e.attachmentId))?[4,Object(C.b)(e.attachmentId,e.isCloudy,document.body)]:(c.d("AttachmentSurfaceActionButton.downloadAttachment attachmentModel is null"),[2]);case 1:return m.sent(),i=Object(A.a)(a),Object(w.r)("AttachmentDownload",{entryPoint:"SurfaceAction",isCloudy:e.isCloudy,isCompose:!e.isReadOnly},{cosmosOnlyData:JSON.stringify({size:a.model.Size,fileType:i,attachmentId:null===(n=a.model.AttachmentId)||void 0===n?void 0:n.Id})}),o=null==t?void 0:t.Id,d=(u=w.o).importAndExecute,s=["SavedAttachment"],f={},(l=o)?[4,Object(T.a)(o)]:[3,3];case 2:l=m.sent(),m.label=3;case 3:return d.apply(u,s.concat([(f.itemId=l,f.customProperties={FileId:null===(r=a.model.AttachmentId)||void 0===r?void 0:r.Id,FileType:i,Destination:"Local",Sender:Object(P.a)(o)},f)])),[2]}}))}))}(t,n);break;case d.a.saveToCloud:!function(e,t,n){var r,a=Object(I.a)(e.attachmentId);if(!a)return void c.d("AttachmentSurfaceActionButton.saveToCloud attachmentModel is null");Object(w.r)("AttachmentSaveToCloud",{entryPoint:"SurfaceAction"},{cosmosOnlyData:JSON.stringify({size:a.model.Size,fileType:Object(A.a)(a),attachmentId:null===(r=a.model.AttachmentId)||void 0===r?void 0:r.Id}),isCore:!0}),Object(g.B)(Object(g.p)(e.attachmentId),.1,(function(t){Object(g.x)(e,t)}),e.attachmentId),Object(g.u)(e,(function(t){Object(g.C)(e.attachmentId,t)}),"SurfaceAction",t,Object(P.a)(null==t?void 0:t.Id),n)}(t,n,s);break;case d.a.editAndReply:!function(e,t,n){Object(O.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(O.__generator)(this,(function(a){switch(a.label){case 0:return[4,C.d.import()];case 1:return n=a.sent(),Object(w.r)("WovenEditAndReplyFromSurface",{},{isCore:!0}),r={viewState:e,attachmentSelectionSource:o.b.ReadingPane,parentItemId:t,isDraft:!1,isEdit:!0,onBeforePreview:function(){return null},createImageGallery:function(){return null},instrumentationContext:null,targetWindow:window},n(r),[2]}}))}))}(t,n);break;case d.a.openNewTabAndSaveToCloud:!function(e,t,n){var r=Object(x.a)();!function(e,t,n){var r=""+W;r+=encodeURIComponent(null==n?void 0:n.Id)+"/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)+"/"+Object(_.a)().search,window.open(r,"_blank")}(e.attachmentId.Id,r,t);var a=new w.b("WovenNewTabSaveToCloud",{isCore:!0});Object(g.B)(4*Object(g.p)(e.attachmentId),.1,(function(t){Object(g.x)(e,t)}),e.attachmentId),Object(g.D)(e,(function(t){Object(g.C)(e.attachmentId,t),t?a.end():a.endWithError("ServerError")}),"PencilExperiment",t,r,Object(P.a)(null==t?void 0:t.Id),n)}(t,n,s);break;case d.a.openAndEdit:a=t,i=Object(I.a)(a.attachmentId).model.AttachmentOriginalUrl,u=-1===i.indexOf("?")?"?":"&",window.open(i+u+"web=1","_blank"),Object(w.r)("WovenOpenAndEditFromSurface",{},{isCore:!0});break;default:Object(l.a)(e)}}var R=n(2108),E=n(15325),z=n(396).bind(E);t.a=Object(r.a)((function(e){var t=u.useContext(R.a),n=e.action,r=e.attachmentViewState,O=e.customClassName,w=e.isForImageView,g=e.previewState;if(Object(p.a)(n,r))return null;var j=void 0,S=function(e){switch(e){case o.a.Edit:return E.edit;case o.a.NotSelectedAndSaving:return E.notSelectedAndSaving;case o.a.OtherSaving:return E.attachmentView;case o.a.Selected:return E.selected;case o.a.SelectedAndPending:return E.selectedAndPending;case o.a.SelectedAndSaving:return E.selectedAndSaving;default:return E.default}}(g);if(w){var I={extraRightPadding:B(n,r)};j=z([E.actionButton,E.actionButtonForImageView,O,I])}else j=r.isReadOnly?z([E.actionButton,S,O]):z([E.actionButton,S,E.actionButtonForDocViewInCompose,O]);var A=function(e,t){switch(e){case d.a.addToCalendar:return"AddEvent";case d.a.download:return"Download";case d.a.saveToCloud:return"CloudUpload";case d.a.openNewTabAndSaveToCloud:return"Edit";case d.a.editAndReply:return"PencilReply";case d.a.openAndEdit:return Object(v.a)(t)?"CloudEdit":"Cloud";default:return Object(l.a)(e)}}(n,r.attachmentId),C=function(e,t){switch(e){case d.a.addToCalendar:return Object(f.b)(m.a);case d.a.download:return Object(f.b)(b.a);case d.a.saveToCloud:return Object(f.b)(h.d);case d.a.openNewTabAndSaveToCloud:return Object(f.b)(h.c);case d.a.editAndReply:return Object(f.b)(h.a);case d.a.openAndEdit:return Object(v.a)(t)?Object(f.b)(h.b):Object(f.b)(h.e);default:return Object(l.a)(e)}}(n,r.attachmentId);return u.createElement(a.a,{onFocus:function(){return Object(s.b)(e.attachmentViewState,e.isForImageView)},onBlur:function(){e.shouldNotHandleOnBlur||Object(s.a)(e.attachmentViewState,e.isForImageView)},onKeyDown:function(n){n.keyCode!==i.a.enter&&n.keyCode!==i.a.space||(c.g.info("AttachmentSurfaceActionButton.keyDown enter|space"),n.stopPropagation(),D(e.action,e.attachmentViewState,e.parentItemId,t))},ariaLabel:C,title:C,onClick:function(n){c.g.info("AttachmentSurfaceActionButton.onclick"),n.stopPropagation(),D(e.action,e.attachmentViewState,e.parentItemId,t)},className:j,iconProps:{iconName:A,styles:{root:E.icon}}})}));function B(e,t){return(e===d.a.saveToCloud||e===d.a.editAndReply||e===d.a.openNewTabAndSaveToCloud||e===d.a.openAndEdit)&&!Object(p.a)(d.a.download,t)}}}]);
//# sourceMappingURL=owa.MailBoot~Attachments~ConversationAttachment~SxS.js.map
self.scriptsLoaded['owa.MailBoot~Attachments~ConversationAttachment~SxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Attachments~ConversationAttachment~SxS.js'] = (new Date()).getTime();