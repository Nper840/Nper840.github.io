self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Attachments~filesView~smime.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[160],{10581:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(13791),i=n(1856),c=n(6),a=n(5168),o=n(1724),u=n(1669);function s(t,e,n,r){var c=[],a=[];if(t.forEach((function(t){n(t)?c.push(t):a.push(t)})),a.length>0){var o=r(a.map((function(t){return t.name})).join(", ")),u=o.messageId,s=o.message;Object(i.a)(e,u,[s])}return c}function f(t,e,n){Object(a.a)(n);for(var i=[],f=0;f<t.length;f++)i.push(t[f]);return i=function(t,e){return s(t,e,(function(t){return!(t.fileType===o.a.Local&&0===t.size)}),(function(t){return{messageId:"WarningEmptyFilesCanNotBeAttached",message:Object(c.c)(Object(c.b)(r.a),t)}}))}(i,n),e&&(i=function(t,e){return s(t,e,(function(t){return Object(u.g)(t.name,t.type)}),(function(t){return{messageId:"WarningInlineImageTypeNotSupported",message:Object(c.c)(Object(c.b)(r.b),t)}}))}(i,n)),i}},13791:function(t){t.exports=JSON.parse('{"a":"bmb","b":"cmb"}')},173:function(t,e,n){"use strict";function r(){var t=Object.create(null),e=0,n=0,r=0,i=!1;function c(e){r--,delete t[e]}this.put=function(e,n,i,a){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var o=t[e];o?clearTimeout(o.timeout):r++;var u={value:n,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){c(e),a&&a(e,n)}.bind(this),i)),t[e]=u,n},this.del=function(e){var n=!0,r=t[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&c(e),n},this.clear=function(){for(var c in t)clearTimeout(t[c].timeout);r=0,t=Object.create(null),i&&(e=0,n=0)},this.get=function(c){var a=t[c];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return i&&e++,a.value;i&&n++,r--,delete t[c]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){i=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),i=Date.now(),c=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(c)if(t[a])continue;var o=r[a],u=o.expire-i;if(u<=0){this.del(a);continue}u=u>0?u:void 0,this.put(a,o.value,u)}return this.size()}}t.exports=new r,t.exports.Cache=r},1840:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(111);function i(t){switch(t){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(t)}}},1955:function(t,e,n){"use strict";var r=n(1682);function i(){var t=Object(r.a)();return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var c=n(1840),a=n(1801);function o(){return i()}function u(t){return(t&&t.length>0&&function(t){return t.some((function(t){return!((e=t).IsInline&&!Object(a.a)(e));var e}))}(t)?i():[]).map(c.a)}n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u}))},2201:function(t,e,n){"use strict";var r=n(37),i=[0,1],c=n(2276),a=n(2215),o=n(6),u=n(111),s=n(1693);function f(t){switch(t){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(a.a),messageParts:[Object(o.b)(a.a),l()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(c.b),messageParts:[Object(o.b)(c.b),l()],color:s.a.Red};default:return Object(u.a)(t)}}function l(){return{text:Object(o.b)(c.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var d=n(1955),m=n(1840),b=n(0),h=n(18),p=n(1682);function g(){var t=Object(p.a)();if(Object(h.i)("fwk-devTools")){if(Object(h.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(b.__assign)(Object(b.__assign)({},t),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(h.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(b.__assign)(Object(b.__assign)({},t),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return t}function O(){var t=g();return t.DirectFileAccessOnPrivateComputersEnabled&&t.DirectFileAccessOnPublicComputersEnabled?2:t.WacViewingOnPrivateComputersEnabled&&t.WacViewingOnPublicComputersEnabled?0:1}n.d(e,"g",(function(){return C})),n.d(e,"a",(function(){return i})),n.d(e,"f",(function(){return f})),n.d(e,"b",(function(){return d.a})),n.d(e,"e",(function(){return m.a})),n.d(e,"d",(function(){return O})),n.d(e,"c",(function(){return g}));var v=new r.c((function(){return n.e(1721).then(n.bind(null,17036))})),C=new r.b(v,(function(t){return t.getAccessIssuesForAttachments}))},2215:function(t){t.exports=JSON.parse('{"a":"Wda"}')},2276:function(t){t.exports=JSON.parse('{"a":"Uda","b":"Vda"}')},2615:function(t,e,n){"use strict";n.d(e,"n",(function(){return s})),n.d(e,"m",(function(){return f})),n.d(e,"j",(function(){return l})),n.d(e,"i",(function(){return d})),n.d(e,"k",(function(){return m})),n.d(e,"f",(function(){return b})),n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return p})),n.d(e,"g",(function(){return g})),n.d(e,"d",(function(){return O})),n.d(e,"h",(function(){return v})),n.d(e,"e",(function(){return j})),n.d(e,"l",(function(){return A})),n.d(e,"b",(function(){return y}));var r=n(3479),i=n(3167),c=n(64),a=n(1832),o=n(1970),u=n(2923);function s(){return Object(c.e)()||Object(c.f)()}function f(t){return function(t){if(t.length<2)return!1;var e=t[0]-parseInt(a.b),n=t[1]-parseInt(a.c);return 0==e&&n>=0}("string"==typeof t?t.split(".").map((function(t){return parseInt(t)})):[])}function l(t){var e="string"==typeof t?t.split("."):[];return e.length&&e[0]!=a.b}function d(){return Object(c.r)()&&(Object(c.i)()&&Object(c.b)()[0]==a.i&&Object(i.a)()||Object(r.a)())}function m(t){return 0!==t}function b(t){var e=[];e.push(t.UserEmailAddress),e.push(t.LogonEmailAddress),e.push(t.UserPrincipalName),e.push(t.UserLegacyExchangeDN);var n=t.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(t){e.indexOf(t)>=0||e.push(t)})),e}function h(t){var e=65001;return t.UseGB18030?e=54936:t.UseISO885915&&(e=28605),e}function p(t){return{AllowUserChoiceOfSigningCertificate:t.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:t.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:t.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:t.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:t.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:t.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:t.CopyRecipientHeaders,OnlyUseSmartCard:t.OnlyUseSmartCard,EncryptionAlgorithms:t.EncryptionAlgorithms,SigningAlgorithms:t.SigningAlgorithms}}function g(t,e){var n=Object(u.a)().ClearSign;return e||t&&!n?o.a:a.e}function O(t){return btoa(unescape(encodeURIComponent(t)))}function v(t,e){var n=Object(u.a)();return t&&e?n.TripleWrapSignedEncryptedMail?14:12:t?n.ClearSign?11:10:6}function C(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function j(){return a.m+C()+C()+C()+C()}function A(t,e){return e.IsInline&&-1===t.indexOf(e.ContentId)}function y(){return a.d+C()+"@"+C()+"."+C()}},2923:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(272);function i(){return Object(r.a)().smime}},3167:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(64);function i(){if(Object(r.i)())try{return new ActiveXObject("htmlfile"),!0}catch(t){return!1}return!1}},3333:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1832),i=function(t,e){return t.substring(0,e.length)===e},c=function(t,e){return t.substring(t.length-e.length)===e},a=function(t){return t.ContentType&&(i(t.ContentType,r.v)||i(t.ContentType,r.l))},o=function(t){return t.ContentType&&t.ContentType===r.j};function u(t){return(null==t?void 0:t.Name)&&c(t.Name,r.t)&&(a(t)||o(t))}},3479:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(64),i=n(1832);function c(){return Object(r.e)()&&Object(r.o)([i.f])||Object(r.g)()&&Object(r.o)([i.h])||Object(r.f)()&&Object(r.o)([i.g])}},360:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return a}));var r,i=n(0);function c(t){r=t}function a(){var t,e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(c=r)?[4,r()]:[3,2];case 1:c=i.sent(),i.label=2;case 2:if((n=c)&&n.length>0){if("bearer"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},369:function(t,e,n){"use strict";var r=n(0);function i(t,e){return t?Object(r.__assign)({mailboxInfo:t},e):null!=e?e:void 0}n.d(e,"a",(function(){return i}))},3725:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return c}));var r=1024,i=1048576,c="Not support special characters"},4447:function(t,e,n){"use strict";var r=n(4728),i=n(4442),c=n(1684),a=n(148);e.a=Object(a.action)("removeAttachmentFromWell")((function(t,e,n){void 0===n&&(n=!0);var a=Object(c.a)(e.attachmentId);if(a){var o,u=!1;1===e.attachmentType?(o=t.inlineAttachments,u=!0):o=t.imageViewAttachments.some((function(t){return t.attachmentId===e.attachmentId}))?t.imageViewAttachments:t.docViewAttachments;for(var s=!1,f=0;f<o.length;f++)if(o[f].attachmentId===e.attachmentId){o.splice(f,1),s=!0;break}n&&s&&(u||!e.isCloudy)&&Object(r.a)(t,-1*a.model.Size,a.model.AttachmentId),Object(i.a)(e.attachmentId)}}))},4728:function(t,e,n){"use strict";var r=n(148);e.a=Object(r.action)("changeTotalClassicAttachmentSize")((function(t,e,n){t.totalClassicAttachmentSize+=e}))},5168:function(t,e,n){"use strict";var r=n(1882),i=["ErrorTooLargeForLocalAttachmentSingle","ErrorTooLargeForLocalAttachmentMultiple","WarningFilesCanNotBeAttachedGenericError","WarningEmptyFilesCanNotBeAttached","WarningFilesCanNotBeAttachedWithNamesGenericError","WarningFilesCannotBeAttachedFromOtherMailboxes","WarningSeveralFilesCanNotBeAttachedGenericError","WarningInlineImageTypeNotSupported","WarningAttachmentsCanNotBeDeleted","InfoIncludeMostRecentAttachmentsMessage","ErrorSmimeHasCloudOrUriAttachments","ErrorAttachmentDownloadFailed","ErrorAttachmentDownloadFailedMultipleFiles","WarningSpecialCharactersAreNotSupported"];function c(t){t&&Object(r.a)(t,i)}n.d(e,"a",(function(){return c}))},5658:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(20);function i(t){var e=t.maxTotalClassicAttachmentSize-t.totalClassicAttachmentSize;return e<0?(r.d("AttachmentWellAvailableSize is smaller than zero: "+t.composeId),0):e}},5663:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"Item:#Exchange"},t)}},6035:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(6750),i=n(6),c=n(20),a=n(3725),o=n(5658),u=n(1856);function s(t,e,n){for(var s=0,f=0,l=void 0;l=t[f];f++)s+=l.size;var d=Object(o.a)(e);if(s>d){var m=Math.floor(d/a.b),b=void 0,h=void 0;return t.length>1?(h="ErrorTooLargeForLocalAttachmentMultiple",b=Object(i.c)(Object(i.b)(r.a),m)):(h="ErrorTooLargeForLocalAttachmentSingle",b=Object(i.c)(Object(i.b)(r.b),m)),Object(u.a)(n,h,[b]),!0}return c.g.info("Attachment: TotalSize = "+Math.floor(e.totalClassicAttachmentSize/1048576)),!1}},6750:function(t){t.exports=JSON.parse('{"a":"$lb","b":"amb"}')},6806:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"ItemIdAttachment:#Exchange"},t)}},8699:function(t){t.exports=JSON.parse('{"a":"Xlb"}')},8702:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"ItemAttachment:#Exchange"},t)}},8703:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"MimeContentType:#Exchange"},t)}}}]);
//# sourceMappingURL=owa.MailBoot~Attachments~filesView~smime.js.map
self.scriptsLoaded['owa.MailBoot~Attachments~filesView~smime.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Attachments~filesView~smime.js'] = (new Date()).getTime();