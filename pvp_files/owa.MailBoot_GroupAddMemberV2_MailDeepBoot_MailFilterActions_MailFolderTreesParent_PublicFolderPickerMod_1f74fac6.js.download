self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GroupAddMemberV2~MailDeepBoot~MailFilterActions~MailFolderTreesParent~PublicFolderPickerMod~1f74fac6.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[98],{1851:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(2),a={bulkActionInformationMap:new(n(9).ObservableMap)},i=Object(r.createStore)("bulkActionStore",a),o=i();t.a=o},1852:function(e,t){e.exports=function(e){return e instanceof Date}},1901:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"SortResults:#Exchange"},e)}},1923:function(e,t,n){var r=n(1852),a=36e5,i=6e4,o=2,u=/[T ]/,c=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,m=/^-?(\d{3})$/,v=/^-?(\d{2})-?(\d{2})$/,O=/^-?W(\d{2})$/,p=/^-?W(\d{2})-?(\d{1})$/,I=/^(\d{2}([.,]\d*)?)$/,j=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,g=/([Z+-].*)$/,T=/^(Z)$/,h=/^([+-])(\d{2})$/,R=/^([+-])(\d{2}):?(\d{2})$/;function S(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var y=function(e){var t,n={},r=e.split(u);c.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var a=g.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),A=function(e,t){var n,r=d[t],a=f[t];if(n=l.exec(e)||a.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=s.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(y.date,n),D=A.year,k=function(e,t){if(null===t)return null;var n,r,a,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=b.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=m.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=v.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var u=parseInt(n[2],10);return r.setUTCFullYear(t,a,u),r}if(n=O.exec(e))return i=parseInt(n[1],10)-1,S(t,i);if(n=p.exec(e)){i=parseInt(n[1],10)-1;var c=parseInt(n[2],10)-1;return S(t,i,c)}return null}(A.restDateString,D);if(k){var C,F=k.getTime(),_=0;return y.time&&(_=function(e){var t,n,r;if(t=I.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=j.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*i;if(t=w.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*a+r*i+1e3*o}return null}(y.time)),y.timezone?C=function(e){var t,n;if(t=T.exec(e))return 0;if(t=h.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=R.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(y.timezone):(C=new Date(F+_).getTimezoneOffset(),C=new Date(F+_+C*i).getTimezoneOffset()),new Date(F+_+C*i)}return new Date(e)}},1935:function(e,t,n){"use strict";var r=n(37),a=n(1991),i=n(1641),o=n(1647),u=n(966),c=n(1644);function s(e,t){return e&&!Object(i.w)()&&t&&"UserMailbox"===t.type&&!Object(o.m)(e)&&e!=Object(u.a)("recoverableitemsdeletions")&&!Object(c.D)(e,"SharedMailbox")}n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b})),n.d(t,"d",(function(){return a.c})),n.d(t,"c",(function(){return s}));var d=new r.c((function(){return n.e(983).then(n.bind(null,17018))})),l=new r.a(d,(function(e){return e.undo}))},1991:function(e,t,n){"use strict";var r,a,i=n(0),o=n(2),u=Object(o.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null})(),c=n(1974),s=n(148),d=n(48),l=n(713),f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DismissUndo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dismissUndo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]};n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return p}));var b=Object(s.action)("addActionToUndoStack")(Object(s.select)({store:function(){return u}})((function(e,t,n,i){null!==e&&(r=e,i.store.hasUndoableAction=!0,i.store.undoableActionFolderId=t,a=n)}))),m=Object(s.action)("clearLastUndoableAction")(Object(s.select)({store:function(){return u}})((function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!a)return[3,7];i.label=1;case 1:return i.trys.push([1,5,,6]),[4,a];case 2:return(t=i.sent()).success&&(n=t.undoRequestId)?(o={undoRequestId:n},[4,v.invokeDismissUndoMutation(o)]):[3,4];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:return i.sent(),[3,6];case 6:a=null,i.label=7;case 7:return r=null,e.store.hasUndoableAction=!1,e.store.undoableActionFolderId=null,[2]}}))}))}))),v={invokeDismissUndoMutation:function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(l.a)()];case 1:return[4,t.sent().mutate({variables:e,mutation:f})];case 2:return t.sent(),[2]}}))}))}},O=Object(s.select)({store:function(){return u}})((function(e){return e.store.hasUndoableAction})),p=Object(d.d)("undo",{name:"TnS_Undo",customData:function(e){return[e]}})((function(e){u.undoableActionFolderId?c.a.clearMapForFolder(u.undoableActionFolderId):c.a.removeAll();null!==r&&(r(),m())}))},1993:function(e,t,n){"use strict";var r=n(37),a=n(2480),i=n(2070),o=n(1950),u=n(2106),c=n(2230),s=n(2231),d=n(2302),l=n(2481),f=n(2347),b=n(1697),m=n(18),v=n(1656);function O(e,t){return!!e&&(1!==t&&!!v.a.conversations.get(e))}function p(e,t){return 2!=t&&(Object(m.i)("rp-persistedReadingPaneTabs")?b.a.loadedItemReadingPaneViewStates.has(e):b.a.itemReadingPaneViewState&&b.a.itemReadingPaneViewState.itemId==e)}var I=n(2135),j=n(2136),w=n(2071),g=n(1756);n.d(t,"l",(function(){return h})),n.d(t,"p",(function(){return R})),n.d(t,"m",(function(){return S})),n.d(t,"q",(function(){return y})),n.d(t,"s",(function(){return A})),n.d(t,"n",(function(){return D})),n.d(t,"o",(function(){return k})),n.d(t,"i",(function(){return C})),n.d(t,"j",(function(){return F})),n.d(t,"k",(function(){return _})),n.d(t,"g",(function(){return U})),n.d(t,"r",(function(){return N})),n.d(t,"h",(function(){return E})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return I.a})),n.d(t,"a",(function(){return j.a})),n.d(t,"t",(function(){return b.a})),n.d(t,"c",(function(){return w.a})),n.d(t,"b",(function(){return g.a}));var T=new r.c((function(){return Promise.all([n.e(3),n.e(5),n.e(6),n.e(13),n.e(17),n.e(20),n.e(21),n.e(23),n.e(25),n.e(56),n.e(55),n.e(62),n.e(86),n.e(135),n.e(180),n.e(276),n.e(267),n.e(280),n.e(734)]).then(n.bind(null,17301))})),h=new r.a(T,(function(e){return e.loadConversationReadingPane})),R=new r.a(T,(function(e){return e.moveReadingPaneToTab})),S=new r.a(T,(function(e){return e.loadConversationReadingPaneForSingleMailItemSelected})),y=new r.a(T,(function(e){return e.print})),A=new r.a(T,(function(e){return e.setItemIdToScrollTo})),D=new r.a(T,(function(e){return e.loadItemReadingPane})),k=new r.a(T,(function(e){return e.loadItemReadingPaneForSingleMailItemSelected})),C=new r.a(T,(function(e){return e.expandCollapseAllItemParts}));Object(r.f)(o.a,T,(function(e){return e.deleteItemsStoreUpdateOrchestrator})),Object(r.f)(c.a,T,(function(e){return e.markConversationsAsReadStoreUpdateOrchestrator})),Object(r.f)(s.a,T,(function(e){return e.markItemsAsReadStoreUpdateOrchestrator})),Object(r.f)(u.a,T,(function(e){return e.markAllAsReadOrchestrator})),Object(r.f)(a.a,T,(function(e){return e.applyConversationFlagStateStoreUpdateOrchestrator})),Object(r.f)(i.a,T,(function(e){return e.deleteConversationStoreUpdateOrchestrator})),Object(r.f)(f.a,T,(function(e){return e.conversationReadyToLoadOrchestrator})),Object(r.f)(f.b,T,(function(e){return e.updateAttachmentsOrchestrator})),Object(r.f)(f.c,T,(function(e){return e.updateItemMandatoryPropertiesOrchestrator})),Object(r.f)(d.a,T,(function(e){return e.updateInternetMessageIdOrchestrator})),Object(r.f)(l.a,T,(function(e){return e.initializeExtendedCardForItemReadingPaneOrchestrator}));new r.b(T,(function(e){return e.getLastestNonDraftItemId}));var F=new r.b(T,(function(e){return e.getLatestNonDraftItemIdFromConversation})),_=new r.b(T,(function(e){return e.isUnsupportedItem})),U=new r.a(T,(function(e){return e.clearReadingPaneStore})),N=new r.a(T,(function(e){return e.replyByMeeting})),E=new r.a(T,(function(e){return e.ensureSecondaryReadingPaneTabHandler}))},2030:function(e,t,n){"use strict";var r=n(37),a=n(1851),i=n(2912),o=n(20);function u(e){var t=a.a.bulkActionInformationMap.get(e);return!!t&&(!(t.customData&&!function(e){var t;try{t=JSON.parse(e)}catch(e){return o.d("Failed to parse bulkActionInfo.customData"),!1}return null!==t&&null!==t.Scenario}(t.customData))&&!Object(i.a)(t,e))}function c(e,t){var n=a.a.bulkActionInformationMap.get(e);return u(e)&&n.state==t}function s(e){return(c(e,d.b.Uninitialized)||c(e,d.b.Running))&&u(e)}var d=n(2105);n.d(t,"a",(function(){return f})),n.d(t,"j",(function(){return b})),n.d(t,"i",(function(){return m})),n.d(t,"k",(function(){return v})),n.d(t,"f",(function(){return O})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return I})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return d.b})),n.d(t,"l",(function(){return a.a}));var l=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(22),n.e(26),n.e(44),n.e(58),n.e(61),n.e(63),n.e(226),n.e(227),n.e(516)]).then(n.bind(null,11206))})),f=Object(r.d)(l,(function(e){return e.BulkActionSpinner})),b=new r.a(l,(function(e){return e.subscribeToBulkActionNotification})),m=new r.a(l,(function(e){return e.onBulkActionSubmitted})),v=new r.a(l,(function(e){return e.findBulkActionItemAction})),O=new r.a(l,(function(e){return e.onBulkActionCancel})),p=new r.a(l,(function(e){return e.onBulkActionHierarchyNotification})),I=new r.a(l,(function(e){return e.onBulkActionDismiss}))},2105:function(e,t,n){"use strict";var r,a;n.d(t,"a",(function(){return a})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout",e[e.Cancelling=6]="Cancelling"}(r||(r={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout"}(a||(a={})),t.b=r},2323:function(e,t,n){"use strict";function r(e){var t="";return e.graphQLErrors&&e.graphQLErrors.forEach((function(e){var n;(null===(n=e.extensions)||void 0===n?void 0:n.responseCode)&&(t=e.extensions.responseCode)})),t}n.d(t,"a",(function(){return r}))},2398:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1737),a=n(1641),i=n(440),o=n(794),u=n(1901),c=n(966);function s(e){var t,n,s=e.sortBy;switch(s.sortColumn){case 1:Object(r.l)(e)?t="ReceivedOrRenewTime":Object(c.a)("drafts")==e.folderId&&(t="ItemLastModifiedTime");break;case 3:n=!0,t=Object(i.a)({PropertyTag:"0x0042",PropertyType:"String"});break;case 7:t="Size";break;case 5:t="Importance";break;case 8:t="Subject";break;default:throw new Error("getMailItemSortByProperty: sort column not supported"+s.sortColumn)}var d=[];if(t){var l=t;n||(l=Object(o.a)({FieldURI:t})),d.push(Object(u.a)({Order:s.sortDirection,Path:l}))}var f=1==e.sortBy.sortColumn?e.sortBy.sortDirection:a.c.DESCENDING_SORT_DIR;return d.push(Object(u.a)({Order:f,Path:Object(o.a)({FieldURI:"DateTimeReceived"})})),d}},2478:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("GET_FOLDER_DATA",(function(e){return{folderId:e}}))},2482:function(e,t,n){"use strict";var r=n(1641),a=n(148);t.a=Object(a.select)({tableViews:function(){return r.Y.tableViews}})((function(e,t,n){var r=n.tableViews,a=[];return r.forEach((function(n){if(n.tableQuery.folderId===e||n.serverFolderId===e||t&&1===n.tableQuery.type)a.push(n);else if(t){var r=n.tableQuery.scenarioType;"category"!==r&&"persona"!==r&&"privatedistributionlist"!==r||a.push(n)}})),a}))},2912:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(3057),a=n.n(r),i=n(2105),o=n(1851);function u(e,t){var n=new Date,r=new Date(e.sendTime),u=a()(n,r),c=isNaN(u),s=u>7.5,d=Object(o.b)().bulkActionInformationMap.get(t);return!(!c&&!s)||!!d&&[i.b.Cancelled,i.b.Failed,i.b.Complete].indexOf(d.state)>-1}},2984:function(e,t,n){var r=n(1923);e.exports=function(e,t){var n=r(e),a=r(t);return n.getTime()-a.getTime()}},3057:function(e,t,n){var r=n(2984),a=36e5;e.exports=function(e,t){var n=r(e,t)/a;return n>0?Math.floor(n):Math.ceil(n)}},3134:function(e,t,n){"use strict";var r=n(0),a=n(127),i=n(1737),o=n(148),u=Object(o.action)("onReloadTableSucceeded")((function(e,t,n){Object(i.h)(t,e,n,!0,!1,"MergeOnReload"),e.currentLoadedIndex=e.rowKeys.length})),c=Object(o.action)("onReloadTableFailed")((function(e){Object(a.r)("TnS_ReloadError",[e])})),s=n(2323),d=n(18),l=n(2478),f=n(2019),b=n(1723),m=n(2398),v=n(439),O=n(1641),p=n(1730),I=new v.a(1,(function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=e.tableViewId,!(n=Object(O.K)().tableViews.get(t)))return[2,Promise.resolve()];switch(i=Math.max(n.currentLoadedIndex,b.a),n.tableQuery.listViewType){case 0:return[3,1];case 1:return[3,3]}return[3,5];case 1:return[4,j(n,i)];case 2:return r.sent(),[3,5];case 3:return[4,w(n,i)];case 4:return r.sent(),[3,5];case 5:return 0==n.tableQuery.type&&Object(l.a)(n.tableQuery.folderId),Object(a.r)("ReloadTable",[i],{sessionSampleRate:10}),[2,Promise.resolve()]}}))}))}),150);t.a=Object(o.action)("reloadMailListTableAction")((function(e){1===e.tableQuery.type||Object(O.U)(e.tableQuery.folderId)||I.add({tableViewId:e.id})}));function j(e,t){var n,r=e.tableQuery,a=null===(n=Object(O.j)(e,!0))||void 0===n?void 0:n.Id;return Object(f.d)(r.folderId,t,r.viewFilter,r.sortBy,Object(i.l)(r),r.focusedViewFilter,r.requestShapeName,Object(p.d)(r),void 0,r.categoryName,a).then((function(t){var n=[];t.edges&&(n=t.edges.map((function(e){return e.node}))),u(e,n,t.totalConversationRowsInView)})).catch((function(e){var t=Object(s.a)(e);c(t)}))}function w(e,t){var n=e.tableQuery;return Object(d.i)("mon-messageList-useGqlForFindItem")?Object(f.h)(Object(O.i)(n),t,n.viewFilter,n.sortBy,Object(i.l)(n),n.focusedViewFilter,n.requestShapeName,Object(p.d)(n),n.shouldTryToUseSessionDataResponse,Object(p.e)(n),n.categoryName,Object(O.j)(e,!0)).then((function(t){var n=[];t.edges&&(n=t.edges.map((function(e){return e.node}))),u(e,n,t.totalItemRowsInView)})).catch((function(e){var t=Object(s.a)(e);c(t)})):Object(f.c)(Object(O.i)(n),0,t,n.viewFilter,Object(m.a)(n),n.focusedViewFilter,n.requestShapeName,n.shouldTryToUseSessionDataResponse,Object(p.e)(n),n.categoryName,Object(O.j)(e,!0)).then((function(t){"Success"==t.ResponseClass?u(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView):c(t.ResponseCode)})).catch((function(e){c()}))}},3154:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("MARK_CONVERSATIONS_PINNED_STORE_UPDATE",(function(e,t,n){return{rowKeys:e,tableViewId:t,shouldMarkAsPinned:n}}))},3155:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("MARK_ITEMS_PINNED_STORE_UPDATE",(function(e,t,n){return{rowKeys:e,tableViewId:t,shouldMarkAsPinned:n}}))},3338:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("RELOAD_TABLE_ON_TRIAGE_ACTION_FAIL",(function(e){return{tableView:e}}))},3588:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("CONVERSATION_CATEGORIES_STORE_UPDATE",(function(e,t,n,r,a){return{conversationRowKeys:e,tableViewId:t,categoriesToAdd:n,categoriesToRemove:r,clearCategories:a}}))},3589:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ITEMS_CATEGORIES_STORE_UPDATE",(function(e,t,n,r){return{itemIds:e,categoriesToAdd:t,categoriesToRemove:n,clearCategories:r}}))}}]);
//# sourceMappingURL=owa.MailBoot~GroupAddMemberV2~MailDeepBoot~MailFilterActions~MailFolderTreesParent~PublicFolderPickerMod~1f74fac6.js.map
self.scriptsLoaded['owa.MailBoot~GroupAddMemberV2~MailDeepBoot~MailFilterActions~MailFolderTreesParent~PublicFolderPickerMod~1f74fac6.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GroupAddMemberV2~MailDeepBoot~MailFilterActions~MailFolderTreesParent~PublicFolderPickerMod~1f74fac6.js'] = (new Date()).getTime();