self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GroupAddMemberV2~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[176],{1715:function(e,t,n){"use strict";n.d(t,"q",(function(){return d})),n.d(t,"t",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"o",(function(){return O})),n.d(t,"b",(function(){return F})),n.d(t,"m",(function(){return p})),n.d(t,"f",(function(){return S})),n.d(t,"p",(function(){return m})),n.d(t,"s",(function(){return j})),n.d(t,"r",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"j",(function(){return w})),n.d(t,"k",(function(){return I})),n.d(t,"n",(function(){return E})),n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return P})),n.d(t,"h",(function(){return T})),n.d(t,"l",(function(){return A}));var r=n(0),o=n(48),i=n(1641),a=n(1647),c=n(2),u=n(1696),s=n(17),d=Object(c.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(_(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(c.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(_(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(c.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,o){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:o}})),b=Object(c.action)("EXPAND_ROW_FIRST_LEVEL",(function(e,t){return{rowKey:e,latestItemIdsInForks:t}})),v=Object(c.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),O=Object(c.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",(function(e){return{rowKey:e}})),F=Object(c.action)("ITEM_PART_SELECTED",(function(e,t,n,r,o){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:o}})),p=Object(c.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),S=Object(c.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),m=Object(c.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r,o){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r,currentSelectedNodeIds:o}})),j=Object(c.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),g=Object(c.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),h=Object(c.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),w=Object(c.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),I=Object(c.action)("RESET_SELECTION",(function(e){return{tableView:e}})),E=Object(c.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(o.c)(_(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),y=Object(c.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),P=Object(c.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),T=Object(c.action)("RESET_BUS_STOP_STATE_MAP"),A=Object(c.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}}));function _(e,t,n,o){return{name:function(e,t,n,o){return!(function(e){return e===a.b.MailListItemRichPreview||e===a.b.KeyboardShiftEnter||e===a.b.MailListItemBodyDoubleClick}(e)||Object(u.c)()&&!function(e){var t;return e===a.b.KeyboardEnter||e===a.b.MailListItemBody||e===a.b.RouteHandler||e===a.b.CommandBarArrows||e===a.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(s.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,o){if(Object(u.c)())return!1;if(e===a.b.KeyboardUpDown){var c=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==c&&1===t.selectedRowKeys.size){var s=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return o===i.d.Next?s===c+1||s===t.rowKeys.length-1&&c===t.rowKeys.length-1:s===c-1||0===s&&0===c}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,o))}(e,t,n,o)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},1734:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2051),o=n(1948);function i(e){return Object(o.b)().scenarioStores.get(Object(r.a)(e))||Object(o.a)()}},1819:function(e,t,n){"use strict";function r(){return{isBeingDragged:!1}}n.d(t,"a",(function(){return r}))},1848:function(e,t,n){"use strict";var r=n(37),o=n(2338),i=n(2),a=n(1644),c=Object(i.mutatorAction)("loadPopoutDataToFolderStore",(function(e){var t=e.folderId,n=e.mailboxInfo,r=e.permission,o=e.principalSMTPAddress,i=Object(a.o)();if(!i.get(t)){var c={FolderId:{Id:t},mailboxInfo:n,PermissionSet:{Permissions:[r]},principalSMTPAddress:o};i.set(t,c)}})),u=n(3309),s=Object(i.mutatorAction)("loadPopoutDataToPublicFolderFavoriteStore",(function(e){var t=e.folderId,n=e.mailboxInfo,r=e.replicaItem,o=u.b.folderTable;if(!o.get(t)){var i={FolderId:{Id:t},mailboxInfo:n,ReplicaList:[r]};o.set(t,i)}})),d=n(2212),l=n(966),f=n(1672),b=n(1647),v=n(148),O=Object(v.action)("selectFolderWithFallbackInFolderForest")((function(e,t){var n=Object(l.a)(e)||e;Object(b.r)(n)?Object(f.isFolderInFavorites)(n)?Object(d.a)(n,"favorites",t):Object(d.a)(n,"primaryFolderTree",t):Object(o.a)(t)})),F=n(1778);function p(e,t){var n=Object(F.c)();return(null==n?void 0:n.id)&&n.treeType==t&&e.toLowerCase()==n.id.toLowerCase()}var S=n(3334),m=n(3335),j=n(3462);Object(i.orchestrator)(j.a,(function(e){O("notes",e.actionSource)}));n.d(t,"c",(function(){return h})),n.d(t,"l",(function(){return w})),n.d(t,"h",(function(){return I})),n.d(t,"g",(function(){return E})),n.d(t,"i",(function(){return y})),n.d(t,"f",(function(){return P})),n.d(t,"j",(function(){return T})),n.d(t,"k",(function(){return A})),n.d(t,"e",(function(){return _})),n.d(t,"b",(function(){return R})),n.d(t,"d",(function(){return L})),n.d(t,"o",(function(){return o.a})),n.d(t,"m",(function(){return c})),n.d(t,"n",(function(){return s})),n.d(t,"p",(function(){return d.a})),n.d(t,"q",(function(){return O})),n.d(t,"a",(function(){return p}));var g=new r.c((function(){return Promise.all([n.e(20),n.e(41),n.e(593)]).then(n.bind(null,17349))})),h=new r.a(g,(function(e){return e.loadDumpster})),w=new r.a(g,(function(e){return e.toggleFavoriteFolder})),I=new r.a(g,(function(e){return e.selectFolderNode})),E=new r.a(g,(function(e){return e.selectFavoriteSearch})),y=new r.a(g,(function(e){return e.selectGroup})),P=new r.a(g,(function(e){return e.selectFavoriteCategory})),T=new r.a(g,(function(e){return e.selectPersona})),A=new r.a(g,(function(e){return e.selectPrivateDistributionList})),_=new r.a(g,(function(e){return e.prefetchFrequentlyUsedFolders})),R=new r.a(g,(function(e){return e.deleteFolderInFolderForest})),L=new r.a(g,(function(e){return e.logConsumerDeletedRetentionPolicy}));Object(r.f)(S.a,g,(function(e){return e.selectPreviousNodeOrchestrator})),Object(r.f)(m.a,g,(function(e){return e.validateDumpsterQuotaOrchestrator}))},1865:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Mail=1]="Mail",e[e.Calendar=2]="Calendar",e[e.FilesHub=3]="FilesHub",e[e.FilesPicker=4]="FilesPicker",e[e.Spaces=5]="Spaces",e[e.FileSuggestions=6]="FileSuggestions"}(r||(r={})),t.b=r},1874:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(9),o=n(2),i={mailFavoritesViewState:{contextMenuState:null,shouldShowFindFavoritesPicker:!1},favoritePersonasRootFolderId:void 0,isFavoritingInProgress:new r.ObservableMap({}),favoriteNodeViewStates:new r.ObservableMap({})},a=Object(o.createStore)("mailFavorites",i);t.a=a()},1948:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9),o=n(2),i=function(){return{alteredQuery:"",alterationProviderId:null,answerPlaceholderId:null,currentSearchQueryId:null,currentSuggestions:null,displayedQFRequestTime:null,flaggedTokens:[],isAnswerRendered:!1,isLastKeyPressedDeletion:!1,isSuggestionsCalloutClickable:!1,isSuggestionsDropdownVisible:!1,isUsing3S:null,latestQFRequestId:null,latestRenderedQFTraceId:null,latestQFTraceId:null,latestTraceId:null,nextSearchQueryId:null,recourseQuery:"",searchBoxHasFocus:!1,searchBoxWidth:null,searchSessionGuid:null,searchText:"",searchTextForSuggestion:"",selectedPillIndex:-1,selectedSuggestionIndex:-1,showRefiners:!1,showSearchBoxInCompactMode:!1,suggestedSearchTerm:"",suggestedSearchTermReferenceId:"",suggestionPillIds:[],suggestionPills:new r.ObservableMap,queryAlterationType:null,queryActionSource:null,queryAlterationLogicalId:null,traceIdToLogicalIdMap:new r.ObservableMap,tableViewId:null,isScopePickerVisible:!1}},a={scenarioStores:new r.ObservableMap},c=Object(o.createStore)("commonSearchStore",a);t.b=c},2034:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"m",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"n",(function(){return s})),n.d(t,"o",(function(){return d})),n.d(t,"p",(function(){return l})),n.d(t,"r",(function(){return f})),n.d(t,"q",(function(){return b})),n.d(t,"u",(function(){return v})),n.d(t,"s",(function(){return O})),n.d(t,"t",(function(){return F})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return S})),n.d(t,"e",(function(){return m})),n.d(t,"a",(function(){return j})),n.d(t,"d",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return w})),n.d(t,"j",(function(){return I})),n.d(t,"k",(function(){return E}));var r=n(37),o=new r.c((function(){return Promise.all([n.e(3),n.e(5),n.e(6),n.e(7),n.e(13),n.e(17),n.e(22),n.e(21),n.e(31),n.e(51),n.e(274),n.e(282),n.e(752)]).then(n.bind(null,2892))})),i=new r.b(o,(function(e){return e.clearSearchBox})),a=new r.b(o,(function(e){return e.endSearchSession})),c=new r.b(o,(function(e){return e.onDownArrowPressedSearchInput})),u=new r.b(o,(function(e){return e.onBackspacePressedSearchInput})),s=new r.b(o,(function(e){return e.onLeftArrowPressedSearchInput})),d=(new r.b(o,(function(e){return e.onRightArrowPressedSearchInput})),new r.b(o,(function(e){return e.onUpArrowPressedSearchInput}))),l=new r.b(o,(function(e){return e.removeSuggestionPillFromSearchBox})),f=new r.b(o,(function(e){return e.setLatestQFRequestId})),b=new r.b(o,(function(e){return e.setIsSuggestionsDropdownVisible})),v=new r.b(o,(function(e){return e.updateIsSuggestionSetComplete})),O=new r.b(o,(function(e){return e.setShowSearchBoxInCompactMode})),F=new r.a(o,(function(e){return e.setSpellerData})),p=(Object(r.d)(o,(function(e){return e.PersonaPill})),Object(r.d)(o,(function(e){return e.PrivateDistributionListPill})),Object(r.d)(o,(function(e){return e.SearchBoxDropdown}))),S=Object(r.d)(o,(function(e){return e.SearchBoxPillWell})),m=Object(r.d)(o,(function(e){return e.SuggestionsCallout})),j=Object(r.d)(o,(function(e){return e.CompactSearchBox})),g=Object(r.d)(o,(function(e){return e.SearchScopePicker})),h=new r.b(o,(function(e){return e.getSuggestionAtIndex})),w=new r.b(o,(function(e){return e.isInSearchMode})),I=new r.b(o,(function(e){return e.isQFRequestIdEqualToLatest})),E=new r.b(o,(function(e){return e.isSearchBoxEmpty}))},2045:function(e,t,n){"use strict";n.r(t);var r=n(37),o=n(0),i=n(127),a=n(893),c=n(219),u=n(17),s=n(2),d=n(2985),l=n(1672);Object(s.orchestrator)(l.migrateOutlookFavorites,(function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r,s,v,O,F,p,S,m,j,g;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return e=function(){var e=Object(u.a)().UserOptions.FavoriteNodes;if(!e)return{owsFavoritesData:[],clientFavoritesData:[]};var t=[],n=[];return e.forEach((function(e){var r=Object(l.parseFavoriteNode)(e);switch(r.type){case 1:var o=r;if(!Object(l.isPersonaInFavorites)(o.personaId,o.mainEmailAddress)){var i=function(e,t,n){return{treeType:"favorites",type:"persona",favoriteId:e,displayName:t.displayName,searchFolderId:t.searchFolderId,client:n?"Migration":"OWA",allEmailAddresses:t.allEmailAddresses,personaId:t.personaId,mainEmailAddress:t.mainEmailAddress,isSearchFolderPopulated:!!t.searchFolderId,isSyncUpdateDone:!0}}(f=Object(c.a)(),o,!0),u=function(e){var t=[],n=[],r=e.displayName||e.mainEmailAddress;if(r){if(e.mainEmailAddress){t.push({Key:"MainEmailAddress",Value:e.mainEmailAddress}),e.searchFolderId&&t.push({Key:"SearchFolderId",Value:Object(l.convertEWSFolderIdToRestFolderId)(e.searchFolderId)});var o=e.allEmailAddresses&&e.allEmailAddresses.filter((function(e){return!!e}));o.length>0?n.push({Key:"EmailAddresses",Values:o}):n.push({Key:"EmailAddresses",Values:[e.mainEmailAddress]})}if(e.personaId&&t.push({Key:"PersonaId",Value:Object(l.convertEWSFolderIdToRestFolderId)(e.personaId)}),0!==t.length)return{Type:"persona",DisplayName:r,SingleValueSettings:t,MultiValueSettings:n,Client:"Migration"}}}(o);u&&(t.push(u),n.push(i))}break;case 4:var s=r.id,d=Object(a.o)().filter((function(e){return e.Id===s}))[0];if(d&&!Object(l.isCategoryInFavorites)(s)){var f=Object(c.a)(),b=Object(l.createClientFavoriteCategoryData)(f,d,!0),v=Object(l.createOwsFavoriteCategoryData)(d,!0);t.push(v),n.push(b)}}})),{owsFavoritesData:t,clientFavoritesData:n}}(),t=e.owsFavoritesData,n=e.clientFavoritesData,0===t.length?(b(),[2]):[4,l.lazyAddMultipleFavoritesToStore.import()];case 1:o.sent()(n),(r=n.filter((function(e){return"persona"===e.type}))).length>0&&Object(d.a)(r),s=Math.ceil(t.length/20),v=!1,(O=new i.b("MigrateOutlookFavoriteService",{isCore:!0})).addCustomProperty("totalBatchCount",s),F=0,p=0,o.label=2;case 2:return F<s?(S=t.slice(p,p+20),(m=new i.b("MigrateOutlookFavoriteSingleBatchService",{isCore:!0})).addCustomProperty("favoritesCount",S.length),j=n.slice(p,p+20),[4,f(S,j,m)]):[3,5];case 3:v=o.sent(),o.label=4;case 4:return F++,p+=20,[3,2];case 5:return v?O.endWithError("ServerError"):O.end(),(g=!Object(l.getIsBitEnabled)(8))?(l.lazySetOutlookFavoritesBitFlag.importAndExecute(8),v||b()):b(),Object(i.r)(g?"FirstAttemptMigrationCompleted":"SecondAttemptMigrationCompleted",[v],{isCore:!0}),[2]}}))}))}));function f(e,t,n){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i,a,c,u,s;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,Object(l.createMultipleOutlookFavoritesService)(e)];case 1:return r=o.sent(),[3,3];case 2:return i=o.sent(),n.endWithError("ServerError",i),[2,!0];case 3:return o.trys.push([3,5,,6]),a=(r.value||[]).map((function(e){return Object(l.convertServiceResponseToFavoriteData)(e,e.Type.toLowerCase())})),[4,l.lazyAddMultipleFavoritesCompleted.import()];case 4:return o.sent()(t,a),c=a.filter((function(e){return"persona"===e.type})),u=a.filter((function(e){return"category"===e.type})),n.addCustomProperty("migratedPersonasCount",c.length),n.addCustomProperty("migratedCategoriesCount",u.length),n.end(),[3,6];case 5:return s=o.sent(),n.endWithError("ClientError",s),[2,!0];case 6:return[2,!1]}}))}))}function b(){l.lazySetOutlookFavoritesBitFlag.importAndExecute(16)}var v=n(1874),O=n(1819),F=n(1664),p=Object(s.mutatorAction)("setFavoriteNodeViewStateMutator",(function(e,t){Object(v.b)().favoriteNodeViewStates.set(e,t)}));function S(e){return Object(v.b)().favoriteNodeViewStates.has(e)||p(e,{drag:Object(O.a)(),drop:Object(F.a)()}),Object(v.b)().favoriteNodeViewStates.get(e)}var m=n(148),j=Object(m.action)("showFindFavoritesPicker")((function(e){v.a.mailFavoritesViewState.shouldShowFindFavoritesPicker=e})),g=n(2527);n.d(t,"lazyModule",(function(){return h})),n.d(t,"lazyToggleFavoritesTreeExpansion",(function(){return w})),n.d(t,"lazyRemoveFavoriteSearch",(function(){return I})),n.d(t,"lazyRemoveFavoritePersona",(function(){return E})),n.d(t,"lazyOnSelectedPersonaNodeChanged",(function(){return y})),n.d(t,"lazyHandleToggleFavoritePersonaError",(function(){return P})),n.d(t,"lazyMarkFavoritePersonaNodeAsAdded",(function(){return T})),n.d(t,"lazyOnFavoritePersonaSelected",(function(){return A})),n.d(t,"lazyAddFavoriteFolder",(function(){return _})),n.d(t,"lazyRemoveFavoriteFolder",(function(){return R})),n.d(t,"lazyAddFavoriteFolderV1",(function(){return L})),n.d(t,"lazyRemoveFavoriteFolderV1",(function(){return C})),n.d(t,"lazyOnFavoritePersonaUpdated",(function(){return N})),n.d(t,"lazyAddFavoritePersona",(function(){return D})),n.d(t,"lazyInitializeFavoritePersonas",(function(){return M})),n.d(t,"lazyOutlookFavoritePersonasLoaded",(function(){return V})),n.d(t,"getFavoriteNodeViewStateFromId",(function(){return S})),n.d(t,"getStore",(function(){return v.b})),n.d(t,"showFindFavoritesPicker",(function(){return j})),n.d(t,"isFavoritingInProgress",(function(){return g.a}));var h=new r.c((function(){return Promise.all([n.e(44),n.e(58),n.e(61),n.e(81),n.e(258),n.e(656)]).then(n.bind(null,17332))})),w=new r.a(h,(function(e){return e.toggleFavoritesTreeExpansion})),I=new r.a(h,(function(e){return e.removeFavoriteSearch})),E=new r.a(h,(function(e){return e.removeFavoritePersona})),y=new r.a(h,(function(e){return e.onSelectedPersonaNodeChanged})),P=new r.a(h,(function(e){return e.handleToggleFavoritePersonaError})),T=new r.a(h,(function(e){return e.markFavoritePersonaNodeAsAdded})),A=new r.a(h,(function(e){return e.onFavoritePersonaSelected})),_=new r.b(h,(function(e){return e.addFavoriteFolder})),R=new r.b(h,(function(e){return e.removeFavoriteFolder})),L=new r.a(h,(function(e){return e.addFavoriteFolderV1})),C=new r.a(h,(function(e){return e.removeFavoriteFolderV1})),N=new r.a(h,(function(e){return e.onFavoritePersonaUpdated})),D=new r.a(h,(function(e){return e.addFavoritePersona})),M=new r.a(h,(function(e){return e.initializeFavoritePersonas})),V=new r.a(h,(function(e){return e.outlookFavoritePersonasLoaded}))},2051:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1865);function o(e){switch(e){case r.b.Mail:return"Mail";case r.b.Calendar:return"Calendar";case r.b.FilesHub:return"FilesHub";case r.b.FilesPicker:return"FilesPicker";case r.b.Spaces:return"Spaces";case r.b.FileSuggestions:return"FileSuggestions";default:throw Error("Unknown SearchScenarioId value!")}}},2212:function(e,t,n){"use strict";var r,o=n(127),i=n(1848),a=n(3241),c=n(3311),u=n(1644),s=n(2478),d=n(2567),l=n(1788),f=n(1778),b=n(3411),v=n(2444),O=n(1641),F=n(1647),p=n(1668),S=n(966),m=n(48),j=n(1667),g=n(2),h=n(1696),w=n(2026),I=n(2054),E=n(1785),y=n(6),P=n(3720),T=n(1859);var A=Object(g.action)("selectFolder",(function(e,t,n,r){var o=Object(f.c)().id;return Object(m.c)({name:"SwitchMailFolder",options:{variant:3},customData:[Object(p.a)(e),o?Object(p.a)(o):"",t,n,Object(O.B)(Object(O.A)(e))]},{folderId:e,treeType:t,previousFolderId:o,actionSource:n,folderNodeType:r,isNewFolderSameAsPreviousFolder:e==o})}));t.a=A,Object(g.orchestrator)(A,(function(e){var t,n,f,m,g,A,_,R=e.folderId,L=e.treeType,C=e.previousFolderId,N=e.actionSource,D=e.folderNodeType,M=e.isNewFolderSameAsPreviousFolder;r&&!(null==r?void 0:r.hasEnded)&&(r.end(void 0,"BackgroundSuccess"),(null===(t=null==r?void 0:r.properties)||void 0===t?void 0:t.E2ETimeElapsed)>500&&Object(o.r)("SwitchMailFolderAbandoned",[null===(n=null==r?void 0:r.properties)||void 0===n?void 0:n.E2ETimeElapsed,null===(f=null==r?void 0:r.propertyBag)||void 0===f?void 0:f.owa_1,null===(m=null==r?void 0:r.propertyBag)||void 0===m?void 0:m.owa_3,null===(g=null==r?void 0:r.propertyBag)||void 0===g?void 0:g.owa_4,null===(A=null==r?void 0:r.propertyBag)||void 0===A?void 0:A.isCached],{sessionSampleRate:10})),r=Object(o.t)((function(e){return"SwitchMailFolder"==e.eventName}));var V=Object(I.a)(),U=u.d.folderTable.get(R);6===D&&(U=E.a.folderTable.get(R));var k=Promise.resolve(),x=Object(O.H)(),B=x&&1==x.tableQuery.type;M&&x&&(Object(h.c)()&&Object(w.a)()||Object(v.a)(x));var K=x&&Object(O.P)(x);if(!M||K&&"All"!==K||"spotlight"==(null===(_=null==x?void 0:x.tableQuery)||void 0===_?void 0:_.scenarioType)){k=function(e,t,n,r){var o;e&&(o=Object(S.a)(e));var i=o||e;return Object(c.a)({id:i,type:null!=r?r:0,treeType:t},n)}(R,L,N,D);var W=Object(p.a)(R);Object(s.a)(R),Object(u.G)(U)&&"inbox"!==W&&W!==j.h&&Object(b.b)(R),W===j.g?i.c.importAndExecute(j.h,U.mailboxInfo):W===j.a&&i.c.importAndExecute(j.b,U.mailboxInfo)}return l.b.importAndExecute(),Object(a.a)(N),"ResetInbox"===N&&F.s.importAndExecute(Object(y.b)(P.a),"assertive"),k.then((function(){Object(d.a)(R,C,B,null==x?void 0:x.id,T.a.Auto,V,N)})),k})),Object(g.mutator)(A,(function(e){e.isNewFolderSameAsPreviousFolder&&(f.a.selectedNode.treeType=e.treeType),O.Y.rowInfoForVLV.clear(),O.Y.scrollTop=0}))},2338:function(e,t,n){"use strict";var r=n(966);var o=n(2212),i=n(1672);function a(e){var t=Object(r.a)("inbox"),n=Object(i.isFolderInFavorites)(t)?"favorites":"primaryFolderTree";Object(o.a)(t,n,e)}n.d(t,"a",(function(){return a}))},2361:function(e,t,n){"use strict";var r=n(37),o=n(2614);function i(e){var t=e.itemId,n=e.conversationId,r=e.rowKey;return Object(o.a)().spotlightItems.some((function(e){return t&&e.itemId===t||n&&e.conversationId===n||r&&e.rowKey===r}))}var a=n(2479);n.d(t,"i",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"h",(function(){return l})),n.d(t,"m",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"g",(function(){return v})),n.d(t,"j",(function(){return O})),n.d(t,"k",(function(){return F})),n.d(t,"l",(function(){return p})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a.a}));var c=new r.c((function(){return Promise.all([n.e(3),n.e(45),n.e(58),n.e(61),n.e(63),n.e(81),n.e(775)]).then(n.bind(null,17329))})),u=new r.a(c,(function(e){return e.initializeSpotlight})),s=new r.b(c,(function(e){return e.getSpotlightLogicalId})),d=new r.b(c,(function(e){return e.getSpotlightItem})),l=new r.b(c,(function(e){return e.getUnacknowledgedSpotlightCount})),f=new r.a(c,(function(e){return e.onSpotlightDismissedFromRP})),b=new r.a(c,(function(e){return e.getSpotlightDonationJson})),v=new r.a(c,(function(e){return e.getSpotlightReasonString})),O=new r.a(c,(function(e){return e.loadImportantTable})),F=new r.a(c,(function(e){return e.logSpotlightItemClicked})),p=new r.a(c,(function(e){return e.logSpotlightResultsRendered})),S=Object(r.d)(c,(function(e){return e.SpotlightIconTeachingMoment}))},2396:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(37),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(777)]).then(n.bind(null,2968))})),i=Object(r.d)(o,(function(e){return e.StarCharm}))},2479:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1796),o=n(18);function i(){return Object(o.i)("tri-spotlight2")&&!Object(r.a)(2048)}},2527:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1874),o=n(1672),i=n(18);function a(e){return Object(i.i)("tri-favorites-roaming")?Object(o.isOutlookFavoritingInProgress)(e):!0===Object(r.b)().isFavoritingInProgress.get(e)}},2565:function(e,t,n){"use strict";var r=n(219),o=n(18);t.a={RemoveFavoritePersonaAction:{name:"RemoveFavoritePersonaAction",customData:function(e,t){return[t]}},AddFavoriteSearch:{name:"AddFavoriteSearch",customData:function(e,t){return[t,Object(o.i)("tri-favorites-roaming")]}},RemoveFavoriteSearch:{name:"RemoveFavoriteSearch",customData:function(e,t){return[t,Object(o.i)("tri-favorites-roaming")]}},AddFavoritePersonaAction:{name:"AddFavoritePersonaAction",customData:function(e,t,n,r,o,i){return[r]}},ValidateAndUpdateFavorite:{name:"ValidateAndUpdateFavorite",customData:function(e,t,n){return Object(r.b)(e)?[e]:null}},DeleteFolderFailure:{name:"DeleteFolderFailure",customData:function(e){return[e]}},OnFavoritePersonaSelectedAction:{name:"OnFavoritePersonaSelectedAction"},OnFavoritePersonaUpdatedAction:{name:"OnFavoritePersonaUpdatedAction"},InitializeFavoritePersonasAction:{name:"InitializeFavoritePersonasAction"},OneOffAddressUsedForFavorite:"OneOffAddressUsedForFavorite",OutlookFavoritePersonasLoaded:{name:"OutlookFavoritePersonasLoaded"}}},2566:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return d}));var r=n(37),o=new r.c((function(){return Promise.all([n.e(20),n.e(48),n.e(80),n.e(247),n.e(611)]).then(n.bind(null,5799))})),i=new r.a(o,(function(e){return e.loadGroups})),a=new r.a(o,(function(e){return e.loadGroupsFromSessionData})),c=new r.a(o,(function(e){return e.removeGroupFromLeftNav})),u=new r.a(o,(function(e){return e.toggleGroupTreeExpansion})),s=new r.a(o,(function(e){return e.unsubscribeFromUnreadNotifications})),d=new r.a(o,(function(e){return e.setGroupLastVisitedTime}))},2613:function(e,t,n){"use strict";var r=n(2),o=Object(r.action)("LOAD_FAVORITES");t.a=o},2614:function(e,t,n){"use strict";var r=n(2),o=Object(r.createStore)("spotlightStore",{spotlightItems:[],rollupDismissed:!1,logicalId:null,requestStartTime:null});t.a=o},2829:function(e,t,n){"use strict";var r=n(2),o=n(9),i=n(3592);Object(r.mutator)(i.a,(function(e){c().prefetchedFolderIds.set(e.folderId,!0)}));n.d(t,"b",(function(){return c}));var a={frequentlyUsedFolders:[],isInitialized:!1,prefetchedFolderIds:new o.ObservableMap({})},c=Object(r.createStore)("frequentlyUsedFoldersStore",a),u=c();t.a=u},2914:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="#"},2985:function(e,t,n){"use strict";var r=n(2),o=n(48),i=n(2565);t.a=Object(r.action)("outlookFavoritePersonasLoaded",(function(e){return Object(o.c)(i.a.OutlookFavoritePersonasLoaded,{personas:e})}))},2987:function(e,t,n){"use strict";var r=n(148),o=n(2443);t.a=Object(r.action)("commandBarAction")((function(e){o.a.navigationButtonSelected=e}))},3058:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("POPULATE_PUBLIC_FOLDER_OUTLOOK_FAVORITE_STORE")},3059:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("POPULATE_PUBLIC_FOLDER_FAVORITE_STORE_V1")},3060:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ADD_PUBLIC_FOLDER_TO_STORE",(function(e,t){return{state:e,item:t}}))},3128:function(e,t,n){"use strict";var r=n(1641),o=n(2019);function i(e,t){var n;switch(t){case 0:n=o.a;break;case 1:n=Object(o.f)()}return{categoryName:null,folderId:e,focusedViewFilter:-1,listViewType:t,viewFilter:"All",sortBy:r.c.getDefaultSortBy(),requestShapeName:n,type:2,shouldTryToUseSessionDataResponse:!1,scenarioType:"group"}}var a=n(17);function c(){var e=Object(a.a)().UserOptions.GlobalListViewTypeReact;return null==e?0:e}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}))},3153:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("REMOVE_FAVORITE_FROM_PUBLIC_FOLDER_STORE",(function(e){return{folderId:e}}))},3241:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(0),o=n(3586),i=n(1935),a=n(2034),c=n(1734),u=n(1865),s=n(887),d=n(2320),l=n(2346),f=n(2158);function b(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,i.b()];case 1:return t.sent(),s.c.import().then((function(e){e("MailModuleNotificationBarHost")})),Object(c.a)(u.a.Mail).searchSessionGuid?[4,a.g.import()]:[3,3];case 2:t.sent()(u.a.Mail,e),t.label=3;case 3:return Object(l.a)()&&Object(d.a)()&&Object(f.a)(!1),Object(o.a)(),[2]}}))}))}},3309:function(e,t,n){"use strict";var r=n(3058),o=n(3059),i=n(37),a=n(2613),c=n(0),u=n(3060),s=n(2),d=n(2593),l=n(1849),f=n(17),b=(Object(s.mutator)(u.a,(function(e){var t=e.state,n=e.item,r=n.FolderId.Id,o=Object(f.a)().SessionSettings.DefaultPublicFolderMailbox,i=Object(l.a)(o);if(!t.folderTable.has(r)){var a=Object(c.__assign)({},Object(d.c)(n,i));t.folderTable.set(r,a)}})),n(3153)),v=n(1785);Object(s.mutator)(b.a,(function(e){var t=e.folderId;v.a.folderTable.has(t)&&v.a.folderTable.delete(t)}));n.d(t,"a",(function(){return F})),n.d(t,"b",(function(){return v.a}));var O=new i.c((function(){return Promise.all([n.e(21),n.e(49),n.e(922)]).then(n.bind(null,17528))}));Object(i.f)(a.a,O,(function(e){return e.loadPublicFolderFavoritesOchestrator})),Object(i.f)(r.a,O,(function(e){return e.populatePublicFolderOutlookFavoriteStoreOrchestrator})),Object(i.f)(o.a,O,(function(e){return e.populatePublicFolderFavoriteStoreV1Orchestrator}));var F=Object(i.d)(O,(function(e){return e.PostedToLine}))},3311:function(e,t,n){"use strict";var r=n(0),o=n(893),i=n(3128),a=n(2045),c=n(2120),u=n(1641),s=n(2822),d=n(1672),l=n(1718),f=n(3339),b=n(2073);var v=n(2987),O=n(2134),F=n(2566),p=n(1709),S=n(2),m=n(1778);function j(e,t){var n=Object(m.d)();if(1===n.selectedNode.type&&a.lazyOnSelectedPersonaNodeChanged.importAndExecute(n.selectedNode),2===n.selectedNode.type){if("DeleteGroup"!=t){var S=Object(u.H)();S&&F.d.importAndExecute(Object(p.b)(S.tableQuery))}2!==e.type&&Object(v.a)(O.a.Email)}var j=Object(r.__assign)({},e);return g(j),function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,v,O,F,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(e.type){case 0:return[3,1];case 4:return[3,2];case 1:return[3,6];case 5:return[3,10];case 2:return[3,14];case 6:return[3,15]}return[3,16];case 1:return v=Object(c.a)(e.id),n=Object(b.a)(e.id,Object(u.A)(e.id),"mail",null,null,null,{sortColumn:v.sortColumn,sortDirection:v.sortOrder}),[3,17];case 2:return Object(a.isFavoritingInProgress)(e.id)?(O=Object(o.k)(e.id,Object(o.o)()),[4,l.e.import()]):[3,4];case 3:return n=r.sent()(O,Object(u.A)(e.id)),[3,5];case 4:n=Object(f.a)(e.id),r.label=5;case 5:return[3,17];case 6:return(F=e).isSearchFolderPopulated?[3,8]:[4,l.f.import()];case 7:return n=r.sent()(F.displayName,F.allEmailAddresses,Object(u.A)(e.id)),[3,9];case 8:n=Object(b.a)(F.searchFolderId,Object(u.A)(F.searchFolderId),"persona"),r.label=9;case 9:return[3,17];case 10:return(p=d.favoritesStore.outlookFavorites.get(e.id)).isSearchFolderPopulated?[3,12]:[4,l.g.import()];case 11:return n=r.sent()(p.displayName,p.members,p.pdlId,p.owsPersonaId,Object(u.A)(e.id)),[3,13];case 12:n=Object(b.a)(p.searchFolderId,Object(u.A)(p.searchFolderId),"privatedistributionlist"),r.label=13;case 13:return[3,17];case 14:return n=Object(i.a)(e.id,Object(i.b)()),[3,17];case 15:return n=Object(b.a)(e.id,1,"mail"),[3,17];case 16:return[3,17];case 17:return[2,Object(s.a)(n,null,t)]}}))}))}(j,t)}n.d(t,"a",(function(){return j}));var g=Object(S.mutatorAction)("setSelectedFolderNode",(function(e){Object(m.d)().selectedNode=e}))},3332:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(272);function o(){return Object(r.a)().favorites}},3334:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("SELECT_PREVIOUS_NODE",(function(e){return{actionSource:e}}))},3335:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("TRY_VALIDATE_DUMPSTER_QUOTA",(function(e){return{folderId:e}}))},3339:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2073),o=n(893),i=n(1641),a=n(966);function c(e){var t=Object(o.k)(e,Object(o.o)());return Object(r.a)(Object(a.a)("msgfolderroot"),Object(i.A)(null),"category",-1,"UserCategory",t)}},3411:function(e,t,n){"use strict";var r=n(3591),o=n(2829),i=n(148),a=Object(i.action)("sortFolders")((function(){var e=Object(o.b)(),t=e.frequentlyUsedFolders.sort((function(e,t){return e.Weight==t.Weight?Math.abs(Date.parse(t.lvt)-Date.parse(e.lvt)):t.Weight-e.Weight}));e.frequentlyUsedFolders=t})),c=Object(i.action)("addFrequentlyUsedFolder")((function(e){var t=!1,n=Object(o.b)();if(n.isInitialized){for(var i=n.frequentlyUsedFolders.length-1;i>=0;i--){var c=n.frequentlyUsedFolders[i];if(c.FolderId==e)c.Weight+=5,c.Weight=Math.min(c.Weight,20),c.lvt=(new Date).toISOString(),t=!0;else if(c.Weight--,c.Weight=Math.max(c.Weight,0),c.Weight<=0){var u=Math.abs(Date.now()-Date.parse(c.lvt));u<6048e5&&u>=0||n.frequentlyUsedFolders.splice(i,1)}}t||n.frequentlyUsedFolders.push({FolderId:e,Weight:10,lvt:(new Date).toISOString()}),a(),n.frequentlyUsedFolders.splice(10),Object(r.a)()}})),u=n(2914);n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u.a}))},3462:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("OPEN_NOTES_FOLDER",(function(e){return{actionSource:e}}))},3586:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2211),o=n(1757),i=n(1764),a=n(2054),c=n(1696),u=n(497);function s(){null===i.a.primaryComposeId||Object(u.v)()?Object(c.c)()&&Object(a.a)()&&Object(r.a)("FolderNodeClick"):o.s.importAndExecute(null)}},3591:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(399),o=n(2829),i=n(20);function a(){var e=[];Object(o.b)().frequentlyUsedFolders.forEach((function(t){e.push(JSON.stringify(t))})),Object(r.a)((function(t){t.UserOptions.FrequentlyUsedFolders=e}),[{key:"FrequentlyUsedFolders",valuetype:"StringArray",value:e}]).catch((function(e){i.g.warn("saveFrequentlyUsedFolders: "+e)}))}},3592:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("folderPrefetchedAction",(function(e){return{folderId:e}}))},3720:function(e){e.exports=JSON.parse('{"a":"LBb"}')}}]);
//# sourceMappingURL=owa.MailBoot~GroupAddMemberV2~MailFolderTreesParent~PublicFolderPickerModule.js.map
self.scriptsLoaded['owa.MailBoot~GroupAddMemberV2~MailFolderTreesParent~PublicFolderPickerModule.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GroupAddMemberV2~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();