self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GroupList.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[611],{1655:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={FavoriteNode:"favoritenode",InboxRule:"inboxrule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",NoteFeedItem:"notefeeditem",Todo:"todo",Attachment:"attachment",CommandBarEditorButton:"commandbareditorbutton",CalendarNode:"calendarnode",CalendarGroupNode:"calendargroupnode"}},1662:function(e,t,r){"use strict";var n=r(0),o=r(1705),i=r(365),a=r(614),u=r(127),c=r(4),s="X-AnchorMailbox",p="Authorization",d="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function b(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,b,f,g,v;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(r={},b=Object(i.k)(e)){if(b.accountState==i.b.AccessRevoked)return[2,null];if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.c)(b.accountState,b.accountProviderType),[2,null]}return t?(r[s]=t,r[l]=t):b&&(r[s]=b.anchorMailbox),b?(f=b.token,!(g=Object(a.g)(b.tokenExpiry))&&f?[3,2]:(Object(u.r)("getAndUpdateAccessToken",{tokenExpiry:Object(c.y)(b.tokenExpiry,Object(c.Qb)()),isTokenExpired_1:g,isTokenInvalid_2:!f},{isCore:!0}),[4,o.a.importAndExecute(b.accountId,e,f)])):[3,3];case 1:(f=n.sent())||(f=""),n.label=2;case 2:v=void 0,"Outlook"==b.accountProviderType?(v='MSAuth1.0 usertoken="'+f+'", type="MSACT"',r[d]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(v="Bearer "+f,r[d]=2..toString()),r[p]=v,n.label=3;case 3:return[2,r]}}))}))}var f=r(1663),g=r(20);function v(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r=Object(f.a)(),o=r,[4,O(e,t)];case 1:return o.headers=n.sent(),r.authNeededOnUnAuthorized=!1,r.datapoint=r.datapoint||{},r.datapoint.mailbox="Connected",[2,r]}}))}))}function O(e,t){var r;return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return o=t&&(null===(r=e.headers)||void 0===r?void 0:r.set)?new Headers(e.headers):new Headers,[4,b(e.mailboxInfo.userIdentity,m(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=n.sent(),Object(f.b)(o,i),[2,o]}}))}))}function m(e,t){var r="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return r&&null==t&&g.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),r}r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return m}))},1663:function(e,t,r){"use strict";function n(e,t){Object.keys(t).forEach((function(r){return e.set(r,t[r])}))}function o(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return o}))},1665:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),o=Object(n.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},1686:function(e,t,r){"use strict";var n=r(1),o=r(1655);var i=r(148),a=Object(i.action)("setDropState")((function(e,t,r){e.isDragOver=t,e.draggableItemType=r})),u=r(1746),c=r(105);r.d(t,"a",(function(){return p}));var s=50,p=function(){function e(e){var t=this;this.props=e,this.onDragEnter=function(e){e.preventDefault(),t.props.preventBubblingDragEvents&&e.stopPropagation();var r=t.getDragData(e);(Object(c.e)()||Object(c.g)())&&t.setDropEffectInternal(e,t.getDesiredDropEffect(r)),t.props.onDragEnter&&t.props.onDragEnter(r)},this.onDragLeave=function(e){if(t.props.preventBubblingDragEvents&&e.stopPropagation(),!t.props.greedy||t.isReallyLeavingDroppable(e)){var r=t.props.dropViewState.draggableItemType;r||(r=t.getDragType(e));var n={itemType:r};if("none"!=t.getDesiredDropEffect(n)){var o=function(r){return function(){t.props.onDragLeave&&t.props.onDragLeave(r,e.currentTarget),a(t.props.dropViewState,!1,null),t.pendingDragLeaveHandler=null}};t.props.shouldIgnoreTransientOnDragLeave?t.pendingDragLeaveHandler||(e.persist(),t.pendingDragLeaveHandler=setTimeout(o(n),s)):o(n)(),(Object(c.e)()||Object(c.g)())&&t.setDropEffectInternal(e,"none")}}},this.onDragOver=function(e){t.props.preventBubblingDragEvents&&e.stopPropagation();var r=t.props.dropViewState.draggableItemType;r||(r=t.getDragType(e));var n={itemType:r},o=t.getDesiredDropEffect(n);"none"!=o?(t.props.bypassActOnDrop||(e.preventDefault(),t.setDropEffectInternal(e,o)),t.props.shouldUseCopyAsDropEffect&&t.setDropEffectInternal(e,"copy"),t.props.onDragOver&&t.props.onDragOver(n,e.pageX,e.pageY,e.currentTarget),t.cancelPendingDragLeaveHandler(),t.props.dropViewState.isDragOver&&t.props.dropViewState.draggableItemType==r||a(t.props.dropViewState,!0,r)):t.props.bypassActOnDrop||t.setDropEffectInternal(e,"none")},this.onDrop=function(e){t.props.preventBubblingDragEvents&&e.stopPropagation();var r=t.getDragData(e);e.preventDefault(),"none"!=t.getDesiredDropEffect(r)&&(t.props.onDrop(r,e.pageX,e.pageY,e.currentTarget),t.props.onDragLeave&&t.props.onDragLeave(r,e.currentTarget),t.cancelPendingDragLeaveHandler(),Object(u.c)(null),a(t.props.dropViewState,!1,null))},this.refCallback=function(e){t.div=e}}return e.prototype.getDiv=function(){return this.div},e.prototype.cancelPendingDragLeaveHandler=function(){this.pendingDragLeaveHandler&&(clearTimeout(this.pendingDragLeaveHandler),this.pendingDragLeaveHandler=null)},e.prototype.isReallyLeavingDroppable=function(e){var t=document.elementFromPoint(e.pageX,e.pageY);return!this.isDescendantOrSelf(t,e.currentTarget)},e.prototype.isDescendantOrSelf=function(e,t){if(!e||!t)return!1;if(e==t)return!0;for(var r=e;r=r.parentElement;)if(r==t)return!0;return!1},e.prototype.getDesiredDropEffect=function(e){return e?this.props.canDrop?"boolean"==typeof this.props.canDrop(e)?this.props.canDrop(e)?"move":"none":this.props.canDrop(e):"move":"none"},e.prototype.getDragData=function(e){var t,r=null;if(e.dataTransfer.files&&e.dataTransfer.files.length>0)t=e.dataTransfer.files,r={itemType:o.a.LocalFile,files:t};else{for(var n=e.dataTransfer.types,i=null,a=!1,u=0;u<n.length;u++){var c=n[u];if("text"!=c){i=e.dataTransfer.getData(c),a=!0;break}}a||(i=e.dataTransfer.getData("text"));try{r=JSON.parse(i)}catch(e){r={itemType:"nothing"}}}return r},e.prototype.getDragType=function(e){var t=Object(u.a)(),r=e.dataTransfer?e.dataTransfer:e.nativeEvent.dataTransfer;if(!t&&r&&r.types&&r.types.length>0){var n=Array.prototype.slice.apply(e.dataTransfer.types),i=Object.values(o.a),a=n.filter((function(e){return i.indexOf(e)>=0}));a.length>0&&(t=a[0])}return t},e.prototype.setDropEffectInternal=function(e,t){e.dataTransfer&&(e.dataTransfer.dropEffect=t),Object(u.d)(t)},e}();t.b=n.forwardRef((function(e,t){var r=n.useRef(new p(e));return n.useImperativeHandle(t,(function(){return{getDiv:function(){return r.current.getDiv()}}}),[]),n.createElement("div",{ref:r.current.refCallback,className:e.classNames,style:e.style,onDrop:r.current.onDrop,onDragOver:r.current.onDragOver,onDragEnter:r.current.onDragEnter,onDragLeave:r.current.onDragLeave},e.children)}))},1699:function(e,t,r){"use strict";var n=r(0),o=r(1663);function i(e){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":e}}function a(e,t){t&&e&&Object(o.b)(t,i(e))}function u(e,t){var r,o=null!=t?t:{},i=(null===(r=o.headers)||void 0===r?void 0:r.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",a(e,i),Object(n.__assign)(Object(n.__assign)({},o),{headers:i})}var c=r(365),s=r(1662),p=r(85),d=r(352);function l(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(n.__generator)(this,(function(r){return[2,Object(p.b)().then((function(r){return Object(n.__awaiter)(t,void 0,void 0,(function(){var t,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return e?Object(c.r)(e.userIdentity)?[4,Object(s.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return t=n.sent(),d(r,t),[3,3];case 2:"GroupMailbox"!=e.type&&"TeamsMailbox"!=e.type||(o=i(e.mailboxSmtpAddress),d(r,o)),n.label=3;case 3:return[2,r]}}))}))}))]}))}))}function b(){return Object(p.b)().then((function(e){return e.prefer='exchange.Behavior="CalendarInternal"',e}))}function f(e){return void 0===e&&(e=null),Object(c.r)(e)?b().then((function(t){return Object(s.a)(e).then((function(e){return Object.keys(e).forEach((function(r){return t[r]=e[r]})),t}))})):Promise.resolve({})}var g=r(55);function v(e,t,r){var n=new Headers;return r&&n.set("X-OWA-CANARY",Object(g.a)()),t&&n.set("X-OWA-ActionName",t),e&&a(e,n),n}r.d(t,"a",(function(){return u})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return b})),r.d(t,"f",(function(){return a})),r.d(t,"e",(function(){return v}))},1705:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(37),o=r(1665);r.d(t,"b",(function(){return o.a}));var i=new n.c((function(){return r.e(1302).then(r.bind(null,1915))})),a=new n.a(i,(function(e){return e.getAndUpdateAccessToken}))},1746:function(e,t,r){"use strict";var n,o;function i(e){n=e}function a(){return n}function u(e){o=e}function c(){return o}r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return c}))},1797:function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var n=r(2),o={myOrgGroups:[],withContextMenuGroup:null,shouldShowAllGroups:!1,hasLoadedFromServer:!1,loadGroupsError:!1,groupNodeViewStates:new(r(9).ObservableMap)({})},i=Object(n.createStore)("leftNavGroupsStore",o),a=i();t.a=a},1808:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),o=Object(n.createStore)("currentGroupInformationStore",{smtpAddress:"",groupId:"",tenantId:""})},1866:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"UnifiedGroupIdentity:#Exchange"},e)}},1919:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"BodyContentType:#Exchange"},e)}},2709:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(17),o=r(18);function i(){var e;return(null===(e=Object(n.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(o.i)("cmp-proxy-address")}},2739:function(e,t,r){"use strict";function n(e,t,r){var n,o,i,a,u,c=e.groups.get(t.toLowerCase());if(c||(r.unreadMessageCount=null,r.groupDetailsError=r.groupDetailsError||!1),!r.groupDetailsError||c&&c.basicInformation||(r.basicInformation={SmtpAddress:t,DisplayName:t}),r.groupDetails){var s=r.groupDetails;c&&c.basicInformation&&!c.groupDetailsError||(r.basicInformation={SmtpAddress:s.SmtpAddress,DisplayName:s.DisplayName,AccessType:s.AccessType,LegacyDN:s.LegacyDN,MailboxGuid:s.MailboxGuid}),r.groupDetails.UserGroupRelationship={SubscriptionType:(null===(n=s.UserGroupRelationship)||void 0===n?void 0:n.SubscriptionType)||0,IsSubscribed:(null===(o=s.UserGroupRelationship)||void 0===o?void 0:o.IsSubscribed)||!1,ShouldIgnoreReply:(null===(i=s.UserGroupRelationship)||void 0===i?void 0:i.ShouldIgnoreReply)||!1,IsMember:(null===(a=s.UserGroupRelationship)||void 0===a?void 0:a.IsMember)||!1,IsOwner:(null===(u=s.UserGroupRelationship)||void 0===u?void 0:u.IsOwner)||!1}}return r}var o=r(148),i=r(1808),a=Object(o.action)("addOrUpdateGroup")((function(e,t,r,o,a){var u;t=t.toLowerCase();var c=void 0!==o&&""!==o;if(c&&(o=o.toLowerCase(),t=r.groupDetails.SmtpAddress),r=n(e,c?o:t,r),e.groups.has(t)||c&&e.groups.has(o)){var s=e.groups.has(t)?e.groups.get(t):e.groups.get(o);r.basicInformation&&(s.basicInformation=r.basicInformation),r.groupDetails&&((null===(u=s.groupDetails)||void 0===u?void 0:u.MailboxSettings)&&!r.groupDetails.MailboxSettings&&(r.groupDetails.MailboxSettings=s.groupDetails.MailboxSettings),s.groupDetails=r.groupDetails),r.members&&(s.members=r.members),null!=r.groupDetailsError&&(s.groupDetailsError=r.groupDetailsError),c&&t!==o&&(void 0!==a&&a(t,o),e.groups.set(t,s),e.groups.delete(o),Object(i.a)().smtpAddress=t)}else e.groups.set(t,r)}));t.a=a},3248:function(e,t,r){"use strict";var n=r(0),o=r(1797),i=r(9),a=r(698),u=r(263),c=r(1996),s=r(1),p=r(3340),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.stopPropagation(),t.props.selectGroup(t.props.groupId,t.props.customData)},t.toggleFavorite=function(){Object(p.a)(t.props.groupId)},t.onKeyDown=function(e){switch(e.keyCode){case 13:case 32:e.stopPropagation(),t.props.selectGroup(t.props.groupId,t.props.customData)}},t.renderRightCharm=function(){return t.props.renderRightCharm(t.props.groupId,t.props.customData)},t.renderRightCharmHover=function(){return t.props.renderRightCharmHover(t.props.groupId,t.props.customData)},t}return Object(n.__extends)(t,e),Object.defineProperty(t.prototype,"isSelected",{get:function(){return this.props.isSelected(this.props.groupId,this.props.customData)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isWithContextMenuOpen",{get:function(){return o.a.withContextMenuGroup&&this.props.groupId==o.a.withContextMenuGroup.groupId},enumerable:!1,configurable:!0}),t.prototype.shouldComponentUpdate=function(e,t){return!Object(u.f)(this.props,e)},t.prototype.render=function(){return s.createElement(c.a,{chevronProps:this.props.chevronProps,customIcon:this.props.customIcon,depth:1,displayName:this.props.displayName,isBeingDragged:this.props.isBeingDragged,isDroppedOver:this.props.isDroppedOver,isRootNode:!1,isSelected:this.isSelected,isWithContextMenuOpen:this.isWithContextMenuOpen,key:this.props.groupId,onClick:this.onClick,onContextMenu:this.props.onContextMenu,onKeyDown:this.onKeyDown,renderCustomTreeNodeDisplay:this.props.renderCustomTreeNodeDisplay,renderRightCharm:this.renderRightCharm,renderRightCharmHover:this.renderRightCharmHover,showAsHoverOnDroppedOver:this.props.showHoverStateOnDroppedOver,isFavorited:this.props.isFavorited,toggleFavorite:this.toggleFavorite})},Object(n.__decorate)([i.computed],t.prototype,"isSelected",null),Object(n.__decorate)([i.computed],t.prototype,"isWithContextMenuOpen",null),t=Object(n.__decorate)([a.observer],t)}(s.Component);t.a=d},3340:function(e,t,r){"use strict";var n=r(2);t.a=Object(n.action)("TOGGLE_FAVORITE_GROUPNODE_FROM_LEFTNAV",(function(e){return{groupId:e}}))},3670:function(e,t,r){"use strict";var n=r(148),o=r(2044),i=r(2512),a=r(1720),u=r(2739),c=r(1860),s=r(1777);var p=function(e,t){var r=Object(s.b)(t,"Site");r?!function(e){return-1==e.indexOf("_layouts/groupstatus.aspx")}(r)?Object(c.a)(e,1):Object(c.a)(e,2):Object(c.a)(e,0)},d=r(2),l=Object(d.action)("beforeGetGroupDetailsStartAction",(function(e){return{groupSmtpAddress:e}}));Object(d.orchestrator)(l,(function(e){3==Object(a.h)(e.groupSmtpAddress)&&Object(a.n)(e.groupSmtpAddress,1)}));var b=l,f=r(1808),g=Object(d.mutatorAction)("updateCurrentGroupIdAndTenantIdAction",(function(e,t){Object(f.a)().groupId=e,Object(f.a)().tenantId=t})),v=function(e,t){Object(u.a)(Object(a.j)(),e,{basicInformation:null,groupDetails:null,members:null,groupDetailsError:!0}),Object(a.n)(e,0),t&&t()},O=Object(n.action)("getGroupDetailsAction")((function(e,t,r,n){b(e),(o.g||i.f)(e,t).then((function(t){return function(e,t,r,n){if(e&&e.Body&&Object(i.i)(e.Body)){var o=e.Body.GroupDetails;o?(Object(u.a)(Object(a.j)(),o.SmtpAddress,{basicInformation:null,groupDetails:o,members:null,groupDetailsError:!1}),g(o.ExternalDirectoryObjectId,o.ExternalDirectoryOrganizationId),p(t,o),r&&r()):v(t,n)}else v(t,n)}(t,e,r,n)})).catch((function(t){v(e,n)}))}));t.a=O},369:function(e,t,r){"use strict";var n=r(0);function o(e,t){return e?Object(n.__assign)({mailboxInfo:e},t):null!=t?t:void 0}r.d(t,"a",(function(){return o}))},5799:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r(30);function i(e){return Object(n.__assign)({__type:"UpdateUserGroupsSetConfigurationRequest:#Exchange"},e)}function a(e){var t,r;void 0===(t={request:i({GroupsSet:e})}).request||t.request.__type||(t.request=i(t.request)),Object(o.a)("UpdateUserGroupsSetConfiguration",t,r)}var u=r(127),c=r(18),s=r(2690),p=r(7057),d=r(148),l=Object(d.action)("removeGroupFromLeftNav")((function(e,t){var r=t.myOrgGroups.indexOf(e);r>=0&&t.myOrgGroups.splice(r,1)})),b=r(3670),f=r(1681),g=r(1641),v=r(2422),O=r(1709),m=r(2822),h=r(6778),j=r(9486);function y(e){if(("RowModified"==e.EventType||"RowAdded"==e.EventType)&&null!=e.IsMember&&null!=e.Group){var t=e.Group.SmtpAddress.toLowerCase();h.d.importAndExecute(t,e.IsMember);var r=Object(s.b)();e.IsMember?r.myOrgGroups.includes(t)||($(),function(e){var t=Object(g.H)(),r=t&&Object(O.b)(t.tableQuery);r&&r.toLowerCase()===e&&Object(m.a)(t.tableQuery)}(t)):r.myOrgGroups.includes(t)&&(l(t,r),Object(p.c)(t),Object(b.a)(t),function(e){var t,r=Object(g.H)(),n=r&&Object(O.b)(r.tableQuery);if((null==n?void 0:n.toLowerCase())!==e)return;var o=Object(f.a)().groups.get(e);3!==(null===(t=null==o?void 0:o.basicInformation)||void 0===t?void 0:t.AccessType)&&(v.a.clear(r,null),Object(m.b)(r,"ErrorAccessDenied"))}(t))}}var D=r(3783),S=r(2739),w=r(1043),T=r(1042),I=r(168),G=r(20),A=r(48),x=r(1720),_=r(4),E=r(1672),C=r(3021),L=r(3128),M=r(3673),N=r(2019),R=r(1730),F=r(2398),k=r(369),H=5,U=1e4,P=30,B="GroupModulePrefetch",V="X-OWA-ActionSource",X="GroupMailbox_WarmUp",q="X-OWA-ActionName",W=!1;function J(){var e=Object(x.j)();W||(W=!0,setTimeout((function(){if(function(e){var t,r;try{for(var o=Object(n.__values)(s.c.myOrgGroups),i=o.next();!i.done;i=o.next()){var a=i.value;if(Q(e,a,P))return!0}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return!1}(e)){Object(M.b)(Date.now());var t=function(e){var t=s.c.myOrgGroups.filter((function(t,r){return Object(E.isGroupInFavorites)(t)&&Q(e,t,P)})).slice(0,H);if(t.length<H){var r=s.c.myOrgGroups.filter((function(t,r){return r<C.a&&!Object(E.isGroupInFavorites)(t)&&Q(e,t,P)}));t=t.concat(r).slice(0,H)}return t}(e);t.forEach((function(e){(function(e){var t=Object(L.b)(),r=Object(L.a)(e,t);switch(t){case 0:return function(e){var t=new Headers;return t.set(V,B),t.set(q,X),Object(N.d)("inbox",1,e.viewFilter,e.sortBy,!1,e.focusedViewFilter,e.requestShapeName,Object(R.d)(e),void 0,e.categoryName,void 0,{headers:t})}(r);case 1:return function(e){return Object(c.i)("mon-messageList-useGqlForFindItem")?Object(N.h)(Object(g.i)(e),1,e.viewFilter,e.sortBy,!1,e.focusedViewFilter,e.requestShapeName,Object(R.d)(e),e.shouldTryToUseSessionDataResponse,z(e),e.categoryName):Object(N.c)(Object(g.i)(e),0,1,e.viewFilter,Object(F.a)(e),e.focusedViewFilter,e.requestShapeName,e.shouldTryToUseSessionDataResponse,z(e),e.categoryName)}(r)}return Promise.resolve()})(e).catch((function(e){}))})),Object(M.c)(t)}}),U))}function Q(e,t,r){var n=e.groups.get(t.toLowerCase());if(!n||!n.basicInformation)return!1;var o=n.basicInformation;if(!o.LastVisitedTimeUtc)return!1;var i=Object(_.mc)(o.LastVisitedTimeUtc),a=Object(_.Xb)(i),u=Object(_.lc)();return Object(_.Nb)(a,Object(_.e)(u,-r),u)}function z(e){var t=Object(k.a)(Object(R.d)(e))||{};return t.headers=new Headers,t.headers.set(V,B),t.headers.set(q,X),t}var Y=r(8172),K=!1;var $=Object(d.action)("loadGroups")((function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,o,i,p;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return K?[2]:(t=new u.b("loadGroups"),K=!0,d=new Array,Object(c.i)("tri-favorites-roaming")?d.push({FilterType:0,SortType:4,SortDirection:"Descending"}):(d.push({FilterType:1,SortType:4,SortDirection:"Descending"}),d.push({FilterType:2,SortType:4,SortDirection:"Descending"})),r=Object(w.a)({RequestedGroupsSets:d,AdditionalProperties:[4]}),[4,Object(T.a)({Header:Object(I.b)(),Body:r})]);case 1:return"Success"==(o=n.sent()).Body.ResponseClass?(t.end(),s.c.loadGroupsError=!1,s.c.hasLoadedFromServer=!0,ee(i=o.Body.GroupsSets),a(i),e&&J()):(p="There was an error loading groups: "+Object(D.b)(o),t.addCustomData({error:p}),t.endWithError("ServerError",new Error(p)),s.c.loadGroupsError=!0),K=!1,[2,Promise.resolve()]}var d}))}))})),Z=Object(A.d)("loadGroupsFromSessionData",{name:"LoadGroupsInLeftNavFromSessionData",options:{}})((function(){if(!K){K=!0;var e=Object(Y.a)();if(!e)return G.g.info("GroupsSets data is not available in session data"),void(K=!1);ee(e.UnifiedGroupsSets),K=!1}}));function ee(e){if(e){s.c.myOrgGroups=[];var t=Object(x.j)();e.forEach((function(e){e.Groups.forEach((function(e){s.c.myOrgGroups.push(e.SmtpAddress.toLowerCase()),Object(S.a)(t,e.SmtpAddress,{basicInformation:e,groupDetails:null,members:null})}))}))}Object(p.b)(),Object(j.a)(y)}var te=r(17),re=r(399);function ne(){var e=!Object(te.a)().UserOptions.IsGroupsTreeCollapsed;Object(re.a)((function(t){t.UserOptions.IsGroupsTreeCollapsed=e}),[{key:"IsGroupsTreeCollapsed",valuetype:"Boolean",value:[String(e)]}])}function oe(e){return Object(n.__assign)({__type:"SetUnifiedGroupLastVisitedTimeJsonRequest:#Exchange"},e)}var ie=r(1866);function ae(e){var t,r,i,a=Object(ie.a)({Type:0,Value:e});void 0===(t=oe({Header:Object(I.b)(),Body:(i={GroupIdentity:a,LastVisitedTimeUtc:(new Date).toISOString(),PreserveReadState:!0},Object(n.__assign)({__type:"SetUnifiedGroupLastVisitedTimeRequest:#Exchange"},i))}))||t.__type||(t=oe(t)),Object(o.a)("SetUnifiedGroupLastVisitedTime",t,r)}r.d(t,"loadGroups",(function(){return $})),r.d(t,"loadGroupsFromSessionData",(function(){return Z})),r.d(t,"removeGroupFromLeftNav",(function(){return l})),r.d(t,"toggleGroupTreeExpansion",(function(){return ne})),r.d(t,"unsubscribeFromUnreadNotifications",(function(){return p.c})),r.d(t,"setGroupLastVisitedTime",(function(){return ae}))},614:function(e,t,r){"use strict";var n=r(2),o=Object(n.action)("initializeOwaObservableDateTime"),i=Object(n.action)("observableNowChanged"),a=Object(n.action)("observableTodayChanged"),u=r(4),c=r(9),s=Object(n.createStore)("ObservableDateTime",{now:0,today:0}),p=Object(c.computed)((function(){return Object(u.mc)(s().now)})),d=function(){return p.get()},l=Object(c.computed)((function(){return Object(u.mc)(s().today)})),b=function(){return l.get()},f=function(e){return Object(u.Hb)(e,d())},g=function(e){return Object(u.Fb)(e,d())},v=function(e){return m(e,u.Hb)},O=function(e){return m(e,u.Ib)},m=function(e,t){return t(Object(u.Xb)(Object(u.mc)(e)),b())};function h(e){if(!e)return"";var t=Object(u.mc)(e);return function(e,t){var r=Object(u.Xb)(e);if(Object(u.Jb)(r,t))return u.ab;var n=function(e){return Object(u.Nb)(r,Object(u.e)(t,-e),t)};if(n(3))return u.ib;if(n(30))return u.hb;return u.Y}(t,b())(t)}function j(e){if(!e)return"";var t=Object(u.mc)(e);return function(e,t){var r=Object(u.Xb)(e);if(Object(u.Jb)(r,t))return u.T;return u.U}(t,b())(t)}function y(e){return e?function(e,t){var r=Object(u.Xb)(e);return Object(u.Jb)(r,t)?Object(u.ab)(e):D(r,t,2)?Object(u.lb)(e):D(r,t,7)?Object(u.H)(Object(u.bb)(e),Object(u.ab)(e)):Object(u.H)(Object(u.J)(e),Object(u.ab)(e))}(Object(u.mc)(e),b()):""}function D(e,t,r){return Object(u.Nb)(e,Object(u.e)(t,-r),t)}var S=Object(n.action)("updateTimes"),w=Object(n.action)("setNow"),T=Object(n.action)("setToday",(function(e){return{today:e}}));Object(n.mutator)(w,(function(){s().now=Object(u.kc)()})),Object(n.mutator)(T,(function(e){var t=e.today;s().today=t}));var I=r(32),G=r(126),A=!1;Object(n.orchestrator)(o,(function(){if(S(),!A){var e=Object(u.Qb)(),t=Object(u.Zb)(Object(u.h)(e,1)),r=Object(u.w)(t,e);setTimeout((function(){return setInterval(S,I.g)}),r),document&&document.addEventListener("visibilitychange",S),A=!0}})),Object(n.orchestrator)(G.l,(function(){S()})),Object(n.orchestrator)(S,(function(){w();var e=Object(u.Ab)(Object(u.lc)()),t=s().today!=e;t&&T(e),i(),t&&a()})),r.d(t,"d",(function(){return o})),r.d(t,"j",(function(){return i})),r.d(t,"l",(function(){return a})),r.d(t,"i",(function(){return d})),r.d(t,"k",(function(){return b})),r.d(t,"g",(function(){return f})),r.d(t,"e",(function(){return g})),r.d(t,"f",(function(){return v})),r.d(t,"h",(function(){return O})),r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return j})),r.d(t,"c",(function(){return y}))},6778:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return u})),r.d(t,"e",(function(){return c})),r.d(t,"d",(function(){return s}));var n=r(37),o=new n.c((function(){return Promise.all([r.e(48),r.e(134),r.e(614)]).then(r.bind(null,9451))})),i=new n.a(o,(function(e){return e.loadGroupAction})),a=new n.a(o,(function(e){return e.onAfterNewGroupSelectedAction})),u=new n.a(o,(function(e){return e.onAfterGroupDetailsSucceededAction})),c=new n.a(o,(function(e){return e.setGroupIsSubscribedAction})),s=new n.a(o,(function(e){return e.setGroupIsMemberAction}))},711:function(e,t,r){"use strict";var n=r(0),o=r(1),i=r(413),a=r(518),u=r(517),c=r(12),s=r(238),p=r(414),d=r(465),l=Object(s.c)((function(e,t){var r,n=Object(p.a)(e),o=Object(d.a)(e),i=e.palette,a={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",color:e.semanticColors.link},rootHovered:{color:i.themeDarkAlt,backgroundColor:i.neutralLighter,selectors:(r={},r[c.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},r)},rootHasMenu:{width:"auto"},rootPressed:{color:i.themeDark,backgroundColor:i.neutralLight},rootExpanded:{color:i.themeDark,backgroundColor:i.neutralLight},rootChecked:{color:i.themeDark,backgroundColor:i.neutralLight},rootCheckedHovered:{color:i.themeDark,backgroundColor:i.neutralQuaternaryAlt},rootDisabled:{color:i.neutralTertiaryAlt}};return Object(c.concatStyleSets)(n,a,o,t)}));r.d(t,"a",(function(){return b}));var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,r=e.theme;return o.createElement(i.a,Object(n.__assign)({},this.props,{variantClassName:"ms-Button--icon",styles:l(r,t),onRenderText:a.b,onRenderDescription:a.b}))},t=Object(n.__decorate)([Object(u.a)("IconButton",["theme","styles"],!0)],t)}(o.Component)},8172:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(272);function o(){return Object(n.a)().groups}},9486:function(e,t,r){"use strict";var n=r(717),o=r(5498);function i(e){n.b.import().then((function(t){n.f.importAndExecute({subscriptionId:"GroupAssociationNotification",requiresExplicitSubscribe:!0,subscriptionParameters:Object(o.a)({NotificationType:"GroupAssociationNotification",ChannelId:t()})},e)}))}r.d(t,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.MailBoot~GroupList.js.map
self.scriptsLoaded['owa.MailBoot~GroupList.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GroupList.js'] = (new Date()).getTime();