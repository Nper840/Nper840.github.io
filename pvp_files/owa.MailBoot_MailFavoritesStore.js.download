self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFavoritesStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[656],{1007:function(e,t,n){"use strict";var r=n(0),i=n(148),o=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,t){var n,i;if(!this.store){this.store=e,this.deleteCallback=t;try{for(var o=Object(r.__values)(e.keys()),a=o.next();!a.done;a=o.next()){var c=a.value;this.mruList.push(c)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}},e.prototype.add=function(e,t){var n=this;Object(i.action)("MruCache_add")((function(){n.store.set(e,t),n.mruList.indexOf(e)>=0?n.touch(e):(n.mruList.push(e),n.purgeIfNecessary())}))()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var t=this.store.get(e);return t&&this.touch(e),t},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var t=this;Object(i.action)("MruCache_remove")((function(){if(t.store.has(e)&&!t.isReferenced(e))return t.removeItemAtIndex(t.mruList.indexOf(e))}))()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(i.action)("MruCache_clear")((function(){e.purgeTillSize(0)}))()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.__spread)([void 0],this.mruList)))},e.prototype.touch=function(e){var t=this.mruList.indexOf(e);if(t<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(t,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var t=0;this.mruList.length>e&&t<this.mruList.length;){var n=this.mruList[t];this.isReferenced(n)?t++:this.removeItemAtIndex(t)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)},e.prototype.isReferenced=function(e){for(var t=0;t<this.references.length;t++){var n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1},e}();n.d(t,"a",(function(){return o}))},13174:function(e){e.exports=JSON.parse('{"a":"iAb"}')},1696:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n(1985),i=n(17),o=n(1732);function a(){return s(r.a.Bottom)}function c(){return s(r.a.Off)}function u(){return s(r.a.Right)}function s(e){var t=Object(o.a)();return null!==t.clientReadingPanePosition?t.clientReadingPanePosition===e:Object(i.a)().UserOptions.GlobalReadingPanePositionReact==e}function d(){var e=Object(i.a)().UserOptions.GlobalReadingPanePositionReact;return e==r.a.Off||e==r.a.Bottom}},1709:function(e,t,n){"use strict";var r=n(37),i=n(1641);function o(){return a(Object(i.H)())}function a(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function c(){var e=Object(i.H)();return e&&2==e.tableQuery.type}function u(e){return!!e&&(2==e.type||s(e))}function s(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function d(e){return 2==e.type?e.folderId:s(e)?e.searchScope.groupId:null}function l(){var e=Object(i.H)();return e&&u(e.tableQuery)}n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return p})),n.d(t,"m",(function(){return v})),n.d(t,"l",(function(){return b})),n.d(t,"j",(function(){return O})),n.d(t,"i",(function(){return w})),n.d(t,"k",(function(){return h})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"f",(function(){return l}));var f=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(20),n.e(21),n.e(49),n.e(80),n.e(703)]).then(n.bind(null,17550))})),m=new r.b(f,(function(e){return e.getGroupDisplayName})),p=new r.b(f,(function(e){return e.getGroupDisplayNameFromTableView})),v=new r.b(f,(function(e){return e.isPrivateUnjoinedGroup})),b=new r.b(f,(function(e){return e.isJoinedGroup})),O=new r.b(f,(function(e){return e.getRetentionPolicyTagsForGroup})),w=new r.b(f,(function(e){return e.getRetentionPolicyTagListForGroupTableQuery})),h=new r.b(f,(function(e){return e.isGroupOwner}))},1715:function(e,t,n){"use strict";n.d(t,"q",(function(){return d})),n.d(t,"t",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"o",(function(){return v})),n.d(t,"b",(function(){return b})),n.d(t,"m",(function(){return O})),n.d(t,"f",(function(){return w})),n.d(t,"p",(function(){return h})),n.d(t,"s",(function(){return g})),n.d(t,"r",(function(){return I})),n.d(t,"g",(function(){return j})),n.d(t,"j",(function(){return M})),n.d(t,"k",(function(){return S})),n.d(t,"n",(function(){return L})),n.d(t,"d",(function(){return R})),n.d(t,"c",(function(){return F})),n.d(t,"h",(function(){return y})),n.d(t,"l",(function(){return V}));var r=n(0),i=n(48),o=n(1641),a=n(1647),c=n(2),u=n(1696),s=n(17),d=Object(c.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(N(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(c.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(N(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(c.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,i){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:i}})),m=Object(c.action)("EXPAND_ROW_FIRST_LEVEL",(function(e,t){return{rowKey:e,latestItemIdsInForks:t}})),p=Object(c.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),v=Object(c.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",(function(e){return{rowKey:e}})),b=Object(c.action)("ITEM_PART_SELECTED",(function(e,t,n,r,i){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:i}})),O=Object(c.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),w=Object(c.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),h=Object(c.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r,i){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r,currentSelectedNodeIds:i}})),g=Object(c.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),I=Object(c.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),j=Object(c.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),M=Object(c.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),S=Object(c.action)("RESET_SELECTION",(function(e){return{tableView:e}})),L=Object(c.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(i.c)(N(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),R=Object(c.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),F=Object(c.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),y=Object(c.action)("RESET_BUS_STOP_STATE_MAP"),V=Object(c.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}}));function N(e,t,n,i){return{name:function(e,t,n,i){return!(function(e){return e===a.b.MailListItemRichPreview||e===a.b.KeyboardShiftEnter||e===a.b.MailListItemBodyDoubleClick}(e)||Object(u.c)()&&!function(e){var t;return e===a.b.KeyboardEnter||e===a.b.MailListItemBody||e===a.b.RouteHandler||e===a.b.CommandBarArrows||e===a.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(s.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,i){if(Object(u.c)())return!1;if(e===a.b.KeyboardUpDown){var c=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==c&&1===t.selectedRowKeys.size){var s=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return i===o.d.Next?s===c+1||s===t.rowKeys.length-1&&c===t.rowKeys.length-1:s===c-1||0===s&&0===c}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,i))}(e,t,n,i)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},1729:function(e,t,n){"use strict";var r=n(235),i=n(1644),o=new Map;var a=n(1821),c=n(1709),u=n(2242);function s(e){return e?d(e.tableQuery):Object(r.d)()}function d(e){var t=Object(c.b)(e),n=null==e?void 0:e.folderId;return null!=t?Object(a.a)(t):l(n)}function l(e){return Object(i.H)(e)?Object(u.a)(e):function(e){if(!e)return Object(r.d)();if(!o.has(e)){var t=Object(i.v)(e,!0);o.set(e,t)}return o.get(e)}(e)}function f(e){return{mailboxInfo:d(e)}}n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return f}))},1730:function(e,t,n){"use strict";var r=n(1729),i=n(1641);function o(){return Object(r.a)(Object(i.H)())}n.d(t,"b",(function(){return r.a})),n.d(t,"d",(function(){return r.c})),n.d(t,"c",(function(){return r.b})),n.d(t,"e",(function(){return r.d})),n.d(t,"a",(function(){return o}))},1732:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.createStore)("maillayout",{clientReadingPanePosition:null,showReadingPane:!1,showListPane:!0,showFolderPane:!0})},17332:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(2),o=n(48),a=n(18),c=n(1668),u=1e4,s={folderId:"",timeRemoved:null};function d(e){return!(!s.folderId||s.folderId!=e)&&(new Date).getTime()-s.timeRemoved.getTime()<u}var l=Object(i.action)("ADD_FAVORITE_FOLDER",(function(e,t,n){return Object(o.c)({name:Object(a.i)("tri-favorites-roaming")?"AddOutlookFavoriteFolder":"AddFavoriteFolder",customData:{actionSource:t,distinguishedFolderName:Object(c.a)(e),wasFolderUnfavoritedRecently:d(e)}},{folderIdToAdd:e,actionSource:t,newIndex:n})})),f=n(3792),m=n(563),p=n(7401),v=n(7402);function b(e,t){var n=function(e,t){var n=Object(m.a)({Id:e.FolderId.Id,ChangeKey:e.FolderId.ChangeKey});return Object(p.a)({Folder:Object(f.a)({FolderId:n,DisplayName:e.DisplayName}),Operation:t?0:1})}(e,t);return Object(v.a)({request:n}).then((function(e){return e}))}var O=n(1644),w=n(148),h=n(1672),g=n(1785),I=Object(w.action)("addFavoriteFolderV1")(Object(w.select)({favoritesFolderNodes:function(){return h.favoritesStore.favoritesFolderNodes},orderedFavoritesNodeIds:function(){return h.favoritesStore.orderedFavoritesNodeIds},folder:function(e,t){return void 0===t&&(t=0),0==t?O.d.folderTable.get(e):g.a.folderTable.get(e)}})((function(e,t,n){if(void 0===t&&(t=0),n.favoritesFolderNodes.has(e))throw new Error("addFavoriteFolderV1: Cannot add duplicate folder to favorites.");n.orderedFavoritesNodeIds.push(e),n.favoritesFolderNodes.set(e,{id:e,type:t}),Object(h.updateFavoritesUserOption)(),b(n.folder,!0)}))),j=(Object(i.orchestrator)(l,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.folderIdToAdd,n=e.newIndex,Object(a.i)("tri-favorites-roaming")?[4,h.lazyAddFavoriteFolderV2.import()]:[3,2];case 1:return r.sent()(t,n),[3,3];case 2:I(t),r.label=3;case 3:return[2]}}))}))})),Object(i.action)("REMOVE_FAVORITE_FOLDER",(function(e,t){return Object(o.c)({name:Object(a.i)("tri-favorites-roaming")?"RemoveFavoriteFolderV2":"RemoveFavoriteFolderV1",customData:{actionSource:t,distinguishedFolderName:Object(c.a)(e)}},{folderIdToRemove:e,actionSource:t})}))),M=Object(w.action)("removeFavoriteFolderV1")(Object(w.select)({favoritesFolderNodes:function(){return h.favoritesStore.favoritesFolderNodes},orderedFavoritesNodeIds:function(){return h.favoritesStore.orderedFavoritesNodeIds}})((function(e,t){if(!t.favoritesFolderNodes.has(e))throw new Error("removeFavoriteFolderV1: Cannot find the folder id in favorite folder list.");var n=0==h.favoritesStore.favoritesFolderNodes.get(e).type?O.d.folderTable.get(e):g.a.folderTable.get(e);t.orderedFavoritesNodeIds.splice(t.orderedFavoritesNodeIds.indexOf(e),1),t.favoritesFolderNodes.delete(e),Object(h.updateFavoritesUserOption)(),s={folderId:e,timeRemoved:new Date},b(n,!1)}))),S=(Object(i.orchestrator)(j,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=e.folderIdToRemove,Object(a.i)("tri-favorites-roaming")?[4,h.lazyRemoveFavoriteFolderV2.import()]:[3,2];case 1:return n.sent()(t),[3,3];case 2:M(t),n.label=3;case 3:return[2]}}))}))})),n(7403)),L=n(3565),R=n(3339),F=n(1723);Object(i.orchestrator)(h.onCategoryFavorited,(function(e){var t=e.categoryId;S.a(t),function(e){var t=Object(R.a)(e),n=Object(F.c)(t,!0);Object(L.d)(n,!1,(function(t,n,r,i){return function(e){S.b(e)}(e)}))}(t)}));Object(i.orchestrator)(h.onCategoryUnfavorited,(function(e){S.b(e.categoryId)}));var y=n(13174),V=n(7993),N=n(7146),A=n(7994),E=n(7147),_=n(6),T=n(3049);function C(e){var t=e?T.c.RemoveFavoritePersonaFailedNotification:T.c.AddFavoritePersonaFailedNotification;Object(T.g)(t,null);var n={actionType:t,title:e?Object(_.b)(N.a):Object(_.b)(E.a),description:e?Object(_.b)(V.a):Object(_.b)(A.a),actionLink:Object(_.b)(y.a)};Object(T.f)(n)}var P=n(20);function D(e){var t=e?Object(_.b)(N.a):Object(_.b)(E.a);P.g.warn(t)}Object(i.orchestrator)(h.addFavoriteFailed,(function(e){var t=e.favoriteKind;"persona"===t?C(!1):"privatedistributionlist"===t&&D(!1)}));var k=n(2985),x=n(6165),U=(Object(i.orchestrator)(k.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.personas,n=t.map((function(e){return e.searchFolderId})).filter((function(e){return!!e})),[4,Object(x.b)(n)];case 1:return i=r.sent(),Object(O.S)(i,t),[2]}}))}))})),Object(i.orchestrator)(h.removeFavoriteFailed,(function(e){var t=e.favoriteKind,n=e.error;n&&404===n.statusCode||("persona"===t?C(!0):"privatedistributionlist"===t&&D(!0))})),Object(w.action)("markFavoritePersonaNodeAsAdded")(Object(w.select)({favoritesPersonaNodes:function(){return h.favoritesStore.favoritesPersonaNodes}})((function(e,t){var n=t.favoritesPersonaNodes.get(e);n&&(n.isJustAdded=!1)})))),K=n(10517),B=n(11320),q=n(219),z=n(127),G=n(2565),H=Object(o.d)("validateAndUpdateFavorite",G.a.ValidateAndUpdateFavorite)((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,a,c,u,s,d,l,f,m,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(h.getStore)(),n=t.favoritesPersonaNodes.get(e),i=Object(q.b)(e)?e:"",n.personaId?(o=Object(B.a)(n.mainEmailAddress,n.displayName,!1),[4,Object(K.a)(n.personaId)]):[3,5];case 1:return(p=r.sent())?(c=p,[3,4]):[3,2];case 2:return[4,o];case 3:c=r.sent(),r.label=4;case 4:return(a=c)?(u=a.DisplayName,s=W(a.EmailAddress),d=(a.EmailAddresses||[]).map(W),l=n.displayName!==u,f=n.mainEmailAddress!==s,v=n.allEmailAddresses,b=d,m=!(v&&b&&v.length===b.length&&v.every((function(e){return b.includes(e)}))),l||f||m?(Object(z.r)("ValidateAndUpdateFavorite: Change Detected",["ContactToUpdatedContact",i,l,f,m]),Q(n,u,s,d,a.PersonaId.Id),[2,!0]):[2,!1]):(Object(z.r)("ValidateAndUpdateFavorite: Change Detected",["ContactToRecipentCache",i]),Q(n,n.displayName,n.mainEmailAddress,n.allEmailAddresses),[2,!0]);case 5:return[4,Object(B.a)(n.mainEmailAddress,n.displayName,!1)];case 6:return(p=r.sent())?(Object(z.r)("ValidateAndUpdateFavorite: Change Detected",["RecipientCacheToContact",i]),Q(n,p.DisplayName,W(p.EmailAddress),p.EmailAddresses.map(W),p.PersonaId.Id),[2,!0]):[2,!1];case 7:return[2]}var v,b}))}))})),Q=Object(w.action)("updatePersona")((function(e,t,n,r,i){e.displayName=t||n,e.mainEmailAddress=n,e.allEmailAddresses=r,i?e.personaId=i:delete e.personaId}));function W(e){return e?e.RoutingType&&"EX"===e.RoutingType.toUpperCase()?e.OriginalDisplayName:e.EmailAddress||e.OriginalDisplayName:""}var J=n(8599),X=n(1778),Y=Object(w.action)("updateSelectedNodeWithNewPersona")((function(e){var t=Object(h.getStore)().favoritesPersonaNodes.get(e),n=Object(X.d)();n.selectedNode=Object(r.__assign)(Object(r.__assign)({},n.selectedNode),{displayName:t.displayName,mainEmailAddress:t.mainEmailAddress})})),$=n(10519),Z=Object(o.d)("onFavoritePersonaSelected",G.a.OnFavoritePersonaSelectedAction)(Object(w.select)({favoritesPersonaNodes:function(){return h.favoritesStore.favoritesPersonaNodes}})((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if((n=t.favoritesPersonaNodes.get(e)).isSyncUpdateDone)return[2];r.label=1;case 1:return r.trys.push([1,6,,7]),[4,H(n.id)];case 2:return(i=r.sent())&&Y(n.id),[4,Object(J.a)(n,"OnClick",i)];case 3:return(o=r.sent())&&setTimeout((function(){Object($.b)(n.id)}),$.a),i||o?[4,Object(h.updateFavoritesUserOption)()]:[3,5];case 4:r.sent(),r.label=5;case 5:return[3,7];case 6:return a=r.sent(),c="UpdatePersonaAndSearchFolderFailure",P.g.warn(c+": "+a),Object(z.r)(c,[a.toString()]),[3,7];case 7:return[2]}}))}))}))),ee=Object(o.d)("onFavoritePersonaUpdated",G.a.OnFavoritePersonaUpdatedAction)((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(h.getStore)().favoritesPersonaNodes.get(e),[4,H(t.id)];case 1:return n=r.sent(),[4,Object(J.a)(t,"OnFavoriteUpdate",n)];case 2:return i=r.sent(),n||i?[4,Object(h.updateFavoritesUserOption)()]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}));function te(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e.markedForDeletion?[4,Object(x.a)([e.searchFolderId],!0)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[3,4];case 3:return t=r.sent(),n=G.a.DeleteFolderFailure,i=n.name,o=n.customData,P.g.warn(i+": "+t),Object(z.r)(i,o(t.toString())),[3,4];case 4:return[2]}}))}))}var ne=n(2527),re=Object(o.d)("removeFavoritePersona",G.a.RemoveFavoritePersonaAction)((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,a,c,u,s,d,l,f,m,p;return Object(r.__generator)(this,(function(v){switch(v.label){case 0:t=Object(h.getStore)(),n=t.favoritesPersonaNodes.get(e),i=void 0,o=!1,v.label=1;case 1:if(v.trys.push([1,9,,10]),!n)throw new Error("RemoveFavoritePersona - NodeId could not be found in the store");if(i=n.mainEmailAddress||n.personaId||n.id,Object(ne.a)(i))throw new Error("RemoveFavoritePersona - Favoriting is already in progress");return S.a(i),o=!0,(a=t.orderedFavoritesNodeIds.indexOf(e))>-1&&t.orderedFavoritesNodeIds.splice(a,1),t.favoritesPersonaNodes.delete(e),[4,Object(h.updateFavoritesUserOption)()];case 2:v.sent(),c=n.searchFolderId,v.label=3;case 3:return v.trys.push([3,7,,8]),c?(u=Object(X.c)()).id!==e?[3,4]:(u.markedForDeletion=!0,[3,6]):[3,6];case 4:return[4,Object(x.a)([c],!0)];case 5:v.sent(),v.label=6;case 6:return[3,8];case 7:return s=v.sent(),d=G.a.DeleteFolderFailure,m=d.name,l=d.customData,P.g.warn(m+": "+s),Object(z.r)(m,l(s.toString())),[3,8];case 8:return S.b(i),[3,10];case 9:throw f=v.sent(),o&&S.b(i),m="RemoveFavoritePersonaFailure",P.g.warn(m+": "+f),p=t.favoritesPersonaNodes.size,Object(z.r)(m,[f.toString(),e,p.toString()]),n&&!t.favoritesPersonaNodes.has(n.id)&&(t.orderedFavoritesNodeIds.push(n.id),t.favoritesPersonaNodes.set(n.id,n)),Object(r.__assign)({type:"RemoveFavoritePersonaError"},f);case 10:return[2]}}))}))}));function ie(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return Object(a.i)("tri-favorites-roaming")?[4,h.lazyRemoveFavoritePersonaV2.import()]:[3,2];case 1:return n.sent()(e,t),[3,3];case 2:return[2,re(e,t)];case 3:return[2]}}))}))}var oe=Object(o.d)("RemoveFavoriteSearch",G.a.RemoveFavoriteSearch)((function(e,t){var n=Object(h.getStore)();if(!n.favoriteSearches.has(e))throw new Error("Cannot find the search query in favorite search list.");n.orderedFavoritesNodeIds.splice(n.orderedFavoritesNodeIds.indexOf(e),1),n.favoriteSearches.delete(e),Object(h.updateFavoritesUserOption)()})),ae=n(17),ce=n(399);function ue(){var e=!Object(ae.a)().UserOptions.IsFavoritesFolderTreeCollapsed;Object(ce.a)((function(t){t.UserOptions.IsFavoritesFolderTreeCollapsed=e}),[{key:"IsFavoritesFolderTreeCollapsed",valuetype:"Boolean",value:[String(e)]}])}var se=n(9497),de=n(10518),le=n(2045),fe=Object(o.d)("initializeFavoritePersonas",G.a.InitializeFavoritePersonasAction)((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(x.c)()];case 1:return t=n.sent(),Object(le.getStore)().favoritePersonasRootFolderId=t,[4,me(t,e)];case 2:return n.sent(),[2]}}))}))}));function me(e,t){return Object(x.e)(t,e).then((function(e){e.forEach((function(e){Object(de.a)(e)}))})).catch((function(e){var t="RetrievePersonaSearchFoldersFailed";P.g.warn(t+": "+e),Object(z.r)(t,[e.toString()])}))}n.d(t,"addFavoriteFolder",(function(){return l})),n.d(t,"removeFavoriteFolder",(function(){return j})),n.d(t,"addFavoriteFolderV1",(function(){return I})),n.d(t,"removeFavoriteFolderV1",(function(){return M})),n.d(t,"markFavoritePersonaNodeAsAdded",(function(){return U})),n.d(t,"onFavoritePersonaSelected",(function(){return Z})),n.d(t,"onFavoritePersonaUpdated",(function(){return ee})),n.d(t,"onSelectedPersonaNodeChanged",(function(){return te})),n.d(t,"removeFavoritePersona",(function(){return ie})),n.d(t,"handleToggleFavoritePersonaError",(function(){return C})),n.d(t,"removeFavoriteSearch",(function(){return oe})),n.d(t,"toggleFavoritesTreeExpansion",(function(){return ue})),n.d(t,"addFavoritePersona",(function(){return se.a})),n.d(t,"initializeFavoritePersonas",(function(){return fe})),n.d(t,"outlookFavoritePersonasLoaded",(function(){return k.a}))},1785:function(e,t,n){"use strict";var r=n(9),i=n(2),o={folderTable:new r.ObservableMap,rootFolder:null},a=Object(i.createStore)("publicFolderFavoriteStore",o)();t.a=a},1821:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(235),i={};function o(e){var t=e.toLocaleLowerCase();if(!i[t]){var n={type:"GroupMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e};i[t]=n}return i[t]}},1832:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return i})),n.d(t,"v",(function(){return o})),n.d(t,"t",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"e",(function(){return v})),n.d(t,"m",(function(){return b})),n.d(t,"d",(function(){return O})),n.d(t,"k",(function(){return w})),n.d(t,"s",(function(){return h})),n.d(t,"o",(function(){return g})),n.d(t,"u",(function(){return I})),n.d(t,"r",(function(){return j})),n.d(t,"q",(function(){return M})),n.d(t,"n",(function(){return S}));var r="multipart/signed",i="application/pkcs7-mime",o="application/x-pkcs7-mime",a=".p7m",c="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",u="CLASSID",s="4",d="0800",l=57,f=78,m=16,p=11,v="IPM.Note.SMIME.MultipartSigned",b="smime-",O="image",w="OwaToSmime",h="SmimeToOwa",g="en-US",I=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],j="OwaSmimeEdgeExtension.appxbundle",M="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",S="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},1849:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(235);function i(e){return{type:"PublicMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e}}},1867:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2086);function i(e){return e&&Object(r.b)(e.ItemClass)}},1901:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SortResults:#Exchange"},e)}},1970:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="IPM.Note.SMIME"},1985:function(e,t,n){"use strict";var r;!function(e){e[e.Off=0]="Off",e[e.Right=1]="Right",e[e.Bottom=2]="Bottom"}(r||(r={})),t.a=r},2014:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",(function(){return r}))},2046:function(e,t,n){"use strict";var r=n(37),i=n(2087),o=n(2121),a=n(2088),c=n(2014),u=n(2089),s=n(2056),d=n(2122);function l(e){var t=e;return"Single"===t.CalendarItemType&&!t.RecurrenceId}function f(e){return!!e.RecurrenceId}n.d(t,"s",(function(){return p})),n.d(t,"t",(function(){return v})),n.d(t,"w",(function(){return b})),n.d(t,"d",(function(){return O})),n.d(t,"g",(function(){return w})),n.d(t,"h",(function(){return h})),n.d(t,"b",(function(){return g})),n.d(t,"f",(function(){return I})),n.d(t,"e",(function(){return j})),n.d(t,"i",(function(){return M})),n.d(t,"j",(function(){return S})),n.d(t,"a",(function(){return L})),n.d(t,"c",(function(){return R})),n.d(t,"v",(function(){return F})),n.d(t,"u",(function(){return y})),n.d(t,"k",(function(){return i.a})),n.d(t,"x",(function(){return o.a})),n.d(t,"m",(function(){return a.a})),n.d(t,"q",(function(){return c.a})),n.d(t,"r",(function(){return u.a})),n.d(t,"l",(function(){return s.a})),n.d(t,"o",(function(){return d.a})),n.d(t,"p",(function(){return l})),n.d(t,"n",(function(){return f}));var m=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(6),n.e(13),n.e(17),n.e(22),n.e(23),n.e(28),n.e(30),n.e(37),n.e(42),n.e(47),n.e(135),n.e(136),n.e(267),n.e(262),n.e(676)]).then(n.bind(null,17293))})),p=new r.a(m,(function(e){return e.addItemToCalendar})),v=new r.a(m,(function(e){return e.initializeMeetingRequestViewStateAction})),b=new r.a(m,(function(e){return e.removeCancelledMeetingFromCalendar})),O=Object(r.d)(m,(function(e){return e.MeetingMessageInfo})),w=(Object(r.d)(m,(function(e){return e.MeetingRequestActions})),Object(r.d)(m,(function(e){return e.MeetingCancellationAction})),Object(r.d)(m,(function(e){return e.MeetingActionButton})),Object(r.d)(m,(function(e){return e.MeetingDetailsTime})),Object(r.d)(m,(function(e){return e.MeetingDetailsLocation})),Object(r.d)(m,(function(e){return e.MeetingRequestInfo}))),h=Object(r.d)(m,(function(e){return e.MeetingRequestResponseEditor})),g=Object(r.d)(m,(function(e){return e.MeetingDetails})),I=Object(r.d)(m,(function(e){return e.MeetingRequestConflicts})),j=(Object(r.d)(m,(function(e){return e.EditEventLink})),Object(r.d)(m,(function(e){return e.MeetingMessageSummary}))),M=Object(r.d)(m,(function(e){return e.PreviewSummary})),S=Object(r.d)(m,(function(e){return e.SenderSummary})),L=Object(r.d)(m,(function(e){return e.CollapsedMeetingMessage})),R=Object(r.d)(m,(function(e){return e.MeetingIcon})),F=new r.a(m,(function(e){return e.logMeetingMessageActionForInvite})),y=new r.a(m,(function(e){return e.logMeetingMessageActionForEvent}))},2056:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}n.d(t,"a",(function(){return r}))},206:function(e,t,n){var r;
/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r))e.push(i.apply(null,r));else if("object"===o)for(var a in r)n.call(r,a)&&r[a]&&e.push(a)}}return e.join(" ")}e.exports?e.exports=i:void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},2086:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(1832),i=n(1970);function o(e){return e&&0===e.indexOf(r.e)}function a(e){return e&&0===e.indexOf(i.a)&&!o(e)}function c(e){return e&&0===e.indexOf(i.a)}function u(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},2087:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("deleteMeetingMessage",(function(e,t){return{item:e,issueDeleteItemCall:t}}))},2088:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.ItemClass)&&e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",(function(){return r}))},2089:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}n.d(t,"a",(function(){return r}))},2121:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("meetingMessageAddToCalendarStatusChanged",(function(e,t){return{status:e,sxsId:t}}))},2122:function(e,t,n){"use strict";function r(e){var t=e;return"RecurringMaster"===t.CalendarItemType&&!t.RecurrenceId}n.d(t,"a",(function(){return r}))},2150:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.createStore)("headerToastNotificationViewState",{notificationViewStates:[]})()},2151:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r="Calling",i="UnreadMessage",o="Summary"},2229:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(e,t){return{itemIdToRemove:e,removeItemSource:t}}))},2242:function(e,t,n){"use strict";var r=n(1641),i=n(1644);function o(){var e=Object(r.H)();return e&&0==e.tableQuery.type&&Object(i.H)(e.tableQuery.folderId)}function a(){var e=Object(r.H)();return e&&0==e.tableQuery.type&&Object(i.H)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var c=n(2),u=n(1785),s=n(1849),d=n(9),l=Object(c.createStore)("publicFolderUtilsStore",new d.ObservableMap),f=n(71);function m(e){if(!l().has(e)){var t=u.a.folderTable.get(e),n=null!=t.ReplicaList?t.ReplicaList[0]:Object(f.h)().SessionSettings.DefaultPublicFolderMailbox,r=Object(s.a)(n);p(e,r)}return l().get(e)}var p=Object(c.mutatorAction)("addPublicFolderMailboxInfoToStore",(function(e,t){l().set(e,t)}));n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return m}))},2299:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var r=350,i=270,o=418},2315:function(e,t,n){"use strict";var r=n(148),i=n(2150);t.a=Object(r.action)("removeNotification")((function(e){var t=i.a.notificationViewStates.indexOf(e);t>=0&&i.a.notificationViewStates.splice(t,1)}))},2323:function(e,t,n){"use strict";function r(e){var t="";return e.graphQLErrors&&e.graphQLErrors.forEach((function(e){var n;(null===(n=e.extensions)||void 0===n?void 0:n.responseCode)&&(t=e.extensions.responseCode)})),t}n.d(t,"a",(function(){return r}))},2341:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.AsyncSendFailed=0]="AsyncSendFailed",e[e.AddFavoritePersonaFailedNotification=1]="AddFavoritePersonaFailedNotification",e[e.RemoveFavoritePersonaFailedNotification=2]="RemoveFavoritePersonaFailedNotification",e[e.PeopleHubNotification=3]="PeopleHubNotification",e[e.SkypeNotification=4]="SkypeNotification",e[e.SkypeForBusinessNotification=5]="SkypeForBusinessNotification"}(r||(r={}))},2398:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1737),i=n(1641),o=n(440),a=n(794),c=n(1901),u=n(966);function s(e){var t,n,s=e.sortBy;switch(s.sortColumn){case 1:Object(r.l)(e)?t="ReceivedOrRenewTime":Object(u.a)("drafts")==e.folderId&&(t="ItemLastModifiedTime");break;case 3:n=!0,t=Object(o.a)({PropertyTag:"0x0042",PropertyType:"String"});break;case 7:t="Size";break;case 5:t="Importance";break;case 8:t="Subject";break;default:throw new Error("getMailItemSortByProperty: sort column not supported"+s.sortColumn)}var d=[];if(t){var l=t;n||(l=Object(a.a)({FieldURI:t})),d.push(Object(c.a)({Order:s.sortDirection,Path:l}))}var f=1==e.sortBy.sortColumn?e.sortBy.sortDirection:i.c.DESCENDING_SORT_DIR;return d.push(Object(c.a)({Order:f,Path:Object(a.a)({FieldURI:"DateTimeReceived"})})),d}},2446:function(e,t,n){"use strict";var r=n(1723),i=n(1737),o=n(1641),a=n(148);t.a=Object(a.action)("onLoadInitialRowsSucceeded")((function(e,t,n,a,c){2==e.tableQuery.type&&c&&(e.serverFolderId=c.Id),a&&(e.serverFolderId=a.Id);var u=Object(o.e)(e);Object(i.h)(t,e,n,u,e.isInitialLoadComplete,"MergeOnInitialRowsFetch"),e.currentLoadedIndex=Math.min(r.b,e.rowKeys.length)}))},2643:function(e,t,n){"use strict";var r=n(0),i=n(148),o=n(2150),a=0;t.a=Object(i.action)("addNotification")((function(e){var t=Object(r.__assign)({id:a++},e);o.a.notificationViewStates.push(t)}))},2644:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(2341),i=n(2315),o={};function a(e,t){var n=r.a[e];o[n]||(o[n]=t)}function c(e){var t=o[r.a[e.actionType]];t&&t(e),Object(i.a)(e)}},2762:function(e,t,n){"use strict";var r;!function(e){e[e.None=-1]="None",e[e.Categories=0]="Categories",e[e.ImportanceHigh=1]="ImportanceHigh",e[e.Attachment=2]="Attachment",e[e.MailListViewReplied=3]="MailListViewReplied",e[e.MailListViewForwarded=4]="MailListViewForwarded",e[e.MailListViewIRM=5]="MailListViewIRM",e[e.MailListViewIRMReplied=6]="MailListViewIRMReplied",e[e.MailListViewIRMForwarded=7]="MailListViewIRMForwarded",e[e.MailListViewVoiceMailItem=8]="MailListViewVoiceMailItem",e[e.MailListViewVoiceMailReplied=9]="MailListViewVoiceMailReplied",e[e.MailListViewVoiceMailForwarded=10]="MailListViewVoiceMailForwarded",e[e.MailListViewVoiceMailIRM=11]="MailListViewVoiceMailIRM",e[e.MailListViewFaxItem=12]="MailListViewFaxItem",e[e.MailListViewAppointmentItem=13]="MailListViewAppointmentItem",e[e.MailListViewAppointmentAccepted=14]="MailListViewAppointmentAccepted",e[e.MailListViewAppointmentDeclined=15]="MailListViewAppointmentDeclined",e[e.MailListViewAppointmentTentative=16]="MailListViewAppointmentTentative",e[e.MailListViewAppointmentCanceled=17]="MailListViewAppointmentCanceled",e[e.MailListViewContactItem=18]="MailListViewContactItem",e[e.MailListViewTaskItem=19]="MailListViewTaskItem",e[e.MailListViewTaskReocurItem=20]="MailListViewTaskReocurItem",e[e.MailListViewJournalItem=21]="MailListViewJournalItem",e[e.MailListViewPostItem=22]="MailListViewPostItem",e[e.MailListViewNoteItem=23]="MailListViewNoteItem",e[e.MailListViewDelivery=24]="MailListViewDelivery",e[e.MailListViewNonDelivery=25]="MailListViewNonDelivery",e[e.MailListViewApprovalRequest=26]="MailListViewApprovalRequest",e[e.MailListViewResponseApprove=27]="MailListViewResponseApprove",e[e.MailListViewResponseReject=28]="MailListViewResponseReject",e[e.MailListViewOutOfOffice=29]="MailListViewOutOfOffice",e[e.MailListViewReadReport=30]="MailListViewReadReport",e[e.MailListViewReminderMessage=31]="MailListViewReminderMessage",e[e.Smime=32]="Smime",e[e.TrustedSender=33]="TrustedSender",e[e.Charm=34]="Charm",e[e.ImportanceLow=35]="ImportanceLow",e[e.GlobalMentionedMe=36]="GlobalMentionedMe",e[e.Like=37]="Like",e[e.Snooze=38]="Snooze",e[e.ReadGlobalMentionedMe=39]="ReadGlobalMentionedMe",e[e.Link=40]="Link"}(r||(r={})),t.a=r},2825:function(e,t,n){"use strict";var r=n(2446),i=n(1641),o=n(1730),a=n(1737),c=n(1723),u=n(2019),s=n(563),d=n(2323);var l=n(18),f=n(2398);var m=n(20),p=n(2);function v(e,t,n){switch(b(e),e.tableQuery.listViewType){case 0:return function(e,t,n){var l,f=e.tableQuery,m=null===(l=Object(i.j)(e,!0))||void 0===l?void 0:l.Id,p=f.viewFilter&&"All"!==f.viewFilter,v=i.c.getDefaultSortBy(),b=v.sortColumn,O=v.sortDirection,w=f.sortBy&&(f.sortBy.sortColumn!==b||f.sortBy.sortDirection!==O);return Object(u.d)(f.folderId,c.a,f.viewFilter,f.sortBy,Object(a.l)(f),f.focusedViewFilter,f.requestShapeName,Object(o.d)(f),void 0,f.categoryName,m,{datapoint:{customData:{scenarioType:f.scenarioType,isPrefetch:t,isFilter:p,isSort:w}}},f.shouldTryToUseSessionDataResponse).then((function(i){var o=[];i.edges&&(o=i.edges.map((function(e){return e.node}))),Object(r.a)(e,o,i.totalConversationRowsInView,i.searchFolderId?Object(s.a)({Id:i.searchFolderId}):null,i.folderId?Object(s.a)({Id:i.folderId}):null),n(e,!0,"200",t)})).catch((function(r){var i=Object(d.a)(r);return n(e,!1,i,t),Promise.reject(r)}))}(e,t,n);case 1:return function(e,t,n){var m=e.tableQuery;return Object(l.i)("mon-messageList-useGqlForFindItem")?Object(u.h)(Object(i.i)(m),c.a,m.viewFilter,m.sortBy,Object(a.l)(m),m.focusedViewFilter,m.requestShapeName,Object(o.d)(m),m.shouldTryToUseSessionDataResponse,Object(o.e)(m),m.categoryName,Object(i.j)(e,!0)).then((function(i){var o=[];i.edges&&(o=i.edges.map((function(e){return e.node}))),Object(r.a)(e,o,i.totalItemRowsInView,i.searchFolderId?Object(s.a)({Id:i.searchFolderId}):null,null),n(e,!0,"200",t)})).catch((function(r){var i=Object(d.a)(r);return n(e,!1,i,t),Promise.reject(r)})):Object(u.c)(Object(i.i)(m),0,c.a,m.viewFilter,Object(f.a)(m),m.focusedViewFilter,m.requestShapeName,m.shouldTryToUseSessionDataResponse,Object(o.e)(m),m.categoryName,Object(i.j)(e,!0)).then((function(i){var o,a=Promise.resolve(),c="Success"==i.ResponseClass;if(c)Object(r.a)(e,null===(o=i.RootFolder.Items)||void 0===o?void 0:o.map((function(e){return e})),i.RootFolder.TotalItemsInView,i.SearchFolderId,null);else{var u=new Error("ResponseCode="+i.ResponseCode+", Stacktrace="+i.StackTrace);u.fetchErrorType="ServerFailure",a=Promise.reject(u)}return n(e,c,i.ResponseCode,t),a}),(function(r){var i,o=(null===(i=null==r?void 0:r.response)||void 0===i?void 0:i.status)||"";return n(e,!1,o,t),Promise.reject(r)}))}(e,t,n);default:return m.g.warn("listViewType: "+e.tableQuery.listViewType+" is not supported."),Promise.resolve()}}n.d(t,"a",(function(){return v}));var b=Object(p.mutatorAction)("setTableViewLoading",(function(e){e.isLoading=!0,e.loadErrorStatus=0}))},2854:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1644);function i(e){return Object(r.D)(e,"SharedMailbox")}},3049:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"i",(function(){return f}));var r=n(37),i=n(2643);n.d(t,"f",(function(){return i.a}));var o=n(2341);n.d(t,"c",(function(){return o.a}));var a=n(2644);n.d(t,"g",(function(){return a.a}));var c=n(2151);n.d(t,"a",(function(){return c.a})),n.d(t,"b",(function(){return c.b})),n.d(t,"e",(function(){return c.c}));var u=n(2150);n.d(t,"h",(function(){return u.a}));var s=n(2315);n.d(t,"j",(function(){return s.a}));var d=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(6),n.e(20),n.e(691)]).then(n.bind(null,5130))})),l=Object(r.d)(d,(function(e){return e.NotificationToast})),f=new r.a(d,(function(e){return e.addNotification}))},3156:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("UPDATE_TABLE_CURRENT_LOADED_INDEX",(function(e,t){return{tableViewId:e,currentLoadedIndexToSet:t}}))},3157:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("EMPTY_FOLDER_STORE_UPDATE",(function(e,t,n,r){return{folder:e,clientLastSyncTime:t,deletedItemsFolderId:n,rowKeysToExclude:r}}))},3339:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2073),i=n(893),o=n(1641),a=n(966);function c(e){var t=Object(i.k)(e,Object(i.o)());return Object(r.a)(Object(a.a)("msgfolderroot"),Object(o.A)(null),"category",-1,"UserCategory",t)}},3408:function(e,t,n){"use strict";var r=n(37),i=n(1641),o=n(1730),a=n(1647),c=n(1668),u=n(1970);var s=n(1867),d=n(148);function l(e,t){if(t.folderId&&"junkemail"==Object(c.a)(t.folderId))return!1;if(Object(s.a)(e))return!1;var n=a.u.items.get(e.ItemId.Id);return!(null==n||!n.shouldShowAttachmentPreviews)||!(!e.HasAttachments&&!e.HasProcessedSharepointLink)&&(v.importAndExecute(Object(o.d)(t),e.ConversationId,e.ItemId.Id),!0)}var f=Object(d.select)({listViewStore:function(){return i.Y}})((function(e,t,n){var r,i,a,s=1==t.type,d=e.ConversationId,l=n.listViewStore.conversationItems.get(d.Id),f=e.HasProcessedSharepointLink;if(t.folderId&&"junkemail"==Object(c.a)(t.folderId))return!1;if((null==(r=e)?void 0:r.ItemClasses)&&r.ItemClasses.length>0&&r.ItemClasses.some((function(e){return 0===e.indexOf(u.a)})))return!1;if(s){if(l)return l.shouldShowAttachmentPreviews;i=a=!!e.HasAttachments}else{if(!e.HasAttachmentPreviews&&!f)return!1;l&&!f?(i=l.globalItemIds.length!=e.GlobalItemIds.length,a=l.shouldShowAttachmentPreviews):(i=!0,a=!0)}return i&&v.importAndExecute(Object(o.d)(t),e.ConversationId,null),a}));n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return l}));var m=new r.c((function(){return n.e(497).then(n.bind(null,17534))})),p=new r.a(m,(function(e){return e.getPreviews})),v=new r.a(m,(function(e){return e.add})),b=new r.a(m,(function(e){return e.getAttachmentsForConversationWell})),O=new r.a(m,(function(e){return e.removeAttachmentPreviewsForRow}))},3565:function(e,t,n){"use strict";var r=n(37),i=n(1715),o=n(3157),a=n(2762),c=n(3993),u=n(206),s=n(5243);function d(e){switch(e){case a.a.ReadGlobalMentionedMe:return{iconClasses:u(s.accountsRead),iconName:"Accounts"};case a.a.GlobalMentionedMe:return{iconClasses:u(s.accounts),iconName:"Accounts"};case a.a.Attachment:return{iconName:"Attach"};case a.a.ImportanceLow:return{iconName:"Down"};case a.a.ImportanceHigh:return{iconClasses:u(s.redDark),iconName:"Important"};case a.a.Like:return{iconName:"Like"};case a.a.Snooze:return{iconClasses:u(s.snooze),iconName:"Clock"};case a.a.MailListViewReplied:return{iconName:"Reply"};case a.a.MailListViewForwarded:return{iconName:"Forward"};case a.a.MailListViewIRM:case a.a.MailListViewIRMReplied:case a.a.MailListViewIRMForwarded:return{iconName:"Lock"};case a.a.MailListViewVoiceMailItem:return{iconName:"Memo"};case a.a.MailListViewVoiceMailReplied:return{iconName:"VoicemailReply"};case a.a.MailListViewVoiceMailForwarded:return{iconName:"VoicemailForward"};case a.a.MailListViewVoiceMailIRM:return{iconName:"VoicemailIRM"};case a.a.MailListViewFaxItem:return{iconName:"Fax"};case a.a.MailListViewAppointmentItem:return{iconName:"Event"};case a.a.MailListViewAppointmentAccepted:return{iconName:"EventAccepted"};case a.a.MailListViewAppointmentDeclined:return{iconName:"EventDeclined"};case a.a.MailListViewAppointmentTentative:return{iconName:"EventTentative"};case a.a.MailListViewAppointmentCanceled:return{iconName:"RemoveEvent"};case a.a.MailListViewContactItem:return{iconName:"ContactCard"};case a.a.MailListViewTaskItem:return{iconName:"CheckboxComposite"};case a.a.MailListViewTaskReocurItem:return{iconName:"RecurringTask"};case a.a.MailListViewJournalItem:return{iconName:"DietPlanNotebook"};case a.a.MailListViewPostItem:return{iconName:"NotePinned"};case a.a.MailListViewNoteItem:return{iconName:"QuickNote"};case a.a.MailListViewDelivery:return{iconName:"ReceiptForward"};case a.a.MailListViewNonDelivery:case a.a.MailListViewApprovalRequest:case a.a.MailListViewResponseApprove:case a.a.MailListViewResponseReject:return{iconName:"ReceiptReply"};case a.a.MailListViewOutOfOffice:return{iconName:"OutOfOffice"};case a.a.MailListViewReadReport:return{iconName:"ReceiptCheck"};case a.a.MailListViewReminderMessage:return{iconName:"Ringer"};case a.a.Link:return{iconName:"Link"};default:throw new Error("No CSS class icon for the given property icon")}}var l=n(2825),f=n(3156),m=n(1641),p=n(2);Object(p.mutator)(f.a,(function(e){Object(m.K)().tableViews.get(e.tableViewId).currentLoadedIndex=e.currentLoadedIndexToSet}));n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return c.a})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l.a}));var v=new r.c((function(){return n.e(1421).then(n.bind(null,17646))}));Object(r.f)(i.f,v,(function(e){return e.mailListItemExpansionOrchestrators})),Object(r.f)(o.a,v,(function(e){return e.emptyFolderStoreUpdateOrchestrator}))},390:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemId:#Exchange"},e)}},3993:function(e,t,n){"use strict";var r=n(2762);var i,o=((i={})["MailReplied".toString()]=r.a.MailListViewReplied,i["MailForwarded".toString()]=r.a.MailListViewForwarded,i["MailIrm".toString()]=r.a.MailListViewIRM,i["MailIrmReplied".toString()]=r.a.MailListViewIRMReplied,i["MailIrmForwarded".toString()]=r.a.MailListViewIRMForwarded,i);function a(){var e={};return e["MailReplied".toString()]=r.a.MailListViewVoiceMailReplied,e["MailForwarded".toString()]=r.a.MailListViewVoiceMailForwarded,e["Default".toString()]=r.a.MailListViewVoiceMailItem,e}function c(){var e={};return e["MailReplied".toString()]=r.a.MailListViewVoiceMailIRM,e["Default".toString()]=r.a.MailListViewVoiceMailIRM,e}var u=function(){var e={};e["ipm.note"]=o,e["ipm.note.irm"]=function(){var e={};return e["MailReplied".toString()]=r.a.MailListViewIRMReplied,e["MailForwarded".toString()]=r.a.MailListViewIRMForwarded,e["Default".toString()]=r.a.MailListViewIRM,e["MailIrmReplied".toString()]=r.a.MailListViewIRMReplied,e["MailIrmForwarded".toString()]=r.a.MailListViewIRMForwarded,e}(),e["ipm.note.microsoft.exchange.voice.um.ca"]=a(),e["ipm.note.microsoft.exchange.voice.um"]=a(),e["ipm.note.microsoft.voicemail.um.ca"]=a(),e["ipm.note.microsoft.voicemail.um"]=a(),e["ipm.note.rpmsg.microsoft.voicemail.um.ca"]=c(),e["ipm.note.rpmsg.microsoft.voicemail.um"]=c();var t={};return t["Default".toString()]=r.a.MailListViewFaxItem,e["ipm.note.microsoft.exchange.fax.ca"]=t,e["ipm.note.microsoft.exchange.fax.um.ca"]=t,e["ipm.note.microsoft.fax.ca"]=t,(t={})["Default".toString()]=r.a.MailListViewAppointmentItem,e["ipm.appointment"]=t,e["ipm.schedule.meeting.request"]=t,(t={})["AppointmentMeetCancel".toString()]=r.a.MailListViewAppointmentCanceled,t["Default".toString()]=r.a.MailListViewAppointmentCanceled,e["ipm.schedule.meeting.canceled"]=t,(t={})["Default".toString()]=r.a.MailListViewContactItem,e["ipm.contact"]=t,e["ipm.distlist"]=t,(t={})["TaskRecur".toString()]=r.a.MailListViewTaskReocurItem,t["TaskItem".toString()]=r.a.MailListViewTaskItem,t["TaskOwned".toString()]=r.a.MailListViewTaskItem,t["TaskDelegated".toString()]=r.a.MailListViewTaskItem,t["Default".toString()]=r.a.MailListViewTaskItem,e["ipm.task"]=t,(t={})["Default".toString()]=r.a.MailListViewJournalItem,e["ipm.activity"]=t,(t={})["Default".toString()]=r.a.MailListViewPostItem,e["ipm.post"]=t,(t={})["Default".toString()]=r.a.MailListViewNoteItem,e["ipm.stickynote"]=t,(t={})["Default".toString()]=r.a.MailListViewNonDelivery,e["report.ipm.note.ndr"]=t,e["report.ipm.ndr"]=t,e["report.ipm.note.mobile.sms.ndr"]=t,e["report.ipm.schedule.meeting.resp.neg.ndr"]=t,e["report.ipm.schedule.meeting.resp.pos.ndr"]=t,e["report.ipm.schedule.meeting.resp.tent.ndr"]=t,e["report.ipm.taskrequest.ndr"]=t,e["report.ipm.oof.ndr"]=t,e["report.report.ipm.note.ipnnrn.ndr"]=t,e["report.ipm.note.smime.ndr"]=t,e["report.ipm.note.smime.multipartsigned.ndr"]=t,(t={})["Default".toString()]=r.a.MailListViewDelivery,e["report.ipm.note.dr"]=t,e["report.ipm.dr"]=t,e["report.ipm.schedule.meeting.request.dr"]=t,e["report.ipm.note.smime.dr"]=t,e["report.ipm.note.smime.multipartsigned.dr"]=t,(t={})["Default".toString()]=r.a.MailListViewApprovalRequest,e["ipm.note.microsoft.approval.request"]=t,(t={})["Default".toString()]=r.a.MailListViewResponseApprove,e["ipm.note.microsoft.approval.reply.approve"]=t,(t={})["Default".toString()]=r.a.MailListViewResponseReject,e["ipm.note.microsoft.approval.reply.reject"]=t,(t={})["Default".toString()]=r.a.MailListViewOutOfOffice,e["ipm.note.rules.ooftemplate.microsoft"]=t,(t={})["Default".toString()]=r.a.MailListViewReadReport,e["report.ipm.note.ipnrn"]=t,(t={})["Default".toString()]=r.a.MailListViewReminderMessage,e["ipm.note.reminder.event"]=t,e}();var s=function(){var e={},t={};return t["AppointmentMeetYes".toString()]=r.a.MailListViewAppointmentAccepted,t["Default".toString()]=r.a.MailListViewAppointmentAccepted,e["ipm.schedule.meeting.resp.pos"]=t,(t={})["AppointmentMeetMaybe".toString()]=r.a.MailListViewAppointmentTentative,t["Default".toString()]=r.a.MailListViewAppointmentTentative,e["ipm.schedule.meeting.resp.tent"]=t,(t={})["AppointmentMeetNo".toString()]=r.a.MailListViewAppointmentDeclined,t["Default".toString()]=r.a.MailListViewAppointmentDeclined,e["ipm.schedule.meeting.resp.neg"]=t,e}();function d(e,t,n){var i=e[t];return(null==i?void 0:i[n])?i[n.toString()]:r.a.None}function l(e,t){var n=d(s,e,t);return n==r.a.None&&Object.keys(s).forEach((function(n){if(0==e.indexOf(n)&&n[t.toString()])return n[t.toString()]})),n}function f(e,t,n){if(n)switch(t){case"MailReplied":t="MailIrmReplied";break;case"MailForwarded":t="MailIrmForwarded";break;default:t="MailIrm"}var i=!1;if(e&&e.length>0){var a=e.length;if(1==a)return function(e,t){if(t||(t="Default"),!e)return r.a.None;e=e.toLowerCase();var n=d(u,e,t);return n==r.a.None&&(n=d(u,e,"Default")),n===r.a.None&&(n=l(e,t)),n===r.a.None&&(n=l(e,"Default")),n}(e[0],t);for(var c=0;c<a;c++)if(-1==e[c].toLowerCase().indexOf("ipm.schedule.meeting")){i=!0;break}}else i=!0;return i?o[t?t.toString():null]:r.a.MailListViewAppointmentItem}n.d(t,"a",(function(){return f}))},441:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,i=t%n;return(((e-=r)/n&(t-=i)/n)>>>0)*n+((r&i)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},5243:function(e,t,n){var r=n(5244),i=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},5244:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,'._378AqQXt7Vn66ek8Mf4Fo5:before{color:"[theme:redDark, default:#a80000]"!important}._32S8K94lku5ujN8zmSd9ED:before{color:"[theme:green20, default:#0b6a0b]"!important}html[dir] ._32S8K94lku5ujN8zmSd9ED:before{margin-bottom:2px}._3Y1jo0XOp_HAd3rW6--a2L:before{color:"[theme:themePrimary, default:#0078D4]"!important}._3K512Ld4FHiESFMYdEMLkE:before{color:"[theme:themePrimary, default:#0078D4]"}',""]),t.locals={redDark:"_378AqQXt7Vn66ek8Mf4Fo5",snooze:"_32S8K94lku5ujN8zmSd9ED",accounts:"_3Y1jo0XOp_HAd3rW6--a2L",accountsRead:"_3K512Ld4FHiESFMYdEMLkE"}},527:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return s}));var r=n(10),i=new r.b((function(){return Promise.all([n.e(40),n.e(46),n.e(85),n.e(105),n.e(494)]).then(n.bind(null,1279))})),o=new r.a(i,(function(e){return e.createApolloClient})),a=new r.a(i,(function(e){return e.wrapInApolloProvider})),c=new r.a(i,(function(e){return e.unblockBootResolvers})),u=new r.a(i,(function(e){return e.getApolloClient})),s=new r.c(i,(function(e){return e.ApolloProvider}))},621:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s}));var r=n(0),i=n(527),o=null,a=null;function c(){return d(o),o}function u(){return d(a),a}function s(e){var t=e.lazyResolvers,n=e.lazyLocalStateResolvers,c=e.lazyCreateManagedQueryLink,u=e.context;return o=Promise.all([i.b.import(),t,n,c]).then((function(e){var t=Object(r.__read)(e,4),n=t[0],i=t[1],o=t[2],c=t[3];return a=n({resolvers:i,localStateResolvers:o,createManagedQueryLink:c,context:u})}))}function d(e){if(!e)throw new Error("Apollo client has not been initialized yet.")}},713:function(e,t,n){"use strict";var r=n(621);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.c}));var i=n(527);n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return i.c})),n.d(t,"e",(function(){return i.d})),n.d(t,"f",(function(){return i.e}))},7146:function(e){e.exports=JSON.parse('{"a":"lAb"}')},7147:function(e){e.exports=JSON.parse('{"a":"jAb"}')},738:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=1,i=16},7401:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"UpdateFavoriteFolderRequest:#Exchange"},e)}},7402:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(30),i=n(7401);function o(e,t){return void 0===e.request||e.request.__type||(e.request=Object(i.a)(e.request)),Object(r.a)("UpdateFavoriteFolder",e,t)}},799:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},e)}},7993:function(e){e.exports=JSON.parse('{"a":"mAb"}')},7994:function(e){e.exports=JSON.parse('{"a":"kAb"}')}}]);
//# sourceMappingURL=owa.MailBoot~MailFavoritesStore.js.map
self.scriptsLoaded['owa.MailBoot~MailFavoritesStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFavoritesStore.js'] = (new Date()).getTime();