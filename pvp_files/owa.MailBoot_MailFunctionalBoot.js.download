self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[660],{1008:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(811);function o(e){return Object(r.b)().projections.filter((function(t){return t.tabId==e}))[0]}},1009:function(e,t,n){"use strict";var r=n(0),o=n(64),i=600,a=800,c=8,u=25,s={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},d=-1;function l(e,t,n){try{t=function(e){var t=u*(1+(d=(d+1)%c)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),i),width:Math.max(8*Math.pow(window.innerWidth,2/3),a)};return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s),n),e)}(t);var l=(n||window).open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map((function(t){return t+"="+("boolean"==typeof(n=e[t])?n?"1":"0":n?String(n):void 0);var n})).join(",")}(t));return(Object(o.e)()||Object(o.f)())&&l.moveTo(t.left,t.top),l}catch(e){return null}}var f=n(811);var b=n(1030),v=n(48),O=n(798),p=n(127);t.a=Object(v.d)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,o,i){return[(t||"").split("/")[0],i]}})((function(e,t,n,r,o,i,a){var c=function(e){var t=null,n=void 0,r=null,o=null;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,Object(f.b)().isAvailable&&(t=e.projectionTabId||null),r=e.projectionTargetWindow,o=e.projectionParentWindow)),{deeplinkCallback:void 0===n?function(){return Promise.resolve(null)}:"function"==typeof n?n:function(){return Promise.resolve(n)},projectionTabId:t,projectionTargetWindow:r,projectionParentWindow:o}}(n),u=c.deeplinkCallback,s=c.projectionTabId,d=c.projectionTargetWindow,v=c.projectionParentWindow,j=new p.b(s?"PopoutProjectionPerf":"PopoutDeeplinkPerf"),m=s?"about:blank":Object(b.a)(e,t,{skipOptinCheck:o,urlParameters:a}),w=d||l(m,r,v);w&&O.h.import().then((function(t){return t(e,w,s,u,j)}))}))},1030:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),o=n(497),i=n(675),a="version";function c(e,t,n){var c;void 0===n&&(n={});var u=n.isStandalone?{}:((c={})[i.a]=i.b,c[a]=Object(r.p)(),c),s=n.urlParameters||{};return Object.keys(s).map((function(e){u[e]=s[e]})),Object(o.p)(e,t,n.skipOptinCheck,u)}},1270:function(e,t,n){var r=n(1271),o=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1271:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}},1662:function(e,t,n){"use strict";var r=n(0),o=n(1705),i=n(365),a=n(614),c=n(127),u=n(4),s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";function b(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,b,v,O,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(i.k)(e)){if(b.accountState==i.b.AccessRevoked)return[2,null];if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.c)(b.accountState,b.accountProviderType),[2,null]}return t?(n[s]=t,n[f]=t):b&&(n[s]=b.anchorMailbox),b?(v=b.token,!(O=Object(a.g)(b.tokenExpiry))&&v?[3,2]:(Object(c.r)("getAndUpdateAccessToken",{tokenExpiry:Object(u.y)(b.tokenExpiry,Object(u.Qb)()),isTokenExpired_1:O,isTokenInvalid_2:!v},{isCore:!0}),[4,o.a.importAndExecute(b.accountId,e,v)])):[3,3];case 1:(v=r.sent())||(v=""),r.label=2;case 2:p=void 0,"Outlook"==b.accountProviderType?(p='MSAuth1.0 usertoken="'+v+'", type="MSACT"',n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(p="Bearer "+v,n[l]=2..toString()),n[d]=p,r.label=3;case 3:return[2,n]}}))}))}var v=n(1663),O=n(20);function p(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(v.a)(),o=n,[4,j(e,t)];case 1:return o.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function j(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,[4,b(e.mailboxInfo.userIdentity,m(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(v.b)(o,i),[2,o]}}))}))}function m(e,t){var n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&O.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return m}))},1663:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function o(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},1665:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},1699:function(e,t,n){"use strict";var r=n(0),o=n(1663);function i(e){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":e}}function a(e,t){t&&e&&Object(o.b)(t,i(e))}function c(e,t){var n,o=null!=t?t:{},i=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",a(e,i),Object(r.__assign)(Object(r.__assign)({},o),{headers:i})}var u=n(365),s=n(1662),d=n(85),l=n(352);function f(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(r.__generator)(this,(function(n){return[2,Object(d.b)().then((function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e?Object(u.r)(e.userIdentity)?[4,Object(s.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return t=r.sent(),l(n,t),[3,3];case 2:"GroupMailbox"!=e.type&&"TeamsMailbox"!=e.type||(o=i(e.mailboxSmtpAddress),l(n,o)),r.label=3;case 3:return[2,n]}}))}))}))]}))}))}function b(){return Object(d.b)().then((function(e){return e.prefer='exchange.Behavior="CalendarInternal"',e}))}function v(e){return void 0===e&&(e=null),Object(u.r)(e)?b().then((function(t){return Object(s.a)(e).then((function(e){return Object.keys(e).forEach((function(n){return t[n]=e[n]})),t}))})):Promise.resolve({})}var O=n(55);function p(e,t,n){var r=new Headers;return n&&r.set("X-OWA-CANARY",Object(O.a)()),t&&r.set("X-OWA-ActionName",t),e&&a(e,r),r}n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return p}))},1705:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(37),o=n(1665);n.d(t,"b",(function(){return o.a}));var i=new r.c((function(){return n.e(1302).then(n.bind(null,1915))})),a=new r.a(i,(function(e){return e.getAndUpdateAccessToken}))},17319:function(e,t,n){"use strict";n.r(t);var r=n(966),o=n(3693),i=n(1641),a=n(18);function c(e){return Object(i.U)(Object(r.a)("inbox"))||Object(a.i)("rp-reactions")}var u=n(1672);function s(e){var t=Object(r.a)("inbox");return Object(i.U)(t)&&!Object(u.isPersonaInFavorites)(null,e.SenderSmtpEmailAddress)}function d(){return Object(i.U)(Object(r.a)("inbox"))||!Object(a.i)("auth-reactionNotifications")||!Object(a.i)("rp-reactions")}var l=n(9389),f=n(3219),b=n(2),v=n(2835),O=n(7422);Object(b.orchestrator)(O.a,(function(e){var t={Subject:e.taskNewEventTitle,IsAllDayEvent:!0};v.g.importAndExecute("GetStarted","GetStarted",t)}));var p=n(1863),j=n(8637);Object(b.orchestrator)(j.a,(function(){p.f.importAndExecute("mail","attachments")}));var m=n(8638);Object(b.orchestrator)(m.a,(function(){p.f.importAndExecute("mail","messageContent")}));var w=n(8635);Object(b.orchestrator)(w.a,(function(){p.f.importAndExecute("general","timeAndLanguage")}));var I=n(2097),h=n(8636),g=n(8642),S=n(2805);Object(b.orchestrator)(h.a,(function(e){I.c.importAndExecute("GetStarted",void 0,void 0,e.taskSendEmailSubject,e.taskSendEmailBody)})),Object(b.orchestrator)(S.a,(function(e){1==e.event&&Object(g.a)()}));var x=n(8639),E=n(8643),P=n(37),y=new P.c((function(){return Promise.all([n.e(201),n.e(298),n.e(709)]).then(n.bind(null,17495))})),N=new P.a(y,(function(e){return e.showPersonalizationCard}));Object(b.orchestrator)(x.a,(function(){N.importAndExecute(E.a)}));var A=n(4578),C=n(5809),k=new P.c((function(){return n.e(321).then(n.bind(null,17722))})),_=new P.a(k,(function(e){return e.loadSenders})),R=n(9604),T=n(3061),M=new P.c((function(){return n.e(868).then(n.bind(null,17488))})),D=new P.a(M,(function(e){return e.subscribeToHierarchyNotification}));Object(P.f)(T.a,M,(function(e){return e.onNewFolderNotificationOrchestrator})),Object(P.f)(T.b,M,(function(e){return e.onUpdateFolderNotificationOrchestrator}));var L=n(6),V=n(9),U=n(1656),K=n(3331),F=n(20);function z(e,t){var n=function(e){var t={},n=U.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){F.d("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(K.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(L.f)(n.parentInternetMessageId))break;n=U.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){var n=new V.ObservableMap({});return t.forEach((function(t){var r=U.a.conversationNodes.get(t),o=t===e?i.a.CheckMark:i.a.None;n.set(r.internetMessageId,o)})),n}(e,t);for(var r=new V.ObservableMap({}),o=!1,a=!1,c=0,u=0;u<t.length;u++){var s=U.a.conversationNodes.get(t[u]);s&&(n[s.internetMessageId]?(o?c+1===Object.keys(n).length?(r.set(s.internetMessageId,i.a.BusEnd),a=!0):r.set(s.internetMessageId,i.a.BusStop):(r.set(s.internetMessageId,i.a.BusStart),o=!0),c++):!o||a?r.set(s.internetMessageId,i.a.None):r.set(s.internetMessageId,i.a.NoStop))}return r}var W=n(1715),G=n(2760),B=Object(b.action)("FOCUS_ITEM_PART",(function(e,t){return{nodeId:e,mailListItemSelectionSource:t}})),Y=n(1739),H=n(7411),q=n(1647),X=n(2526);function Q(){var e=Y.a.expandedConversationViewState;e.expandedRowKey=null,e.focusedNodeId=null,e.selectedNodeIds=[],e.allNodeIds=[],e.shouldBeExpanded=!1,e.busStopStateMap=new V.ObservableMap({}),e.latestNodeIdsInEachFork=null}Object(b.mutator)(W.s,(function(e){var t=e.nodeId,n=Y.a.expandedConversationViewState,r=n.selectedNodeIds,o=n.allNodeIds;Y.a.expandedConversationViewState.focusedNodeId=t,r.indexOf(t)>-1?r.splice(r.indexOf(t),1):r.push(t),1===r.length&&(Y.a.expandedConversationViewState.busStopStateMap=z(r[0],o))})),Object(b.mutator)(W.h,(function(e){Y.a.expandedConversationViewState.busStopStateMap=new V.ObservableMap({})})),Object(b.mutator)(B,(function(e){Y.a.expandedConversationViewState.focusedNodeId=e.nodeId})),Object(b.mutator)(W.p,(function(e){var t=e.rowKey,n=e.nodeIdToSelect,r=e.allNodeIds,o=Y.a.expandedConversationViewState;o.selectedNodeIds=[n],o.busStopStateMap=z(n,r),o.expandedRowKey=t,o.focusedNodeId=n,o.allNodeIds=r})),Object(b.mutator)(W.t,(function(e){e.mailListItemSelectionSource===q.b.MailListItemCheckbox&&Q()})),Object(b.mutator)(G.a,(function(e){Q()})),Object(b.mutator)(W.i,(function(e){Q()})),Object(b.mutator)(W.k,(function(e){Q()})),Object(b.mutator)(W.a,(function(e){Q();var t=Y.a.expandedConversationViewState;t.latestNodeIdsInEachFork=e.latestItemIdsInForks,t.expandedRowKey=e.rowKey})),Object(b.mutator)(W.q,(function(e){var t=Y.a.expandedConversationViewState,n=e.rowKey,r=e.mailListItemSelectionSource;t.expandedRowKey!=n?Object(X.d)()?(t.shouldBeExpanded=!0,t.expandedRowKey=n,t.latestNodeIdsInEachFork=[]):r===q.b.MailListItemTwisty&&(t.shouldBeExpanded=!0,t.expandedRowKey=n,t.latestNodeIdsInEachFork=null):r===q.b.MailListItemTwisty&&Object(X.a)(n)&&(Q(),t.shouldBeExpanded=!0,t.expandedRowKey=n)})),Object(b.mutator)(W.o,(function(e){Q(),Y.a.expandedConversationViewState.expandedRowKey=e.rowKey})),Object(b.mutator)(H.a,(function(e){if(1===Y.a.expandedConversationViewState.selectedNodeIds.length){var t=Y.a.expandedConversationViewState.selectedNodeIds[0],n=q.u.conversations.get(e.conversationId).conversationNodeIds;Y.a.expandedConversationViewState.busStopStateMap=z(t,n)}}));var J,Z=n(0),$=n(3056),ee=n(5903),te=n(1993),ne=n(1696),re=n(3159),oe=n(1979),ie=n(1730),ae=n(9524),ce=n(9390),ue=n(2054);Object(b.orchestrator)(W.b,(function(e){le(e.itemId,e.tableView,e.nodeId,e.allNodeIds,e.mailListItemSelectionSource)}));Object(b.orchestrator)(W.e,(function(e){if(1!=e.listViewType){var t=i.Y.expandedConversationViewState,n=e.mailListItemSelectionSource==q.b.MailListItemTwisty;Object(X.d)()&&t.expandedRowKey!=e.rowKey?pe(e.rowKey,e.tableView,n):t.expandedRowKey==e.rowKey&&(t.shouldBeExpanded?t.latestNodeIdsInEachFork?pe(e.rowKey,e.tableView,n):ve(e.rowKey,e.tableView):!t.latestNodeIdsInEachFork&&n&&Oe())}})),Object(b.orchestrator)(W.c,(function(e){(Object(X.a)(e.rowKey)||Object(X.c)(e.rowKey))&&Oe()})),Object(b.orchestrator)(W.m,(function(e){for(var t=i.b.getConversationId(e.rowKey,e.tableView),n=q.u.conversations.get(t),r=null,o=null,a=n.conversationNodeIds.indexOf(i.Y.expandedConversationViewState.selectedNodeIds[0])+1;a<n.conversationNodeIds.length;a++){var c=n.conversationNodeIds[a],u=Object($.a)(c,Object(X.a)(e.rowKey));if(u){o=u.ItemId.Id,r=c;break}}r?le(o,e.tableView,r,n.conversationNodeIds,q.b.RowRemoval):be(e.rowKey,e.tableView)}));var se=0,de=!0;function le(e,t,n,r,o){if(J&&(clearTimeout(J),J=null),Object(ee.a)(t,!0,o,void 0),o!==q.b.KeyboardUpDown||Object(ne.c)())fe(e,t);else{var a=Date.now(),c=a-se;se=a,(de||c<=500)&&(de=!1,J=setTimeout((function(){J=null,de=!0,fe(e,t)}),250))}var u=i.Y.expandedConversationViewState;W.p(u.expandedRowKey,n,r,t.id,u.selectedNodeIds)}function fe(e,t){if(Object(oe.a)())te.o.importAndExecute({Id:e,mailboxInfo:Object(ie.b)(t)},!0,null,!1);else{var n=i.b.getRowClientItemId(i.Y.expandedConversationViewState.expandedRowKey,t);te.s.importAndExecute(null==n?void 0:n.Id,e,!0)}}function be(e,t,n){var r,o,a=n;if(!a||0==a.length){var c=i.b.getConversationId(e,t);a=q.u.conversations.get(c).conversationNodeIds}try{for(var u=Object(Z.__values)(a),s=u.next();!s.done;s=u.next()){var d=s.value,l=Object($.a)(d,Object(X.a)(e));if(l){le(l.ItemId.Id,t,d,a,Object(oe.a)()&&Object(X.d)()&&Object(ue.a)()&&Object(ne.c)()?q.b.MailListItemExpansion:q.b.RowRemoval);break}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}}function ve(e,t){W.o(e),Object(re.a)(t,!1),be(e,t)}function Oe(){W.i()}function pe(e,t,n){var r=i.b.getRowClientItemId(e,t),o=r.Id;Object(ae.c)(o)?je(o,e,t,n):Object(ce.b)(r,"CreateConversationRelationMap").then((function(){je(o,e,t,n)}))}function je(e,t,n,r){return Object(Z.__awaiter)(this,void 0,void 0,(function(){var o,a;return Object(Z.__generator)(this,(function(c){switch(c.label){case 0:return o=Object(i.L)(t,n.id),[4,Object(ae.b)(e,null==o?void 0:o.itemIds)];case 1:return(a=c.sent()).length>1?(W.a(t,a),be(t,n,a)):r?ve(t,n):W.a(t,[]),[2]}}))}))}var me=n(7414),we=n(6798),Ie=(Object(b.orchestrator)(we.a,(function(e){Object(me.a)(),1===Object(i.K)().expandedConversationViewState.selectedNodeIds.length&&W.h()})),n(8586)),he=n(2982),ge=(Object(b.orchestrator)(Ie.a,(function(e){if(i.Y.expandedConversationViewState.expandedRowKey){var t=q.u.conversations.get(e.conversationId);W.p(i.Y.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(he.a)())}})),n(7426)),Se=n(4734),xe=n(6046),Ee=n(2488),Pe=Object(b.action)("FOCUS_ROW_IN_DIRECTION",(function(e,t,n){return{tableView:e,selectionDirection:t,mailListItemSelectionSource:n}}));function ye(e,t,n){return Object(Ee.a)()?1===e&&n===i.d.Next||0===e&&n===i.d.Previous:e===t-1&&n===i.d.Next||e===t-2&&n===i.d.Previous}Object(b.orchestrator)(ge.a,(function(e){var t=e.selectionDirection,n=e.tableView,r=e.mailListItemSelectionSource,o=e.shouldSelect,a=Object(Z.__read)(function(e,t){var n=i.Y.expandedConversationViewState,r=n.focusedNodeId,o=n.allNodeIds;if(!r)return[null,null];var a,c,u=o.indexOf(r);e===i.d.Next?(a=o.length-1,c=1):(a=0,c=-1);var s=Object(i.L)(t.focusedRowKey,t.id).id,d=i.Y.conversationItems.get(s);for(;u!==a;){if(u+=c,Object(Se.a)(d.id)&&ye(u,o.length,e))return Object(xe.a)(d.clientId),["loading",null];var l=o[u],f=Object($.a)(l,Object(X.a)(t.focusedRowKey));if(f)return[l,f]}return[null,null]}(t,n),2),c=a[0],u=a[1];"loading"!==c&&(c?o?W.b(c,u.ItemId.Id,i.Y.expandedConversationViewState.allNodeIds,n,r):B(c,r):i.Y.expandedConversationViewState.expandedRowKey&&t===i.d.Previous?W.c(i.Y.expandedConversationViewState.expandedRowKey):o?W.n(n,t,r):Pe(n,t,r))}));var Ne=n(5904),Ae=n(2915),Ce=n(2708),ke=n(2707),_e=(Object(b.orchestrator)(Pe,(function(e){var t=e.tableView,n=e.selectionDirection,r=Object(Ne.a)(t,n);if(null!==r){var o=t.rowKeys[r];Object(Ae.a)(t,o),Object(ke.a)(t,o),Object(Ce.a)(t,null),W.i()}})),n(7427));Object(b.orchestrator)(_e.a,(function(e){var t=e.tableView,n=e.mailListItemSelectionSource,r=i.Y.expandedConversationViewState.focusedNodeId;r?W.s(r):W.t(t,t.focusedRowKey,!0,n)}));var Re=n(1859),Te=n(5870),Me=n(7428);Object(b.orchestrator)(Me.a,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys,o=e.mailListItemSelectionSource;if(n.length>0&&o===Re.a.KeyboardEnter){if(1!==n.length)return;W.b(n[0],Object(Te.a)(n[0],Object(X.a)(r[0])),i.Y.expandedConversationViewState.allNodeIds,t,o)}else{if(1!==r.length)return;W.q(t,r[0],!0,o)}}));var De=n(30);var Le=n(222),Ve=n(2361),Ue=n(6213),Ke=n(3829),Fe=n(4536),ze=n(8451),We=n(3828),Ge=n(2616),Be=n(3048),Ye=n(4083),He=new P.c((function(){return Promise.all([n.e(272),n.e(908)]).then(n.bind(null,17382))})),qe=new P.a(He,(function(e){return e.evaluatePlaywrightMailActions})),Xe=n(17),Qe=n(4897),Je=n(1883),Ze=n(1661),$e=n(2439);function et(){Object(Xe.a)().IsMonitoring&&qe.importAndExecute(),D.importAndExecute(),Object(l.a)(!0),Be.b.importAndExecute({condition:Object(a.i)("fwk-devTools")||Object(a.i)("sea-contextFeedback"),task:function(){return R.b.importAndExecute()}},{condition:Object(a.i)("fwk-nlqsFloodgateSurvey"),task:function(){return $e.a.importAndExecute(null,!0)}},tt,{condition:Object(a.i)("sea-clientWarmup")&&Object(Ze.u)(),task:function(){return Je.l.importAndExecute()}},{condition:Object(Je.j)(),task:function(){return Je.m.importAndExecute()}},{condition:Object(a.i)("tri-spotlight2"),task:function(){return Ve.i.importAndExecute()}},(function(){return Fe.a.importAndExecute()}),{condition:Object(Le.a)(),task:function(){return _.importAndExecute()}},(function(){return ze.b.importAndExecute()}),(function(){return ze.a.importAndExecute()}),{condition:Object(We.j)(),task:function(){return We.d.importAndExecute()}},(function(){return We.e.importAndExecute()}),{condition:Object(Qe.a)(),task:function(){return A.c.importAndExecute()}},{condition:Object(a.i)("mc-personalization"),task:function(){Ue.b.importAndExecute()},idle:!0},{task:function(){return Ke.c.importAndExecute()},idle:!0},{condition:Object(te.f)(),task:function(){return C.a.importAndExecute()},idle:!0},{task:function(){return f.d.importAndExecute()},idle:!0},{condition:Object(Ge.e)(window),task:function(){return Ge.j.importAndExecute(window)},idle:!0},{task:function(){return Ye.a.importAndExecute()},idle:!0},{condition:Object(a.i)("auth-activityFeed")&&Object(a.i)("auth-activityFeedWeveSignal"),task:function(){return f.e.importAndExecute()},idle:!0},{condition:Object(a.i)("rp-projectionPopout"),task:function(){return te.h.importAndExecute()},idle:!0}).then((function(){Be.a.importAndExecute()}))}function tt(){var e,t;Object(o.h)(s),Object(o.g)(c),Object(o.i)(d),Object(Le.a)()&&(e={isOWALogon:!0},Object(De.a)("ConnectedAccountsNotification",e,t))}var nt=n(2098);Object(b.orchestrator)(o.c,(function(e){return Object(Z.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,o,a,c;return Object(Z.__generator)(this,(function(u){switch(u.label){case 0:return t=e.notification,Object(i.Q)(Object(i.H)())?(n=Object(q.g)().conversations.get(t.conversationId),r={Id:t.conversationId,mailboxInfo:Object(ie.a)()},n?[3,2]:[4,nt.d.importAndExecute(r,"LoadLikedConversation")]):[3,3];case 1:u.sent(),u.label=2;case 2:return rt(r,t.subject),[3,6];case 3:return o=Object(q.g)().items.get(t.itemId),a={Id:t.itemId,mailboxInfo:Object(ie.a)()},(null==o?void 0:o.NormalizedBody)?(rt(a,t.subject),[3,6]):[3,4];case 4:return c={Id:t.itemId,mailboxInfo:Object(ie.a)()},[4,nt.e.importAndExecute(c,"LoadLikedItem")];case 5:u.sent(),rt(c,t.subject),u.label=6;case 6:return[2]}}))}))}));function rt(e,t){te.p.importAndExecute(e,t,[],!0,null)}var ot=n(8656),it=n(71);Object(b.orchestrator)(o.d,(function(e){var t=e.notification,n=1===Object(it.h)().UserOptions.GlobalListViewTypeReact?t.ItemId:t.ConversationId;Object(ot.a)("inbox",n)})),Object(b.orchestrator)(o.e,(function(e){return Object(Z.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,o,a,c;return Object(Z.__generator)(this,(function(u){switch(u.label){case 0:return t=e.notification,Object(i.Q)(Object(i.H)())?(n=Object(q.g)().conversations.get(t.conversationId),r={Id:t.conversationId,mailboxInfo:Object(ie.a)()},n?[3,2]:[4,nt.d.importAndExecute(r,"LoadReactedConversation")]):[3,3];case 1:u.sent(),u.label=2;case 2:return at(r,t.subject),[3,6];case 3:return o=Object(q.g)().items.get(t.itemId),a={Id:t.itemId,mailboxInfo:Object(ie.a)()},(null==o?void 0:o.NormalizedBody)?(at(a,t.subject),[3,6]):[3,4];case 4:return c={Id:t.itemId,mailboxInfo:Object(ie.a)()},[4,nt.e.importAndExecute(c,"LoadReactedItem")];case 5:u.sent(),at(c,t.subject),u.label=6;case 6:return[2]}}))}))}));function at(e,t){te.p.importAndExecute(e,t,[],!0,null)}n.d(t,"setupMailModulePostRender",(function(){return et}))},1830:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return b}));var r=n(127),o="WebPushSetup";function i(e){O("vipMailEnabled",e)}function a(e){O("mailOption",e)}function c(e){O("reminderOption",e)}function u(e){O("enabled",e)}function s(e,t){O("disabled",e),O("allClients",t)}function d(e){(window.webPushOptics.enabled||window.webPushOptics.disabled)&&(O("result",e),v())}function l(){O("lightning","ignored"),v()}function f(e){O("permission",e)}function b(e){O("roaming",e)}function v(){Object(r.r)(o,window.webPushOptics,{isCore:!0}),window.webPushOptics={}}function O(e,t){window.webPushOptics[e]=t}window.webPushOptics={}},1877:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}));var r=n(37),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(22),n.e(823)]).then(n.bind(null,5112))})),i=new r.a(o,(function(e){return e.bootStrapWebPushService})),a=new r.b(o,(function(e){return e.userInitiatedWebPushSetupWorkflow})),c=new r.b(o,(function(e){return e.userInitiatedWebPushDisableWorkflow})),u=new r.b(o,(function(e){return e.unsubscribe})),s=new r.b(o,(function(e){return e.loadWebPushOptions})),d=Object(r.d)(o,(function(e){return e.WebPushDiscovery}))},1905:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1699);function o(e){return{headers:Object(r.e)(e,"GroupMailbox")}}},1967:function(e,t,n){"use strict";n(1905);var r=n(1821),o=n(2),i=Object(o.action)("EDIT_GROUP_SUCCESS",(function(e,t){return{groupSmtp:e,photoUrl:t}})),a=Object(o.action)("ADD_GROUP_MEMBER_SUCCESS",(function(e){return{groupSmtp:e}})),c=Object(o.action)("MEMBER_MANAGEMENT_SUCCESS",(function(e){return{groupSmtp:e}})),u=Object(o.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),s=Object(o.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),d=Object(o.action)("DELETE_GROUP_SUCCESS",(function(e){return{groupSmtp:e}})),l=n(1895);n.d(t,"m",(function(){return r.a})),n.d(t,"l",(function(){return i})),n.d(t,"j",(function(){return a})),n.d(t,"n",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"o",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"g",(function(){return l.g})),n.d(t,"c",(function(){return l.c})),n.d(t,"d",(function(){return l.d})),n.d(t,"a",(function(){return l.a})),n.d(t,"e",(function(){return l.e})),n.d(t,"f",(function(){return l.f})),n.d(t,"i",(function(){return l.i})),n.d(t,"b",(function(){return l.b})),n.d(t,"h",(function(){return l.h}))},1999:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r,o=n(2),i=Object(o.createStore)("webPushStore",{currentView:0,webPushPermission:null===(r=window.Notification)||void 0===r?void 0:r.permission})(),a=Object(o.createStore)("localWebPushUserSettingStore",{userPreferenceIdentifier:null,lastSessionDate:null,uniqueDaysSessionCount:0,enabled:null,mailEnabled:null,reminderEnabled:null,vipMailEnabled:null,lastCheckboxUnchecked:null,promptCount:0,lastPromptDate:null})();function c(){return a}},2039:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d}));var r=n(1999),o=n(2617),i=n(148),a=n(2047),c=Object(i.select)({store:function(){return r.b}})((function(e){return null!=e.store&&null==e.store.enabled&&e.store.uniqueDaysSessionCount>=a.b&&e.store.lastPromptDate!=Object(o.a)().toDateString()&&e.store.promptCount<=a.a})),u=Object(i.select)({store:function(){return r.b}})((function(e){return e.store.mailEnabled||e.store.reminderEnabled})),s=Object(i.select)({store:function(){return r.b}})((function(e){var t,n,r;return{newMail:null!==(t=e.store.mailEnabled)&&void 0!==t&&t,reminder:null!==(n=e.store.reminderEnabled)&&void 0!==n&&n,vipMailOnly:null!==(r=e.store.vipMailEnabled)&&void 0!==r&&r}})),d=Object(i.select)({store:function(){return r.b}})((function(e){return e.store.reminderEnabled&&e.store.enabled}))},2047:function(e,t,n){"use strict";var r=n(1999),o=n(2617),i=n(148),a=n(7),c="WebPushUserSettings",u=5;function s(e,t){for(var n=d(e),r=-1,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t.userPreferenceIdentifier){r=o;break}if(r>=0)n[r]=t;else{if(r=n.length,n.length>=u){r=0;var i=new Date(n[0].lastSessionDate);for(o=1;o<n.length;++o){var s=new Date(n[o].lastSessionDate);s.getTime()<i.getTime()&&(i=s,r=o)}}n[r]=t}!function(e,t){if(t.length>0){var n=JSON.stringify(t);Object(a.e)(e,c,n)}else Object(a.d)(e,c)}(e,n)}function d(e){var t=Object(a.a)(e,c),n=new Array;try{var r=JSON.parse(t);null!=r&&(n=r)}catch(t){Object(a.d)(e,c)}return n}var l=n(2039),f=n(18);n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return v})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return m})),n.d(t,"c",(function(){return w})),n.d(t,"f",(function(){return I})),n.d(t,"i",(function(){return h}));var b=4,v=3,O=Object(i.select)({store:function(){return r.b}})(Object(i.action)("loadLocalWebPushUserSetting")((function(e,t,n){var r=function(e,t){for(var n=d(e),r=null,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t){r=n[o];break}return r}(e,t);if(null!=r)Object.keys(r).forEach((function(e){n.store[e]=r[e]})),h(e);else{var o=function(e,t){for(var n=d(e),r=null,o=0;o<n.length;++o)n[o].userPreferenceIdentifier<t&&(r?n[o].userPreferenceIdentifier>r.userPreferenceIdentifier&&(r=n[o]):r=n[o]);return r}(e,t);o&&(n.store.lastCheckboxUnchecked=o.lastCheckboxUnchecked,n.store.mailEnabled=o.mailEnabled,n.store.reminderEnabled=o.reminderEnabled,n.store.vipMailEnabled=o.vipMailEnabled),n.store.userPreferenceIdentifier=t,s(e,n.store)}}))),p=Object(i.select)({store:function(){return r.b}})(Object(i.action)("incrementUniqueDaysSessionCount")((function(e,t){var n=Object(o.a)().toDateString();t.store.lastSessionDate!=n&&(t.store.lastSessionDate=n,t.store.uniqueDaysSessionCount<b&&t.store.uniqueDaysSessionCount++,s(e,t.store))}))),j=Object(i.select)({store:function(){return r.b}})(Object(i.action)("resetLocalWebpushUserSetting")((function(e,t,n){n.store.userPreferenceIdentifier=t,n.store.enabled=!1,n.store.promptCount=0,n.store.lastPromptDate=null,n.store.uniqueDaysSessionCount=0,s(e,n.store)}))),m=Object(i.select)({store:function(){return r.b}})(Object(i.action)("updateLocalWebPushEnabledStatus")((function(e,t,n,r){r.store.enabled=t,r.store.userPreferenceIdentifier=n,t&&h(e),s(e,r.store)}))),w=Object(i.select)({store:function(){return r.b}})(Object(i.action)("incrementLocalWebPushPromptCount")((function(e,t){t.store.promptCount++,t.store.lastPromptDate=Object(o.a)().toDateString(),s(e,t.store)}))),I=Object(i.select)({store:function(){return r.b}})(Object(i.action)("resetLocalWebPushPromptCount")((function(e,t){t.store.promptCount=0,t.store.lastPromptDate=null,s(e,t.store)}))),h=Object(i.select)({store:function(){return r.b}})(Object(i.action)("validateAndUpdateCheckboxOptions")((function(e,t){if(t.store.enabled){if(!Object(l.b)())if(t.store.lastCheckboxUnchecked){switch(t.store.lastCheckboxUnchecked){case"NewMail":t.store.mailEnabled=!0;break;case"Reminder":t.store.reminderEnabled=!0}t.store.lastCheckboxUnchecked=null}else t.store.mailEnabled=!0,t.store.reminderEnabled=!0;1!=t.store.mailEnabled||null!=t.store.reminderEnabled&&null!=t.store.reminderEnabled||(t.store.reminderEnabled=!0)}Object(f.i)("auth-scheduleTimerForReminderWebPush")||Object(f.i)("auth-sendReminderWebPush")||(t.store.reminderEnabled=null,t.store.lastCheckboxUnchecked=null),s(e,t.store)})))},2439:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(37),o=new r.c((function(){return Promise.all([n.e(22),n.e(23),n.e(590)]).then(n.bind(null,4305))})),i=new r.a(o,(function(e){return e.loadAndInitializeFloodgateEngine})),a=new r.b(o,(function(e){return e.logFloodgateActivity}))},2492:function(e,t,n){"use strict";function r(e,t){return e+"_"+(null!=t.enabledTimeInUTCMs?t.enabledTimeInUTCMs:"")}n.d(t,"a",(function(){return r}))},2521:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Unknown="Unknown",e.Like="Like",e.AtMention="AtMention",e.GroupMention="GroupMention",e.MeMention="MeMention",e.FileMention="FileMention",e.GroupAtAllMention="GroupAtAllMention",e.TxpRentalCarReservation="TxpRentalCarReservation",e.TxpFlightReservation="TxpFlightReservation",e.TxpLodgingReservation="TxpLodgingReservation",e.TxpFoodEstablishmentReservation="TxpFoodEstablishmentReservation",e.TxpEventReservation="TxpEventReservation",e.TxpParcelDelivery="TxpParcelDelivery",e.TxpInvoice="TxpInvoice",e.TxpServiceReservation="TxpServiceReservation",e.UserAtMentioned="UserAtMentioned",e.TaskNotificationInsight="TaskNotificationInsight",e.FollowUpNotificationInsight="FollowUpNotificationInsight",e.OutOfRoutineNotificationInsight="OutOfRoutineNotificationInsight",e.RealTimeFlightUpdate="RealTimeFlightUpdate",e.YammerLiveEventNotification="YammerLiveEventNotification",e.Reactions="Reactions"}(r||(r={}))},2575:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(18),o=n(64),i=n(17),a=n(619),c=function(e){return!(!Object(r.i)("fwk-webPushNotification")&&!Object(r.i)("fwk-webPushNotificationV2"))&&(!(!e.navigator||null==e.navigator.serviceWorker||null==e.PushManager)&&((Object(o.e)()||Object(o.h)()||Object(r.i)("fwk-webPushNotificationExtended")&&(Object(o.f)()||Object(o.j)()))&&!Object(i.a)().SessionSettings.IsUserCultureRightToLeft&&(1==Object(a.b)()||2==Object(a.b)())))}},2616:function(e,t,n){"use strict";var r=n(1830);n.d(t,"m",(function(){return r.b})),n.d(t,"l",(function(){return r.a})),n.d(t,"q",(function(){return r.i})),n.d(t,"n",(function(){return r.d})),n.d(t,"p",(function(){return r.g})),n.d(t,"o",(function(){return r.f}));var o=n(2492);n.d(t,"b",(function(){return o.a}));var i=n(1999);n.d(t,"a",(function(){return i.a}));var a=n(2047);n.d(t,"k",(function(){return a.e})),n.d(t,"r",(function(){return a.i}));var c=n(2039);n.d(t,"c",(function(){return c.b})),n.d(t,"d",(function(){return c.c}));var u=n(2575);n.d(t,"e",(function(){return u.a}));var s=n(1877);n.d(t,"j",(function(){return s.f})),n.d(t,"i",(function(){return s.e})),n.d(t,"h",(function(){return s.d})),n.d(t,"g",(function(){return s.c})),n.d(t,"f",(function(){return s.b}))},2617:function(e,t,n){"use strict";function r(){return new Date}n.d(t,"a",(function(){return r}))},2698:function(e,t,n){"use strict";var r=n(2),o=Object(r.createStore)("SkypeStore",{unreadConversationCount:0,isRecentsInitialized:!1,isSwcInitialized:!1,isGlimpseOpen:!1})();t.a=o},2709:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(17),o=n(18);function i(){var e;return(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(o.i)("cmp-proxy-address")}},2805:function(e,t,n){"use strict";var r=n(2),o=Object(r.action)("OnComposeLifecycleEvent",(function(e,t){return{viewState:e,event:t}}));t.a=o},2835:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"g",(function(){return v}));var r=n(2007),o=n(37),i=new o.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(6),n.e(20),n.e(28),n.e(30),n.e(37),n.e(42),n.e(74),n.e(136),n.e(177),n.e(289),n.e(967)]).then(n.bind(null,3972))}));Object(o.f)(r.d,i,(function(e){return e.openTimePanelOrchestrator}));var a=Object(o.d)(i,(function(e){return e.TimePanel})),c=Object(o.d)(i,(function(e){return e.TimePanelHeaderBar})),u=new o.a(i,(function(e){return e.loadTimePanelData})),s=new o.a(i,(function(e){return e.openEventDetailsView})),d=(new o.a(i,(function(e){return e.openAttendeeTrackingView})),new o.a(i,(function(e){return e.closeAttendeeTrackingView})),new o.a(i,(function(e){return e.openTasksView}))),l=new o.a(i,(function(e){return e.openCalendarView})),f=new o.a(i,(function(e){return e.openConflictsView})),b=new o.a(i,(function(e){return e.closeConflictsView})),v=new o.a(i,(function(e){return e.openEventQuickComposeView}))},2922:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("saveReadingPanePositionOption")},2974:function(e,t,n){"use strict";var r=n(2),o=Object(r.actionCreator)("ADD_CHAT_TAB",(function(e){return{chatConversationId:e}}));t.a=o},3141:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(18),o=n(619);function i(){return Object(r.i)("rp-skypeInTabs")&&1==Object(o.b)()}},3219:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return d}));var r=n(37),o=n(2521);n.d(t,"c",(function(){return o.a}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(6),n.e(13),n.e(17),n.e(102),n.e(122),n.e(149),n.e(207),n.e(313)]).then(n.bind(null,4774))})),a=Object(r.d)(i,(function(e){return e.ActivityFeed})),c=new r.a(i,(function(e){return e.initializeActivityFeed})),u=Object(r.d)(i,(function(e){return e.ActivityFeedTitle})),s=new r.a(i,(function(e){return e.postWeveSignal})),d=new r.a(i,(function(e){return e.loadActivityFeed}))},3403:function(e,t,n){"use strict";var r=n(37),o=n(2),i=n(2922),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(8),n.e(20),n.e(21),n.e(23),n.e(25),n.e(30),n.e(26),n.e(49),n.e(69),n.e(89),n.e(93),n.e(103),n.e(145),n.e(150),n.e(152),n.e(151),n.e(209),n.e(697)]).then(n.bind(null,17134))})),c=(new r.a(a,(function(e){return e.saveReadingPaneOptionQuick})),n(2656)),u=n(2211),s=n(2300),d=n(2301),l=n(148),f=n(1696),b=Object(l.action)("onPrintRow")((function(){Object(f.c)()&&(Object(d.a)(!0),Object(s.a)(!1))})),v=Object(l.action)("onNewMessage")((function(e){e||(Object(d.a)(!0),Object(s.a)(!Object(f.c)()))})),O=n(3478);n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return w})),n.d(t,"f",(function(){return I})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return O.a}));var p=new r.c((function(){return Promise.all([n.e(56),n.e(63),n.e(666)]).then(n.bind(null,17450))})),j=new r.a(p,(function(e){return e.onReplyOrReplyAllOrForwardMessage})),m=(new r.b(p,(function(e){return e.onSxSPreviewPaneClose})),new r.a(p,(function(e){return e.onReadingPanePositionOptionSaved}))),w=new r.a(p,(function(e){return e.onSelectMessageAd}));function I(){Object(o.orchestrator)(i.a,(function(){m.importAndExecute()}))}Object(r.f)(c.a,p,(function(e){return e.onClientReadingPanePositionChangeOrchestrator})),Object(r.f)(u.a,p,(function(e){return e.closeImmersiveReadingPaneOrchestrator}))},3420:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.createStore)("whatsNewStore",{cards:null,disablePauseInboxTryIt:!1})},3421:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("OPEN_PAUSE_INBOX")},3478:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("exitSearch",(function(e){return{actionSource:e}}))},3581:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_REMINDER_CLICKED",(function(e,t){return{itemId:e,reminderType:t}}))},3693:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var r=n(37),o=n(3852);n.d(t,"h",(function(){return o.a}));var i=n(3853);n.d(t,"g",(function(){return i.a}));var a=n(3854);n.d(t,"i",(function(){return a.a}));var c=n(3694);n.d(t,"c",(function(){return c.a}));var u=n(3695);n.d(t,"e",(function(){return u.a}));var s=n(3696);n.d(t,"d",(function(){return s.a}));var d=n(3581);n.d(t,"f",(function(){return d.a}));var l=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(6),n.e(28),n.e(30),n.e(37),n.e(42),n.e(89),n.e(122),n.e(177),n.e(150),n.e(632)]).then(n.bind(null,7745))})),f=Object(r.d)(l,(function(e){return e.NotificationPane})),b=new r.b(l,(function(e){return e.onDismissAutomaticReplyNotification}))},3694:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_LIKE_NOTIFICATION_CLICKED",(function(e){return{notification:e}}))},3695:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_REACTION_NOTIFICATION_CLICKED",(function(e){return{notification:e}}))},3696:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_NEW_MAIL_NOTIFICATION_NAVIGATED",(function(e){return{notification:e}}))},3697:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Read="Read",e.Unread="Unread"}(r||(r={}))},3828:function(e,t,n){"use strict";var r=n(37),o=n(3141),i=n(18),a=function(){return!Object(i.i)("fwk-partner-code-off")&&!Object(i.i)("fwk-skypeSuite")&&Object(i.i)("fwk-skypeConsumer")},c=n(2974),u=n(2698);n.d(t,"a",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"h",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"g",(function(){return O})),n.d(t,"f",(function(){return p})),n.d(t,"c",(function(){return o.a})),n.d(t,"j",(function(){return a})),n.d(t,"b",(function(){return c.a})),n.d(t,"k",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(0),n.e(3),n.e(769)]).then(n.bind(null,17365))})),d=Object(r.d)(s,(function(e){return e.SkypeGlimpse})),l=new r.a(s,(function(e){return e.updateIsGlimpseOpen})),f=new r.b(s,(function(e){return e.shouldShowUnreadConversationCount})),b=new r.a(s,(function(e){return e.beginSkypeInitialization})),v=new r.a(s,(function(e){return e.createOnSwcReadyEvent})),O=new r.a(s,(function(e){return e.onNotificationReceived})),p=new r.a(s,(function(e){return e.onHideNotificationReceived}))},3829:function(e,t,n){"use strict";var r=n(37),o=n(3420),i=n(3697);function a(){var e=Object(o.a)();return e.cards?Object.keys(e.cards).filter((function(t){return e.cards[t].status===i.a.Unread})).length:0}var c=n(3421);n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(0),n.e(30),n.e(286),n.e(824)]).then(n.bind(null,17295))})),s=Object(r.d)(u,(function(e){return e.WhatsNewFluentPane})),d=new r.a(u,(function(e){return e.initializeWhatsNewIfNecessary})),l=new r.a(u,(function(e){return e.openPremiumDashboard}))},3852:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=[];function o(e){r.push(e)}function i(e){return r.reduce((function(t,n){return t||n(e)}),!1)}},3853:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=[];function o(e){r.push(e)}function i(e){return r.reduce((function(t,n){return t||n(e)}),!1)}},3854:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=[];function o(e){r.push(e)}function i(e){return r.reduce((function(t,n){return t||n(e)}),!1)}},4536:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(37),o=new r.c((function(){return Promise.all([n.e(136),n.e(288),n.e(825)]).then(n.bind(null,7028))})),i=new r.a(o,(function(e){return e.loadWorkloadScenarioSettings}))},4734:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1656);function o(e){var t=r.a.conversations.get(e);return null==t?void 0:t.canLoadMore}},4743:function(e){e.exports=JSON.parse('{"e":"eza","a":"fza","n":"hza","p":"iza","u":"kza","q":"lza","m":"mza","j":"nza","s":"oza","r":"pza","h":"qza","o":"rza","k":"sza","t":"tza","i":"uza","g":"vza","l":"wza","f":"xza","d":"yza","b":"zza","c":"Aza"}')},499:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},5061:function(e,t,n){"use strict";var r=n(3164),o=n(48);t.a=Object(o.d)("expandCollapsedItemsRollUp",r.a.RPCountExpCollItemsRollUp)((function(e,t){void 0===t&&(t=!1),e.conversationNodeIdsInCollapsedItemsRollUp=[]}))},570:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(499),o=n(2),i=n(675),a=n(5),c={state:r.a.NotStarted,isPopoutV2:Object(a.a)(i.a)==i.b},u=Object(o.createStore)("popoutChild",c);u()},579:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c}));var r,o=2,i=[window.location.origin];function a(e,t,n){var r={version:o,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function c(e){if(i.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&o==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow",e[e.DeeplinkReady=4]="DeeplinkReady"}(r||(r={}))},6046:function(e,t,n){"use strict";var r=n(5061),o=n(3164),i=n(1756),a=n(3346),c=n(127),u=n(48),s=n(2098),d=n(1656),l=n(3741),f=n(148);t.a=Object(u.d)("loadMore",o.a.RPCountLoadMore)(Object(f.select)({conversations:function(){return d.a.conversations},conversationReadingPaneViewState:function(e){return Object(i.a)(e.Id)}})((function(e,t){if(e&&t.conversations.has(e.Id)){var n=t.conversations.get(e.Id);n.isLoadMoreInProgress=!0,n.maxItemsToReturn=n.maxItemsToReturn+s.a,n.syncState="";var o=Object(c.t)();return o&&o.addCustomData([(i=n.maxItemsToReturn,u=Math.ceil((i-20)/10),Object(l.a)(u))]),Object(a.b)(t.conversationReadingPaneViewState)&&Object(r.a)(t.conversationReadingPaneViewState,!0),s.d.importAndExecute(e,"LoadMore")}var i,u;return Promise.resolve()})))},6058:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1715),o=n(1641),i=n(1995),a=n(1859);function c(e){var t=Object(i.a)(),n=Object(o.E)([e],t)[0];t.rowKeys.includes(n)&&Object(r.q)(t,n,!0,a.a.RouteHandler)}},6059:function(e,t,n){"use strict";var r=n(9),o=n(2),i={usageSuggestions:new r.ObservableMap},a=Object(o.createStore)("personalization",i)();t.a=a},6213:function(e,t,n){"use strict";var r=n(37),o=n(6059);function i(e){var t;return null===(t=o.a.usageSuggestions)||void 0===t?void 0:t.get(e)}n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return i}));var a=new r.c((function(){return n.e(912).then(n.bind(null,17425))})),c=new r.a(a,(function(e){return e.initializePersonalizationSuggestions})),u=(new r.a(a,(function(e){return e.postPersonalizationSuggestionFeedback})),new r.a(a,(function(e){return e.postPersonalizationUsageSignals})))},6798:function(e,t,n){"use strict";var r=n(2),o=Object(r.action)("ON_CONVERSATION_OPTION_SAVED");t.a=o},7411:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",(function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}}))},7414:function(e,t,n){"use strict";var r=n(0),o=n(4491),i=n(3988),a=n(4598),c=n(1757),u=n(1764),s=n(2132),d=n(1979),l=n(148),f=n(1641);t.a=Object(l.select)({composeViewState:function(){return u.a.viewStates.get(u.a.primaryComposeId)},conversationItems:function(){return f.Y.conversationItems}})(Object(l.action)("reloadReadingPane")((function(e){var t,n,u=Object(f.H)(),l=u?Object(r.__spread)(u.selectedRowKeys.keys()):[];if(1==l.length){var b=f.b.getRowIdToShowInReadingPane(l[0],u),v=Object(s.a)(l,u)[0],O=u.tableQuery.listViewType;if(1===O||Object(d.a)())(null===(t=e.composeViewState)||void 0===t?void 0:t.isInlineCompose)?c.s.importAndExecute(e.composeViewState).then((function(){Object(i.a)(b,v,a.a)})):Object(i.a)(b,v,a.a);else if(0===O){var p=e.conversationItems.get(b.Id);(null===(n=e.composeViewState)||void 0===n?void 0:n.isInlineCompose)?c.s.importAndExecute(e.composeViewState).then((function(){Object(o.b)(b,v,p.subject)})):Object(o.b)(b,v,p.subject)}}})))},7422:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),o=n(4743),i=n(6),a=Object(r.action)("ADD_FIRST_EVENT",(function(){return{taskNewEventTitle:Object(i.b)(o.l)}}))},7426:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{selectionDirection:e,tableView:t,mailListItemSelectionSource:n,shouldSelect:r}}))},7427:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_KEYBOARD_TOGGLE_SELECT",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}}))},7428:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n,mailListItemSelectionSource:r}}))},798:function(e,t,n){"use strict";var r=n(37),o=n(1009),i=n(814),a=n(25),c=n(1),u=n(813),s=n(570),d=n(18),l=n(499),f=n(1266),b=n(1270),v=Object(a.a)((function(e){c.useEffect((function(){Object(d.i)("rp-popoutsDebug")||O()}),[]);return c.createElement("div",{className:b.view},Object(s.a)().state==l.a.Loading?c.createElement("span",null,c.createElement(f.a,null),e.loadingString):c.createElement("button",{onClick:O},"Get Data"))}));function O(){Object(u.a)()}function p(e,t,n,r){var o="";if(r)o="readimid/",o+=encodeURIComponent(btoa(r));else{if(o=n?"readconv/":"read/",e&&"GroupMailbox"==e.type){o+="group/";var i=e.mailboxSmtpAddress.split("@");o+=i[1]+"/"+i[0]+"/"}o+=encodeURIComponent(n||t)}return o}var j=n(497);function m(e){var t=e&&e!==window;return Object(j.v)()||t}n(1008);n.d(t,"h",(function(){return I})),n.d(t,"c",(function(){return o.a})),n.d(t,"i",(function(){return i.a})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return l.a})),n.d(t,"f",(function(){return s.a})),n.d(t,"d",(function(){return u.b})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return m}));var w=new r.c((function(){return n.e(920).then(n.bind(null,17391))})),I=new r.b(w,(function(e){return e.bootPopout}))},813:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r,o=n(0),i=n(814),a=n(579),c=n(499),u=n(570),s=!1;function d(){Object(i.a)(c.a.Loading),r?r():s=!0}function l(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return s?[3,2]:[4,new Promise((function(e){r=function(){e()}}))];case 1:t.sent(),t.label=2;case 2:return[2,Object(u.a)().isPopoutV2?new Promise((function(t,n){var r=function(n){var o=Object(a.b)(n);if(o&&o.type==a.a.SetData){window.removeEventListener("message",r);var i=void 0;try{i=e?e(o.serializedData):JSON.parse(o.serializedData)}catch(e){}t(i)}};window.addEventListener("message",r);try{var o=window.opener;Object(a.c)(o,a.a.PopoutReady,null)}catch(e){t(null)}})):Promise.resolve(null)]}}))}))}},814:function(e,t,n){"use strict";var r=n(570),o=n(2),i=n(499),a=n(579);t.a=Object(o.mutatorAction)("setPopoutChildState",(function(e){var t=Object(r.a)();t.state=e,e==i.a.Ready&&t.isPopoutV2&&window.opener&&Object(a.c)(window.opener,a.a.DeeplinkReady,null)}))},8451:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(37),o=new r.c((function(){return Promise.all([n.e(0),n.e(226),n.e(469)]).then(n.bind(null,11206))})),i=new r.a(o,(function(e){return e.subscribeToBulkActionNotification})),a=new r.a(o,(function(e){return e.findBulkActionItemAction}))},8586:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_ITEM_PART_SELECTED",(function(e,t){return{conversationNodeId:e,conversationId:t}}))},8635:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("CONFIRM_TIMEZONE")},8636:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),o=n(4743),i=n(6),a=n(17),c=Object(r.action)("SEND_AN_EMAIL",(function(){return{taskSendEmailSubject:Object(i.c)(Object(i.b)(o.s),Object(a.a)().SessionSettings.UserEmailAddress),taskSendEmailBody:Object(i.c)(Object(i.b)(o.r),Object(a.a)().SessionSettings.UserEmailAddress)}}))},8637:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("ADD_STORAGE_ACCOUNT")},8638:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("SETUP_SIGNATURE")},8639:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("SHOW_PERSONALIZATION_MODAL")},8642:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("COMPLETE_SEND_AN_EMAIL")},8643:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("COMPLETE_PERSONALIZATION")},8656:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5902),o=n(6058);function i(e,t){Object(r.a)(e),Object(o.a)(t)}},9524:function(e,t,n){"use strict";var r,o,i=n(0),a=n(2098),c=n(1647),u=n(235);function s(e){var t,n;return Object(i.__awaiter)(this,void 0,void 0,(function(){var r;return Object(i.__generator)(this,(function(o){switch(o.label){case 0:r=null===(t=c.u.conversations)||void 0===t?void 0:t.get(e),o.label=1;case 1:return!r||null!=r&&r.canLoadMoreForRelationMap?(r&&(r.isLoadMoreInProgress=!0,r.maxItemsToReturn=r.maxItemsToReturn+a.a,r.syncState=""),[4,a.d.importAndExecute({Id:e,mailboxInfo:Object(u.d)()},"CreateConversationRelationMap")]):[3,3];case 2:return o.sent(),r||(r=null===(n=c.u.conversations)||void 0===n?void 0:n.get(e))?[3,1]:[3,3];case 3:return[2]}}))}))}function d(e){var t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,a,u,d,l,f,b,O;return Object(i.__generator)(this,(function(p){switch(p.label){case 0:return o==e?[3,2]:(o=e,[4,s(e)]);case 1:if(p.sent(),!(n=null===(t=c.u.conversations)||void 0===t?void 0:t.get(e)))return[2,null];if(a=null==n?void 0:n.conversationNodeIds,u=null==a?void 0:a.length,!a||!u||0==u)return[2,null];for((d=Object(i.__spread)(a)).reverse(),l=c.u.conversationNodes.get(d[0]),f=new Map,l&&f.set(l.internetMessageId,{itemIds:l.itemIds,childrenImIds:[]}),b=1;b<u;)O=c.u.conversationNodes.get(d[b]),v(f,O),b+=1;r=f,p.label=2;case 2:return[2,r]}}))}))}function l(e){var t,n=null===(t=c.u.conversations)||void 0===t?void 0:t.get(e);if(!n)return!1;var r=n.conversationNodeIds,o=null==r?void 0:r.length;return!(!r||!o||0==o)}function f(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){switch(o.label){case 0:return[4,d(e)];case 1:return(n=o.sent())?(r=[],n.forEach((function(e,o){if(0===e.childrenImIds.length){var i=O(t,e.itemIds);i&&r.push(i);for(var a=e;!i&&(null==a?void 0:a.parentImId);)a=n.get(null==a?void 0:a.parentImId),(i=O(t,null==a?void 0:a.itemIds))&&r.push(i)}})),[2,r.reverse()]):[2,[]]}}))}))}function b(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,u,s,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return r=[n],[4,d(t)];case 1:if((o=i.sent())&&(null==(a=c.u.items.get(n))?void 0:a.InternetMessageId))for(u=o.get(a.InternetMessageId),s=null==u?void 0:u.parentImId;s;)(l=o.get(s))?(l.itemIds.forEach((function(t){var n,o=c.u.items.get(t);(!e||o&&(null===(n=o.ParentFolderId)||void 0===n?void 0:n.Id)==e)&&r.push(t)})),s=l.parentImId):s=void 0;return[2,r]}}))}))}function v(e,t){if(t&&e){var n=t.internetMessageId,r=t.parentInternetMessageId;if(r){var o=e.get(r);o&&o.childrenImIds.push(n)}e.set(n,{itemIds:t.itemIds,parentImId:r,childrenImIds:[]})}}function O(e,t){if(t)for(var n=0;n<t.length;n++)if(e.includes(t[n]))return t[n];return null}n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return b}))}}]);
//# sourceMappingURL=owa.MailBoot~MailFunctionalBoot.js.map
self.scriptsLoaded['owa.MailBoot~MailFunctionalBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();