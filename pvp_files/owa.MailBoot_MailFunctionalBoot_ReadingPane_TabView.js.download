self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFunctionalBoot~ReadingPane~TabView.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[180],{10494:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(13139),a=n(6);function i(e){var t;if((null==e?void 0:e.RightsManagedMessageDecryptionStatus)&&0!=e.RightsManagedMessageDecryptionStatus)switch(e.RightsManagedMessageDecryptionStatus){case-2147160052:case-2147160012:case-2147160011:t=Object(a.c)(Object(a.b)(r.d),o());break;case-2147160010:t=Object(a.b)(r.a);break;case-2147168507:t=Object(a.c)(Object(a.b)(r.l),o());break;case-2147160014:t=Object(a.b)(r.j);break;case-2147160054:case-2147160055:t=Object(a.b)(r.h);break;case-2147160064:case-2147160013:t=Object(a.b)(r.g);break;case-2147160051:t=Object(a.b)(r.c);break;case-2147160060:t=Object(a.b)(r.k);break;case-2147160009:default:t=Object(a.c)(Object(a.b)(r.i),e.RightsManagedMessageDecryptionStatus)}return t}function o(){var e=Object(a.c)('<a href="{0}" target="_blank">{1}</a>',Object(a.b)(r.f),Object(a.b)(r.e));return Object(a.c)(Object(a.b)(r.b),e)}},10505:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(1697),a=n(2),i=n(18),o=n(1721),c=n(2274),u=Object(a.mutatorAction)("addLoadedConversationReadingPaneViewState",(function(e){if(Object(i.i)("rp-persistedReadingPaneTabs")){var t=e.conversationId.Id,n=Object(r.b)().loadedConversationReadingPaneViewStates;n.has(t)||n.set(t,e)}})),s=Object(a.mutatorAction)("releaseOrphanedLoadedConversationViewStates",(function(){if(Object(i.i)("rp-persistedReadingPaneTabs")){var e=Object(r.b)().loadedConversationReadingPaneViewStates;e.forEach((function(t,n){Object(o.n)(n)||n==Object(c.a)()||e.delete(n)}))}})),d=Object(a.mutatorAction)("releaseLoadedConversationViewState",(function(e){Object(i.i)("rp-persistedReadingPaneTabs")&&Object(r.b)().loadedConversationReadingPaneViewStates.delete(e)}))},10506:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r=/ipm.note.rules.ooftemplate.microsoft/i;function a(e){return{isOofItem:r.test(e),oofReplyNodeIds:[],isOofRollUpExpanded:!1}}},10507:function(e,t,n){"use strict";var r=n(10508),a=n(148);t.a=Object(a.action)("tryAddOofNodesInRollUp")((function(e,t,n,a){a&&e.forEach((function(e){e.oofRollUpViewState.oofReplyNodeIds=[]})),n.forEach((function(n){var a=e.get(n);if(a&&a.oofRollUpViewState.isOofItem){a.isInRollUp=!1;var i=Object(r.a)(n,e,t);i&&!i.isInRollUp&&(a.isInRollUp=!0,i.oofRollUpViewState.oofReplyNodeIds.push(n))}}))}))},10508:function(e,t,n){"use strict";function r(e,t,n){var r=n.get(e);return r?t.get(r.parentInternetMessageId):null}n.d(t,"a",(function(){return r}))},1051:function(e,t,n){"use strict";var r=function(){function e(){this.eventDictionary={}}return e.prototype.on=function(e,t,n){return(this.eventDictionary[e]||(this.eventDictionary[e]=[])).push({callback:t,callbackThis:n}),this},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=(this.eventDictionary[e]||[]).slice();return r.forEach((function(e){return e.callback.apply(e.callbackThis,t)})),this},e.prototype.off=function(e,t){var n=this.eventDictionary[e];if(n){var r=n.filter((function(e){return e.callback!==t}));r.length?this.eventDictionary[e]=r:delete this.eventDictionary[e]}return this},e.prototype.once=function(e,t,n){var r=this,a=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return r.off(e,a),t.apply(n,i)};return(this.eventDictionary[e]||(this.eventDictionary[e]=[])).push({callback:a,callbackThis:n}),this},e}();t.a=r},13139:function(e){e.exports=JSON.parse('{"d":"mqb","a":"nqb","l":"oqb","j":"pqb","h":"qqb","g":"rqb","c":"sqb","k":"tqb","i":"uqb","f":"vqb","e":"wqb","b":"xqb"}')},1682:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(256);function a(e){var t;return null===(t=Object(r.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},1693:function(e,t,n){"use strict";var r,a,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(a||(a={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},1786:function(e,t,n){"use strict";n.d(t,"n",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"r",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"p",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"u",(function(){return b})),n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return p})),n.d(t,"j",(function(){return g})),n.d(t,"i",(function(){return O})),n.d(t,"l",(function(){return I})),n.d(t,"k",(function(){return h})),n.d(t,"c",(function(){return j})),n.d(t,"o",(function(){return S})),n.d(t,"s",(function(){return P})),n.d(t,"b",(function(){return w})),n.d(t,"m",(function(){return C})),n.d(t,"h",(function(){return A})),n.d(t,"t",(function(){return R}));var r=n(37),a=n(1930);n.d(t,"v",(function(){return a.a}));var i=n(1931);n.d(t,"w",(function(){return i.a}));var o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(20),n.e(22),n.e(26),n.e(31),n.e(34),n.e(41),n.e(44),n.e(45),n.e(56),n.e(64),n.e(65),n.e(70),n.e(94),n.e(107),n.e(159),n.e(160),n.e(219),n.e(218),n.e(217),n.e(205),n.e(326)]).then(n.bind(null,3030))})),c=new r.a(o,(function(e){return e.initializeAttachments})),u=new r.a(o,(function(e){return e.reinitializeAttachments})),s=new r.a(o,(function(e){return e.setInlineAttachmentStatus})),d=new r.a(o,(function(e){return e.addAttachmentIntoWellBeforeUpload})),l=new r.b(o,(function(e){return e.refreshSharingTipsAttachmentWell})),f=new r.b(o,(function(e){return e.createAttachmentsViaQueueManager})),b=new r.b(o,(function(e){return e.createAttachmentsFromRecentAttachments})),m=new r.a(o,(function(e){return e.deleteAttachmentViaQueueManager})),v=new r.b(o,(function(e){return e.createAttachmentFullViewStateAndStoreBackingModel})),p=new r.b(o,(function(e){return e.createAttachmentFullViewState})),g=new r.b(o,(function(e){return e.getAttachmentWellInitialValue})),O=new r.b(o,(function(e){return e.getAttachmentWellForCompose})),I=new r.b(o,(function(e){return e.getConversationAttachmentWellInitialValue})),h=(new r.b(o,(function(e){return e.getMaxClassicAttachmentsSize})),new r.b(o,(function(e){return e.getAvailableLocalAttachmentSize}))),j=new r.b(o,(function(e){return e.createAttachmentFileFromExistingMailboxAttachment})),S=new r.a(o,(function(e){return e.mergeToConversationAttachmentWell})),P=new r.a(o,(function(e){return e.sortConversationAttachmentWell})),w=new r.a(o,(function(e){return e.convertImageViewAttachmentToInlineAttachment})),C=new r.b(o,(function(e){return e.getLastCloudyAttachmentsSharingIssueForBlockOnSend})),A=new r.b(o,(function(e){return e.getAllValidAttachments})),R=new r.b(o,(function(e){return e.uploadLocalFile}))},1840:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(111);function a(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},1856:function(e,t,n){"use strict";var r=n(0),a=n(2328),i=n(148),o=Object(i.action)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=Object(r.__spread)(e.infoBarIds);var i=e.infoBarHostKey;n&&(a.b[i]||(a.b[i]={}),a.b[i][t]=n)}}));t.a=o},1930:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_ATTACHMENT_CREATED",(function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}}))},1931:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_ATTACHMENT_DELETED",(function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}}))},1955:function(e,t,n){"use strict";var r=n(1682);function a(){var e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var i=n(1840),o=n(1801);function c(){return a()}function u(e){return(e&&e.length>0&&function(e){return e.some((function(e){return!((t=e).IsInline&&!Object(o.a)(t));var t}))}(e)?a():[]).map(i.a)}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}))},2201:function(e,t,n){"use strict";var r=n(37),a=[0,1],i=n(2276),o=n(2215),c=n(6),u=n(111),s=n(1693);function d(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(o.a),messageParts:[Object(c.b)(o.a),l()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(i.b),messageParts:[Object(c.b)(i.b),l()],color:s.a.Red};default:return Object(u.a)(e)}}function l(){return{text:Object(c.b)(i.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(1955),b=n(1840),m=n(0),v=n(18),p=n(1682);function g(){var e=Object(p.a)();if(Object(v.i)("fwk-devTools")){if(Object(v.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(m.__assign)(Object(m.__assign)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(v.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(m.__assign)(Object(m.__assign)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function O(){var e=g();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return h})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return f.a})),n.d(t,"e",(function(){return b.a})),n.d(t,"d",(function(){return O})),n.d(t,"c",(function(){return g}));var I=new r.c((function(){return n.e(1721).then(n.bind(null,17036))})),h=new r.b(I,(function(e){return e.getAccessIssuesForAttachments}))},2215:function(e){e.exports=JSON.parse('{"a":"Wda"}')},2232:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Initial=0]="Initial",e[e.Adaptive=1]="Adaptive",e[e.Show=2]="Show",e[e.Hide=3]="Hide",e[e.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},2239:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(9),a=n(2),i={clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap},o=Object(a.createStore)("protection",i),c=o()},2254:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Blank=0]="Blank",e[e.Loading=1]="Loading",e[e.Error=2]="Error",e[e.Custom=3]="Custom",e[e.Image=4]="Image",e[e.Wac=5]="Wac",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.Text=8]="Text",e[e.NativePdf=9]="NativePdf",e[e.PdfJs=10]="PdfJs",e[e.IFrame=11]="IFrame"}(r||(r={}))},2276:function(e){e.exports=JSON.parse('{"a":"Uda","b":"Vda"}')},2280:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return v})),n.d(t,"r",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return O})),n.d(t,"j",(function(){return I})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return j})),n.d(t,"a",(function(){return S}));var r=n(37),a=new r.c((function(){return Promise.all([n.e(3),n.e(20),n.e(27),n.e(34),n.e(38),n.e(64),n.e(65),n.e(70),n.e(154),n.e(160),n.e(855)]).then(n.bind(null,3971))})),i=new r.a(a,(function(e){return e.onSmimeItemAttachmentOpened})),o=new r.a(a,(function(e){return e.mergeSmimeDecodedMessageProperties})),c=(new r.b(a,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(a,(function(e){return e.setSmimePropertiesInDraftMessage}))),u=new r.b(a,(function(e){return e.trySetSmimeProperties})),s=new r.b(a,(function(e){return e.tryAddSmimeProperties})),d=new r.b(a,(function(e){return e.createMailResponseBodyContent})),l=new r.b(a,(function(e){return e.downloadSmimeAttachment})),f=new r.b(a,(function(e){return e.getMergedSmimeViewState})),b=new r.b(a,(function(e){return e.getMergedSmimeViewStateForDraft})),m=new r.b(a,(function(e){return e.isSmimeItemDecoding})),v=new r.b(a,(function(e){return e.previewSmimeAttachment})),p=new r.b(a,(function(e){return e.updateSmimeAttachmentIds})),g=new r.b(a,(function(e){return e.createSmimeAttachmentsFromFiles})),O=new r.b(a,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),I=new r.b(a,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),h=new r.b(a,(function(e){return e.getAttachmentsForSmimeResponse})),j=new r.b(a,(function(e){return e.getSmimeAttachmentsForRequest})),S=Object(r.d)(a,(function(e){return e.SignatureDetails}))},2328:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r={};function a(e,t){var n,a=e.infoBarHostKey;return null===(n=r[a])||void 0===n?void 0:n[t]}},2451:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(2),a=n(3167),i={installationStatus:0,isBrowserSupportActiveX:Object(a.a)(),version:""},o=Object(r.createStore)("SmimeStore",i),c=o();t.a=c},2488:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(17);function a(){var e=Object(r.a)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},2510:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(1721),i=n(1654),o=n(1764),c=n(111);function u(e,t,n,u){var f,b;void 0===t&&(t=0);var m=function(e){switch(e){case 0:return s;case 1:return d;case 2:return l;default:return Object(c.a)(e)}}(t),v=Object(o.b)();try{for(var p=Object(r.__values)(Object(i.a)().tabs),g=p.next();!g.done;g=p.next()){var O=g.value;if(O.type==a.a.Compose&&0==O.state){var I=v.viewStates.get(O.data);if((null==I?void 0:I.isInlineCompose)&&m(I,e)&&(0==I.asyncSendState||n&&6==I.asyncSendState)&&(!u&&!O.projectionRPTabId||O.projectionRPTabId==u))return I}}}catch(e){f={error:e}}finally{try{g&&!g.done&&(b=p.return)&&b.call(p)}finally{if(f)throw f.error}}return null}function s(e,t){return e.conversationId===t}function d(e,t){return e.referenceItemId.Id===t}function l(e,t){return!1}},2615:function(e,t,n){"use strict";n.d(t,"n",(function(){return s})),n.d(t,"m",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return b})),n.d(t,"f",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"d",(function(){return O})),n.d(t,"h",(function(){return I})),n.d(t,"e",(function(){return j})),n.d(t,"l",(function(){return S})),n.d(t,"b",(function(){return P}));var r=n(3479),a=n(3167),i=n(64),o=n(1832),c=n(1970),u=n(2923);function s(){return Object(i.e)()||Object(i.f)()}function d(e){return function(e){if(e.length<2)return!1;var t=e[0]-parseInt(o.b),n=e[1]-parseInt(o.c);return 0==t&&n>=0}("string"==typeof e?e.split(".").map((function(e){return parseInt(e)})):[])}function l(e){var t="string"==typeof e?e.split("."):[];return t.length&&t[0]!=o.b}function f(){return Object(i.r)()&&(Object(i.i)()&&Object(i.b)()[0]==o.i&&Object(a.a)()||Object(r.a)())}function b(e){return 0!==e}function m(e){var t=[];t.push(e.UserEmailAddress),t.push(e.LogonEmailAddress),t.push(e.UserPrincipalName),t.push(e.UserLegacyExchangeDN);var n=e.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(e){t.indexOf(e)>=0||t.push(e)})),t}function v(e){var t=65001;return e.UseGB18030?t=54936:e.UseISO885915&&(t=28605),t}function p(e){return{AllowUserChoiceOfSigningCertificate:e.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:e.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:e.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:e.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:e.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:e.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:e.CopyRecipientHeaders,OnlyUseSmartCard:e.OnlyUseSmartCard,EncryptionAlgorithms:e.EncryptionAlgorithms,SigningAlgorithms:e.SigningAlgorithms}}function g(e,t){var n=Object(u.a)().ClearSign;return t||e&&!n?c.a:o.e}function O(e){return btoa(unescape(encodeURIComponent(e)))}function I(e,t){var n=Object(u.a)();return e&&t?n.TripleWrapSignedEncryptedMail?14:12:e?n.ClearSign?11:10:6}function h(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function j(){return o.m+h()+h()+h()+h()}function S(e,t){return t.IsInline&&-1===e.indexOf(t.ContentId)}function P(){return o.d+h()+"@"+h()+"."+h()}},2776:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2451);function a(){var e=Object(r.b)();return 9==e.installationStatus||6==e.installationStatus}},2866:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(37),a=new r.c((function(){return n.e(856).then(n.bind(null,6166))})),i=new r.b(a,(function(e){return e.SmimeAdapter}))},2923:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(272);function a(){return Object(r.a)().smime}},3164:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(4125),a=n(3346);function i(e){return Math.min(Math.floor(e/2),24)}t.a={RPPerfLoadConversationReadingPane:{name:"RPPerfLoadConversationReadingPane"},RPPerfLoadItemReadingPane:{name:"RPPerfLoadItemReadingPane"},RPCountExpCollQuotedText:{name:"RPCountExpCollQuotedText",customData:function(e,t,n){return[n?1:0,!e.isExpanded]}},RPCountExpCollItemPart:{name:"RPCountExpCollItemPart",customData:function(e,t,n){return[t||n?e.isExpanded?"EC":"CE":e==Object(r.b)()?"SC":e.isExpanded?"ES":"CS",t]}},RPCountLoadMore:{name:"RPCountLoadMore"},RPCountExpCollItemsRollUp:{name:"RPCountExpCollItemsRollUp",customData:function(e,t){return[i(Object(a.a)(e)),t]}},RPCountExpCollAllItemParts:{name:"RPCountExpCollAllItemParts",customData:function(e,t,n){return[t,n]}},PrintItem:{name:"PrintItem",actionSource:function(e,t){return t}},ReplyByMeeting:{name:"ReplyByMeeting",actionSource:function(e,t,n,r){return r}}}},3165:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.SeeMore=3]="SeeMore"}(r||(r={}))},3166:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var r=n(37),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(8),n.e(11),n.e(20),n.e(727)]).then(n.bind(null,6161))})),i=new r.a(a,(function(e){return e.loadCLPUserLabels})),o=(new r.a(a,(function(e){return e.addAuditActionToViewState})),new r.b(a,(function(e){return e.showJustificationModal}))),c=new r.a(a,(function(e){return e.loadItemCLPInfo})),u=new r.b(a,(function(e){return e.updateItemCLPInfo})),s=new r.b(a,(function(e){return e.logReadCLPLabel})),d=new r.b(a,(function(e){return e.triggerCLPAutoLabeling})),l=(new r.b(a,(function(e){return e.constructCLPAuditAction})),Object(r.d)(a,(function(e){return e.CLPSubjectHeaderLabel}))),f=Object(r.d)(a,(function(e){return e.CLPMandatoryLabelModal}))},3167:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(64);function a(){if(Object(r.i)())try{return new ActiveXObject("htmlfile"),!0}catch(e){return!1}return!1}},3265:function(e,t,n){"use strict";function r(e,t,n,r){var i=a(e,t,n,r);return i?i.Value:null}function a(e,t,n,r){if(!e||!e.ExtendedProperty)return null;for(var a=0;a<e.ExtendedProperty.length;a++){var i=e.ExtendedProperty[a],o=null,c=null,u=null;if((null==i?void 0:i.ExtendedFieldURI)&&(o=i.ExtendedFieldURI.PropertyTag,c=i.ExtendedFieldURI.PropertyName,u=i.ExtendedFieldURI.PropertyId),t&&o==t)return i;if(n&&c==n)return i;if(r&&u==r)return i}return null}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},3346:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(1656);function a(e){return(null==e?void 0:e.conversationNodeIdsInCollapsedItemsRollUp)&&e.conversationNodeIdsInCollapsedItemsRollUp.length>0}function i(e){var t=r.a.conversations.get(e.conversationId.Id);return a(e)||(null==t?void 0:t.canLoadMore)}function o(e,t){return(null==e?void 0:e.conversationNodeIdsInCollapsedItemsRollUp)&&t&&e.conversationNodeIdsInCollapsedItemsRollUp.includes(t.conversationNodeId)}function c(e){if(!a(e))return 0;var t=e.conversationNodeIdsInCollapsedItemsRollUp,n=e.itemPartsMap,r=t.length;return t.forEach((function(e){var t=n.get(e);t.oofRollUpViewState.oofReplyNodeIds&&(r+=t.oofRollUpViewState.oofReplyNodeIds.length)})),r}},3371:function(e,t,n){"use strict";var r=n(18),a=n(2239),i=n(222);t.a=function(){var e=a.b.clpLabels;return Object(r.i)("cmp-clp")&&e.length>0&&e.some((function(e){return e.isLabelEnabled}))&&!Object(i.a)()}},3479:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(64),a=n(1832);function i(){return Object(r.e)()&&Object(r.o)([a.f])||Object(r.g)()&&Object(r.o)([a.h])||Object(r.f)()&&Object(r.o)([a.g])}},3609:function(e,t,n){"use strict";t.a=function(e){var t;return null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.isDecoded}},3651:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.TXP=0]="TXP",e[e.CalendarCard=1]="CalendarCard",e[e.MeetingPoll=2]="MeetingPoll",e[e.Voting=3]="Voting",e[e.Yammer=4]="Yammer"}(r||(r={}))},3741:function(e,t,n){"use strict";t.a=function(e,t){void 0===t&&(t=!0);var n=t?23:24;return e>=n?n:e}},3742:function(e,t,n){"use strict";function r(e,t){return{infoBarIds:t||[],infoBarHostKey:e||"0"}}n.d(t,"a",(function(){return r}))},3988:function(e,t,n){"use strict";var r=n(0),a=n(2481),i=n(5284),o=n(4598),c=n(3164),u=n(7175),s=n(5285),d=n(7176),l=n(7177),f=n(5286),b=n(48),m=n(18),v=n(3742),p=n(7178),g=n(1778),O=n(3166),I=n(7826),h=n(2098),j=n(1656),S=n(2280),P=n(2866),w=n(2451),C=n(5289),A=n(2776),R=n(7053),y=n(5290),E=function(e){var t;return(null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.ErrorState)||0},x=n(3871),M=n(3609),L=n(1867),V=n(20),N=n(127),D=function(e,t){V.g.info("S/MIME: processing S/MIME message. isSmimeAdapterAlreadyUsable: "+Object(A.a)());var n=new N.b("RPProcessSmimeItem",{isCore:!0});return S.q.import().then((function(t){return t(e)})).then((function(){T(e,n,t)})).catch((function(){T(e,n,t)}))};function _(e,t,n,o,c,s){if(e.itemId==t.Id){var b=(null==t?void 0:t.Id)&&Object(j.b)().items.get(t.Id);e.itemViewState=function(e,t){return Object(r.__assign)(Object(r.__assign)({},Object(v.a)(e.Id,Object(u.a)())),{itemId:e.Id,isConversationItemPart:!1,attachmentWell:null,meetingRequestViewState:null,loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,smartPillViewState:{smartPillBlockVisible:!1},hideSmartReplyFeedbackDialog:!0,ampViewState:Object(p.a)(t),hasMeetingPoll:Object(l.a)(t),omeMessageState:Object(I.a)(t)})}(t,b),e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!b,e.instrumentationContext=n,b&&(o.addCustomData(Object(d.b)(b,s,c)),O.h.import().then((function(e){e(b)})),Object(f.d)(b)?e.isUnsupportedItem=!0:(Object(i.a)(e.itemViewState,!1,{item:b}),Object(a.a)(e,b)))}}var k=function(e,t,n,r,a){return r?r(e):h.e.importAndExecute(e,n?"LoadItemPreviewPane":"LoadItemReadingPane",t,Object(A.a)(),a)},F=function(e,t,n,r,a){var i;return Object(L.a)(n)?P.a.import().then((function(){return Object(A.a)()&&Object(R.a)(n)?(i=!0,k(e,t,r,a)):n})).then((function(){return D(e,i)})):Promise.resolve()};function T(e,t,n){var r=Object(j.b)().items.get(null==e?void 0:e.Id);t.addCustomData({smimeInstallationStatus:w.a.installationStatus,smimeType:Object(x.a)(r),numAttachments:U(r),wasReloaded:n}),Object(M.a)(r)?t.end():t.endWithError("ClientError",new Error(E(r).toString()))}function U(e){var t;return null===(t=null==e?void 0:e.Attachments)||void 0===t?void 0:t.length}t.a=Object(b.d)("loadItemReadingPane",c.a.RPPerfLoadItemReadingPane)((function(e,t,n,r,a,i,u,d){var l=function(e,t,n){return{itemId:e.Id,itemViewState:null,isPrint:t,loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(g.b)(),isUnsupportedItem:!1,instrumentationContext:null,extendedCardViewState:null,isReadonly:n}}(e,r,!!i);Object(s.c)(),Object(o.a)(l),n&&n(l);var f=Object(N.t)((function(e){return e.eventName==c.a.RPPerfLoadItemReadingPane.name})),b=Object(j.b)().items.get(e.Id);!Object(m.i)("ring-dogfood")||r||a||Object(N.r)("RPMailStoreItemsCount",{count:Object(j.b)().items.size});var v=Object(R.a)(b),p=Object(L.a)(b);return p&&b.Smime&&!Object(M.a)(b)&&(b.Smime.ErrorState=0),b&&(b.NormalizedBody&&!v||Object(y.a)(b))?p&&!Object(M.a)(b)?(new N.b("RPProcessSmimeItem").addCustomData({wasItemReloaded:!1}),D(e,!1).then((function(){var n,i;return null===(i=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===i||i.call(n,"LIRP_SMIME"),_(l,e,t,f,r,a)}))):(_(l,e,t,f,r,a),Promise.resolve()):new Promise((function(e){return p&&v&&!Object(C.a)()?P.a.import().then(e):e(void 0)})).then((function(){var n,i;return null===(i=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===i||i.call(n,"LIRP_THEN"),function(e,t,n,r,a,i,o,c){return k(t,r,i,c,o).then((function(e){var a,o;return null===(o=null===(a=null==n?void 0:n.dp)||void 0===a?void 0:a.addCheckpoint)||void 0===o||o.call(a,"LI_THEN"),F(t,r,e,i,c)})).then((function(){var o,c;return null===(c=null===(o=null==n?void 0:n.dp)||void 0===o?void 0:o.addCheckpoint)||void 0===c||c.call(o,"LI_SMIME_THEN"),_(e,t,n,r,a,i)})).catch((function(t){return e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!0,Promise.reject(t)}))}(l,e,t,f,r,a,u,d)}))}))},4125:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s}));var r=n(3165),a=n(1756),i=n(148),o=Object(i.select)({conversationReadingPaneState:function(){return Object(a.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.focusedItemPart)?e.conversationReadingPaneState.focusedItemPart.itemPart:null})),c=Object(i.select)({conversationReadingPaneState:function(){return Object(a.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.focusedItemPart)?e.conversationReadingPaneState.focusedItemPart.focusedItemArea:null})),u=Object(i.select)({conversationReadingPaneState:function(){return Object(a.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.initiallySelectedItemPart)?e.conversationReadingPaneState.initiallySelectedItemPart.itemPart:null})),s=Object(i.select)({conversationReadingPaneState:function(){return Object(a.a)()}})((function(e,t){var n=o(t),a=c(t);return n==e&&a==r.a.Item}))},4491:function(e,t,n){"use strict";var r=n(0),a=n(9424),i=n(3164),o=n(7175),c=n(10505),u=n(1697),s=n(7176),d=n(7177),l=n(6777),f=n(10506),b=n(9),m=n(127),v=n(48),p=n(18),g=n(3742),O=n(7178),I=n(1739),h=n(1656);function j(e){var t=I.a.conversationItems.get(e);if(t){var n=function(e){var t,n,a,i,o={unreadItemCount:0,totalItemCount:0},c=h.a.conversations.get(e);try{for(var u=Object(r.__values)(c.conversationNodeIds),s=u.next();!s.done;s=u.next()){var d=s.value,l=h.a.conversationNodes.get(d);if(!l){o.totalItemCount=0;break}o.totalItemCount+=l.itemIds.length;try{for(var f=(a=void 0,Object(r.__values)(l.itemIds)),b=f.next();!b.done;b=f.next()){var m=b.value,v=h.a.items.get(m);if(!v){o.totalItemCount=0;break}o.unreadItemCount+=v.IsRead?0:1}}catch(e){a={error:e}}finally{try{b&&!b.done&&(i=f.return)&&i.call(f)}finally{if(a)throw a.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return o}(e);return t.globalItemIds.length!=n.totalItemCount||t.globalUnreadCount!=n.unreadItemCount}return!1}var S=n(1778),P=n(1647),w=n(2098),C=n(148),A=n(3331);n.d(t,"a",(function(){return y}));var R=[];var y=Object(C.select)({conversationNodes:function(){return P.u.conversationNodes}})((function(e,t,n){var a;if(!t||!t.Id)return[null,null];var i=n.conversationNodes.get(t.Id),c=(a=Object(r.__read)(Object(A.a)(i),3))[0],u=a[1],s=a[2];if(!Object(A.c)(c,s,u))return[null,null];var l={isExpanded:!1,loadingState:{isLoading:!1,hasLoadFailed:!1}},b=function(e,t,n){return!e.IsRead&&t||e.IsDraft&&!n}(c,u,s),m={mailboxInfo:t.mailboxInfo,Id:c.ItemId.Id};return[Object(r.__assign)(Object(r.__assign)({},Object(g.a)(m.Id,Object(o.a)())),{conversationNodeId:t.Id,itemId:m.Id,isConversationItemPart:!0,isExpanded:b,isLocal:u,isDeleted:s,attachmentWell:null,quotedBodyViewState:l,isFossilizedTextExpanded:b,hideSmartReplyFeedbackDialog:!0,meetingRequestViewState:null,loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,oofRollUpViewState:Object(f.b)(c.ItemClass),isInRollUp:!1,smartPillViewState:{smartPillBlockVisible:!1},ampViewState:Object(O.a)(c),hasMeetingPoll:Object(d.a)(c),omeMessageState:null}),c]}));t.b=Object(C.select)({readingPaneStore:function(){return u.a},conversationNodes:function(){return P.u.conversationNodes},conversations:function(){return P.c}})(Object(v.d)("loadConversationReadingPane",i.a.RPPerfLoadConversationReadingPane)((function(e,t,n,r,o,u){var d,f=Promise.resolve(),v=function(e,t,n,r,a){return{conversationId:e,conversationSubject:t,conversationCategories:n,initiallySelectedItemPart:null,itemIdToScrollTo:a,itemPartsMap:new b.ObservableMap({}),loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(S.b)(),unsupportedItemId:null,instrumentationContext:r,attachmentWell:null,calendarInlineComposeViewState:null,focusedItemPart:null,conversationNodeIdsInCollapsedItemsRollUp:[],nodeIdBundledWithSeeMoreMessages:null,extendedCardViewState:null}}(e,n,r,t,o);Object(p.i)("rp-persistedReadingPaneTabs")||(u.readingPaneStore.conversationReadingPaneViewState=v);var g=Object(P.q)(e.Id),O=Object(m.t)((function(e){return e.eventName==i.a.RPPerfLoadConversationReadingPane.name}));if(Object(p.i)("ring-dogfood")){var I=!1;R.includes(e.Id)?I=!0:R.push(e.Id),Object(m.r)("RPCacheStatus",{hasValidConversationCache:g,hasOpened:I,OpenedCount:R.length})}return Object(c.c)(),g&&(d="Valid",u.conversations.getAndTouch(e.Id),Object(l.a)(e.Id)||(Object(c.a)(v),Object(a.a)(e.Id))),g&&!j(e.Id)||(Object(c.a)(v),d=g?"Stale":"Not",f=w.d.importAndExecute(e,"LoadConversationReadingPane",O)),f.then((function(){var n,r;null===(r=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===r||r.call(n,"LCRP_POST"),O&&O.addCustomData(Object(s.a)(e.Id,d))}))})))},4598:function(e,t,n){"use strict";var r=n(5285),a=n(1697),i=n(18),o=n(148);t.a=Object(o.action)("setItemReadingPaneViewState")((function(e){Object(i.i)("rp-persistedReadingPaneTabs")?Object(r.a)(e):a.a.itemReadingPaneViewState=e}))},5062:function(e,t,n){"use strict";function r(e,t){return(null==e?void 0:e.extendedCardViewState)&&e.extendedCardViewState.cardType==t}function a(e){var t;return null===(t=null==e?void 0:e.extendedCardViewState)||void 0===t?void 0:t.coverOriginalContent}function i(e,t){return r(e,t)?e.extendedCardViewState.cardViewState:null}n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}))},5284:function(e,t,n){"use strict";var r=n(0),a=n(7834),i=n(1656),o=n(2046),c=n(148);t.a=Object(c.select)({item:function(e){return i.a.items.get(e.itemId)}})(Object(c.action)("initializeExtendedStateForItemViewState")((function(e,t,n){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(a.a)(e,n.item,t)];case 1:return r.sent(),n.item&&Object(o.q)(n.item.ItemClass)&&o.t.importAndExecute(e),[2]}}))}))})))},5285:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(1697),a=n(2),i=n(18),o=n(1721),c=n(2274),u=Object(a.mutatorAction)("addLoadedItemReadingPaneViewState",(function(e){if(Object(i.i)("rp-persistedReadingPaneTabs")){var t=e.itemId,n=Object(r.b)().loadedItemReadingPaneViewStates;n.has(t)||n.set(t,e)}})),s=Object(a.mutatorAction)("releaseOrphanedLoadedItemViewStates",(function(){if(Object(i.i)("rp-persistedReadingPaneTabs")){var e=Object(r.b)().loadedItemReadingPaneViewStates;e.forEach((function(t,n){Object(o.n)(n)||n==Object(c.a)()||e.delete(n)}))}})),d=Object(a.mutatorAction)("releaseLoadedItemViewState",(function(e){Object(i.i)("rp-persistedReadingPaneTabs")&&Object(r.b)().loadedItemReadingPaneViewStates.delete(e)}))},5286:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var r=n(1644),a=n(1656),i=n(966),o="IPM.Appointment",c="IPM.Contact",u="IPM.DistList",s="IPM.Task",d="calendar",l="contacts",f="tasks",b="inbox";function m(e){return e&&(O(e.ItemClass)||I(e.ItemClass)||h(e.ItemClass)||j(e.ItemClass))}function v(e){var t=a.a.conversations.get(e),n=a.a.conversationNodes.get(t&&t.conversationNodeIds[0]);if(n){var r=n.itemIds[0];if(m(a.a.items.get(r)))return r}return null}function p(e){var t=a.a.items.get(e);return O(t.ItemClass)?Object(i.a)(d):I(t.ItemClass)||h(t.ItemClass)?Object(i.a)(l):j(t.ItemClass)?Object(i.a)(f):Object(i.a)(b)}function g(e){var t="",n=r.d.folderTable.get(e);return n&&(t=Object(r.j)(n)),t}function O(e){return 0==e.indexOf(o)}function I(e){return 0==e.indexOf(c)}function h(e){return 0==e.indexOf(u)}function j(e){return 0==e.indexOf(s)}},5287:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(883),a=n(18),i=n(222);function o(){var e=Object(r.e)(r.b.AmpDeveloper);return Object(i.a)()&&Object(a.i)("rp-amp")&&e.enabled}},5288:function(e,t,n){"use strict";var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e[e.None=0]="None",e[e.Revocable=1]="Revocable",e[e.Expirable=2]="Expirable"}(r||(r={})),function(e){e[e.None=0]="None",e[e.SuccessOrNoChange=1]="SuccessOrNoChange",e[e.FailedOrMessageNotFound=2]="FailedOrMessageNotFound",e[e.PartialFailed=3]="PartialFailed"}(a||(a={}))},5289:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2451),a=n(2615);function i(){var e=Object(r.b)();return Object(a.k)(e.installationStatus)}},5290:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1832);function a(e){return(null==e?void 0:e.ItemId)&&0===e.ItemId.Id.indexOf(r.m)}},6369:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(20),a=null,i={register:function(e){a=e},available:function(){return!!a},run:function(e,t){return a?a(e,t):(r.d("getAttachmentWellViewStateByItemIdHelper is not registered."),null)}}},6370:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.None="none",e.AmpDisabled="ampDisabled",e.MessageUnsafe="messageUnsafe",e.SenderNotAllowed="sendNotAllowed",e.BrowserNotSupported="browserNotSupported",e.AmpNotValidated="ampNotValidated",e.AmpValidationFailed="ampValidationFailed",e.AmpValidated="ampValidated"}(r||(r={}))},675:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));var r="popoutv2",a="1",i="_owa_projection_root"},6777:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1697),a=n(18);function i(e){return!(!Object(a.i)("rp-persistedReadingPaneTabs")||!e)&&Object(r.b)().loadedConversationReadingPaneViewStates.has(e)}},7053:function(e,t,n){"use strict";var r=n(2853),a=n(3609),i=n(1867),o=n(5289),c=n(2776),u=function(){return!!Object(o.a)()&&!Object(c.a)()};t.a=function(e){return!Object(a.a)(e)&&!u()&&Object(i.a)(e)&&!Object(r.a)(e)}},7175:function(e,t,n){"use strict";function r(){return["unsubscribeInfoBar","safetyBar","infoImportance","infoSensitivity","infoFlagStatus","irmInfoBar","infoMessageSubmitted","agendaMailFeedback","unauthenticatedSender","infoDelegate","infoMeetingAttendeeDoNotForward","infoSMIME","infoSmimeDecodeError","infoSmimeSigned","infoItemPartLoadFailure","infoLastUserAction","infoReadReceiptRequested","translateInfoBar","infoResend","infoPolicyTag","infoMessageApprovalAndVoting","nudged","nudgeFeedback","infoMessageClassification","infoCLPLabel","infoRevocation","externalMessage","spotlight","spotlightFeedback"]}n.d(t,"a",(function(){return r}))},7176:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var r=n(2488),a=n(1756),i=n(1656),o=n(3741),c=n(2046),u=n(17),s=n(1867),d="Meeting",l="Message";function f(e,t){var n=0,u=0,s=0,d=0,l=0,f=Object(a.a)(e);if(f){var b=f.itemPartsMap;b.forEach((function(e){e.isExpanded&&d++;var t=i.a.items.get(e.itemId);t&&(t.IsRead||n++,t.IsDraft&&u++,Object(c.m)(t)&&s++)})),l=b.size}return{owa_1:v(),owa_2:Object(r.a)(),owa_3:Object(o.a)(l),owa_4:Object(o.a)(d),owa_5:Object(o.a)(n),owa_6:Object(o.a)(s),owa_7:Object(o.a)(u),owa_8:t}}function b(e,t,n){return{owa_1:v(),owa_2:m(e),owa_3:t,owa_4:n,owa_5:Object(s.a)(e)}}function m(e){return Object(c.m)(e)?d:l}function v(){return Object(u.a)().UserOptions.GlobalReadingPanePositionReact}},7177:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(6),a=n(18),i="findtime/vote?getrequesturl=";function o(e){if(!Object(a.i)("cal-mf-meetingPollCard")||!e)return!1;var t=null;return e.UniqueBody?t=e.UniqueBody.Value:e.NormalizedBody&&(t=e.NormalizedBody.Value),!Object(r.f)(t)&&t.indexOf(i)>-1}},7178:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(7803);function a(e){return{preferAmp:!0,ampAvailability:Object(r.a)(e)}}},7179:function(e,t,n){"use strict";function r(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.EmailAddress:null}n.d(t,"a",(function(){return r}))},7180:function(e,t,n){"use strict";var r=n(2),a=Object(r.createStore)("ampstore",{allowedSenders:[]});t.a=a()},7803:function(e,t,n){"use strict";var r=n(6);var a=n(7179),i=n(5287),o=n(105),c=n(6370),u=n(7180),s=n(883);function d(e){if(!function(e){return e&&!Object(r.f)(e.AmpHtmlBody)}(e))return c.a.None;if(!Object(i.a)())return c.a.AmpDisabled;if(!function(e){return e&&!e.BlockStatus&&(!e.MessageSafety||!e.MessageSafety.MessageSafetyLevel||e.MessageSafety.MessageSafetyLevel<=2)}(e))return c.a.MessageUnsafe;var t=Object(a.a)(e);return null==t||!function(e){var t=Object(s.e)(s.b.AmpDeveloper);return t.enabled&&t.allowedSender.some((function(t){return l(t,e)}))}(t)&&!function(e){return u.a.allowedSenders&&u.a.allowedSenders.some((function(t){return l(t,e)}))}(t)?c.a.SenderNotAllowed:Object(o.e)()||Object(o.g)()?c.a.BrowserNotSupported:c.a.AmpNotValidated}function l(e,t){return e.toLowerCase()==t.toLowerCase()}n.d(t,"a",(function(){return d}))},7826:function(e,t,n){"use strict";var r=n(5288),a=n(4);var i=n(18),o=n(3265),c=n(966);n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return l}));var u="x-ms-exchange-organization-ome-messagestate",s="rp-omeRevocation",d="sentitems";function l(e){return!Object(i.i)(s)||(null==e?void 0:e.ParentFolderId)&&e.ParentFolderId.Id!==Object(c.a)(d)?null:function(e){if(e){var t={permissions:r.b.None,revoked:!1,expired:!1,revocationDate:null,revokedBy:null,responseState:r.a.None};try{var n=JSON.parse(e);if(1==n.Permissions&&(t.permissions=r.b.Revocable),2==n.Permissions&&(t.permissions=r.b.Expirable),t.revoked=n.IsRevoked,t.expired=n.IsExpired,n.RevocationDate){var i=Object(a.Rb)("UTC",n.RevocationDate);t.revocationDate=new Date(Object(a.Ab)(i))}t.revokedBy=n.RevokedBy}catch(e){return null}return t}return null}(Object(o.a)(e,null,u))}},7834:function(e,t,n){"use strict";var r=n(0),a=n(2201),i=n(1786),o=n(2853),c=n(3609),u=n(1867),s=n(148),d=n(1756),l=n(1656),f=n(6369);function b(e,t){var n,r=l.a.items.get(t);if(r){var a=r.InternetMessageId,i=null===(n=Object(d.a)(e))||void 0===n?void 0:n.itemPartsMap.get(a);return i?i.attachmentWell:null}return null}var m=n(1856);t.a=Object(s.action)("initializeAttachmentsForItem")((function(e,t,n){return void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return!t||Object(u.a)(t)&&!function(e,t){if(!Object(o.a)(t))return!0;if(!e.isConversationItemPart&&Object(c.a)(t))return!0;return!1}(e,t)||!t.Attachments?[2]:e.attachmentWell?[3,2]:[4,i.j.import()];case 1:s=r.sent(),e.attachmentWell=s(!0,!1,""),r.label=2;case 2:return f.a.register(b),n?[4,i.q.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0)]:[3,4];case 3:return r.sent(),[3,6];case 4:return[4,i.n.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0,!1,null,null,!!t.RightsManagementLicenseData,Object(u.a)(t))];case 5:r.sent(),r.label=6;case 6:return[4,a.g.import()];case 7:return d=r.sent(),d(t.Attachments).forEach((function(t){return Object(m.a)(e,t)})),[2]}}))}))}))},796:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(18),a=n(222),i=n(225);function o(){var e;return(e={})[i.b.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[i.b.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[i.b.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(a.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddClassicAttachment","InsertLink","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[i.b.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[i.b.Confetti]={confettiEnabled:!0},e[i.b.ComposeAssistance]={composeAssistanceEnabled:!0},e[i.b.GdprAdsPrefs]={feature:i.b.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[i.b.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[i.b.ExternalImages]={externalImagesSelectedOption:0},e[i.b.EventCapture]={autoCollectionEnabled:!1},e[i.b.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[i.b.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[i.b.AmpDeveloper]={enabled:Object(r.i)("rp-ampDefault"),allowedSender:[]},e[i.b.CalendarHelp]={calendarHelpEnabled:!1},e[i.b.LinkedInViewProfile]={dismissed:!1},e[i.b.Bohemia]={bohemiaEnabled:Object(r.i)("cmp-prague")},e[i.b.GdprAdsV2]={feature:i.b.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},e[i.b.GdprAdsV3]={feature:i.b.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[i.b.Proofing]={feature:i.b.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[i.b.ActiveProxyAddress]={feature:i.b.ActiveProxyAddress,activeProxyAddresses:[]},e[i.b.OutlookSpaces]={feature:i.b.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[i.b.SxS]={feature:i.b.SxS,hideReadingPane:!1,defaultEditCommand:i.a.EditInBrowser},e[i.b.ReadingPaneConversation]={feature:i.b.ReadingPaneConversation,conversationEnabled:!0,conversationEnabledNativeHost:!1},e}},8588:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(10494);function a(e,t){var n=t?t.Value:"",a=Object(r.a)(e);return a||n}},8591:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("initializeExtendedCardForConversationReadingPane",(function(e,t){return{conversationViewState:e,loadedItemParts:t}}))},8592:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("tryInitializeShouldShowCLPLabel",(function(e){return{conversationViewState:e}}))},883:function(e,t,n){"use strict";var r=n(37),a=n(993),i=n(225),o=n(2),c=[i.b.SurfaceActions];Object(o.orchestrator)(a.a,(function(e){var t=e.defaultOptions;c.forEach((function(e){t[e]&&Object(i.g)(Number(e),t[e])}))}));var u=n(796);n.d(t,"f",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"d",(function(){return u.a})),n.d(t,"e",(function(){return i.e})),n.d(t,"c",(function(){return i.c})),n.d(t,"b",(function(){return i.b})),n.d(t,"a",(function(){return i.a}));var s=new r.c((function(){return n.e(903).then(n.bind(null,17449))})),d=new r.a(s,(function(e){return e.createOrUpdateOptionsForFeature})),l=new r.a(s,(function(e){return e.updateAddinPinStatus})),f=(new r.a(s,(function(e){return e.updateAddInArray})),new r.b(s,(function(e){return e.getServerOptionsForFeature}))),b=new r.a(s,(function(e){return e.loadOptions}))},9424:function(e,t,n){"use strict";var r=n(0),a=n(9449),i=n(8591),o=n(5284),c=n(4491),u=n(3164),s=n(3346),d=n(2488),l=n(127),f=n(148),b=n(1656),m=n(2046),v=n(5062),p=n(3651),g=5,O=3,I=Object(f.action)("markConversationCollapsedItemsRollUp")((function(e,t,n){Object(v.b)(e,p.a.CalendarCard)?function(e,t){for(var n=t.length,r=[],a=Object(d.a)()?0:n-1,i=Object(d.a)()?1:-1,o=a;o<=n-1&&o>=0&&!t[o].isExpanded;o+=i)h(t[o])&&r.push(t[o].conversationNodeId);r.length>1&&(e.conversationNodeIdsInCollapsedItemsRollUp=r)}(e,t):function(e,t,n){var r=t.length;if(r<g)return;var a=[],i=Object(d.a)()?1:r-2,o=Object(d.a)()?1:-1;n&&(i-=o);for(var c=i;c<=r-1&&c>=0&&!t[c].isExpanded;c+=o)a.push(t[c].conversationNodeId);if(a.length>=O){if(a.pop(),e.conversationNodeIdsInCollapsedItemsRollUp=a,!n){var f=Object(d.a)()?0:r-1;e.nodeIdBundledWithSeeMoreMessages=t[f].conversationNodeId}Object(l.r)("RPCountRenderCollItemsRollUp",[Object(u.b)(Object(s.a)(e))])}}(e,t,n)}));function h(e){var t=b.a.items.get(e.itemId);return!(!t||!Object(m.m)(t))&&t.IsOutOfDate}var j=n(10507),S=n(8592),P=n(3165),w=n(1756),C=n(8588),A=n(1641);var R=n(6);var y=n(5286),E=n(2510),x=n(3371),M=n(3331);function L(e,t,n,a){var u=[],s=t.itemPartsMap,d=t.itemIdToScrollTo,l=null;if(e.conversationNodeIds){e.conversationNodeIds.forEach((function(n){var a=Object(r.__read)(Object(c.a)(t.conversationId.Id,{mailboxInfo:e.conversationId.mailboxInfo,Id:n}),1)[0];a&&s.set(n,a)})),Object(x.a)()&&Object(S.a)(t),Object(j.a)(s,n,e.conversationNodeIds,!1);var f=!1;e.conversationNodeIds.forEach((function(e){var t=s.get(e);if(t&&!t.isInRollUp){u.push(t);var n=a.get(t.itemId);(function(e){var t=Object(A.H)();if(null==t?void 0:t.highlightTerms){var n=Object(C.a)(e.RightsManagementLicenseData,e.UniqueBody),r=document.createElement("div");return r.innerHTML=n,t.highlightTerms.some((function(e){return r.innerText.toLowerCase().indexOf(e)>=0}))}return!1})(n)&&(t.isExpanded=!0),f=f||t.isExpanded&&!n.IsDraft}}));var g="ChronologicalNewestOnBottom"==e.conversationSortOrder;if(function(e,t,n,r){var a=n.length;if(0!=a&&!t){for(var i=null,o=e?a-1:0,c=o,u=e?-1:1,s=function(e){var t=r.get(e);return Object(M.a)(t)[1]};c>=0&&c<a;){var d=n[c],l=d.oofRollUpViewState.oofReplyNodeIds.some(s);if(!d.isExpanded&&(d.isLocal||l)){i=d;break}c+=u}i||(i=n[o]),i.isExpanded=!0,i.isFossilizedTextExpanded=!0}}(g,f,u,n),l=function(e,t){for(var n=e.length,r=0;r<n;r++){var a=e[r],i=a.itemId;if(t){if(i==t)return a.isExpanded=!0,{itemPart:a,focusedItemArea:P.a.Item}}else{if(a.isExpanded)return{itemPart:a,focusedItemArea:P.a.Item};if(a.oofRollUpViewState.isOofRollUpExpanded)return{itemPart:a,focusedItemArea:P.a.Oof}}}return null}(u,d),u.forEach((function(e){e.isExpanded&&Object(o.a)(e)})),Object(i.a)(t,u),Object(v.b)(t,p.a.CalendarCard)&&function(e){var t,n=e.length;if(0!=n)for(var r=0;r<n;r++){var a=e[r],i=a?a.itemId:null,o=b.a.items.get(i),c=Object(A.H)();if(o&&Object(m.m)(o)&&(null==c||!c.highlightTerms))if(o.IsRead||o.IsOutOfDate)a.isExpanded=!1,a.isFossilizedTextExpanded=!1;else if(Object(m.q)(o.ItemClass)){var u=o;"NewMeetingRequest"==u.MeetingRequestType&&!Object(R.f)(u.Preview)||(null===(t=u.ChangeHighlights)||void 0===t?void 0:t.HasBodyChanged)?a.isExpanded=!0:(a.isExpanded=!1,a.isFossilizedTextExpanded=!1)}else!Object(m.r)(o.ItemClass)&&!Object(m.l)(o.ItemClass)||Object(R.f)(o.Preview)?(a.isExpanded=!1,a.isFossilizedTextExpanded=!1):a.isExpanded=!0}}(u),u.length){var O=g?0:e.conversationNodeIds.length-1,h=e.conversationNodeIds[O],w=s.has(h);e.canLoadMore&&(t.nodeIdBundledWithSeeMoreMessages=h),Object(E.a)(t.conversationId.Id)||I(t,u,e.canLoadMore&&!w)}}return l}t.a=Object(f.select)({loadedConversation:function(e){return b.a.conversations.get(e)},conversationNodes:function(){return b.a.conversationNodes},conversationReadingPaneState:function(e){return Object(w.a)(e)},items:function(){return b.a.items}})(Object(f.action)("firstLoadConversationReadingPane")((function(e,t){if(t.conversationReadingPaneState.conversationId.Id==e){var n=t.conversationReadingPaneState;if(n.loadingState.isLoading=!1,n.loadingState.hasLoadFailed=t.loadedConversation.loadingState.hasLoadFailed,!n.loadingState.hasLoadFailed){var r=Object(y.c)(e);if(n.unsupportedItemId=r,!r){var i=L(t.loadedConversation,n,t.conversationNodes,t.items);n.initiallySelectedItemPart=n.focusedItemPart=i,Object(a.a)(n)}}}})))},9449:function(e,t,n){"use strict";var r=n(0),a=n(7834),i=n(1656);function o(e,t){if(e.itemPartsMap.size>0){if(function(e){if(!e)return!1;var t=i.a.conversations.get(e.conversationId.Id);return null==t?void 0:t.canLoadMore}(e))return!0;for(var n=Object(r.__spread)(e.itemPartsMap.keys()),a=0;a<n.length;a++){var o=e.itemPartsMap.get(n[a]);if(o){var c=t.get(o.itemId);if(c&&c.Attachments)return!0}}}return!1}var c=n(2488),u=n(1786),s=n(3408),d=n(148);t.a=Object(d.action)("initializeAttachmentsForConversationWell")(Object(d.select)({mailStoreItems:function(){return i.a.items}})((function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,d,l,f,b,m,v,p,g;return Object(r.__generator)(this,(function(O){switch(O.label){case 0:return o(e,n.mailStoreItems)?(null==e?void 0:e.attachmentWell)?[3,4]:[4,s.c.importAndExecute(e.conversationId)]:[3,11];case 1:return i=r.__read.apply(void 0,[O.sent(),3]),d=i[0],l=i[1],f=i[2],[4,u.l.import()];case 2:return b=O.sent(),e.attachmentWell=b(l,f),[4,u.n.importAndExecute(d,e.conversationId.mailboxInfo,e.attachmentWell,!0,!1)];case 3:O.sent(),O.label=4;case 4:m=Object(r.__spread)(e.itemPartsMap.keys()),v=0,O.label=5;case 5:return v<m.length?(p=e.itemPartsMap.get(m[v]))&&(g=n.mailStoreItems.get(p.itemId))?[4,Object(a.a)(p,g,t)]:[3,8]:[3,9];case 6:return O.sent(),[4,u.o.importAndExecute(p.attachmentWell,e.attachmentWell,Object(r.__assign)(Object(r.__assign)({},g.ItemId),{mailboxInfo:g.MailboxInfo}),g.DateTimeReceived)];case 7:O.sent(),O.label=8;case 8:return v++,[3,5];case 9:return[4,u.s.importAndExecute(e.attachmentWell,Object(c.a)())];case 10:O.sent(),O.label=11;case 11:return[2]}}))}))})))},993:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),a=n(796),i=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(a.a)()),{defaultOptions:e}}))}}]);
//# sourceMappingURL=owa.MailBoot~MailFunctionalBoot~ReadingPane~TabView.js.map
self.scriptsLoaded['owa.MailBoot~MailFunctionalBoot~ReadingPane~TabView.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFunctionalBoot~ReadingPane~TabView.js'] = (new Date()).getTime();