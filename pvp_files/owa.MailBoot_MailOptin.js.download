self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailOptin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[667],{1007:function(e,n,t){"use strict";var r=t(0),o=t(148),i=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,n){var t,o;if(!this.store){this.store=e,this.deleteCallback=n;try{for(var i=Object(r.__values)(e.keys()),a=i.next();!a.done;a=i.next()){var u=a.value;this.mruList.push(u)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}}},e.prototype.add=function(e,n){var t=this;Object(o.action)("MruCache_add")((function(){t.store.set(e,n),t.mruList.indexOf(e)>=0?t.touch(e):(t.mruList.push(e),t.purgeIfNecessary())}))()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var n=this.store.get(e);return n&&this.touch(e),n},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var n=this;Object(o.action)("MruCache_remove")((function(){if(n.store.has(e)&&!n.isReferenced(e))return n.removeItemAtIndex(n.mruList.indexOf(e))}))()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(o.action)("MruCache_clear")((function(){e.purgeTillSize(0)}))()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.__spread)([void 0],this.mruList)))},e.prototype.touch=function(e){var n=this.mruList.indexOf(e);if(n<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(n,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var n=0;this.mruList.length>e&&n<this.mruList.length;){var t=this.mruList[n];this.isReferenced(t)?n++:this.removeItemAtIndex(n)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var n=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(n):this.store.delete(n)},e.prototype.isReferenced=function(e){for(var n=0;n<this.references.length;n++){var t=this.references[n]();if(Array.isArray(t)){if(-1!=t.indexOf(e))return!0}else if(t==e)return!0}return!1},e}();t.d(n,"a",(function(){return i}))},11262:function(e,n,t){"use strict";t.r(n);var r=t(6996),o=t(3301),i=t(222);function a(){Object(r.c)(),Object(r.d)()&&Object(o.c)(),Object(r.d)()&&!Object(i.a)()&&Object(o.d)(),Object(r.a)(window),Object(r.b)(window)}t.d(n,"initializeMailOptinService",(function(){return a}))},1648:function(e,n,t){"use strict";function r(e){if(!e)return null;var n=e.lastIndexOf(".");return n>0?e.substr(n).toLowerCase():null}function o(e){var n=r(e);return n?n.replace(".",""):null}function i(e){var n;return(null===(n=o(e))||void 0===n?void 0:n.substring(0,4))||""}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return i}))},1653:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1664:function(e,n,t){"use strict";function r(){return{isDragOver:!1,draggableItemType:null}}t.d(n,"a",(function(){return r}))},1669:function(e,n,t){"use strict";var r=t(1648),o=t(1838),i=t(6);function a(e){var n;return e>=1073741824?(e/=1073741824,n=Object(i.b)(o.b)):e>=1048576?(e/=1048576,n=Object(i.b)(o.d)):e>=1024?(e/=1024,n=Object(i.b)(o.c)):n=Object(i.b)(o.a),Object(i.c)(n,Math.round(e))}var u,c=t(1713),s=t(18),d=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function l(e){if(!Object(s.i)("doc-attachment-documentThumbnail"))return!1;var n=Object(r.a)(e);return!!n&&d.indexOf(n.toLowerCase())>=0}function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return u.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return u.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return u.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(u||(u={}));var p=t(1683);t.d(n,"b",(function(){return r.a})),t.d(n,"c",(function(){return r.b})),t.d(n,"d",(function(){return r.c})),t.d(n,"i",(function(){return a})),t.d(n,"g",(function(){return c.a})),t.d(n,"h",(function(){return l})),t.d(n,"f",(function(){return f})),t.d(n,"e",(function(){return p.b})),t.d(n,"a",(function(){return u}))},1683:function(e,n,t){"use strict";function r(e){return n=e||"",(t=i.exec(n))&&t.length>1&&o[t[1].toLowerCase()];var n,t}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return a}));var o={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},i=/^\s*([^;\s]*)(?:;|\s|$)/;function a(e){var n="";return Object.entries(o).forEach((function(t){t[1]===e&&(n=t[0])})),n}},1709:function(e,n,t){"use strict";var r=t(37),o=t(1641);function i(){return a(Object(o.H)())}function a(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function u(){var e=Object(o.H)();return e&&2==e.tableQuery.type}function c(e){return!!e&&(2==e.type||s(e))}function s(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function d(e){return 2==e.type?e.folderId:s(e)?e.searchScope.groupId:null}function l(){var e=Object(o.H)();return e&&c(e.tableQuery)}t.d(n,"g",(function(){return p})),t.d(n,"h",(function(){return m})),t.d(n,"m",(function(){return b})),t.d(n,"l",(function(){return v})),t.d(n,"j",(function(){return g})),t.d(n,"i",(function(){return h})),t.d(n,"k",(function(){return w})),t.d(n,"c",(function(){return i})),t.d(n,"a",(function(){return a})),t.d(n,"d",(function(){return u})),t.d(n,"e",(function(){return c})),t.d(n,"b",(function(){return d})),t.d(n,"f",(function(){return l}));var f=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(20),t.e(21),t.e(49),t.e(80),t.e(703)]).then(t.bind(null,17550))})),p=new r.b(f,(function(e){return e.getGroupDisplayName})),m=new r.b(f,(function(e){return e.getGroupDisplayNameFromTableView})),b=new r.b(f,(function(e){return e.isPrivateUnjoinedGroup})),v=new r.b(f,(function(e){return e.isJoinedGroup})),g=new r.b(f,(function(e){return e.getRetentionPolicyTagsForGroup})),h=new r.b(f,(function(e){return e.getRetentionPolicyTagListForGroupTableQuery})),w=new r.b(f,(function(e){return e.isGroupOwner}))},1713:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return s}));var r=t(1648),o=t(1683),i=t(105),a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],u=[".tiff",".tif"];function c(e,n,t){return void 0===t&&(t=!0),s(Object(r.a)(e)||Object(o.a)(n),t)}function s(e,n){return void 0===n&&(n=!0),!!e&&(a.indexOf(e.toLowerCase())>=0||n&&u.indexOf(e.toLowerCase())>=0&&(Object(i.e)()||Object(i.d)()||Object(i.h)()||Object(i.g)()&&!Object(i.l)()))}},1724:function(e,n,t){"use strict";var r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function o(e){var n=null,t=r.exec(e);if(t){var o=t[1],i=t[2],a=null;try{a=atob(i)}catch(e){}if(a){for(var u=new ArrayBuffer(a.length),c=new Uint8Array(u),s=0;s<a.length;s++)c[s]=a.charCodeAt(s);n=new File([u],"image.png",{type:o})}}return n}var i=t(1653),a=t(1669);function u(e){return e.map((function(e){return{fileType:i.a.Uri,name:e.name,type:Object(a.b)(e.url)||"",size:0,uri:e.url}}))}var c=t(20);function s(e,n,t){if(e.length!=n.length)return c.d("The sizes of subjects and latestItemIds are different"),null;for(var r=[],o=0;o<e.length;o++){var a={fileType:i.a.MailItem,name:e[o],size:(null==t?void 0:t[o])||0,itemId:n[o]};r.push(a)}return r}function d(e,n,t){var r=[],o={fileType:i.a.MailItem,name:e,size:t||0,mimeContent:n};return r.push(o),r}function l(e){if(!e)return null;for(var n=[],t=0;t<e.length;t++){var r=e[t],o={fileType:i.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};n.push(o)}return n}function f(e){if(!e)return null;for(var n=[],t=0;t<e.length;t++){var r=e[t],o={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};n.push(o)}return n}function p(e){var n,t;return null===e?null:{fileType:i.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(n=e.Thumbnail)||void 0===n?void 0:n.Url)||"",previewUrl:(null===(t=e.Preview)||void 0===t?void 0:t.Url)||"",type:e.MimeType}}function m(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:i.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var b={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function v(e){switch(e?e.toLowerCase():null){case b.ONE_DRIVE_PRO.toLowerCase():return 0;case b.GDRIVE.toLowerCase():return 5;case b.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case b.DROPBOX.toLowerCase():return 2;case b.BOX.toLowerCase():return 3;case b.WOPI_BOX.toLowerCase():return 7;case b.WOPI_EGNYTE.toLowerCase():return 8;case b.MAILBOX.toLowerCase():return 4;case b.FACEBOOK.toLowerCase():return 6;default:return null}}t.d(n,"f",(function(){return o})),t.d(n,"j",(function(){return u})),t.d(n,"i",(function(){return s})),t.d(n,"h",(function(){return d})),t.d(n,"g",(function(){return l})),t.d(n,"d",(function(){return f})),t.d(n,"e",(function(){return p})),t.d(n,"c",(function(){return m})),t.d(n,"b",(function(){return v})),t.d(n,"a",(function(){return i.a}))},1733:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return i})),t.d(n,"e",(function(){return a})),t.d(n,"d",(function(){return u}));var r="FileAttachment:#Exchange",o="ItemAttachment:#Exchange",i="ItemIdAttachment:#Exchange",a="ReferenceAttachment:#Exchange",u="LinkAttachment:#Exchange"},1736:function(e,n,t){"use strict";t.d(n,"q",(function(){return i})),t.d(n,"z",(function(){return a})),t.d(n,"d",(function(){return u})),t.d(n,"u",(function(){return c})),t.d(n,"x",(function(){return s})),t.d(n,"y",(function(){return d})),t.d(n,"w",(function(){return l})),t.d(n,"v",(function(){return f})),t.d(n,"e",(function(){return p})),t.d(n,"f",(function(){return m})),t.d(n,"h",(function(){return b})),t.d(n,"m",(function(){return v})),t.d(n,"A",(function(){return g})),t.d(n,"r",(function(){return h})),t.d(n,"j",(function(){return w})),t.d(n,"s",(function(){return A})),t.d(n,"t",(function(){return C})),t.d(n,"a",(function(){return O})),t.d(n,"l",(function(){return y})),t.d(n,"p",(function(){return S})),t.d(n,"i",(function(){return I})),t.d(n,"b",(function(){return P})),t.d(n,"n",(function(){return x})),t.d(n,"c",(function(){return E})),t.d(n,"g",(function(){return j})),t.d(n,"o",(function(){return D})),t.d(n,"k",(function(){return T}));var r=t(37),o=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(5),t.e(6),t.e(20),t.e(21),t.e(28),t.e(26),t.e(44),t.e(55),t.e(87),t.e(121),t.e(154),t.e(153),t.e(211),t.e(210),t.e(489)]).then(t.bind(null,3197))})),i=new r.b(o,(function(e){return e.removeExtensibilityNotification})),a=new r.b(o,(function(e){return e.updatePersistentNotifications})),u=new r.b(o,(function(e){return e.closeTaskPaneAddinCommand})),c=new r.b(o,(function(e){return e.triggerAppointmentTimeChangedEvent})),s=new r.b(o,(function(e){return e.triggerRecipientsChangedEvent})),d=new r.b(o,(function(e){return e.triggerRecurrenceChangedEvent})),l=new r.b(o,(function(e){return e.triggerLocationsChangedEvent})),f=new r.b(o,(function(e){return e.triggerAttachmentsChangedEvent})),p=new r.b(o,(function(e){return e.deinitializeAddinsForItem})),m=new r.b(o,(function(e){return e.initializeAddinsForItem})),b=new r.a(o,(function(e){return e.initializeExtensibilityContext})),v=new r.b(o,(function(e){return e.onHostItemChanged})),g=new r.b(o,(function(e){return e.whenItemHasContextualAddinKeywords})),h=new r.b(o,(function(e){return e.runContextualEvaluationAndUpdate})),w=new r.b(o,(function(e){return e.launchTranslateCommand})),A=new r.b(o,(function(e){return e.setPersistedAddin})),C=new r.b(o,(function(e){return e.shouldForceOnSendCompliantBehavior})),O=(Object(r.d)(o,(function(e){return e.AddinBarView})),Object(r.d)(o,(function(e){return e.TaskPaneCollection}))),y=new r.b(o,(function(e){return e.onComposeClose})),S=new r.b(o,(function(e){return e.openContextualCallout})),I=new r.b(o,(function(e){return e.launchAddinCommand})),P=new r.b(o,(function(e){return e.observeAddinCommandSurfaceItems})),x=new r.b(o,(function(e){return e.onItemNavigation})),E=new r.b(o,(function(e){return e.allowItemSendEvent})),j=new r.a(o,(function(e){return e.ExecuteEntryPoint})),D=new r.a(o,(function(e){return e.onLaunchEventTriggered})),T=new r.a(o,(function(e){return e.logAppTeachingUICalloutTelemetry}))},1757:function(e,n,t){"use strict";t.d(n,"p",(function(){return u})),t.d(n,"h",(function(){return c})),t.d(n,"b",(function(){return s})),t.d(n,"f",(function(){return d})),t.d(n,"j",(function(){return l})),t.d(n,"m",(function(){return f})),t.d(n,"s",(function(){return p})),t.d(n,"k",(function(){return m})),t.d(n,"r",(function(){return b})),t.d(n,"o",(function(){return v})),t.d(n,"l",(function(){return g})),t.d(n,"d",(function(){return h})),t.d(n,"i",(function(){return w})),t.d(n,"q",(function(){return A})),t.d(n,"c",(function(){return C})),t.d(n,"n",(function(){return O})),t.d(n,"g",(function(){return y})),t.d(n,"e",(function(){return S})),t.d(n,"t",(function(){return I}));var r=t(37),o=t(1853);t.d(n,"a",(function(){return o.a}));var i=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(5),t.e(6),t.e(7),t.e(8),t.e(12),t.e(13),t.e(16),t.e(17),t.e(20),t.e(23),t.e(25),t.e(27),t.e(26),t.e(32),t.e(38),t.e(39),t.e(43),t.e(44),t.e(53),t.e(861)]).then(t.bind(null,2816))})),a={captureBundleTime:!0},u=new r.a(i,(function(e){return e.replyToMessage}),a),c=new r.a(i,(function(e){return e.forwardMessage}),a),s=new r.a(i,(function(e){return e.closeCompose})),d=new r.a(i,(function(e){return e.discardCompose})),l=new r.a(i,(function(e){return e.loadDraftToCompose})),f=new r.a(i,(function(e){return e.openCompose})),p=new r.a(i,(function(e){return e.trySaveAndCloseCompose})),m=new r.a(i,(function(e){return e.moveComposeToTab})),b=new r.a(i,(function(e){return e.tryCreateResendDraft})),v=new r.a(i,(function(e){return e.replyToApprovalMessage})),g=new r.a(i,(function(e){return e.onEditDraftButtonClicked})),h=new r.b(i,(function(e){return e.createReply})),w=new r.b(i,(function(e){return e.getToCcRecipientsForReply})),A=new r.b(i,(function(e){return e.replyToMessageAndCreateViewState})),C=new r.b(i,(function(e){return e.createAttachments})),O=new r.b(i,(function(e){return e.popoutCompose})),y=new r.b(i,(function(e){return e.extractComposePopoutData})),S=new r.b(i,(function(e){return e.didInsertLinksHaveIssuesOnBlockDialogDismiss})),I=new r.b(i,(function(e){return e.insertSignature}))},1801:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(1733);function o(e){return(e.__type||e.OwsTypeName)===r.e}},1838:function(e){e.exports=JSON.parse('{"b":"tba","d":"uba","c":"vba","a":"wba"}')},1853:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("conversationSendStateChanged",(function(e,n){return{viewState:e,isSendPending:n}}))},1922:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(1933);function o(){return r.a}},1933:function(e,n,t){"use strict";var r=t(2);var o=t(9),i=Object(r.createStore)("extensibility",{EnabledAddinCommands:null,HostItems:new o.ObservableMap,IsPreinstalledTeachingUIAvailable:!1,Context:null,frameworkComponentHostItemIndexMap:new o.ObservableMap,taskPanes:new o.ObservableMap,activeDialogs:new o.ObservableMap,ExtensibilityStateIsDirty:!1,contextualCalloutState:{activeContextualAddinCommands:[],contextualAnchor:null,hostItemIndex:null,selectedTerms:[]},runningContextualAddinCommand:null,runningUILessExtendedAddinCommands:new o.ObservableMap,autoRunAddinCommandWaitingQueue:new o.ObservableMap,compliance:{isMinor:!1},activeAutorunUilessFrames:new o.ObservableMap})();n.a=i},225:function(e,n,t){"use strict";var r,o,i,a=t(2),u=Object(a.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),c=Object(a.action)("assignOptionValue",(function(e,n){return{feature:e,value:n}})),s=Object(a.action)("verifyAndSetOptionValues",(function(e){return{potentialOptionValues:e}})),d=Object(a.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),l=t(0);!function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper",e[e.CalendarHelp=21]="CalendarHelp",e[e.LinkedInViewProfile=22]="LinkedInViewProfile",e[e.Bohemia=23]="Bohemia",e[e.GdprAdsV2=24]="GdprAdsV2",e[e.Proofing=25]="Proofing",e[e.ActiveProxyAddress=26]="ActiveProxyAddress",e[e.OutlookSpaces=27]="OutlookSpaces",e[e.GdprAdsV3=28]="GdprAdsV3",e[e.SxS=29]="SxS",e[e.ReadingPaneConversation=30]="ReadingPaneConversation"}(r||(r={})),function(e){e[e.EditInBrowser=0]="EditInBrowser",e[e.EditInDesktop=1]="EditInDesktop",e[e.EditAndReply=2]="EditAndReply"}(o||(o={}));var f=Object(a.createStore)("owsOptionsStore",{options:(i={},i[r.SmartSuggestions]={feature:r.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},i[r.DiverseEmojis]={feature:r.DiverseEmojis,diverseEmojisSelectedSkinTone:""},i[r.SurfaceActions]={feature:r.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},i[r.SkypeNotifications]={feature:r.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},i[r.WebPushNotifications]={feature:r.WebPushNotifications,enabled:!1,applicationServerKey:null},i[r.Confetti]={feature:r.Confetti,confettiEnabled:!1},i[r.GdprAdsPrefs]={feature:r.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},i[r.GdprAdsV2]={feature:r.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},i[r.GdprAdsV3]={feature:r.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},i[r.CalendarSurfaceAddins]={feature:r.CalendarSurfaceAddins,calendarSurfaceAddins:[]},i[r.ExternalImages]={feature:r.ExternalImages,externalImagesSelectedOption:null},i[r.EventCapture]={autoCollectionEnabled:!1},i[r.Translation]={feature:r.Translation,translationMode:0,targetLanguage:"",excludedLanguages:[]},i[r.CalendarSurfaceOptions]={feature:r.CalendarSurfaceOptions,agendaPaneIsClosed:!0,lastKnownRoamingTimeZone:void 0,roamingTimeZoneNotificationsIsDisabled:void 0,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},i[r.MentionEventNotifications]={feature:r.MentionEventNotifications,enabled:!1},i[r.TxpEventNotifications]={feature:r.TxpEventNotifications,enabled:!1},i[r.ComposeAssistance]={feature:r.ComposeAssistance,composeAssistanceEnabled:!1},i[r.AmpDeveloper]={feature:r.AmpDeveloper,enabled:!0,allowedSender:[]},i[r.ActivityFeed]={feature:r.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},i[r.LinkedInViewProfile]={dismissed:!1},i[r.CalendarHelp]={feature:r.CalendarHelp,calendarHelpEnabled:!1},i[r.Bohemia]={feature:r.Bohemia,bohemiaEnabled:!1,fluidEnabledForTenant:!1},i[r.Proofing]={feature:r.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!1,proofingLocale:void 0,overriddenOptions:void 0},i[r.ActiveProxyAddress]={feature:r.ActiveProxyAddress,activeProxyAddresses:[]},i[r.OutlookSpaces]={feature:r.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},i[r.SxS]={feature:r.SxS,hideReadingPane:!1,defaultEditCommand:o.EditInBrowser},i[r.ReadingPaneConversation]={feature:r.ReadingPaneConversation,conversationEnabled:!0,conversationEnabledNativeHost:!1},i)}),p=t(9);function m(e){return(null==e?void 0:e.feature)in r}var b,v=t(352);function g(e,n){f().options[e]=n}function h(e){return f().options[e]}Object(a.mutator)(c,(function(e){var n=e.feature,t=e.value;v(f().options[n],t)})),Object(a.mutator)(u,(function(e){g(e.feature,e.value)})),Object(a.mutator)(d,(function(e){var n=e.feature,t=e.value;Object(p.extendObservable)(f().options[n],t)})),Object(a.mutator)(s,(function(e){var n,t,r=e.potentialOptionValues;try{for(var o=Object(l.__values)(r),i=o.next();!i.done;i=o.next()){var a=i.value;a&&m(a)&&g(a.feature,a)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(n)throw n.error}}})),function(e){e[e.Work=1]="Work",e[e.Life=2]="Life"}(b||(b={})),t.d(n,"h",(function(){return u})),t.d(n,"d",(function(){return c})),t.d(n,"i",(function(){return s})),t.d(n,"g",(function(){return d})),t.d(n,"f",(function(){return f})),t.d(n,"e",(function(){return h})),t.d(n,"c",(function(){return b})),t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return o}))},2564:function(e,n,t){var r,o;
/*!
 * JavaScript Cookie v2.1.3
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(i){if(void 0===(o="function"==typeof(r=i)?r.call(n,t,n,e):r)||(e.exports=o),!0,e.exports=i(),!!0){var a=window.Cookies,u=window.Cookies=i();u.noConflict=function(){return window.Cookies=a,u}}}((function(){function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var r in t)n[r]=t[r]}return n}return function n(t){function r(n,o,i){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(i=e({path:"/"},r.defaults,i)).expires){var u=new Date;u.setMilliseconds(u.getMilliseconds()+864e5*i.expires),i.expires=u}try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(e){}return o=t.write?t.write(o,n):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=(n=(n=encodeURIComponent(String(n))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[n,"=",o,i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}n||(a={});for(var c=document.cookie?document.cookie.split("; "):[],s=/(%[0-9A-Z]{2})+/g,d=0;d<c.length;d++){var l=c[d].split("="),f=l.slice(1).join("=");'"'===f.charAt(0)&&(f=f.slice(1,-1));try{var p=l[0].replace(s,decodeURIComponent);if(f=t.read?t.read(f,p):t(f,p)||f.replace(s,decodeURIComponent),this.json)try{f=JSON.parse(f)}catch(e){}if(n===p){a=f;break}n||(a[p]=f)}catch(e){}}return a}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(n,t){r(n,"",e(t,{expires:-1}))},r.withConverter=n,r}((function(){}))}))},3301:function(e,n,t){"use strict";var r=t(1677),o=t(37),i=t(4683),a=t(6),u=t(4245);var c=t(2324);function s(e){if(!e)return!1;if(function(e){return null!=e.RightsManagementLicenseData}(e))return!1;if(e.IsDraft)return!1;if(Object(c.a)()&&e.MailboxInfo&&"GroupMailbox"===e.MailboxInfo.type)return!1;var n=e.ItemClass.toLowerCase();return!function(e){return 0==e.indexOf("ipm.note.smime")&&-1==e.indexOf("ipm.note.smime.multipartsigned")}(n)&&!function(e){return 0==e.indexOf("report")}(n)}var d=t(161),l=t(219),f=t(127),p=t(883),m="ows/api/beta/Addins/PinAddins";function b(){var e=Object(l.a)(),n=new f.b("ExtPinRequest");Object(d.d)(m,{correlationId:e,defaults:Object(p.d)()[p.b.SurfaceActions]},e,!0).then((function(t){n.addCustomData([e,t.status]),200==t.status&&t.text().then((function(e){p.f.importAndExecute(p.b.SurfaceActions,JSON.parse(e))})),n.end()})).catch((function(){n.end()}))}var v,g,h=t(0),w=t(1776),A=t(17);!function(e){e[e.None=0]="None",e[e.Compose=1]="Compose",e[e.Read=2]="Read"}(g||(g={}));var C=((v={})[g.None]="NoAddins",v[g.Compose]="ComposeAddinOnly",v[g.Read]="ReadAddinOnly",v[g.Compose|g.Read]="BothAddins",v);function O(e){var n=JSON.parse(e);return{addinId:n.id,commandId:n.controlId}}function y(){return Object(h.__awaiter)(this,void 0,void 0,(function(){var e,n,t,o,i,a,u;return Object(h.__generator)(this,(function(c){switch(c.label){case 0:return e=Object(A.a)().ViewStateConfiguration,[4,r.I.import()];case 1:return n=c.sent(),t=g.None,(o=e.PinnedComposeAddin)&&(i=O(o),n(w.a.MessageCompose,i),t|=g.Compose),(a=e.PinnedReadAddin)&&(u=O(a),n(w.a.MessageRead,u),t|=g.Read),Object(f.r)("ExtPersistedAddinMigration",[C[t]]),[2]}}))}))}var S=t(222);function I(e,n){return void 0===n&&(n=null),Object(h.__awaiter)(this,void 0,void 0,(function(){return Object(h.__generator)(this,(function(t){switch(t.label){case 0:return!Object(S.a)()?[4,r.D.import()]:[3,2];case 1:t.sent()(e,n),t.label=2;case 2:return[2]}}))}))}var P=t(1709);function x(){Object(P.f)()?I(r.h.NotSupported):I(r.h.Empty)}t.d(n,"b",(function(){return j})),t.d(n,"a",(function(){return D})),t.d(n,"e",(function(){return s})),t.d(n,"c",(function(){return b})),t.d(n,"d",(function(){return y})),t.d(n,"f",(function(){return I})),t.d(n,"g",(function(){return x}));var E=new o.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(5),t.e(6),t.e(20),t.e(21),t.e(28),t.e(26),t.e(44),t.e(55),t.e(87),t.e(121),t.e(154),t.e(153),t.e(211),t.e(210),t.e(489)]).then(t.bind(null,17311))})),j=new o.b(E,(function(e){return e.createMailReadAdapter})),D=new o.b(E,(function(e){return e.createMailComposeAdapter}));r.i.sendFeedback=function(){var e=[{Name:Object(a.b)(i.a),EmailAddress:"outlookinclientstorefeedback@service.microsoft.com"}];u.a(e,[],[],Object(a.b)(i.c),Object(a.b)(i.b),[])}},390:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(0);function o(e){return Object(r.__assign)({__type:"ItemId:#Exchange"},e)}},3928:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(0),o=t(1677),i=t(1724),a=t(1669);function u(e){var n,t,u=[];try{for(var c=Object(r.__values)(e),s=c.next();!s.done;s=c.next()){var d=s.value,l=null;d.attachmentType==o.a.Item?l={fileType:i.a.MailItem,name:d.name,size:d.size,itemId:d.id}:d.attachmentType==o.a.File&&(l={fileType:i.a.Uri,name:d.name,size:d.size,uri:d.id,type:Object(a.b)(d.id)}),l&&u.push({file:l,isInline:d.isInline})}}catch(e){n={error:e}}finally{try{s&&!s.done&&(t=c.return)&&t.call(c)}finally{if(n)throw n.error}}return u}},4245:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(3928),o=t(1757);function i(e,n,t,i,a,u){var c={operation:0,bodyType:"HTML",subject:i,newContent:a,to:e,cc:n,bcc:t,preferAsyncSend:!0,attachmentFilesToUpload:Object(r.a)(u)};o.m.importAndExecute(c,2)}},4336:function(e,n,t){"use strict";var r=t(30),o=t(0);function i(e,n){if(void 0!==e.datapoints)for(var t=0;t<e.datapoints.length;t++)void 0===e.datapoints[t]||e.datapoints[t].__type||(e.datapoints[t]=(i=e.datapoints[t],Object(o.__assign)({__type:"Datapoint:#Exchange"},i)));var i;return Object(r.a)("LogDatapoint",e,n)}t.d(n,"a",(function(){return i}))},4683:function(e){e.exports=JSON.parse('{"a":"Lyb","c":"Myb","b":"Nyb"}')},6996:function(e,n,t){"use strict";var r=t(127),o=t(30);var i=t(2564);function a(e){return i.get(e)}function u(e,n,t){n?i.set(e,n,t):i.remove(e)}var c="OptInPrg";function s(){return d(2)}function d(e){return a(c)==""+e}function l(e){null==e?u(c):u(c,""+e,{path:"/"})}var f=2,p=1e4,m=0;function b(e){s()&&(l(0),e.addEventListener("unload",(function(){d(1)||l(null)})),Object(r.r)("optInReactClient"),function e(n){(t={clientTypeOptInState:2},Object(o.a)("UpdateClientTypeOptInState",t,r)).then((function(e){l(null)})).catch((function(t){m++<f&&n.setTimeout((function(){e(n)}),p)}));var t,r}(e))}var v=t(7),g="appcacheuninstaller",h="owa/manifests/appCacheManifestHandler.ashx",w="?manifest=0&layout=mouse&UA=0",A="UnInstallAppcache",C="AppcacheObsolete",O=null;function y(e){var n,t;e.applicationCache&&(function(e){return Object(v.a)(e,C)}(e)||((O=e.document.createElement("iframe")).src=(n=e.location.href,(t=new URL(n)).pathname=h,t.search=w,t.href),O.setAttribute("id",g),O.style.display="none",O.onload=function(){O.onload=null;try{!function(e){var n=O.contentWindow.applicationCache;n.onobsolete=function(){I(e),S(n)},n.onerror=function(){I(e),S(n)}}(e)}catch(n){I(e)}},u(A,"true",{path:"/"}),e.document.body.appendChild(O)))}function S(e){e.onerror=null,e.onobsolete=null}function I(e){!function(e){Object(v.e)(e,C,"1")}(e),u(A),e.document.body.removeChild(O),O=null}var P=t(0);function x(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(P.__assign)({__type:"UpdateLightningRequest:#Exchange"},t)),Object(o.a)("UpdateLightning",e,n)}var E=t(4336),j=69,D=75,T=1,R="ReOptInClk",L="CalReOptInClk";function k(){if(s()){var e=0;M(j,R)&&(e=j),M(D,L)&&(e=D),Object(r.r)("cleanupOptInCallout",[e])}}function M(e,n){var t=!1;return a(n)&&(t=!0,Object(E.a)({datapoints:[{Id:"PerfTraceCTQ",Consumers:1,Time:new Date(Date.now()).toISOString(),Keys:["S","cd"],Values:["lightningPeekMore","id_"+e+"|category_4"]}]}),u(n)),x({Identities:[e],Command:T}),t}t.d(n,"a",(function(){return b})),t.d(n,"b",(function(){return y})),t.d(n,"c",(function(){return k})),t.d(n,"d",(function(){return s}))},796:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(18),o=t(222),i=t(225);function a(){var e;return(e={})[i.b.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[i.b.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[i.b.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(o.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddClassicAttachment","InsertLink","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[i.b.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[i.b.Confetti]={confettiEnabled:!0},e[i.b.ComposeAssistance]={composeAssistanceEnabled:!0},e[i.b.GdprAdsPrefs]={feature:i.b.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[i.b.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[i.b.ExternalImages]={externalImagesSelectedOption:0},e[i.b.EventCapture]={autoCollectionEnabled:!1},e[i.b.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[i.b.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[i.b.AmpDeveloper]={enabled:Object(r.i)("rp-ampDefault"),allowedSender:[]},e[i.b.CalendarHelp]={calendarHelpEnabled:!1},e[i.b.LinkedInViewProfile]={dismissed:!1},e[i.b.Bohemia]={bohemiaEnabled:Object(r.i)("cmp-prague")},e[i.b.GdprAdsV2]={feature:i.b.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},e[i.b.GdprAdsV3]={feature:i.b.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[i.b.Proofing]={feature:i.b.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[i.b.ActiveProxyAddress]={feature:i.b.ActiveProxyAddress,activeProxyAddresses:[]},e[i.b.OutlookSpaces]={feature:i.b.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[i.b.SxS]={feature:i.b.SxS,hideReadingPane:!1,defaultEditCommand:i.a.EditInBrowser},e[i.b.ReadingPaneConversation]={feature:i.b.ReadingPaneConversation,conversationEnabled:!0,conversationEnabledNativeHost:!1},e}},799:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(0);function o(e){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},e)}},883:function(e,n,t){"use strict";var r=t(37),o=t(993),i=t(225),a=t(2),u=[i.b.SurfaceActions];Object(a.orchestrator)(o.a,(function(e){var n=e.defaultOptions;u.forEach((function(e){n[e]&&Object(i.g)(Number(e),n[e])}))}));var c=t(796);t.d(n,"f",(function(){return d})),t.d(n,"i",(function(){return l})),t.d(n,"g",(function(){return f})),t.d(n,"h",(function(){return p})),t.d(n,"d",(function(){return c.a})),t.d(n,"e",(function(){return i.e})),t.d(n,"c",(function(){return i.c})),t.d(n,"b",(function(){return i.b})),t.d(n,"a",(function(){return i.a}));var s=new r.c((function(){return t.e(903).then(t.bind(null,17449))})),d=new r.a(s,(function(e){return e.createOrUpdateOptionsForFeature})),l=new r.a(s,(function(e){return e.updateAddinPinStatus})),f=(new r.a(s,(function(e){return e.updateAddInArray})),new r.b(s,(function(e){return e.getServerOptionsForFeature}))),p=new r.a(s,(function(e){return e.loadOptions}))},966:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(35);function o(e){if(!e)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(e)}},993:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2),o=t(796),i=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(o.a)()),{defaultOptions:e}}))}}]);
//# sourceMappingURL=owa.MailBoot~MailOptin.js.map
self.scriptsLoaded['owa.MailBoot~MailOptin.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailOptin.js'] = (new Date()).getTime();