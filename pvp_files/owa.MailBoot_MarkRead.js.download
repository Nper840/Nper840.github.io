self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MarkRead.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[673],{13107:function(e){e.exports=JSON.parse('{"a":"Lqb","b":"Mqb","c":"Nqb","d":"Oqb"}')},13108:function(e){e.exports=JSON.parse('{"a":"Hqb","b":"Iqb","c":"Jqb","d":"Kqb"}')},13109:function(e){e.exports=JSON.parse('{"a":"Dqb","b":"Eqb","c":"Fqb","d":"Gqb"}')},1793:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.action)("onOfficeAppClick",(function(e,n){return{app:e,currentlySelectedModule:n}}))},1844:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var a=t(1735),i=t(497),r=t(33),o=t(278);function c(e){var n=Object(r.a)().search;switch(e){case o.a.Mail:return Object(i.j)()+n;case o.a.Calendar:return Object(i.c)()+n;case o.a.People:return Object(i.o)()+n;case o.a.FilesHub:return Object(i.f)()+n;case o.a.Tasks:return Object(a.b)()?Object(i.t)():Object(i.n)({path:"/tasks"});case o.a.OutlookSpaces:return Object(i.m)()+n;case o.a.Eventify:return Object(i.d)();default:throw new Error("Cannot get module switcher item URL of a workload that doesn't exist")}}},1864:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.action)("onModuleClick",(function(e,n,t){return{module:e,currentlySelectedModule:n,activeModuleAction:t}}))},1935:function(e,n,t){"use strict";var a=t(37),i=t(1991),r=t(1641),o=t(1647),c=t(966),s=t(1644);function u(e,n){return e&&!Object(r.w)()&&n&&"UserMailbox"===n.type&&!Object(o.m)(e)&&e!=Object(c.a)("recoverableitemsdeletions")&&!Object(s.D)(e,"SharedMailbox")}t.d(n,"e",(function(){return l})),t.d(n,"a",(function(){return i.a})),t.d(n,"b",(function(){return i.b})),t.d(n,"d",(function(){return i.c})),t.d(n,"c",(function(){return u}));var d=new a.c((function(){return t.e(983).then(t.bind(null,17018))})),l=new a.a(d,(function(e){return e.undo}))},1974:function(e,n,t){"use strict";var a={};t.r(a),t.d(a,"add",(function(){return u})),t.d(a,"remove",(function(){return d})),t.d(a,"removeAll",(function(){return l})),t.d(a,"getCount",(function(){return b})),t.d(a,"getTombstonedReasons",(function(){return v})),t.d(a,"clearMapForFolder",(function(){return m})),t.d(a,"removeRowsFromTombstone",(function(){return f}));var i=t(0),r=t(2),o=Object(r.createStore)("tombstone",{folderTombstoneMap:{}}),c=(o(),t(127)),s=t(148),u=Object(s.action)("tombstoneOperations.add")((function(e,n,t){if(1!=n.tableQuery.type&&"spotlight"!==n.tableQuery.scenarioType){var a=n.serverFolderId,i=o().folderTombstoneMap;a in i||(i[a]={});var r=i[a];e.forEach((function(e){var n=r[e];n?3!=t?n.indexOf(3)>-1||-1==n.indexOf(t)&&n.push(t):r[e]=[3]:r[e]=[t]}))}})),d=Object(s.action)("tombstoneOperations.remove")((function(e,n,t){var a=o().folderTombstoneMap;if(n in a){var i=a[n],r=i[e],c=r?r.indexOf(t):-1;if(-1==c)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");r.splice(c,1),0==r.length&&delete i[e],0==Object.keys(i).length&&delete a[n]}})),l=Object(s.action)("tombstoneOperations.removeAll")((function(){o().folderTombstoneMap={},Object(c.s)("TnS_RemoveAllFromTombstone")})),b=function(e,n){var t=o().folderTombstoneMap;if(!(e in t))return 0;var a=0,i=t[e];return Object.values(i).forEach((function(e){e==n&&a++})),a},v=function(e,n){var t=o().folderTombstoneMap;if(n in t){var a=t[n][e];if(a)return a}return[]},m=Object(s.action)("tombstoneOperations.clearMapForFolder")((function(e){var n=o().folderTombstoneMap;n[e]&&(Object(c.s)("TnS_ClearFolderMapInTombstone",[Object.keys(n[e]).length]),delete n[e])})),f=Object(s.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,n){var t,a,r=o().folderTombstoneMap;if(n in r){var c=r[n];try{for(var s=Object(i.__values)(e),u=s.next();!u.done;u=s.next()){var d=u.value;d in c&&delete c[d]}}catch(e){t={error:e}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(t)throw t.error}}0==Object.keys(c).length&&delete r[n]}}));n.a=a},1991:function(e,n,t){"use strict";var a,i,r=t(0),o=t(2),c=Object(o.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null})(),s=t(1974),u=t(148),d=t(48),l=t(713),b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DismissUndo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dismissUndo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]};t.d(n,"a",(function(){return v})),t.d(n,"b",(function(){return m})),t.d(n,"c",(function(){return O})),t.d(n,"d",(function(){return j}));var v=Object(u.action)("addActionToUndoStack")(Object(u.select)({store:function(){return c}})((function(e,n,t,r){null!==e&&(a=e,r.store.hasUndoableAction=!0,r.store.undoableActionFolderId=n,i=t)}))),m=Object(u.action)("clearLastUndoableAction")(Object(u.select)({store:function(){return c}})((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!i)return[3,7];r.label=1;case 1:return r.trys.push([1,5,,6]),[4,i];case 2:return(n=r.sent()).success&&(t=n.undoRequestId)?(o={undoRequestId:t},[4,f.invokeDismissUndoMutation(o)]):[3,4];case 3:r.sent(),r.label=4;case 4:return[3,6];case 5:return r.sent(),[3,6];case 6:i=null,r.label=7;case 7:return a=null,e.store.hasUndoableAction=!1,e.store.undoableActionFolderId=null,[2]}}))}))}))),f={invokeDismissUndoMutation:function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(l.a)()];case 1:return[4,n.sent().mutate({variables:e,mutation:b})];case 2:return n.sent(),[2]}}))}))}},O=Object(u.select)({store:function(){return c}})((function(e){return e.store.hasUndoableAction})),j=Object(d.d)("undo",{name:"TnS_Undo",customData:function(e){return[e]}})((function(e){c.undoableActionFolderId?s.a.clearMapForFolder(c.undoableActionFolderId):s.a.removeAll();null!==a&&(a(),m())}))},2025:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(18);function i(e){return Object(a.i)("tri-officeRailHost")&&"Yammer"===e}},2063:function(e,n,t){"use strict";var a=t(71),i=t(719),r=t(18);function o(){var e=Object(r.i)("outlookSpaces-enabled"),n=Object(a.h)(),t=n.SessionSettings,o=void 0===t?{}:t,c=n.PolicySettings;switch(o.WebSessionType){case 0:var s=Object(r.i)("outlookSpaces-canEnableByPolicy")||Object(i.d)(),u=!!(c||{}).ProjectMocaEnabled;return e||s&&u;case 1:var d=Object(a.u)(),l=Object(r.i)("outlookSpaces-free-consumer-enabled");return e&&(d||l);case 2:return e&&Object(r.i)("outlookSpaces-gmail-enabled");default:return!1}}t.d(n,"a",(function(){return o}))},2090:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return i}));var a=20,i=10},2098:function(e,n,t){"use strict";var a=t(37),i=t(2179),r=t(1647),o=t(148),c=Object(o.action)("setIsPendingDeleteConversationItemParts")(Object(o.select)({conversationItemParts:function(e){return r.u.conversations.get(e)}})((function(e,n,t){var a=t.conversationItemParts;a&&(a.isPendingDelete=n)}))),s=t(2090);t.d(n,"c",(function(){return d})),t.d(n,"e",(function(){return l})),t.d(n,"d",(function(){return b})),t.d(n,"b",(function(){return i.a})),t.d(n,"f",(function(){return c})),t.d(n,"a",(function(){return s.b}));var u=new a.c((function(){return Promise.all([t.e(260),t.e(671)]).then(t.bind(null,17582))})),d=new a.a(u,(function(e){return e.loadAllRecipientsForItem})),l=new a.a(u,(function(e){return e.loadItem})),b=new a.a(u,(function(e){return e.loadConversation}))},2158:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2),i=Object(a.action)("setShowFolderPane",(function(e){return{showFolderPane:e}}))},2179:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var a=t(0),i=t(1647),r=t(2229),o=t(2659),c=t(2);function s(e){var n,t,c,s;if(i.u.conversations.has(e)){var l=i.u.conversations.get(e);try{for(var b=Object(a.__values)(l.conversationNodeIds),v=b.next();!v.done;v=b.next()){var m=v.value,f=i.u.conversationNodes.get(m);if(f)try{for(var O=(c=void 0,Object(a.__values)(f.itemIds)),j=O.next();!j.done;j=O.next()){var k=j.value;Object(r.a)(k,1)}}catch(e){c={error:e}}finally{try{j&&!j.done&&(s=O.return)&&s.call(O)}finally{if(c)throw c.error}}u(m)}}catch(e){n={error:e}}finally{try{v&&!v.done&&(t=b.return)&&t.call(b)}finally{if(n)throw n.error}}d(e)}Object(o.a)()}var u=Object(c.mutatorAction)("deleteConversationNode",(function(e){i.u.conversationNodes.delete(e)})),d=Object(c.mutatorAction)("deleteConversation",(function(e){i.u.conversations.delete(e)}))},2210:function(e){e.exports=JSON.parse('{"a":"qOa"}')},2227:function(e){e.exports=JSON.parse('{"a":"zNb"}')},2246:function(e){e.exports=JSON.parse('{"a":"_qb"}')},2247:function(e){e.exports=JSON.parse('{"a":"$qb"}')},2248:function(e){e.exports=JSON.parse('{"a":"Zqb"}')},2249:function(e){e.exports=JSON.parse('{"b":"TIb","a":"UIb"}')},2268:function(e){e.exports=JSON.parse('{"b":"VIb","a":"WIb","c":"XIb"}')},2299:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return i})),t.d(n,"c",(function(){return r}));var a=350,i=270,r=418},2300:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2),i=Object(a.action)("setShowListPane",(function(e){return{showListPane:e}}))},2301:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2),i=Object(a.action)("setShowReadingPane",(function(e){return{showReadingPane:e}}))},2320:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(1710),i=t(1696);function r(){var e=Object(a.c)();return Object(i.a)()?e<=541:e<=918}},2346:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(1732);function i(){return Object(a.a)().showFolderPane}},2375:function(e){e.exports=JSON.parse('{"a":"Lxc"}')},2376:function(e,n){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHRpdGxlPkV4Y2VsXzE2eDwvdGl0bGU+PHBhdGggZD0iTTEwLDBINEExLDEsMCwwLDAsMywxVjRsNyw0LDMsMS45NjhMMTYsOFY0WiIgZmlsbD0iIzIxYTM2NiIvPjxwb2x5Z29uIHBvaW50cz0iMTYgOCAzIDggMyAxMiAxMCAxMy40IDE2IDEyIDE2IDgiIGZpbGw9IiMxMDdjNDEiLz48cGF0aCBkPSJNMywxMnYzYTEsMSwwLDAsMCwxLDFIMTVhMSwxLDAsMCwwLDEtMVYxMloiIGZpbGw9IiMxODVjMzciLz48cGF0aCBkPSJNMTAsNEgzVjE0SDlhMiwyLDAsMCwwLDItMlY1QTEsMSwwLDAsMCwxMCw0WiIgb3BhY2l0eT0iMC41Ii8+PHJlY3QgeT0iMyIgd2lkdGg9IjEwIiBoZWlnaHQ9IjEwIiByeD0iMSIgZmlsbD0iIzEwN2M0MSIvPjxwYXRoIGQ9Ik0yLjI5MiwxMSw0LjIzNCw3Ljk5MiwyLjQ1NSw1SDMuODg2bC45NzEsMS45MTJjLjA4OS4xODIuMTUxLjMxNy4xODQuNDA2aC4wMTNxLjEtLjIxNy4yLS40MjNMNi4yOTIsNUg3LjYwNkw1Ljc4Miw3Ljk3NSw3LjY1MiwxMWgtMS40TDUuMTMzLDguOUExLjgwNiwxLjgwNiwwLDAsMSw1LDguNjE5SDQuOTgzYTEuMzQsMS4zNCwwLDAsMS0uMTMuMjcyTDMuNywxMVoiIGZpbGw9IiNmZmYiLz48cGF0aCBkPSJNMTYsMVY0SDEwVjBoNUExLDEsMCwwLDEsMTYsMVoiIGZpbGw9IiMzM2M0ODEiLz48L3N2Zz4="},2377:function(e,n){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHRpdGxlPk9uZURyaXZlXzE2eDwvdGl0bGU+PHBhdGggZD0iTTkuNDYsOC40M2wzLjUwOS0xLjkyMkE1LDUsMCwwLDAsMy45NDksNVoiIGZpbGw9IiMwMzY0YjgiLz48cGF0aCBkPSJNNi4xLDUuNmgwYTQsNCwwLDAsMC01LjM4Miw1LjY5bDUuNjk0LjE1Mkw5LjQ2LDcuNjA4WiIgZmlsbD0iIzAwNzhkNCIvPjxwYXRoIGQ9Ik0xMi45NjksNi41MDhhMy4yMjQsMy4yMjQsMCwwLDAtMS41MDcuMjU4aDBsLTIsLjg0MiwxLjc0OSwyLjk0Miw0LjQuNzQyYTMuMjUsMy4yNSwwLDAsMC0yLjY0Mi00Ljc4NFoiIGZpbGw9IiMxNDkwZGYiLz48cGF0aCBkPSJNOS40Niw3LjYwOC43MTksMTEuMjg2QTMuOTkzLDMuOTkzLDAsMCwwLDQsMTNoOC43NWEzLjI0OCwzLjI0OCwwLDAsMCwyLjg2MS0xLjcwOFoiIGZpbGw9IiMyOGE4ZWEiLz48L3N2Zz4="},2378:function(e,n){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHRpdGxlPlBvd2VyUG9pbnRfMTZ4PC90aXRsZT48cGF0aCBkPSJNOCwwQTguMDI0LDguMDI0LDAsMCwwLDAsOGwxMCwyLjM2M1oiIGZpbGw9IiNlZDZjNDciLz48cGF0aCBkPSJNOCwwVjhsNCwyLjU5TDE2LDhBOC4wMjQsOC4wMjQsMCwwLDAsOCwwWiIgZmlsbD0iI2ZmOGY2YiIvPjxwYXRoIGQ9Ik0xNiw4QTgsOCwwLDAsMSwwLDhaIiBmaWxsPSIjZDM1MjMwIi8+PHBhdGggZD0iTTEwLDRIMS4wODZBNy45Myw3LjkzLDAsMCwwLDIuNzM1LDE0SDlhMiwyLDAsMCwwLDItMlY1QTEsMSwwLDAsMCwxMCw0WiIgb3BhY2l0eT0iMC41Ii8+PHBhdGggZD0iTTEwLDRIMS4wODZBNy45Myw3LjkzLDAsMCwwLDIuNzM1LDE0SDlhMiwyLDAsMCwwLDItMlY1QTEsMSwwLDAsMCwxMCw0WiIgb3BhY2l0eT0iMC4xIi8+PHJlY3QgeT0iMyIgd2lkdGg9IjEwIiBoZWlnaHQ9IjEwIiByeD0iMSIgZmlsbD0iI2M0M2UxYyIvPjxwYXRoIGQ9Ik01LjMzNiw1QTIuMjc1LDIuMjc1LDAsMCwxLDYuOSw1LjQ4MWExLjc2NiwxLjc2NiwwLDAsMSwuNTQxLDEuMzkzLDIuMDIzLDIuMDIzLDAsMCwxLS4yNjcsMS4wNDIsMS44MzYsMS44MzYsMCwwLDEtLjc2Mi43MSwyLjQ4NCwyLjQ4NCwwLDAsMS0xLjE0NC4yNTNINC4xODJWMTFIMy4wNzJWNVpNNC4xODIsNy45NjJoLjk1NkExLjIsMS4yLDAsMCwwLDUuOTgzLDcuN2ExLjAxMiwxLjAxMiwwLDAsMCwuMjg1LS43NzdxMC0uOTkxLTEuMDk0LS45OTFINC4xODJaIiBmaWxsPSIjZmZmIi8+PC9zdmc+"},2379:function(e,n){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHRpdGxlPldvcmRfMTZ4PC90aXRsZT48cGF0aCBkPSJNMTYsNFYxYTEsMSwwLDAsMC0xLTFINEExLDEsMCwwLDAsMywxVjRMOS41LDUuMzc5WiIgZmlsbD0iIzQxYTVlZSIvPjxwb2x5Z29uIHBvaW50cz0iMTUuOTk5IDQgMi45OTkgNCAyLjk5OSA4IDkuNSA5LjE2OCAxNS45OTkgOCAxNS45OTkgNCIgZmlsbD0iIzJiN2NkMyIvPjxwb2x5Z29uIHBvaW50cz0iMTYgOCAzIDggMyAxMiA5LjQ5OSAxMyAxNiAxMiAxNiA4IiBmaWxsPSIjMTg1YWJkIi8+PHBhdGggZD0iTTMsMTJ2M2ExLDEsMCwwLDAsMSwxSDE1YTEsMSwwLDAsMCwxLTFWMTJaIiBmaWxsPSIjMTAzZjkxIi8+PHBhdGggZD0iTTEwLDQsMyw0LDMsMTRIOWEyLDIsMCwwLDAsMi0yVjVBMSwxLDAsMCwwLDEwLDRaIiBvcGFjaXR5PSIwLjUiLz48cmVjdCB5PSIzIiB3aWR0aD0iMTAiIGhlaWdodD0iMTAiIHJ4PSIxIiBmaWxsPSIjMTg1YWJkIi8+PHBhdGggZD0iTTMuMzUyLDkuNTRjLjAxNy4xNDIuMDI5LjI2Ni4wMzQuMzcyaC4wMTljLjAwOC0uMS4wMjMtLjIyMi4wNDYtLjM2NHMuMDQ0LS4yNjIuMDY1LS4zNkw0LjQyOSw1SDUuNjFsLjk0NSw0LjEyNmE2LjI2Nyw2LjI2NywwLDAsMSwuMTE4Ljc3OGguMDE2YTYuMzQ4LDYuMzQ4LDAsMCwxLC4xLS43NTNMNy41NDMsNUg4LjYxOEw3LjMsMTFINi4wMzlsLS45LTMuOTc1Yy0uMDI2LS4xMTQtLjA1Ni0uMjY0LS4wODktLjQ0OHMtLjA1My0uMzE4LS4wNjEtLjRINC45NzJjLS4wMS4xLS4wMy4yNDItLjA2MS40MzVzLS4wNTQuMzM1LS4wNzIuNDI3TDMuOTkyLDExSDIuNzE2TDEuMzgyLDVIMi40NzZMMy4zLDkuMkMzLjMxOCw5LjI4MywzLjMzNSw5LjQsMy4zNTIsOS41NFoiIGZpbGw9IiNmZmYiLz48L3N2Zz4="},2380:function(e){e.exports=JSON.parse('{"a":"Mxc"}')},2381:function(e){e.exports=JSON.parse('{"a":"Qxc"}')},2382:function(e){e.exports=JSON.parse('{"a":"Pxc"}')},2383:function(e){e.exports=JSON.parse('{"a":"Oxc"}')},2384:function(e){e.exports=JSON.parse('{"a":"Nxc"}')},2423:function(e,n,t){"use strict";var a=t(37),i=t(1864),r=t(1793),o=t(1844),c=t(6),s=t(0),u=t(159),d=t(2375),l=t(2246),b=t(2247),v=t(2248),m=t(2210),f=t(71),O="https://www.office.com/launch/word?auth=1&from=OWAPromo&WT.mc_id=PROD_OL-Web_InApp_LeftNav_FreeOfficeBarWord",j="https://www.office.com/launch/excel?auth=1&from=OWAPromo&WT.mc_id=PROD_OL-Web_InApp_LeftNav_FreeOfficeBarExcel",k="https://www.office.com/launch/powerpoint?auth=1&from=OWAPromo&WT.mc_id=PROD_OL-Web_InApp_LeftNav_FreeOfficeBarPPT",M="https://onedrive.live.com?WT.mc_id=PROD_OL-Web_InApp_LeftNav_FreeOfficeBarOD",w="https://www.office.com/launch/onenote?auth=1",I="ShellWordOnline",p="ShellExcelOnline",N="ShellPowerPointOnline",y="ShellDocuments",T="ShellYammer",h="ShellOneNoteOnline";function D(e){if(Object(f.s)())return function(e){var n,t;switch(e){case"Word":n=O,t=l.a;break;case"Excel":n=j,t=b.a;break;case"Powerpoint":n=k,t=v.a;break;case"OneDrive":n=M,t=m.a;break;case"OneNote":n=w,t=d.a;break;default:return null}return{Url:n,Text:Object(c.b)(t),Title:Object(c.b)(t)}}(e);var n=Object(u.a)();if(!(null==n?void 0:n.WorkloadLinks))return null;var t=null;switch(e){case"Word":t=I;break;case"Excel":t=p;break;case"Powerpoint":t=N;break;case"OneDrive":t=y;break;case"OneNote":t=h;break;case"Yammer":t=T;break;default:throw new Error("No url for office app "+e)}return Object(s.__read)(n.WorkloadLinks.filter((function(e){return e.Id===t})),1)[0]}var g=t(20),L=t(2376),S=t(2377),x=t(2378),A=t(2379);function R(e,n){var t,a=D(e);if(!a)return null;switch(e){case"Word":t=A;break;case"Excel":t=L;break;case"Powerpoint":t=x;break;case"OneDrive":t=S;break;default:g.d("Svg does not exist for app "+e),t=""}return{key:a.Text,text:a.Text,ariaLabel:a.Title,app:e,href:a.Url,iconProps:{imageProps:{src:t,width:16,height:16,shouldFadeIn:!1}},onClick:function(){Object(r.a)(e,n)},isSelected:!1,openInNewTab:!0}}var C=t(18),_=t(2249);function E(e){var n=[R("Word",e),R("Excel",e),R("Powerpoint",e),R("OneDrive",e)].filter((function(e){return!!e}));return Object(C.i)("tri-officeRail")&&n.push({key:"appDrawer",text:Object(c.b)(_.b),ariaLabel:Object(c.b)(_.b),name:Object(c.b)(_.b),isAppDrawerItem:!0}),0===n.length?[]:n}var P=t(1789),V=t(321),F={Mail:!0,Calendar:!0,People:!0,FilesHub:!0,OutlookSpaces:!1,MailDeepLink:!1,OrgExplorer:!1};function z(e,n){return(Object(V.a)("moduleSwitch")||Object(C.i)("fwk-module-switch"))&&F[e]&&F[n]}function U(e,n,t,a,r){var c=e===n,s="";return z(n,e)||n==e||(s=Object(o.a)(e)),{key:t,iconProps:a,text:t,title:t,ariaLabel:t,name:t,workload:e,isSelected:c,href:s,onClick:function(){Object(i.a)(e,n,r)}}}var B=t(2380),Y=t(2381),Q=t(2382),Z=t(2383),G=t(2227),W=t(2384),J=t(2268),H=t(278),q=t(2063),X=t(1735),K=t(3);function $(e,n){var t=[U(H.a.Mail,e,Object(c.b)(J.b),{iconName:"Mail"},n),U(H.a.Calendar,e,Object(c.b)(Z.a),{iconName:"Calendar"},n),U(H.a.People,e,Object(c.b)(Q.a),{iconName:"People"},n)];Object(C.i)("doc-fileshub")&&t.push(U(H.a.FilesHub,e,Object(c.b)(J.a),{iconName:"Attach"},n));var a=Object(X.d)();return a===X.a.ToDo?t.push(U(H.a.Tasks,e,Object(c.b)(Y.a),{iconName:"ToDoLogoOutline"},n)):a===X.a.LegacyTasks&&t.push(U(H.a.Tasks,e,Object(c.b)(B.a),{iconName:"CheckboxComposite"},n)),Object(q.a)()&&t.push(U(H.a.OutlookSpaces,e,Object(c.b)(G.a),{iconName:"NotePinned"},n)),Object(C.i)("eventify-includeInModuleSwitcher")&&t.push(U(H.a.Eventify,e,Object(c.b)(W.a),{imageProps:{src:Object(K.n)()+"assets/eventify/logo/24.svg",width:16,height:16,shouldFadeIn:!1}},n)),t}var ee=t(1771),ne=t(2025);t.d(n,"h",(function(){return ae})),t.d(n,"i",(function(){return i.a})),t.d(n,"j",(function(){return r.a})),t.d(n,"b",(function(){return E})),t.d(n,"e",(function(){return P.a})),t.d(n,"a",(function(){return $})),t.d(n,"c",(function(){return D})),t.d(n,"f",(function(){return ee.a})),t.d(n,"g",(function(){return ne.a})),t.d(n,"d",(function(){return z}));var te=new a.c((function(){return t.e(646).then(t.bind(null,17479))})),ae=new a.b(te,(function(e){return e.getSelectedOfficeRailApp}));Object(a.f)(i.a,te,(function(e){return e.onModuleClickOrchestrator})),Object(a.f)(r.a,te,(function(e){return e.onOfficeAppClickOrchestrator}))},2656:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2),i=Object(a.action)("onClientReadingPanePositionChange")},2659:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return r}));var a=t(2),i=Object(a.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),r=Object(a.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},2759:function(e){e.exports=JSON.parse('{"a":"lFa","c":"mFa","e":"nFa","b":"oFa","d":"pFa"}')},2854:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(1644);function i(e){return Object(a.D)(e,"SharedMailbox")}},3056:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(1656),i=t(3331);function r(e,n){return n?a.a.items.get(e):Object(i.b)(e)}},3148:function(e){e.exports=JSON.parse('{"a":"Pqb"}')},3338:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.action)("RELOAD_TABLE_ON_TRIAGE_ACTION_FAIL",(function(e){return{tableView:e}}))},3714:function(e){e.exports=JSON.parse('{"a":"yqb","c":"zqb","e":"Aqb","b":"Bqb","d":"Cqb"}')},4301:function(e,n,t){"use strict";t.r(n);var a=t(0),i=t(1641),r={markConversationAsRead:{name:function(e,n,t,a,i,r,o){var c="TnS_MarkConversation";return c+=t?"Read":"Unread",a||(c+="Background"),c},options:function(e,n,t,a,i,r,o){return a?{isCore:!0}:{sessionSampleRate:10}},customData:function(e,n,t,a,r,o,c){return[r,e.length,Object(i.l)(n),Object(i.P)(n)]},cosmosOnlyData:function(e,n,t,r,o,c,s){var u,d,l=[],b=Object(i.E)(e,n);try{for(var v=Object(a.__values)(b),m=v.next();!m.done;m=v.next()){var f=m.value;l.push(i.b.getItemIds(f,n))}}catch(e){u={error:e}}finally{try{m&&!m.done&&(d=v.return)&&d.call(v)}finally{if(u)throw u.error}}return JSON.stringify({itemIds:l,conversationIds:e})}},markItemReadUnread:{name:function(e,n,t,a,i,r){var o="TnS_MarkItem";return o+=t?"Read":"Unread",a||(o+="Background"),o},options:function(e,n,t,a,i,r){return a?{isCore:!0}:{}},customData:function(e,n,t,a,r,o){var c=e?e.tableQuery.type:null,s=e?Object(i.l)(e):null,u=e?Object(i.P)(e):null;return[c,n.length,s,u]},cosmosOnlyData:function(e,n,t,a,i,r){return JSON.stringify({itemIds:n})},actionSource:function(e,n,t,a,i){return i}}},o=t(148),c=t(2),s=Object(c.createStore)("markread",{markAsReadTimerTask:null,suppressedItemIdsMap:{}})(),u=Object(o.action)("AddMarkReadSuppressedItemIds")(Object(o.select)({store:function(){return s}})((function(e,n){e.forEach((function(e){return n.store.suppressedItemIdsMap[e]=!0}))}))),d=Object(o.action)("RemoveMarkReadSuppressedItemIds")(Object(o.select)({store:function(){return s}})((function(e,n){e.forEach((function(e){return delete n.store.suppressedItemIdsMap[e]}))}))),l=Object(o.action)("ClearMarkReadSuppressedMap")(Object(o.select)({store:function(){return s}})((function(e){e.store.suppressedItemIdsMap={}})));function b(e){for(var n=0;n<e.length;n++)if(!s.suppressedItemIdsMap[e[n]])return!1;return!0}var v=t(6774),m=t(2287),f=t(2230),O=t(5875),j=t(1730),k=t(20),M=t(48),w=t(3304);var I=t(1656);var p=t(2231),N=t(713),y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkItemAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipts"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markItemAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipts"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipts"}}},{kind:"ObjectField",name:{kind:"Name",value:"isUserInitiated"},value:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},T=t(17),h=Object(M.d)("markItemsAsReadBasedOnItemIds",r.markItemReadUnread)((function(e,n,t,r,o,c){return Object(a.__awaiter)(this,void 0,void 0,(function(){var s,l,b,f,O;return Object(a.__generator)(this,(function(a){return 0==(s=function(e,n){var t=[];return e.forEach((function(e){var a=I.a.items.get(e);Object(i.W)(a)&&a&&a.IsRead!=n&&t.push(e)})),t}(n,t)).length?[2,Promise.resolve()]:(t?d(s):r?u(s):k.g.warn("Invalid scenario to implicitly mark item as unread."),l=e?e.id:null,Object(p.a)(s,t,r,l),v.a.import().then((function(n){n(e?e.tableQuery:null,!1,t,o,s)})),b={itemIds:s},t?r?Object(m.d)("MarkAsRead",c,b):Object(m.d)("MarkAsReadImplicit",c,b):Object(m.d)("MarkAsUnread",c,b),f=Object(j.e)(e.tableQuery).mailboxInfo,O=e?Object(i.E)(s,e):[],[2,D(e,O,s,t,r,f)])}))}))}));function D(e,n,t,i,r,o){return Object(a.__awaiter)(this,void 0,void 0,(function(){var c,s,u,d;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:c=Object(T.a)(),s="AlwaysSend"!=c.UserOptions.ReadReceipt,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,g.invokeMarkItemAsReadMutation(t,i,s,r,o)];case 2:return a.sent(),[2];case 3:return u=a.sent(),d=e?e.serverFolderId:null,Object(w.a)(n,d,!0),[2,Promise.reject(u)];case 4:return[2]}}))}))}var g={invokeMarkItemAsReadMutation:function(e,n,t,i,r){var o;return Object(a.__awaiter)(this,void 0,void 0,(function(){var c;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(N.a)()];case 1:return[4,a.sent().mutate({variables:{ids:e,isRead:n,suppressReadReceipts:t,isUserInitiated:i,mailboxInfo:r},mutation:y})];case 2:return c=a.sent(),[2,null===(o=null==c?void 0:c.data)||void 0===o?void 0:o.markItemAsRead]}}))}))}},L={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkConversationAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markConversationAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"isUserInitiated"},value:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},S=t(5057),x=Object(M.d)("markConversationsAsReadBasedOnConversationIds",r.markConversationAsRead)((function(e,n,t,r,o,c,s){var d=function(e,n,t){var a=[];return e.forEach((function(e){var r=Object(i.L)(e,n);if(r){var o=0==r.unreadCount,c=r.itemIds.length,s=r.unreadCount==c;o&&t||s&&!t||a.push(e)}})),a}(s,n.id,t);if(0==d.length)return Promise.resolve();if(1==e.length&&1==n.selectedRowKeys.size){var b=i.b.getRowIdString(d[0],n),M=Object(i.L)(Object(a.__spread)(n.selectedRowKeys.keys())[0],n.id);if(b==M.id){var I=M.itemIds;t?l():r?u(I):k.g.warn("Invalid scenario to implicitly mark conversation as unread.")}}Object(f.a)(e,n.id,t,r),v.a.import().then((function(a){a(n.tableQuery,!1,t,o,e)}));var p={conversationIds:e};t?r?Object(m.d)("MarkAsRead",c,p):Object(m.d)("MarkAsReadImplicit",c,p):Object(m.d)("MarkAsUnread",c,p);var N=Object(j.e)(n.tableQuery).mailboxInfo;return Object(i.e)(n)?function(e,n,t,r,o){var c=[];return n.forEach((function(n){c.push.apply(c,Object(a.__spread)(i.b.getItemIds(n,e)))})),D(e,n,c,t,r,o)}(n,d,t,r,N):function(e,n,t,a,r){var o=Object(O.a)(e),c=n.map((function(n){return Object(i.h)(n,e.id)})),s=A.invokeMarkConversationAsReadMutation(c,t,a,o,r),u=Object(i.bb)(e,t,a);return Object(w.c)(s,n,o,e,u,!0)}(n,d,t,r,N)}));var A={invokeMarkConversationAsReadMutation:function(e,n,t,i,r){var o;return Object(a.__awaiter)(this,void 0,void 0,(function(){var c,s;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return c=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(S.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(N.a)()];case 1:return[4,a.sent().mutate({variables:{conversations:c,isRead:n,isUserInitiated:t,folderId:i,mailboxInfo:r},mutation:L})];case 2:return s=a.sent(),[2,null===(o=null==s?void 0:s.data)||void 0===o?void 0:o.markConversationAsRead]}}))}))}},R=t(2610),C=Object(o.action)("autoMarkConversationAsRead")(Object(o.select)({items:function(){return I.a.items}})((function(e,n,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var r,o,c,u,d,v,m,f,O;return Object(a.__generator)(this,(function(j){switch(j.label){case 0:return r=Object(i.E)([e],n),(o=Object(R.a)(r[0],n.id))?Object(i.f)(n)?b(c=o.itemIds)?[2]:0!=Object.keys(s.suppressedItemIdsMap).length?[3,2]:[4,x([e],n,!0,!1,null,[],r)]:[2]:[2];case 1:return j.sent(),[3,9];case 2:j.trys.push([2,7,8,9]),u=Object(a.__values)(c),d=u.next(),j.label=3;case 3:return d.done?[3,6]:b([v=d.value])||!t.items.get(v)?[3,5]:[4,h(n,[v],!0,!1,null,[])];case 4:j.sent(),j.label=5;case 5:return d=u.next(),[3,3];case 6:return[3,9];case 7:return m=j.sent(),f={error:m},[3,9];case 8:try{d&&!d.done&&(O=u.return)&&O.call(u)}finally{if(f)throw f.error}return[7];case 9:return l(),[2]}}))}))}))),_=t(9524);var E=t(1979),P=Object(o.action)("autoMarkItemAsRead")((function(e,n,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return Object(i.f)(n)?b([e])?[2]:Object(E.a)()?(function(e,n,t){Object(a.__awaiter)(this,void 0,void 0,(function(){var r,o,c;return Object(a.__generator)(this,(function(s){return n?(r=t||Object(a.__spread)(e.selectedRowKeys.keys())[0],o=i.b.getRowClientItemId(r,e),(c=null==o?void 0:o.Id)?(Object(_.a)(e.tableQuery.folderId,c,n).then((function(n){h(e,n,!0,!1,null,[])})),[2]):[2]):[2]}))}))}(n,e,t),[3,3]):[3,1]:[2];case 1:return[4,h(n,[e],!0,!1,null,[])];case 2:r.sent(),r.label=3;case 3:return l(),[2]}}))}))}));function V(e,n){var t;return Object(a.__awaiter)(this,void 0,void 0,(function(){var r,o;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:if("OnSelectionChange"!==Object(T.a)().UserOptions.PreviewMarkAsRead)return[2];switch(r=i.b.getRowIdString(e,n),n.tableQuery.listViewType){case 0:return[3,1];case 1:return[3,6]}return[3,8];case 1:return Object(E.a)()?(o=null===(t=i.b.getRowIdToShowInReadingPane(e,n))||void 0===t?void 0:t.Id,[4,P(o,n,e)]):[3,3];case 2:return a.sent(),[3,5];case 3:return[4,C(r,n)];case 4:a.sent(),a.label=5;case 5:return[3,8];case 6:return[4,P(r,n)];case 7:return a.sent(),[3,8];case 8:return[2]}}))}))}var F=t(1769),z=Object(o.action)("onReadingPaneClosed")((function(e,n){Object(F.q)()||k.d("onReadingPaneClosed should only be called in single line view."),V(e,n)})),U=Object(o.action)("onSingleSelectionChanged")((function(e,n,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return Object(F.q)()?[2]:t?[4,V(e,n)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}));function B(e,n,t){0==e.length||Object(F.q)()||1!==e.length||"Unread"===Object(i.P)(t)||V(e[0],n)}var Y=Object(c.action)("MARK_ITEMS_READ_BASED_ON_NODE_IDS",(function(e,n,t,a,i){return{nodeIds:e,tableViewId:n,isReadValueToSet:t,isExplicit:a,actionSource:i}})),Q=Object(o.action)("markItemAsReadFromReadingPane")((function(e,n,t,a,r){var o=[],c=null;if(n){if(Object(i.Q)(n)){var s=I.a.items.get(e).ConversationId.Id;o=Object(i.E)([s],n)}else o=Object(i.E)([e],n);c=Object(i.k)(n)}h(n,[e],t,!0,r,a).then((function(){n&&Object(w.a)(o,c)})).catch((function(e){n&&(Object(w.a)(o,c),Object(w.b)(n))}))})),Z=t(2132),G=Object(o.action)("markConversationsAsReadFromTable")((function(e,n,t,a){var r=Object(i.C)(e,n.id),o=Object(Z.a)(e,n);return x(r,n,t,!0,a,o,e)})),W=Object(o.action)("markItemsReadFromTable")((function(e,n,t,a,r){var o=Object(i.C)(e,n.id),c=Object(Z.a)(e,n),s=h(n,o,t,a,r,c),u=Object(i.k)(n),d=Object(i.bb)(n,t,a);s.then((function(n){Object(w.a)(e,u,d)})).catch((function(t){Object(w.a)(e,u,d),Object(w.b)(n)}))})),J=t(2659),H=Object(o.action)("toggleRowReadState")((function(e,n,t){var a=i.Y.tableViews.get(n),r=i.b.getUnreadCount(e,a)>0;switch(a.tableQuery.listViewType){case 0:G([e],a,r,t);break;case 1:W([e],a,r,!0,t)}Object(J.b)()})),q=Object(o.action)("onNavigateAwayViaUpDown")((function(e,n){V(e,n)})),X=Object(c.action)("onKeyboardMarkAsRead",(function(e,n,t,a,i,r){return{tableView:e,selectedNodeIds:n,isInVirtualSelectAllMode:t,rowKeysToActOn:a,exclusionList:i,isReadValueToSet:r}})),K=t(3714),$=t(2759),ee=t(3148),ne=t(13107),te=t(6),ae=t(6760),ie=t(13108),re=t(13109);var oe=t(127),ce=t(893),se=t(884),ue=t(4),de=t(18),le=t(1644),be=t(2305),ve=t(2106),me=t(4448),fe=t(2854),Oe=t(1935),je={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkAllAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"markAsRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markAllAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"markAsRead"},value:{kind:"Variable",name:{kind:"Name",value:"markAsRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"clientLastSyncTime"},value:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemIdsToExclude"},value:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipt"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]}]}}]}}]}}]}}]},ke=Object(o.action)("markAsReadInTable")((function(e,n,t,r,o,c,s){var u=this;if(o.length&&t)throw new Error("If in virtual select all mode, rowKeysToActOn should be empty.");if(n.length&&!t)throw new Error("If not in virtual select all mode, exclusionList should be empty.");var d=c.tableQuery.folderId,l=le.d.folderTable.get(d),b=c.isInVirtualSelectAllMode&&n.length>0,m=Object(i.P)(c),f="ContextFolder"===e||"CommandBar"===e&&t&&!c.isInCheckedMode&&!Object(i.T)(c,m),O=o.length>0&&!t,M=t&&l&&l.UnreadCount>=ae.b,w=function(e,n,t,a,r,o,c,s){if(e){if(Object(de.i)("tri-categoryUnreadCount")){var u=Object(i.O)(o);if(u)return Object(ce.n)(u)}return null==t?void 0:t.UnreadCount}if(Object(i.u)(o)||n||Object(i.T)(o,c)&&s)return o.totalRowsInView-a;return r}(f,b,l,n.length,o.length,c,m,t),I=M||w>=ae.b,p={headerText:"",bodyText:""};if(I){var N=Object(i.o)(c.tableQuery.type,c,l&&Object(le.j)(l));p=function(e,n,t,a,i,r,o,c){var s,u="",d="",l=1===n,b=e||l;return t<0&&(k.g.warn("totalCount in getMarkAsReadUnreadAllConfirmText should not be negative."),u=b?i?Object(te.b)(K.e):Object(te.b)($.e):i?Object(te.b)(K.c):Object(te.b)($.c)),1==t&&(u=i?Object(te.b)(ee.a):Object(te.b)($.a)),s=t<ae.a?t:"10000+",u=b?i?Object(te.c)(Object(te.b)(K.d),s):Object(te.c)(Object(te.b)($.d),s):i?Object(te.c)(Object(te.b)(K.b),s):Object(te.c)(Object(te.b)($.b),s),d=e?i?Object(te.c)(Object(te.b)(ie.b),a):Object(te.c)(Object(te.b)(re.b),a):r||o?l?i?Object(te.c)(Object(te.b)(ie.d),a):Object(te.c)(Object(te.b)(re.d),a):i?Object(te.c)(Object(te.b)(ie.c),a):Object(te.c)(Object(te.b)(re.c),a):l?i?Object(te.c)(Object(te.b)(ie.b),a):Object(te.c)(Object(te.b)(re.b),a):i?Object(te.c)(Object(te.b)(ie.a),a):Object(te.c)(Object(te.b)(re.a),a),c&&(d=l?i?Object(te.b)(ne.b):Object(te.b)(ne.d):i?Object(te.b)(ne.a):Object(te.b)(ne.c)),{headerText:u,bodyText:d}}(f,c.tableQuery.listViewType,w,N,r,b,O,2===c.tableQuery.type)}Object(se.b)(p.headerText,p.bodyText,!I,{delayCallbackAfterAnimation:!0,okText:Object(te.b)(be.a)}).then((function(s){return Object(a.__awaiter)(u,void 0,void 0,(function(){var u,l,b,m,f,O,k,M,w;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return s!==se.a.ok?[3,2]:[4,Oe.b()];case 1:if(a.sent(),t){switch(u=Object(T.a)().UserOptions.ReadReceipt,l="DoNotAutomaticallySend"==u||"NeverSend"==u||Object(fe.a)(d),b=Object(i.U)(d)?i.Y.inboxPausedDateTime:null,function(e,n,t){var a="TnS_MarkAllAs";a+=n?"Read":"Unread",Object(oe.r)(a,[e,Object(i.l)(t),t.isInCheckedMode])}(e,r,c),v.a.import().then((function(n){n(c.tableQuery,!0,r,e)})),m=[],c.tableQuery.listViewType){case 0:m=Object(me.a)(n,c.id);break;case 1:m=Object(i.C)(n,c.id)}Object(ve.a)(c,r,m),f=Object(i.j)(c),(O=null===(M=f)||void 0===M?void 0:M.Id)||(O=null===(w=f)||void 0===w?void 0:w.Id),k={id:O,markAsRead:r,clientLastSyncTime:b&&Object(ue.ub)(b),itemIdsToExclude:m,suppressReadReceipt:l,mailboxInfo:Object(j.b)(c)},Me.invokeMarkAllAsReadMutation(k)}else switch(c.tableQuery.listViewType){case 0:G(o,c,r,e);break;case 1:W(o,c,r,!0,e)}a.label=2;case 2:return[2]}}))}))}))})),Me={invokeMarkAllAsReadMutation:function(e){var n;return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(N.a)()];case 1:return[4,a.sent().mutate({variables:e,mutation:je})];case 2:return t=a.sent(),[2,null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.markAllAsRead]}}))}))}};var we=t(1995),Ie=Object(o.action)("setAutoMarkAsReadTimer")(Object(o.select)({store:function(){return s}})((function(e,n,t){var a=Object(T.a)().UserOptions;if("Delayed"==a.PreviewMarkAsRead){var r=Object(we.a)();if(!r||!Object(i.f)(r))return;t.store.markAsReadTimerTask=setTimeout((function(){Ne(e,r,n)}),1e3*a.MarkAsReadDelaytime)}}))),pe=Object(o.action)("clearAutoMarkAsReadTimer")(Object(o.select)({store:function(){return s}})((function(e){e.store.markAsReadTimerTask&&(clearTimeout(e.store.markAsReadTimerTask),e.store.markAsReadTimerTask=null)}))),Ne=Object(o.action)("setMarkAsReadTimer:timeout")((function(e,n,t){pe(),t?P(e,n):1===n.tableQuery.listViewType||Object(E.a)()?P(e,n):C(e,n)})),ye=t(2442),Te=t(37),he=Object(Te.e)(ye.b,"CLONE_ON_ITEM_PART_DESELECTED",(function(e){var n=e.itemId,t=e.tableView;t&&"OnSelectionChange"==Object(T.a)().UserOptions.PreviewMarkAsRead&&P(n,t)})),De=t(6765),ge=t(2526),Le=(Object(c.orchestrator)(Y,(function(e){var n=i.Y.tableViews.get(e.tableViewId),t=Object(a.__spread)(n.selectedRowKeys.keys()),r=Object(De.a)(e.nodeIds,Object(ge.a)(t[0]));h(n,r,e.isReadValueToSet,e.isExplicit,e.actionSource,null)})),t(1715)),Se=t(5870);Object(c.orchestrator)(Le.p,(function(e){var n=e.tableViewId,t=e.currentSelectedNodeIds,a=e.rowKey;if("OnSelectionChange"==Object(T.a)().UserOptions.PreviewMarkAsRead&&Object(E.a)()&&1===(null==t?void 0:t.length)){var r=i.Y.tableViews.get(n);P(Object(Se.a)(t[0],Object(ge.a)(a)),r)}}));Object(c.orchestrator)(X,(function(e){var n=e.tableView,t=e.selectedNodeIds,a=e.isInVirtualSelectAllMode,i=e.rowKeysToActOn,r=e.exclusionList,o=e.isReadValueToSet;t.length>0?Y(t,n.id,o,!0,"Keyboard"):ke("Keyboard",r,a,o,i,n)}));t.d(n,"onReadingPaneClosed",(function(){return z})),t.d(n,"onSingleSelectionChanged",(function(){return U})),t.d(n,"markReadOnTableViewChange",(function(){return B})),t.d(n,"markItemsAsReadBasedOnNodeIds",(function(){return Y})),t.d(n,"markItemAsReadFromReadingPane",(function(){return Q})),t.d(n,"toggleRowReadState",(function(){return H})),t.d(n,"onNavigateAwayViaUpDown",(function(){return q})),t.d(n,"onKeyboardMarkAsRead",(function(){return X})),t.d(n,"markAsReadInTable",(function(){return ke})),t.d(n,"clearAutoMarkAsReadTimer",(function(){return pe})),t.d(n,"setAutoMarkAsReadTimer",(function(){return Ie})),t.d(n,"onItemPartDeselectedOrchestrator",(function(){return he}))},6774:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return c}));var a=t(37),i=new a.c((function(){return t.e(445).then(t.bind(null,10943))})),r=new a.b(i,(function(e){return e.addMarkAsReadDiagnostics})),o=new a.b(i,(function(e){return e.addUnreadCountNotificationDiagnostics})),c=new a.b(i,(function(e){return e.addUnreadCountSubscriptionDiagnostics}))},9524:function(e,n,t){"use strict";var a,i,r=t(0),o=t(2098),c=t(1647),s=t(235);function u(e){var n,t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:a=null===(n=c.u.conversations)||void 0===n?void 0:n.get(e),i.label=1;case 1:return!a||null!=a&&a.canLoadMoreForRelationMap?(a&&(a.isLoadMoreInProgress=!0,a.maxItemsToReturn=a.maxItemsToReturn+o.a,a.syncState=""),[4,o.d.importAndExecute({Id:e,mailboxInfo:Object(s.d)()},"CreateConversationRelationMap")]):[3,3];case 2:return i.sent(),a||(a=null===(t=c.u.conversations)||void 0===t?void 0:t.get(e))?[3,1]:[3,3];case 3:return[2]}}))}))}function d(e){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,o,s,d,l,b,v,f;return Object(r.__generator)(this,(function(O){switch(O.label){case 0:return i==e?[3,2]:(i=e,[4,u(e)]);case 1:if(O.sent(),!(t=null===(n=c.u.conversations)||void 0===n?void 0:n.get(e)))return[2,null];if(o=null==t?void 0:t.conversationNodeIds,s=null==o?void 0:o.length,!o||!s||0==s)return[2,null];for((d=Object(r.__spread)(o)).reverse(),l=c.u.conversationNodes.get(d[0]),b=new Map,l&&b.set(l.internetMessageId,{itemIds:l.itemIds,childrenImIds:[]}),v=1;v<s;)f=c.u.conversationNodes.get(d[v]),m(b,f),v+=1;a=b,O.label=2;case 2:return[2,a]}}))}))}function l(e){var n,t=null===(n=c.u.conversations)||void 0===n?void 0:n.get(e);if(!t)return!1;var a=t.conversationNodeIds,i=null==a?void 0:a.length;return!(!a||!i||0==i)}function b(e,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,a;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return[4,d(e)];case 1:return(t=i.sent())?(a=[],t.forEach((function(e,i){if(0===e.childrenImIds.length){var r=f(n,e.itemIds);r&&a.push(r);for(var o=e;!r&&(null==o?void 0:o.parentImId);)o=t.get(null==o?void 0:o.parentImId),(r=f(n,null==o?void 0:o.itemIds))&&a.push(r)}})),[2,a.reverse()]):[2,[]]}}))}))}function v(e,n,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i,o,s,u,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=[t],[4,d(n)];case 1:if((i=r.sent())&&(null==(o=c.u.items.get(t))?void 0:o.InternetMessageId))for(s=i.get(o.InternetMessageId),u=null==s?void 0:s.parentImId;u;)(l=i.get(u))?(l.itemIds.forEach((function(n){var t,i=c.u.items.get(n);(!e||i&&(null===(t=i.ParentFolderId)||void 0===t?void 0:t.Id)==e)&&a.push(n)})),u=l.parentImId):u=void 0;return[2,a]}}))}))}function m(e,n){if(n&&e){var t=n.internetMessageId,a=n.parentInternetMessageId;if(a){var i=e.get(a);i&&i.childrenImIds.push(t)}e.set(t,{itemIds:n.itemIds,parentImId:a,childrenImIds:[]})}}function f(e,n){if(n)for(var t=0;t<n.length;t++)if(e.includes(n[t]))return n[t];return null}t.d(n,"c",(function(){return l})),t.d(n,"b",(function(){return b})),t.d(n,"a",(function(){return v}))}}]);
//# sourceMappingURL=owa.MailBoot~MarkRead.js.map
self.scriptsLoaded['owa.MailBoot~MarkRead.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MarkRead.js'] = (new Date()).getTime();