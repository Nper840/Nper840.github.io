self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~OwaGroupSharedActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[702],{1662:function(t,e,n){"use strict";var r=n(0),o=n(1705),i=n(365),u=n(614),a=n(127),c=n(4),s="X-AnchorMailbox",d="Authorization",f="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function b(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,b,p,g,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(i.k)(t)){if(b.accountState==i.b.AccessRevoked)return[2,null];if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.c)(b.accountState,b.accountProviderType),[2,null]}return e?(n[s]=e,n[l]=e):b&&(n[s]=b.anchorMailbox),b?(p=b.token,!(g=Object(u.g)(b.tokenExpiry))&&p?[3,2]:(Object(a.r)("getAndUpdateAccessToken",{tokenExpiry:Object(c.y)(b.tokenExpiry,Object(c.Qb)()),isTokenExpired_1:g,isTokenInvalid_2:!p},{isCore:!0}),[4,o.a.importAndExecute(b.accountId,t,p)])):[3,3];case 1:(p=r.sent())||(p=""),r.label=2;case 2:v=void 0,"Outlook"==b.accountProviderType?(v='MSAuth1.0 usertoken="'+p+'", type="MSACT"',n[f]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(v="Bearer "+p,n[f]=2..toString()),n[d]=v,r.label=3;case 3:return[2,n]}}))}))}var p=n(1663),g=n(20);function v(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(p.a)(),o=n,[4,O(t,e)];case 1:return o.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function O(t,e){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,[4,b(t.mailboxInfo.userIdentity,j(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(p.b)(o,i),[2,o]}}))}))}function j(t,e){var n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&g.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return v})),n.d(e,"c",(function(){return j}))},1663:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach((function(n){return t.set(n,e[n])}))}function o(t){var e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},1665:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2),o=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1681:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2),o=n(9),i=Object(r.createStore)("groupsStore",{groups:new o.ObservableMap})},1698:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1681);function o(t){var e=Object(r.a)().groups.get(t.toLowerCase());return e?e.groupDetails:null}},1699:function(t,e,n){"use strict";var r=n(0),o=n(1663);function i(t){return{"X-OWA-ExplicitLogonUser":t,"X-AnchorMailbox":t}}function u(t,e){e&&t&&Object(o.b)(e,i(t))}function a(t,e){var n,o=null!=e?e:{},i=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",u(t,i),Object(r.__assign)(Object(r.__assign)({},o),{headers:i})}var c=n(365),s=n(1662),d=n(85),f=n(352);function l(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(r.__generator)(this,(function(n){return[2,Object(d.b)().then((function(n){return Object(r.__awaiter)(e,void 0,void 0,(function(){var e,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t?Object(c.r)(t.userIdentity)?[4,Object(s.a)(t.userIdentity,"GroupMailbox"==t.type||"TeamsMailbox"==t.type?t.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return e=r.sent(),f(n,e),[3,3];case 2:"GroupMailbox"!=t.type&&"TeamsMailbox"!=t.type||(o=i(t.mailboxSmtpAddress),f(n,o)),r.label=3;case 3:return[2,n]}}))}))}))]}))}))}function b(){return Object(d.b)().then((function(t){return t.prefer='exchange.Behavior="CalendarInternal"',t}))}function p(t){return void 0===t&&(t=null),Object(c.r)(t)?b().then((function(e){return Object(s.a)(t).then((function(t){return Object.keys(t).forEach((function(n){return e[n]=t[n]})),e}))})):Promise.resolve({})}var g=n(55);function v(t,e,n){var r=new Headers;return n&&r.set("X-OWA-CANARY",Object(g.a)()),e&&r.set("X-OWA-ActionName",e),t&&u(t,r),r}n.d(e,"a",(function(){return a})),n.d(e,"d",(function(){return l})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return b})),n.d(e,"f",(function(){return u})),n.d(e,"e",(function(){return v}))},1700:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2),o=n(1749),i=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:o.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},1705:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(37),o=n(1665);n.d(e,"b",(function(){return o.a}));var i=new r.c((function(){return n.e(1302).then(n.bind(null,1915))})),u=new r.a(i,(function(t){return t.getAndUpdateAccessToken}))},1711:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Executing=1]="Executing",t[t.Succeed=2]="Succeed",t[t.FailureNotice=3]="FailureNotice",t[t.FailureRetry=4]="FailureRetry"}(r||(r={})),e.a=r},1720:function(t,e,n){"use strict";var r=n(2),o=n(9),i=(Object(r.createStore)("personaPhotoStore",{personaPhotoUrls:new o.ObservableMap})(),n(1827),n(1749),n(1681)),u=n(1700),a=n(1698);function c(t){var e=Object(i.a)().groups.get(t.toLowerCase());return!!e&&!e.groupDetailsError}var s=n(1777),d=n(1808),f=function(){return Object(d.a)().smtpAddress},l=n(1740),b=Object(r.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(t,e,n,r){if(2==e){var o=Object(a.a)(t);Object(s.a)(o,"Site")[0].Url=n,Object(s.a)(o,"Files")[0].Url=r}})),p=n(1860);function g(t){return t=t.toLocaleLowerCase(),Object(l.a)().groupSiteStatus.has(t)?Object(l.a)().groupSiteStatus.get(t):0}var v=function(t){var e="string"==typeof t?Object(a.a)(t):t;return e?e.ExternalDirectoryObjectId:null},O=(n(1711),n(1854),n(1845),n(1861),n(1855),n(2161)),j=n(2162),S=n(2181),m=n(2137),h=n(2138),A=n(6);function y(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(A.b)(m.a);if(3===e)return Object(A.b)(h.a)}return""}function x(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(A.b)(S.b);if(3===e)return Object(A.b)(S.c)}return""}function w(t){var e=0;return t.members?e=t.members.totalCount:t.groupDetails&&(e=t.groupDetails.MemberCount),e?e>1?Object(A.c)(Object(A.b)(j.a),e.toString()):Object(A.c)(Object(A.b)(O.a),e.toString()):Object(A.b)(S.a)}n.d(e,"j",(function(){return i.a})),n.d(e,"l",(function(){return u.a})),n.d(e,"d",(function(){return a.a})),n.d(e,"m",(function(){return c})),n.d(e,"f",(function(){return s.a})),n.d(e,"g",(function(){return s.b})),n.d(e,"c",(function(){return f})),n.d(e,"i",(function(){return l.a})),n.d(e,"o",(function(){return b})),n.d(e,"n",(function(){return p.b})),n.d(e,"h",(function(){return g})),n.d(e,"e",(function(){return v})),n.d(e,"a",(function(){return y})),n.d(e,"b",(function(){return x})),n.d(e,"k",(function(){return w}))},1740:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2),o=n(9),i=Object(r.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new o.ObservableMap})},1749:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Private=0]="Private",t[t.Public=1]="Public"}(r||(r={}))},1766:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function o(t){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},t)}},1777:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var r=n(1698),o=function(t,e){var n="string"==typeof t?Object(r.a)(t):t;if(!n||!n.GroupResources)return null;var o=n.GroupResources.filter((function(t){return t.Name===e}));return!o||o.length<1?null:o},i=function(t,e){var n=o(t,e);return n&&0!=n.length?n[0].Url:null}},1808:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2),o=Object(r.createStore)("currentGroupInformationStore",{smtpAddress:"",groupId:"",tenantId:""})},1827:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(18),o=n(1700),i=n(71);function u(){return(Object(r.i)("grp-shareable-crud")||Object(o.a)().isSensitivityLabelsEnabled)&&!Object(i.s)()}},1845:function(t,e,n){"use strict";var r=n(2),o=n(1907),i=Object(r.mutatorAction)("setJoinButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=i},1854:function(t,e,n){"use strict";var r=n(2),o=n(1906),i=Object(r.mutatorAction)("setFollowButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=i},1855:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1711),o=n(1907);function i(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},1860:function(t,e,n){"use strict";n.d(e,"b",(function(){return i}));var r=n(2),o=n(1740),i=Object(r.mutatorAction)("setGroupSiteStatus",(function(t,e){t=t.toLocaleLowerCase(),Object(o.a)().groupSiteStatus.has(t)&&e==Object(o.a)().groupSiteStatus.get(t)||Object(o.a)().groupSiteStatus.set(t,e)}));e.a=i},1861:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1711),o=n(1906);function i(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},1866:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function o(t){return Object(r.__assign)({__type:"UnifiedGroupIdentity:#Exchange"},t)}},1906:function(t,e,n){"use strict";var r=n(2),o=n(9);e.a=Object(r.createStore)("followButtonStore",{groupActionState:new o.ObservableMap})()},1907:function(t,e,n){"use strict";var r=n(2),o=n(9);e.a=Object(r.createStore)("joinButtonStore",{groupActionState:new o.ObservableMap})()},1919:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function o(t){return Object(r.__assign)({__type:"BodyContentType:#Exchange"},t)}},2044:function(t,e,n){"use strict";var r,o,i,u,a,c,s,d,f,l,b,p,g,v,O;var j;n(6);function S(t,e){e,j=t}function m(){return j}n.d(e,"o",(function(){return r})),n.d(e,"n",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return a})),n.d(e,"g",(function(){return c})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return d})),n.d(e,"l",(function(){return f})),n.d(e,"m",(function(){return l})),n.d(e,"q",(function(){return b})),n.d(e,"r",(function(){return p})),n.d(e,"h",(function(){return g})),n.d(e,"j",(function(){return v})),n.d(e,"e",(function(){return O})),n.d(e,"p",(function(){})),n.d(e,"k",(function(){return S})),n.d(e,"i",(function(){return m}))},2137:function(t){t.exports=JSON.parse('{"a":"rca"}')},2138:function(t){t.exports=JSON.parse('{"a":"nca"}')},2161:function(t){t.exports=JSON.parse('{"a":"mca"}')},2162:function(t){t.exports=JSON.parse('{"a":"sca"}')},2181:function(t){t.exports=JSON.parse('{"b":"oca","c":"pca","a":"qca"}')},2709:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(17),o=n(18);function i(){var t;return(null===(t=Object(r.a)().UserOptions)||void 0===t?void 0:t.SendFromAliasEnabled)&&Object(o.i)("cmp-proxy-address")}},2739:function(t,e,n){"use strict";function r(t,e,n){var r,o,i,u,a,c=t.groups.get(e.toLowerCase());if(c||(n.unreadMessageCount=null,n.groupDetailsError=n.groupDetailsError||!1),!n.groupDetailsError||c&&c.basicInformation||(n.basicInformation={SmtpAddress:e,DisplayName:e}),n.groupDetails){var s=n.groupDetails;c&&c.basicInformation&&!c.groupDetailsError||(n.basicInformation={SmtpAddress:s.SmtpAddress,DisplayName:s.DisplayName,AccessType:s.AccessType,LegacyDN:s.LegacyDN,MailboxGuid:s.MailboxGuid}),n.groupDetails.UserGroupRelationship={SubscriptionType:(null===(r=s.UserGroupRelationship)||void 0===r?void 0:r.SubscriptionType)||0,IsSubscribed:(null===(o=s.UserGroupRelationship)||void 0===o?void 0:o.IsSubscribed)||!1,ShouldIgnoreReply:(null===(i=s.UserGroupRelationship)||void 0===i?void 0:i.ShouldIgnoreReply)||!1,IsMember:(null===(u=s.UserGroupRelationship)||void 0===u?void 0:u.IsMember)||!1,IsOwner:(null===(a=s.UserGroupRelationship)||void 0===a?void 0:a.IsOwner)||!1}}return n}var o=n(148),i=n(1808),u=Object(o.action)("addOrUpdateGroup")((function(t,e,n,o,u){var a;e=e.toLowerCase();var c=void 0!==o&&""!==o;if(c&&(o=o.toLowerCase(),e=n.groupDetails.SmtpAddress),n=r(t,c?o:e,n),t.groups.has(e)||c&&t.groups.has(o)){var s=t.groups.has(e)?t.groups.get(e):t.groups.get(o);n.basicInformation&&(s.basicInformation=n.basicInformation),n.groupDetails&&((null===(a=s.groupDetails)||void 0===a?void 0:a.MailboxSettings)&&!n.groupDetails.MailboxSettings&&(n.groupDetails.MailboxSettings=s.groupDetails.MailboxSettings),s.groupDetails=n.groupDetails),n.members&&(s.members=n.members),null!=n.groupDetailsError&&(s.groupDetailsError=n.groupDetailsError),c&&e!==o&&(void 0!==u&&u(e,o),t.groups.set(e,s),t.groups.delete(o),Object(i.a)().smtpAddress=e)}else t.groups.set(e,n)}));e.a=u},3670:function(t,e,n){"use strict";var r=n(148),o=n(2044),i=n(2512),u=n(1720),a=n(2739),c=n(1860),s=n(1777);var d=function(t,e){var n=Object(s.b)(e,"Site");n?!function(t){return-1==t.indexOf("_layouts/groupstatus.aspx")}(n)?Object(c.a)(t,1):Object(c.a)(t,2):Object(c.a)(t,0)},f=n(2),l=Object(f.action)("beforeGetGroupDetailsStartAction",(function(t){return{groupSmtpAddress:t}}));Object(f.orchestrator)(l,(function(t){3==Object(u.h)(t.groupSmtpAddress)&&Object(u.n)(t.groupSmtpAddress,1)}));var b=l,p=n(1808),g=Object(f.mutatorAction)("updateCurrentGroupIdAndTenantIdAction",(function(t,e){Object(p.a)().groupId=t,Object(p.a)().tenantId=e})),v=function(t,e){Object(a.a)(Object(u.j)(),t,{basicInformation:null,groupDetails:null,members:null,groupDetailsError:!0}),Object(u.n)(t,0),e&&e()},O=Object(r.action)("getGroupDetailsAction")((function(t,e,n,r){b(t),(o.g||i.f)(t,e).then((function(e){return function(t,e,n,r){if(t&&t.Body&&Object(i.i)(t.Body)){var o=t.Body.GroupDetails;o?(Object(a.a)(Object(u.j)(),o.SmtpAddress,{basicInformation:null,groupDetails:o,members:null,groupDetailsError:!1}),g(o.ExternalDirectoryObjectId,o.ExternalDirectoryOrganizationId),d(e,o),n&&n()):v(e,r)}else v(e,r)}(e,t,n,r)})).catch((function(e){v(t,r)}))}));e.a=O},7306:function(t,e,n){"use strict";var r=n(241),o=n(1700);e.a=Object(r.mutatorAction)("updateUnifiedGroupSettings",(function(t){var e=Object(o.a)();Object.keys(t).forEach((function(n){e[n]=t[n]}))}))},7819:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n(7306),i=n(5641),u=n(2),a=Object(u.action)("loadUnifiedGroupsSettings");Object(u.orchestrator)(a,(function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(i.b)()];case 1:return(null==(t=e.sent())?void 0:t.unifiedGroupSettings)&&t.responseCode===i.a.Success&&Object(o.a)(t.unifiedGroupSettings),[2]}}))}))}));var c=a,s=n(3670);n.d(e,"loadUnifiedGroupsSettings",(function(){return c})),n.d(e,"getGroupDetailsAction",(function(){return s.a}))}}]);
//# sourceMappingURL=owa.MailBoot~OwaGroupSharedActions.js.map
self.scriptsLoaded['owa.MailBoot~OwaGroupSharedActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~OwaGroupSharedActions.js'] = (new Date()).getTime();