self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~OwaMailPlaywright~TriageAction.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[272],{10481:function(e,t,n){"use strict";var r=n(0),i=n(7379),a=n(6181),o=n(5662),c=n(884),u=n(1709),s=n(6),l=n(7123),d=n(1757),b=n(1764),f=n(3035),m=n(5226),v=n(1739),O=n(1883),j=n(1647),p=n(6759),y=n(6760),I=n(966),g=n(148),k=n(13049),h=n(1641),S=n(1644),w=n(1667);function T(e,t,n,i,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=Object(h.C)(e,t.id),a(o)?[4,d.f.importAndExecute(b.a.viewStates.get(b.a.primaryComposeId))]:[3,2];case 1:r.sent(),r.label=2;case 2:return a(o)||(c=e.filter((function(e){return t.rowKeys.indexOf(e)>=0}))).length>0&&i(c,n),[2]}}))}))}t.a=Object(g.select)({originalTableView:function(e,t){return v.a.tableViews.get(t)},folderTable:function(){return S.d.folderTable},searchStore:function(){return Object(O.i)()}})((function(e,t,n,r,o,d,b,m){var v,O,g=m.originalTableView,k=g.tableQuery,D=k.folderId;if(Object(i.a)(D,null))return null;var x=Object(u.e)(k),V=1==k.type,F=V&&0===g.selectedRowKeys.size&&"Hover"!==b,M=Object(S.H)(D),R=Object(h.R)(k)||Object(f.c)(k);if(x)v=!1;else if(V){var A=m.searchStore.staticSearchScope;v=e.map((function(e){return h.b.getParentFolderId(e,g)})).every((function(e){return Object(j.j)(e)}))||("PrimaryMailbox"==A.kind||"ArchiveMailbox"==A.kind)&&Object(j.j)(A.folderId),O=Object(s.b)(l.a)}else if(!R&&!M){var J=m.folderTable.get(D);v=Object(j.j)(D)||Object(j.p)(J),O=Object(S.j)(J)}var Q=n||v||x||M,P=e.length,E=P>=y.b,q=Object(h.u)(g),B=_(P,d),U=N(d,R,F,Q,g,O),H=C(Q,E,R,F,q);return Object(c.b)(B,U,H,{delayCallbackAfterAnimation:!0}).then((function(t){if(t===c.a.ok){var n=e.filter((function(e){return g.rowKeys.indexOf(e)>=0}));if(Object(S.D)(D,"SharedMailbox")){var i=Object(I.a)(w.g),u=Object(h.C)(e,g.id);return Object(a.a)(u,Object(p.a)(i),!0).then((function(){n.length>0&&T(n,g,"HardDelete",r,o)}))}var s=R?"HardDelete":Q?"SoftDelete":"MoveToDeletedItems";if(n.length>0)return T(n,g,s,r,o)}return Promise.resolve()}))}));var _=function(e,t){return e>1?Object(s.c)(t.deleteNumberOfRowsTitle,e):t.deleteOneRowTitle},N=function(e,t,n,r,i,a){if(n)return r?Object(s.b)(k.b):Object(s.b)(k.a);var c=Object(h.Q)(i)?o.e:o.f;return r||t?e.confirmDeleteRows:Object(s.c)(Object(s.b)(c),Object(m.a)(i.tableQuery.type,i,a))},C=function(e,t,n,r,i){return!(i||e||t||n||r)}},10482:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1641);function i(e,t){var n=[],i={};return e.forEach((function(e){var a=Object(r.h)(e,t);i[a.conversationId]||(i[a.conversationId]=!0,n.push(a))})),n}},10483:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(6761),i=n(168),a=n(10484),o=n(10485),c=n(390);function u(e){var t=function(e){return Object(a.a)({MessageAction:Object(o.a)({Action:"Restore"}),Ids:e.map((function(e){return Object(c.a)({Id:e})}))})}(e);return Object(r.a)({Header:Object(i.b)(),Body:t}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}},10484:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ApplyMessageActionRequest:#Exchange"},e)}},10485:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"MessageAction:#Exchange"},e)}},13048:function(e){e.exports=JSON.parse('{"a":"Swb","c":"Twb","b":"Uwb","d":"Vwb"}')},13049:function(e){e.exports=JSON.parse('{"b":"Owb","a":"Pwb"}')},13050:function(e){e.exports=JSON.parse('{"a":"nwb","b":"owb"}')},13051:function(e){e.exports=JSON.parse('{"b":"vwb","a":"wwb"}')},13052:function(e){e.exports=JSON.parse('{"b":"_wb","a":"$wb","c":"axb","d":"bxb"}')},2811:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(0),i=n(4),a=n(1668),o=n(20),c=n(1641);function u(e){var t=c.Y.tableViews.get(e),n=null;t&&(n=0==t.tableQuery.type||2==t.tableQuery.type?Object(c.J)(t).sortColumn:null);return n}function s(e,t){var n,i,a=[];if(e)try{for(var o=Object(r.__values)(e),u=o.next();!u.done;u=o.next()){var s=u.value,l=c.b.getItemIds(s,t);l&&a.push.apply(a,Object(r.__spread)(l))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return a}function l(e,t){var n,i,a=[];if(e)try{for(var o=Object(r.__values)(e),u=o.next();!u.done;u=o.next()){var s=u.value;a.push(c.b.getConversationId(s,t))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return a}t.a={blockSendersFromTable:{name:"TnS_BlockSendersFromListView",customData:function(e,t,n,r){return[n,e.length,t.tableQuery.type]}},setConversationsFlagState:{name:function(e,t,n,r,i){var a;switch(r.FlagStatus){case"Flagged":a="TnS_FlagConversation";break;case"NotFlagged":a="TnS_UnflagConversation";break;case"Complete":a="TnS_CompleteFlagConversation";break;default:o.d("Cannot log invalid flag type")}return a},customData:function(e,t,n,r,i){var a=c.Y.tableViews.get(n);return[Object(c.l)(a),Object(c.P)(a),null==e?void 0:e.length]},cosmosOnlyData:function(e,t,n,i,a){return function(e,t){var n,i,a=[],o=[],u=c.Y.tableViews.get(t);try{for(var s=Object(r.__values)(e),l=s.next();!l.done;l=s.next()){var d=l.value;a.push(c.b.getItemIds(d,u)[0]),o.push(c.b.getConversationId(d,u))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return JSON.stringify({itemIds:a,conversationIds:o})}(e,n)},actionSource:function(e,t,n,r,i){return i},options:{isCore:!0}},setItemsFlagState:{name:function(e,t,n,r,i){var a;switch(n.FlagStatus){case"Flagged":a="TnS_FlagItem";break;case"NotFlagged":a="TnS_UnflagItem";break;case"Complete":a="TnS_CompleteFlagItem";break;default:o.d("Cannot log invalid flag type")}return a},customData:function(e,t,n,r,i){var a=c.Y.tableViews.get(r);return[Object(c.l)(a),Object(c.P)(a),null==e?void 0:e.length]},cosmosOnlyData:function(e,t,n,r,i){return JSON.stringify({itemIds:e})},actionSource:function(e,t,n,r,i){return i},options:{isCore:!0}},archiveMailListRows:{name:"TnS_Archive",customData:function(e,t,n){return[t.tableQuery.folderId?Object(a.a)(t.tableQuery.folderId):null,t.tableQuery.type,t.tableQuery.listViewType,e.length,Object(c.l)(t),Object(c.P)(t)]},cosmosOnlyData:function(e,t,n){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0},actionSource:function(e,t,n){return n}},markItemsJunkNotJunk:{name:function(e,t,n,r,i,a){var o="TnS_MarkAs";return o+=t?"Junk":"NotJunk"},customData:function(e,t,n,r,i,a){return[e.length,Object(c.l)(r),Object(c.P)(r)]},cosmosOnlyData:function(e,t,n,r,i,a){return JSON.stringify({itemIds:e})},actionSource:function(e,t,n,r,i,a){return n}},markItemsAsPhishing:{name:"TnS_MarkAsPhishing",customData:function(e,t,n,r){return[e.length,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:e})},actionSource:function(e,t,n,r){return n}},moveConversation:{name:function(e,t,n,r){var i="TnS_MoveConversation";return i+=r?"":"Background"},customData:function(e,t,n,r){return[n.tableQuery.type,n.tableQuery.folderId?Object(a.a)(n.tableQuery.folderId):null,Object(a.a)(t),e.length,Object(c.l)(n),Object(c.P)(n)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,n),conversationIds:l(e,n)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},moveItems:{name:function(e,t,n,r){var i="TnS_MoveItem";return i+=r?"":"Background"},customData:function(e,t,n,r){return[n.tableQuery.type,n.tableQuery.folderId?Object(a.a)(n.tableQuery.folderId):null,Object(a.a)(t),e.length,Object(c.l)(n),Object(c.P)(n)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:e})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},copyMailListRows:{name:"TnS_Copy",customData:function(e,t,n,r,i){return[t.tableQuery.type,t.tableQuery.folderId?Object(a.a)(r):null,Object(a.a)(n),e.length,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n,r,i){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},actionSource:function(e,t,n,r,i){return i}},restoreConversation:{name:"TnS_RestoreConversation"},restoreItems:{name:"TnS_RestoreItem"},unsubscribe:{name:"TnS_Unsubscribe",customData:function(e,t,n,r){return[r,n,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemId:e.ItemId.Id})}},pinConversations:{name:function(e,t,n,r){var i="TnS_";return i+=n?"PinConversation":"UnpinConversation"},customData:function(e,t,n,r){return[e.length,Object(c.l)(t),Object(c.P)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},actionSource:function(e,t,n,r){return r},options:{isCore:!0}},pinItems:{name:function(e,t,n,r){var i="TnS_";return i+=n?"PinItem":"UnpinItem"},customData:function(e,t,n,r){return[e.length,Object(c.l)(t),Object(c.P)(t)]},cosmosOnlyData:function(e,t,n,r){var i=s(e,t);return JSON.stringify({itemIds:i})},actionSource:function(e,t,n,r){return r},options:{isCore:!0}},moveConversationToFocusedOrOther:{name:function(e,t,n,r){return 0===n?"TnS_MoveConversationToFocused":"TnS_MoveConversationToOther"},customData:function(e,t,n,r){return[e.length,Object(c.l)(c.Y.tableViews.get(t))]},cosmosOnlyData:function(e,t,n,r){var i=c.Y.tableViews.get(t);return JSON.stringify({itemIds:s(e,i),conversationIds:l(e,i)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},moveItemToFocusedOrOther:{name:function(e,t,n,r){return 0===n?"TnS_MoveItemToFocused":"TnS_MoveItemToOther"},customData:function(e,t,n,r){return[e.length,Object(c.l)(c.Y.tableViews.get(t))]},cosmosOnlyData:function(e,t,n,r){var i=c.Y.tableViews.get(t);return JSON.stringify({itemIds:s(e,i)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},alwaysMoveRowToFocusedOrOther:{name:function(e,t,n,r){return 0===n?"TnS_AlwaysMoveToFocused":"TnS_AlwaysMoveToOther"},customData:function(e,t,n,r){return[e.length,Object(c.l)(t),t.tableQuery.listViewType]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},addCategories:{name:"TnS_AddCategory",customData:function(e,t,n,r){return[r,e.length,t.tableQuery.listViewType,Object(c.l)(t),Object(c.P)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0}},removeCategories:{name:"TnS_RemoveCategory",customData:function(e,t,n,r){return[r,e.length,t.tableQuery.listViewType,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0}},clearCategories:{name:"TnS_ClearCategory",customData:function(e,t,n){return[n,e.length,t.tableQuery.listViewType,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0}},scheduleItems:{name:"TnS_ScheduleItem",customData:function(e,t,n,r){return[e.length,t.tableQuery.listViewType,Object(c.l)(t),r?Object(i.ub)(r):null]},options:{isCore:!0},actionSource:function(e,t,n){return n}}}},3279:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemJsonRequest:#Exchange"},e)}},3378:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemRequest:#Exchange"},e)}},3379:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(30),i=n(3279);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("DeleteItem",e,t)}},3632:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(3378),i=n(390),a=n(3379),o=n(168);function c(e,t){return Object(r.a)({ItemIds:e.map((function(e){return t=e,Object(i.a)({Id:t.Id,ChangeKey:t.ChangeKey});var t})),DeleteType:t,SuppressReadReceipts:!0,ReturnMovedItemIds:!0,SendMeetingCancellations:"SendToNone",AffectedTaskOccurrences:"AllOccurrences"})}function u(e,t,n){var r=c(e,t);return Object(a.a)({Header:Object(o.b)(),Body:r},n).then((function(e){return e.Body.ResponseMessages.Items}))}},3950:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1641),i=n(1647);function a(e){return e.map((function(e){var t,n=i.u.items.get(e);return t=!Object(r.W)(n)||n.IsRead,{itemId:e,itemConversationId:n.ConversationId,isRead:t,mailboxInfo:n.MailboxInfo}}))}},4416:function(e){e.exports=JSON.parse('{"a":"RKa"}')},5662:function(e){e.exports=JSON.parse('{"f":"xwb","d":"ywb","j":"zwb","c":"Awb","h":"Bwb","e":"Cwb","a":"Dwb","i":"Ewb","b":"Fwb","g":"Gwb","k":"Hwb","p":"Iwb","o":"Jwb","m":"Kwb","l":"Mwb","n":"Nwb"}')},6043:function(e,t,n){"use strict";n.d(t,"c",(function(){return Q})),n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return E}));var r=n(0),i=n(13052),a=n(5662),o=n(2705),c=n(6),u=n(1935),s=n(1764),l=n(6181),d=n(3950),b=n(2811),f=n(3632),m=n(1950),v=n(10481),O=n(966),j=n(6759),p=n(7379),y=n(1739),I=n(10483),g=n(8553),k=n(1647),h=n(884),S=n(1730),w=n(1641),T=n(1656),_=(n(1788),n(127)),N=n(2287),C=n(1644),D=n(1667),x=n(7381),V=n(3304),F=n(1795),M=n(48),R=n(2),A=n(369);function J(e){var t=s.a.primaryComposeId&&s.a.viewStates.get(s.a.primaryComposeId).itemId;return t&&e.indexOf(t.Id)>=0}var Q=Object(R.action)("deleteItemsWithoutConfirmDialog",(function(e,t,n,r,i,a,o){return Object(M.c)({name:"TnS_DeleteItem",options:{timeout:7e4},customData:[e.length,t],cosmosOnlyData:JSON.stringify({itemIds:e}),actionSource:r},{itemIds:e,disposalType:t,parentFolderId:n,actionSource:r,instrumentationContexts:i,requestInitOptions:a,allowUndoAction:o})}));function P(e,t,n,r,a,o){var s=Object(T.b)().items.get(e[0]).ParentFolderId.Id;if(Object(p.a)(s,null))return Promise.resolve();var d=Object(C.D)(s,"SharedMailbox"),b=Object(A.a)(a)||null,f=a&&"GroupMailbox"==a.type,m=Object(k.j)(s),v="SoftDelete"==t&&m||f||Object(C.H)(s);return Object(h.b)(f?Object(c.b)(i.b):"",f?Object(c.b)(i.a):Object(c.b)(i.c),!v,{delayCallbackAfterAnimation:!0}).then((function(i){var o=Object(u.c)(s,a)&&"MoveToDeletedItems"===t;if(i==h.a.ok){if(d){var c=Object(O.a)(D.g);return Object(l.a)(e,Object(j.a)(c),!0).then((function(){return Q(e,"HardDelete",s,r,n,b,o)}))}return Q(e,t,s,r,n,b,o)}return Promise.resolve()}))}function E(e,t,n,r,s){var l=y.a.tableViews.get(t),d={deleteNumberOfRowsTitle:Object(c.b)(a.m),deleteOneRowTitle:Object(c.b)(o.a),confirmDeleteRows:Object(c.b)(i.d)},f=y.a.tableViews.get(t);return Object(_.r)("TnS_DeleteItemsFromTable",[s,e.length,Object(b.b)(t),Object(w.u)(f)]),Object(v.a)(e,t,n,(function(e,n){var i=Object(w.C)(e,t);return Q(i,n,l.tableQuery.folderId,s,r,Object(A.a)(Object(S.b)(l)),Object(u.c)(l.tableQuery.folderId,Object(S.b)(l))&&"MoveToDeletedItems"==n)}),J,d,s)}Object(R.orchestrator)(Q,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,a,o,c,s,l,b,v,O,j,p,y;return Object(r.__generator)(this,(function(k){switch(k.label){case 0:return t=e.itemIds,n=e.disposalType,i=e.parentFolderId,a=e.actionSource,o=e.instrumentationContexts,c=e.requestInitOptions,s=e.allowUndoAction,l=Object(w.H)(),b=null,v=[],l&&(v=Object(w.E)(t,l),b=l.serverFolderId,Object(x.a)(l.tableQuery,!0)&&(O=Object(d.a)(t),Object(m.a)(O,i,"Delete"))),j=Object(_.t)(),[4,u.b()];case 1:return k.sent(),p=t.map((function(e){return{Id:e}})),(c=c||{}).timeoutMS=6e4,y=Object(f.a)(p,n,c),u.a((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,i,a,o,c,u;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return[4,y];case 1:if(e=l.sent(),s){t=[];try{for(n=Object(r.__values)(e),i=n.next();!i.done;i=n.next())a=i.value,"Success"==(o=a).ResponseClass&&t.push(o.MovedItemId.Id)}catch(e){c={error:e}}finally{try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}}if(t.length>0)return[2,Object(I.a)(t)]}return[2,Promise.resolve()]}}))}))}),b),a&&Object(g.a)(t.length,s),Object(N.d)("Delete",o,{itemIds:t}),j.markUserPerceivedTime(),[2,y.then((function(e){return j.addCheckpoint("di_then"),Object(V.a)(v,i,!!l),Object(F.a)(e)})).catch((function(e){return j.addCheckpoint("di_catch"),"ErrorItemNotFound"==e.responseCode&&(e.fetchErrorType="Expected"),Object(V.a)(v,i,!!l),Object(V.b)(l),Promise.reject(e)}))]}}))}))}))},6181:function(e,t,n){"use strict";var r=n(7380),i=n(0);var a=n(30);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"CopyItemJsonRequest:#Exchange"},n)),Object(a.a)("CopyItem",e,t)}var c=n(168);function u(e,t,n,a){var u=function(e,t,n){return a={ToFolderId:t,ItemIds:Object(r.a)(e),ReturnNewItemIds:!0,RemoteExecute:n},Object(i.__assign)({__type:"CopyItemRequest:#Exchange"},a);var a}(e,t,n);return o({Header:Object(c.b)(),Body:u},a).then((function(e){return e.Body}))}n.d(t,"a",(function(){return u}))},6758:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(9518),i=n(6043),a=n(1739),o=n(2132);function c(e,t,n,c){var u=a.a.tableViews.get(t),s=Object(o.a)(e,u);switch(u.tableQuery.listViewType){case 0:Object(r.a)(e,t,n,s,c);break;case 1:Object(i.b)(e,t,n,s,c)}}},6759:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(563),i=n(801);function a(e){return e?Object(i.a)({BaseFolderId:Object(r.a)({Id:e})}):null}},6761:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(30),i=n(6762);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("ApplyMessageAction",e,t)}},6762:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ApplyMessageActionJsonRequest:#Exchange"},e)}},7379:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(13048),i=n(6),a=n(884),o=n(1644),c=n(17);function u(e,t){if(!Object(c.a)().SessionSettings.IsShadowMailbox)return!1;var n,u=o.d.folderTable.get(e),s=o.d.folderTable.get(t),l=u.sourceWellKnownFolderType;if(87==l)n=Object(i.b)(r.a);else if(88==l)n=Object(i.b)(r.c);else if(null!=s){var d=s.sourceWellKnownFolderType;87==d?n=Object(i.b)(r.b):88==d&&(n=Object(i.b)(r.d))}return null!=n&&(Object(a.b)("",n,!1,{hideCancelButton:!0}),!0)}},7380:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(390);function i(e){return e.map((function(e){return Object(r.a)({Id:e})}))}},7381:function(e,t,n){"use strict";function r(e,t){switch(0==e.type?e.scenarioType:""){case"persona":case"privatedistributionlist":return!1;case"category":return t;default:return!0}}n.d(t,"a",(function(){return r}))},7842:function(e,t,n){"use strict";var r=n(0),i=n(2811),a=n(48),o=n(2070),c=n(1641),u=n(1739),s=n(5877),l=n(3304),d=n(713),b=n(5057),f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoDeleteConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoDeleteConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]};n.d(t,"b",(function(){return m}));t.a=Object(a.d)("RestoreConversation",i.a.restoreConversation)((function(e,t){var n=Object(u.b)().tableViews.get(t),r=Object(s.a)(e,t,(function(e){return!!e})),i=Object(c.C)(r,t),a=r.map((function(e){return Object(c.h)(e,t)}));Object(o.a)(i,n,"Restore");var d=n.tableQuery.folderId,b=m.invokeUndoDeleteMutation(a,d);return Object(l.c)(b,r,n.serverFolderId,n,!1,!0)}));var m={invokeUndoDeleteMutation:function(e,t,n){var i;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(b.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(d.a)()];case 1:return[4,r.sent().mutate({variables:{conversations:a,folderId:t,undoRequestId:n},mutation:f})];case 2:return o=r.sent(),[2,null===(i=null==o?void 0:o.data)||void 0===i?void 0:i.undoDeleteConversation]}}))}))}}},8553:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(6),i=n(4416),a=n(1769),o=n(1935),c=n(887),u=n(17),s=n(13050);function l(e,t){if(Object(u.a)().UserOptions.ShowNotificationBar){var n=1===e?Object(r.b)(s.a):Object(r.c)(Object(r.b)(s.b),e),l=Object(a.h)();c.e.importAndExecute("deleteNotification","MailModuleNotificationBarHost",n,{icon:"Delete",primaryActionText:t?Object(r.b)(i.a):null,allowClear:!0,minWidth:l.minWidth,maxWidth:l.maxWidth,notificationCallback:function(e){e===c.a.PrimaryActionClicked&&o.e.importAndExecute("NotificationBar")}})}}},9518:function(e,t,n){"use strict";var r=n(0),i=n(2811),a=n(10481),o=n(10482),c=n(7381),u=n(8553),s=n(7842),l=n(5662),d=n(127),b=n(48),f=n(713),m=n(1709),v=n(6),O=n(2705),j=n(2287),p=n(2070),y=n(1764),I=n(1739),g=n(1730),k=n(3304),h=n(5057),S=n(1935),w=n(966),T=n(2),_=n(1641),N=n(13051),C={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposalType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposalType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"disposalType"},value:{kind:"Variable",name:{kind:"Name",value:"disposalType"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"undoRequestId"},arguments:[],directives:[]}]}}]}}]};n.d(t,"b",(function(){return D})),n.d(t,"a",(function(){return x})),n.d(t,"c",(function(){return F}));var D=Object(T.action)("deleteConversationsWithoutConfirmDialog",(function(e,t,n,r,a){var o=I.a.tableViews.get(t);return Object(b.c)({name:"TnS_DeleteConversation",options:{timeout:7e4},customData:[a,e.length,n,Object(i.b)(t),Object(_.l)(o),Object(_.P)(o),Object(_.u)(o)],cosmosOnlyData:JSON.stringify({conversationIds:e.map((function(e){return e.conversationId}))}),actionSource:a},{conversationActionContexts:e,originalTableViewId:t,disposalType:n,instrumentationContexts:r})}));Object(T.orchestrator)(D,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,a,o,l,b,f,m,v,O,y,h,T;return Object(r.__generator)(this,(function(N){switch(N.label){case 0:return t=e.conversationActionContexts,n=e.originalTableViewId,i=e.disposalType,a=e.instrumentationContexts,o=t.map((function(e){return e.conversationId})),l=Object(I.b)().tableViews.get(n),Object(c.a)(l.tableQuery,!0)&&Object(p.a)(o,l,"Delete"),b=Object(d.t)(),[4,S.b()];case 1:return N.sent(),f=Object(w.a)("deleteditems"),m=Object(_.E)(o,l),v=Object(g.b)(l),O=Object(_.k)(l,!0),y=Object(S.c)(l.tableQuery.folderId,v)&&"MoveToDeletedItems"===i,h={timeoutMS:6e4},T=F.invokeDeleteConversationMutation(t,O,i,v,h),y&&S.a((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,T];case 1:return(e=n.sent()).success?[4,s.b.invokeUndoDeleteMutation(t,f,e.undoRequestId)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2,Promise.resolve()]}}))}))}),l.serverFolderId,T),Object(u.a)(t.length,y),Object(j.d)("Delete",a,{conversationIds:o}),b.markUserPerceivedTime(),[2,Object(k.c)(T,m,l.serverFolderId,l,!0,!0)]}}))}))}));function x(e,t,n,r,i){var c=I.a.tableViews.get(t),u=Object(m.e)(c.tableQuery),s={deleteNumberOfRowsTitle:Object(v.b)(l.k),deleteOneRowTitle:Object(v.b)(O.a),confirmDeleteRows:u?Object(v.b)(N.b):Object(v.b)(N.a)};return Object(a.a)(e,t,n,(function(e,n){var a=Object(o.a)(e,t);D(a,t,n,r,i)}),V,s,i)}function V(e){var t=y.a.primaryComposeId&&y.a.viewStates.get(y.a.primaryComposeId).conversationId;return t&&e.indexOf(t)>=0}var F={invokeDeleteConversationMutation:function(e,t,n,i,a){var o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(h.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(f.a)()];case 1:return[4,r.sent().mutate({variables:{conversations:c,disposalType:n,folderId:t,mailboxInfo:i},context:{requestOptions:a},mutation:C})];case 2:return u=r.sent(),[2,null===(o=null==u?void 0:u.data)||void 0===o?void 0:o.deleteConversation]}}))}))}}}}]);
//# sourceMappingURL=owa.MailBoot~OwaMailPlaywright~TriageAction.js.map
self.scriptsLoaded['owa.MailBoot~OwaMailPlaywright~TriageAction.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~OwaMailPlaywright~TriageAction.js'] = (new Date()).getTime();