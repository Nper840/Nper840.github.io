self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~PeopleExperiences~Search.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[274],{1013:function(e,t,r){"use strict";r.r(t);var n=r(985),a=r(795),i=r(981),s=r(980);t.default=function(e,t,r){e=Object(s.a)(e),t=Object(a.a)(t);var o=e.length,c=r=void 0===r?o:Object(n.a)(Object(i.a)(r),0,o);return(r-=t.length)>=0&&e.slice(r,c)==t}},1029:function(e,t,r){"use strict";var n=r(2),a=Object(n.action)("initializeApplicationSettings",(function(e){return{config:e}})),i=r(498),s=r(389),o=r(0),c=function(e,t){return e.filter((function(e){return!t.includes(e)}))},u=(Object(n.mutator)(a,(function(e){var t=e.config,r=Object(s.a)();if(!t)return r.initialized=!0,void(r.report={NoSettings:!0});if(!t.settings)return r.lastError=t.lastError,r.initialized=!0,void(r.report={NoSettings:!0});var n={};Object.keys(i.a).forEach((function(e){n[e]={};var r=t.settings[e];Object.keys(i.a[e]).forEach((function(t){n[e][t]=r&&r.hasOwnProperty(t)?r[t]:i.a[e][t]}))})),r.configIDs=t.configIDs,r.lastError=t.lastError,r.settings=n,r.initialized=!0,r.report=function(e,t,r){var n,a,i,s,u,l={},d=0,f=0,b=Object.keys(e),h=Object.keys(t),m=c(b,h),p=c(h,b),v=(u=h,b.filter((function(e){return u.includes(e)})));if(m.length){l.MissingSettings=[];try{for(var g=Object(o.__values)(m),O=g.next();!O.done;O=g.next()){var k=O.value;l.MissingSettings.push({group:k,settings:["all"]}),d+=Object.keys(e[k]).length}}catch(e){n={error:e}}finally{try{O&&!O.done&&(a=g.return)&&a.call(g)}finally{if(n)throw n.error}}}if(p.length){l.ExtraSettings=[];try{for(var y=Object(o.__values)(p),x=y.next();!x.done;x=y.next()){k=x.value;var j=Object.keys(t[k]);l.ExtraSettings.push({group:k,settings:j}),f+=Object.keys(t[k]).length}}catch(e){i={error:e}}finally{try{x&&!x.done&&(s=y.return)&&s.call(y)}finally{if(i)throw i.error}}}if(v.forEach((function(r){var n=Object.keys(e[r]),a=Object.keys(t[r]),i=c(n,a),s=c(a,n);i.length&&(l.MissingSettings=[{group:r,settings:i}],d+=i.length),s.length&&(l.ExtraSettings=[{group:r,settings:s}],f+=s.length)})),d&&(l.MissingSettingsCount=d),f&&(l.ExtraSettingsCount=f),r&&(l.LastError=r),d||f)return l}(i.a,t.settings,t.lastError)})),Object(n.action)("setApplicationSettingOverride",(function(e,t,r){return{group:e,setting:t,value:r}}))),l=(Object(n.mutator)(u,(function(e){var t=e.group,r=e.setting,n=e.value;Object(s.a)().overrides[t][r]=n})),Object(n.action)("setApplicationSettingsSearchKey",(function(e){return{key:e}}))),d=(Object(n.mutator)(l,(function(e){var t=e.key;Object(s.a)().searchKey=t})),Object(n.action)("resetApplicationSettingOverrides")),f=r(802),b=(Object(n.mutator)(d,(function(){Object(s.a)().overrides=Object(f.a)(i.a,!1)})),r(665)),h=(Object(n.orchestrator)(u,(function(e){var t=e.group,r=e.setting,n=e.value;Object(b.c)(t,r,n)})),Object(n.orchestrator)(d,b.b),r(979));function m(){return Object(s.a)().settings}function p(){return Object(s.a)().overrides}function v(){return Object(s.a)().report}function g(){return Object(s.a)().searchKey}r.d(t,"a",(function(){return h.a})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return v})),r.d(t,"e",(function(){return g})),r.d(t,"f",(function(){return a})),r.d(t,"h",(function(){return u})),r.d(t,"i",(function(){return l})),r.d(t,"g",(function(){return d}))},10378:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(1),a=r(51),i=r(971),s=r(12370),o=r(396).bind(s);function c(e){if(0===e.personas.length)return null;var t=e.isSearchPill?a.c.size24:a.c.size48,r=e.isSearchPill?a.c.size16:a.c.size24,c=e.isSearchPill?s.sizeSmall:s.sizeBig;if(1===e.personas.length)return n.createElement(i.a,{name:e.personas[0].name,emailAddress:e.personas[0].emailAddress,size:t,mailboxType:""});if(2===e.personas.length||e.isSearchPill){var u=e.personas[0],l=e.personas[1];return n.createElement("div",{className:o(s.multiPersonContainer,c)},n.createElement(i.a,{name:u.name,emailAddress:u.emailAddress,size:t,className:s.leftPersona,mailboxType:""}),n.createElement(i.a,{name:l.name,emailAddress:l.emailAddress,size:t,className:o(s.leftPersona,s.leftDivider),mailboxType:""}))}var d=e.personas[0],f=e.personas[1],b=e.personas[2];return n.createElement("div",{className:o(s.multiPersonContainer,c)},n.createElement(i.a,{name:d.name,emailAddress:d.emailAddress,size:t,className:s.leftPersona}),n.createElement("div",{className:s.rightContainer},n.createElement(i.a,{name:f.name,emailAddress:f.emailAddress,size:r,className:s.topRightPersona}),n.createElement(i.a,{name:b.name,emailAddress:b.emailAddress,size:r,className:s.bottomRightPersona})))}},1039:function(e,t,r){"use strict";var n=r(0);function a(e){return e>0}var i=r(2),s=r(48),o=Object(i.action)("UNSUBSCRIBE_FROM_BRAND_SUBSCRIPTION",(function(e,t,r,n,a,i){return Object(s.c)({name:"UnsubscribeSubscription",customData:{unsubscribeSourceType:e}},{unsubscribeSourceType:e,smtpAddress:t,smtpIdentifier:r,unsubscribeSilentUris:n,unsubscribeHttpUri:a,completedCallback:i})})),c=Object(i.action)("AFTER_UNSUBSCRIBE",(function(e,t,r,n,a){return{smtpIdentifier:e,unsubscribeSourceType:t,responseType:r,debugMessage:n,completedCallback:a}})),u=r(6),l=r(161),d="ows/api/beta/subscriptions/{0}/unsubscribe";var f,b=function(e,t){return Object(l.c)(Object(u.c)(d,e),{unsubscribeSilentUris:t},null,!0)};!function(e){e[e.Fail=0]="Fail",e[e.Success=1]="Success"}(f||(f={}));var h=f,m=r(9),p=Object(i.createStore)("BrandSubscription",{subscriptions:new m.ObservableMap({}),unsubscribedSubscriptions:new m.ObservableMap({})})();function v(e){return e&&p.subscriptions.has(e.toLowerCase())?p.subscriptions.get(e.toLowerCase()):null}var g=Object(i.mutatorAction)("unsubscribeFromCache",(function(e){var t=Object(n.__assign)({},v(e));t?(p.subscriptions.delete(e.toLowerCase()),p.unsubscribedSubscriptions.set(e.toLowerCase(),t)):x()})),O=r(236);Object(i.orchestrator)(o,(function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var t,r,i,s,o,u,l,d,f,m,p,v;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t=e.unsubscribeSourceType,r=e.smtpAddress,i=e.smtpIdentifier,s=e.unsubscribeSilentUris,o=e.unsubscribeHttpUri,u=e.completedCallback,o&&0!==o.length||s&&0!==s.length?(s&&a(s.length)||!o?l="No unsubscribe URIs provided":(window.open(o,"_blank"),l="Opened unsubscribe URI in new tab"),[4,b(i,s)]):(l="No unsubscribe URIs or SilentURIs provided",d=h.Fail,c(i,t,d,l,u),[2,Promise.reject("No unsubscribe URIs or SilentURIs provided")]);case 1:return f=n.sent(),m=null,Object(O.a)(f.status)?(l="Unsubscribe service called successfully. "+l,d=h.Success,g(r),[3,4]):[3,2];case 2:return l="Unsubscribe service failed. "+l,d=h.Fail,[4,f.text().then((function(e){return e?JSON.parse(e):{}}))];case 3:p=n.sent(),(m=new Error("ResponseCode="+f.status+", ErrorMessage="+(null===(v=null==p?void 0:p.error)||void 0===v?void 0:v.message))).fetchErrorType="ServerFailure",n.label=4;case 4:return c(i,t,d,l,u),m?[2,Promise.reject(m)]:[2,Promise.resolve()]}}))}))}));Object(i.mutator)(c,(function(e){var t=e.unsubscribeSourceType,r=e.responseType,n=e.debugMessage,a=e.completedCallback;"BrandCard"===t&&a&&a(r===h.Success,n)}));var k=Object(i.mutatorAction)("populateSubscriptionStore",(function(e){e.subscriptions.forEach((function(e){var t;(null===(t=null==e?void 0:e.smtpInfo)||void 0===t?void 0:t.smtpAddress)&&p.subscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)})),e.unsubscribedSubscriptions.forEach((function(e){var t;(null===(t=null==e?void 0:e.smtpInfo)||void 0===t?void 0:t.smtpAddress)&&p.unsubscribedSubscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)}))})),y="ows/api/beta/subscriptions?orderBy=name, asc";var x=function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(l.b)(e?y+"&noResolveBrand=true":y,void 0,!0)];case 1:return t=n.sent(),Object(O.a)(t.status)?[4,t.json()]:[3,3];case 2:return r=n.sent(),k(r),[2,r];case 3:return[2,null]}}))}))};r.d(t,"b",(function(){return x})),r.d(t,"e",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"a",(function(){return h})),r.d(t,"c",(function(){return v})),r.d(t,"f",(function(){return a}))},1045:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));var n=r(0),a=void 0,i=new Promise((function(e){a=e}));function s(e){null==a||a(e)}function o(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){return[2,Promise.race([i,new Promise((function(e,t){setTimeout((function(){return t()}),45e3)}))])]}))}))}},1049:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(822),a=r(168),i=r(821);function s(e){if(!e)return Promise.reject(new Error("GetPersonaByEmailAddress failed"));var t=Object(n.a)({EmailAddress:{EmailAddress:e}});return Object(i.a)({Header:Object(a.b)(),Body:t}).then((function(e){if(e.Body&&"NoError"===e.Body.ResponseCode)return e.Body.Persona;throw new Error("GetPersonaByEmailAddress failed")}))}},1057:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(30),a=r(834);function i(e,t){return void 0===e.getNotesForPersonaRequest||e.getNotesForPersonaRequest.__type||(e.getNotesForPersonaRequest=Object(a.a)(e.getNotesForPersonaRequest)),Object(n.a)("GetNotesForPersona",e,t)}},12370:function(e,t,r){var n=r(12371),a=r(109);"string"==typeof n&&(n=[[e.i,n]]);for(var i=0;i<n.length;i++)a.loadStyles(n[i][1],!1);n.locals&&(e.exports=n.locals)},12371:function(e,t,r){(t=e.exports=r(108)(!1)).push([e.i,'._3plXYxFJtmVgEG6F-il-Or{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-item-align:start;align-self:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden}html[dir] ._3plXYxFJtmVgEG6F-il-Or{border-radius:50%}html[dir=ltr] ._2sBD73W6Jnw_mCxIc3vKyF{border-left:.5px solid "[theme:white, default:#ffffff]"}html[dir=rtl] ._2sBD73W6Jnw_mCxIc3vKyF{border-right:.5px solid "[theme:white, default:#ffffff]"}._18I4GiMjH-2YfR8lRc8mJe{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}html[dir] ._18I4GiMjH-2YfR8lRc8mJe .ms-Persona-image,html[dir] ._18I4GiMjH-2YfR8lRc8mJe .ms-Persona-initials{border-radius:0}._18I4GiMjH-2YfR8lRc8mJe .ms-Image-image{height:100%;width:auto}._24wo_KFm4GkkDe1rXZPJqh{}._24wo_KFm4GkkDe1rXZPJqh .ms-Persona-initials{font-size:8px}html[dir=ltr] ._2xxg5Jl2QdypJlGDT18d82{border-left:.5px solid "[theme:white, default:#ffffff]"}html[dir=rtl] ._2xxg5Jl2QdypJlGDT18d82{border-right:.5px solid "[theme:white, default:#ffffff]"}._2OPZZoAwEk_xqsCDcHituz{}._2OPZZoAwEk_xqsCDcHituz .ms-Persona-initials{font-size:7px}._2OPZZoAwEk_xqsCDcHituz .ms-Persona-initials span{position:absolute}html[dir=ltr] ._2OPZZoAwEk_xqsCDcHituz .ms-Persona-initials span{left:4px}html[dir=rtl] ._2OPZZoAwEk_xqsCDcHituz .ms-Persona-initials span{right:4px}._2F1nvA1SqdrwLOykBk1UIM{}._2F1nvA1SqdrwLOykBk1UIM .ms-Persona-initials span{top:2px}.eSN1hMsxhc_zPYwQvMTsN{}html[dir] .eSN1hMsxhc_zPYwQvMTsN{border-top:.5px solid "[theme:white, default:#ffffff]"}.eSN1hMsxhc_zPYwQvMTsN .ms-Persona-initials span{bottom:6px}.ItRY-685bxGeJLWKh8WPy{width:48px;height:48px}.ItRY-685bxGeJLWKh8WPy ._18I4GiMjH-2YfR8lRc8mJe{width:24px;min-width:24px!important}.ItRY-685bxGeJLWKh8WPy ._24wo_KFm4GkkDe1rXZPJqh{min-width:24px!important;height:48px!important}.ItRY-685bxGeJLWKh8WPy ._24wo_KFm4GkkDe1rXZPJqh .ms-Persona-image,.ItRY-685bxGeJLWKh8WPy ._24wo_KFm4GkkDe1rXZPJqh .ms-Persona-imageArea{width:24px!important}.ItRY-685bxGeJLWKh8WPy ._24wo_KFm4GkkDe1rXZPJqh .ms-Persona-initials{height:24px;line-height:24px}.ItRY-685bxGeJLWKh8WPy .eSN1hMsxhc_zPYwQvMTsN,.ItRY-685bxGeJLWKh8WPy ._2OPZZoAwEk_xqsCDcHituz,.ItRY-685bxGeJLWKh8WPy ._2F1nvA1SqdrwLOykBk1UIM{min-width:24px!important;height:24px!important}.ItRY-685bxGeJLWKh8WPy .eSN1hMsxhc_zPYwQvMTsN .ms-Persona-initials,.ItRY-685bxGeJLWKh8WPy ._2OPZZoAwEk_xqsCDcHituz .ms-Persona-initials,.ItRY-685bxGeJLWKh8WPy ._2F1nvA1SqdrwLOykBk1UIM .ms-Persona-initials{height:24px;line-height:24px}.v62xXUnCUQHFBsnPdJm6U{width:24px;height:24px}.v62xXUnCUQHFBsnPdJm6U ._18I4GiMjH-2YfR8lRc8mJe{width:12px;min-width:12px!important}.v62xXUnCUQHFBsnPdJm6U ._24wo_KFm4GkkDe1rXZPJqh{min-width:12px!important;height:24px!important}.v62xXUnCUQHFBsnPdJm6U ._24wo_KFm4GkkDe1rXZPJqh .ms-Persona-image,.v62xXUnCUQHFBsnPdJm6U ._24wo_KFm4GkkDe1rXZPJqh .ms-Persona-imageArea{width:12px!important}.v62xXUnCUQHFBsnPdJm6U ._24wo_KFm4GkkDe1rXZPJqh .ms-Persona-initials{height:12px;line-height:12px}.v62xXUnCUQHFBsnPdJm6U .eSN1hMsxhc_zPYwQvMTsN,.v62xXUnCUQHFBsnPdJm6U ._2OPZZoAwEk_xqsCDcHituz,.v62xXUnCUQHFBsnPdJm6U ._2F1nvA1SqdrwLOykBk1UIM{min-width:12px!important;height:12px!important}.v62xXUnCUQHFBsnPdJm6U .eSN1hMsxhc_zPYwQvMTsN .ms-Persona-initials,.v62xXUnCUQHFBsnPdJm6U ._2OPZZoAwEk_xqsCDcHituz .ms-Persona-initials,.v62xXUnCUQHFBsnPdJm6U ._2F1nvA1SqdrwLOykBk1UIM .ms-Persona-initials{height:12px;line-height:12px}',""]),t.locals={multiPersonContainer:"_3plXYxFJtmVgEG6F-il-Or",rightContainer:"_2sBD73W6Jnw_mCxIc3vKyF",persona:"_18I4GiMjH-2YfR8lRc8mJe",leftPersona:"_24wo_KFm4GkkDe1rXZPJqh _18I4GiMjH-2YfR8lRc8mJe",leftDivider:"_2xxg5Jl2QdypJlGDT18d82",rightPersona:"_2OPZZoAwEk_xqsCDcHituz _18I4GiMjH-2YfR8lRc8mJe",topRightPersona:"_2F1nvA1SqdrwLOykBk1UIM _2OPZZoAwEk_xqsCDcHituz _18I4GiMjH-2YfR8lRc8mJe",bottomRightPersona:"eSN1hMsxhc_zPYwQvMTsN _2OPZZoAwEk_xqsCDcHituz _18I4GiMjH-2YfR8lRc8mJe",sizeBig:"ItRY-685bxGeJLWKh8WPy",sizeSmall:"v62xXUnCUQHFBsnPdJm6U"}},1257:function(e,t,r){var n=r(1258),a=r(109);"string"==typeof n&&(n=[[e.i,n]]);for(var i=0;i<n.length;i++)a.loadStyles(n[i][1],!1);n.locals&&(e.exports=n.locals)},1258:function(e,t,r){(t=e.exports=r(108)(!1)).push([e.i,"._3fxSw_KFta16t28JP70e_s .ms-Persona-initials{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage)}html[dir] ._3fxSw_KFta16t28JP70e_s .ms-Persona-initials{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground)}",""]),t.locals={persona:"_3fxSw_KFta16t28JP70e_s"}},1259:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=r(885).a},173:function(e,t,r){"use strict";function n(){var e=Object.create(null),t=0,r=0,n=0,a=!1;function i(t){n--,delete e[t]}this.put=function(t,r,a,s){if(void 0!==a&&("number"!=typeof a||isNaN(a)||a<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==s&&"function"!=typeof s)throw new Error("Cache timeout callback must be a function");var o=e[t];o?clearTimeout(o.timeout):n++;var c={value:r,expire:a+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){i(t),s&&s(t,r)}.bind(this),a)),e[t]=c,r},this.del=function(t){var r=!0,n=e[t];return n?(clearTimeout(n.timeout),!isNaN(n.expire)&&n.expire<Date.now()&&(r=!1)):r=!1,r&&i(t),r},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);n=0,e=Object.create(null),a&&(t=0,r=0)},this.get=function(i){var s=e[i];if(void 0!==s){if(isNaN(s.expire)||s.expire>=Date.now())return a&&t++,s.value;a&&r++,n--,delete e[i]}else a&&r++;return null},this.size=function(){return n},this.memsize=function(){var t,r=0;for(t in e)r++;return r},this.debug=function(e){a=e},this.hits=function(){return t},this.misses=function(){return r},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var r in e){var n=e[r];t[r]={value:n.value,expire:n.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,r){var n=JSON.parse(t),a=Date.now(),i=r&&r.skipDuplicates;for(var s in n)if(n.hasOwnProperty(s)){if(i)if(e[s])continue;var o=n[s],c=o.expire-a;if(c<=0){this.del(s);continue}c=c>0?c:void 0,this.put(s,o.value,c)}return this.size()}}e.exports=new n,e.exports.Cache=n},223:function(e,t,r){"use strict";var n=r(477),a=r(472),i=r(2),s=r(9),o={viewStates:new s.ObservableMap,livePersonaCardInitializationStatus:{state:n.a.NotInitialized,timestamp:Date.now()},isLivePersonaCardInitialized:!1,isPersonaCardDisabled:!1,brandList:null,brandListLoadState:a.a.unloaded,dynamicBrandSets:{unverifiedBrands:new s.ObservableMap,verifiedBrands:new s.ObservableMap}},c=Object(i.createStore)("personacontrol",o)();t.a=c},325:function(e,t,r){"use strict";var n=r(617),a="object"==typeof self&&self&&self.Object===Object&&self,i=n.a||a||Function("return this")();t.a=i},360:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return s}));var n,a=r(0);function i(e){n=e}function s(){var e,t;return Object(a.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(i=n)?[4,n()]:[3,2];case 1:i=a.sent(),a.label=2;case 2:if((r=i)&&r.length>0){if("bearer"===(null===(e=null==r?void 0:r.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,r.split(" ")[1]];if("msauth1.0"===(null===(t=null==r?void 0:r.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,r]}return[2,void 0]}}))}))}},368:function(e,t,r){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},383:function(e,t,r){"use strict";var n=r(325).a.Symbol;t.a=n},389:function(e,t,r){"use strict";var n=r(2),a=r(498),i=r(802),s={settings:a.a,overrides:Object(i.a)(a.a),configIDs:void 0,lastError:void 0,initialized:!1,report:void 0,searchKey:void 0};t.a=Object(n.createStore)("applicationSettings",s)},417:function(e,t,r){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},419:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(17),a=r(222),i=r(18);function s(){return Object(a.a)()&&Object(i.i)("rp-imageApiConsumer")&&!Object(n.a)().SessionSettings.IsShadowMailbox}},433:function(e,t,r){"use strict";var n=r(383),a=Object.prototype,i=a.hasOwnProperty,s=a.toString,o=n.a?n.a.toStringTag:void 0;var c=function(e){var t=i.call(e,o),r=e[o];try{e[o]=void 0;var n=!0}catch(e){}var a=s.call(e);return n&&(t?e[o]=r:delete e[o]),a},u=Object.prototype.toString;var l=function(e){return u.call(e)},d="[object Null]",f="[object Undefined]",b=n.a?n.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?f:d:b&&b in Object(e)?c(e):l(e)}},439:function(e,t,r){"use strict";var n=function(){function e(e,t,r){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=r,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();r.d(t,"a",(function(){return n}))},472:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.unloaded=0]="unloaded",e[e.loading=1]="loading",e[e.loadSucceeded=2]="loadSucceeded",e[e.loadFailed=3]="loadFailed"}(n||(n={}))},477:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.NotInitialized="NotInitialized",e.Initializing="Initializing",e.Initialized="Initialized",e.Failed="Failed"}(n||(n={}))},498:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={Loki:{resourceUrl:"https://loki.delve.office.com/"}}},562:function(e,t,r){"use strict";var n=Array.isArray;t.a=n},615:function(e,t,r){"use strict";var n=r(433),a=r(417),i="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(a.a)(e)&&Object(n.a)(e)==i}},617:function(e,t,r){"use strict";(function(e){var r="object"==typeof e&&e&&e.Object===Object&&e;t.a=r}).call(this,r(93))},619:function(e,t,r){"use strict";var n=r(664),a=r(806),i=r(2),s=Object(i.mutatorAction)("setOwaWorkload",(function(e){a.a.currentWorkload=e})),o=r(984);function c(){switch(Object(n.a)()){case 1:case 8:case 32:case 2415919103:case 0:return["outlookweberrors@microsoft.com"];case 2:return["outlookweberrors@microsoft.com","calendarreactfeedback@service.microsoft.com"];case 8192:return["outlookweberrors@microsoft.com","calendarreactfeedback@service.microsoft.com","timepanel@service.microsoft.com"];case 4:return["outlookweberrors@microsoft.com","Opfeedbackoc@service.microsoft.com"];case 4096:return["spacesteam@service.microsoft.com"];case 16384:return["eventifyfeedback@microsoft.com"];case 65536:return["orgxfeedback@microsoft.com"];default:return["outlookweberrors@microsoft.com"]}}r.d(t,"b",(function(){return n.a})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return o.a})),r.d(t,"a",(function(){return c}))},663:function(e,t,r){"use strict";var n=r(368),a=r(615),i=NaN,s=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(a.a)(e))return i;if(Object(n.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(n.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var r=c.test(e);return r||u.test(e)?l(e.slice(2),r?2:8):o.test(e)?i:+e}},664:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(806);function a(){return n.a.currentWorkload}},665:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return s}));var n=r(7),a=function(){var e=Object(n.a)(window,"applicationSettingOverrides");if(e)try{return JSON.parse(e)}catch(e){return{}}return{}},i=function(e,t,r){var i,s=a();s[e]?s[e][t]=r:s[e]=((i={})[t]=r,i),Object(n.e)(window,"applicationSettingOverrides",JSON.stringify(s))},s=function(){Object(n.d)(window,"applicationSettingOverrides")}},671:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(17),a=r(222);function i(e){if(Object(a.a)()&&e){var t,r,i=Object(n.a)();if(i&&i.SessionSettings)return t=e,r=i.SessionSettings.UserEmailAddress,t&&r&&t.toLowerCase()==r.toLowerCase()?i.HexCID:void 0}}},795:function(e,t,r){"use strict";var n=r(383),a=r(969),i=r(562),s=r(615),o=1/0,c=n.a?n.a.prototype:void 0,u=c?c.toString:void 0;t.a=function e(t){if("string"==typeof t)return t;if(Object(i.a)(t))return Object(a.a)(t,e)+"";if(Object(s.a)(t))return u?u.call(t):"";var r=t+"";return"0"==r&&1/t==-o?"-0":r}},802:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(665);function a(e,t){void 0===t&&(t=!0);var r={},a=Object(n.a)();return Object.keys(e).forEach((function(n){var i=e[n],s=a[n];r[n]={},Object.keys(i).forEach((function(e){r[n][e]=t&&(null==s?void 0:s.hasOwnProperty(e))?s[e]:void 0}))})),r}},806:function(e,t,r){"use strict";var n=r(2);t.a=Object(n.createStore)("owaWorkload",{currentWorkload:0})()},818:function(e,t,r){"use strict";var n=r(0),a=r(2),i=r(223),s=Object(a.mutatorAction)("SET_BRAND_LIST",(function(e){i.a.brandList=e})),o=Object(a.mutatorAction)("SET_BRAND_LIST_LOAD_STATE",(function(e){i.a.brandListLoadState=e})),c=r(472),u=r(20),l=r(3),d=function(e){if(200!==e.status)throw new Error("error fetching brand list: request for '"+e.url+"' resolved with status "+e.status);return e.json()},f=function(){var e=Object(l.z)()+"resources/json/brandList.json";return fetch(e).then(d)};function b(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:if(i.a.brandListLoadState!=c.a.unloaded)return[2];o(c.a.loading),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,f()];case 2:return(e=r.sent())?(s(e),o(c.a.loadSucceeded)):(o(c.a.loadFailed),u.g.info("error fetching brand list. Empty response")),[3,4];case 3:return t=r.sent(),o(c.a.loadFailed),u.g.info("error fetching brand list. Exception: "+t),[3,4];case 4:return[2]}}))}))}r.d(t,"a",(function(){return b}))},821:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(30),a=r(999);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(n.a)("GetPersona",e,t)}},822:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(0);function a(e){return Object(n.__assign)({__type:"GetPersonaRequest:#Exchange"},e)}},834:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(0);function a(e){return Object(n.__assign)({__type:"GetNotesForPersonaRequest:#Exchange"},e)}},838:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(0);function a(e){return Object(n.__assign)({__type:"PersonaPropertyUpdate:#Exchange"},e)}},903:function(e,t,r){"use strict";var n=r(18),a=r(70),i=r(904),s=r(222),o=r(1013);r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return l}));var c={NotResolved:"NotResolved",User:"User",Group:"Group",External:"External",DistributionList:"DistributionList",PrivateDistributionList:"PrivateDistributionList",Location:"Location",Room:"Room",Meeting:"Meeting",Brand:"Brand",Topic:"Topic"};function u(e,t,r,u){if(e)return{personaType:c.User,isBrand:!1,isTier3Brand:!1};if(Object(n.i)("rp-brandCards")&&!Object(a.b)(u)&&Object(i.a)(u)){var d=Object(i.b)(u);return{personaType:c.Brand,isBrand:!0,isTier3Brand:d}}return Object(a.b)(t)?!Object(a.b)(r)&&Object.keys(c).indexOf(r)>-1?{personaType:r,isBrand:!1,isTier3Brand:!1}:(f=u,Object(o.default)(f,"@groups.outlook.com")?{personaType:"Group",isBrand:!1,isTier3Brand:!1}:Object(s.a)()?{personaType:"User",isBrand:!1,isTier3Brand:!1}:{personaType:"NotResolved",isBrand:!1,isTier3Brand:!1}):{personaType:l(t),isBrand:!1,isTier3Brand:!1};var f}function l(e){switch(e){case"PublicDL":return c.DistributionList;case"PrivateDL":return c.PrivateDistributionList;case"GroupMailbox":return c.Group;case"Mailbox":case"Contact":return c.User;case"OneOff":case"Unknown":return c.NotResolved;default:return c.User}}},904:function(e,t,r){"use strict";var n=r(818),a=r(223),i=r(9),s=Object(i.computed)((function(){var e=new Set;return a.a.brandList.smtps.forEach((function(t){return e.add(t.toLowerCase())})),a.a.brandList.tier3Smtps.forEach((function(t){return e.add(t.toLowerCase())})),e})),o=Object(i.computed)((function(){var e=new Set;return a.a.brandList.tier3Smtps.forEach((function(t){return e.add(t.toLowerCase())})),e})),c=r(472),u=r(619),l=r(419);function d(e){return Object(l.a)()?a.a.dynamicBrandSets.verifiedBrands.get(e)||a.a.dynamicBrandSets.unverifiedBrands.get(e)||!1:!(1!==Object(u.b)()||!b())&&h(e,s)}function f(e){return Object(l.a)()?a.a.dynamicBrandSets.verifiedBrands.get(e)||!1:!(1!==Object(u.b)()||!b())&&h(e,o)}function b(){return a.a.brandListLoadState===c.a.unloaded&&Object(n.a)(),!(a.a.brandListLoadState!=c.a.loadSucceeded||!a.a.brandList||!a.a.brandList.smtps)}function h(e,t){return!!e&&(-1!==(e=e.toLowerCase()).indexOf("@")&&t.get().has(e))}r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return f}))},969:function(e,t,r){"use strict";t.a=function(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}},971:function(e,t,r){"use strict";var n=r(0),a=r(671),i=r(223),s=r(990),o=r(25),c=r(1),u=r(51),l=r(1261),d=r(900),f=r(37),b=new f.c((function(){return r.e(1420).then(r.bind(null,1581))})),h=new f.a(b,(function(e){return e.getPersonaPhoto})),m=r(1257),p=r(396).bind(m);t.a=Object(o.a)((function(e){var t;e=Object(n.__assign)({emailAddress:"",name:"",size:u.c.regular,secondaryText:"",showPresence:!1,mailboxType:""},e);var r=Object(s.a)(e.emailAddress,e.personaId,e.size,e.mailboxType,e.name);c.useEffect((function(){!function(e){(e.emailAddress||e.name||e.personaId)&&h.importAndExecute(e.name,e.emailAddress,e.personaId,e.size,e.hexConsumerIdForUser||Object(a.a)(e.emailAddress),e.mailboxType,e.skipLoadingPhoto)}(e)}),[r]);var o=i.a.viewStates.get(r);if(!o)return null;var f=e.className,b=e.size,v=e.name,g=e.statusText,O=e.showPersonaDetails,k=e.secondaryText,y=e.showSecondaryText,x=e.presence,j=e.onRenderPrimaryText,w=e.onRenderCoin,P=e.initialsColor,S=e.onRenderInitials,_=e.styleProps,B=e.coinProps,T=e.showUnknownPersonaCoin,C=e.imageInitials,I=(null===(t=o.personaBlob)||void 0===t?void 0:t.blobUrl)?{imageUrl:o.personaBlob.blobUrl,imageShouldFadeIn:!1,imageShouldStartVisible:!0}:{};return O||y||g?c.createElement(l.a,Object(n.__assign)({className:p(f,m.persona),presence:x||u.b.none,hidePersonaDetails:!O,size:b,text:v,secondaryText:k,showSecondaryText:y,tertiaryText:g,onRenderPrimaryText:j,onRenderCoin:w,onRenderInitials:S},I,{initialsColor:P,showUnknownPersonaCoin:T,styles:_,coinProps:B,imageInitials:C})):c.createElement(d.a,Object(n.__assign)({},B,{className:p(f,m.persona),presence:x||u.b.none,size:b,text:v,onRenderCoin:w,onRenderInitials:S},I,{initialsColor:P,showUnknownPersonaCoin:T,showInitialsUntilImageLoads:!0,imageInitials:C}))}))},979:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return s}));var n=r(389),a=r(20),i=r(18);function s(t,r){var s,o=Object(n.a)();if(o.initialized||e.env.JEST_WORKER_ID||a.d("Attempted to read "+t+"."+r+" before application settings were initialized."),Object(i.i)("fwk-devTools")){var c=null===(s=o.overrides[t])||void 0===s?void 0:s[r];if(void 0!==c)return c}return o.settings[t][r]}}).call(this,r(94))},980:function(e,t,r){"use strict";var n=r(795);t.a=function(e){return null==e?"":Object(n.a)(e)}},981:function(e,t,r){"use strict";var n=r(663),a=1/0,i=17976931348623157e292;var s=function(e){return e?(e=Object(n.a)(e))===a||e===-a?(e<0?-1:1)*i:e==e?e:0:0===e?e:0};t.a=function(e){var t=s(e),r=t%1;return t==t?r?t-r:t:0}},984:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(664);function a(e){return!!(Object(n.a)()&e)}},985:function(e,t,r){"use strict";t.a=function(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}},990:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(419);function a(e,t,r,a,i){var s="",o=Object(n.a)();return e?s+=e.toLowerCase():t?s+=t:i&&(s+=i.toLowerCase()),a&&o&&(s+=a),r&&!o&&(s+=r),s}},995:function(e,t,r){"use strict";var n=r(0),a=r(1),i=r(249),s=r(818),o=r(1064),c=r(223),u=r(127),l=r(647),d=r(25),f=r(1001),b=r(51),h=r(903),m=r(18),p=Object(d.a)((function(e){var t=e.personaSize,r=e.identifiers,n=e.styles,i=e.children,s=e.onPersonaInsightRingStateChange,o="User"===r.PersonaType||"NotResolved"===r.PersonaType,u=window.PersonaInsightRing;return u&&c.a.isLivePersonaCardInitialized&&o?a.createElement(u,{identifiers:r,styles:n,personaSize:t,onPersonaInsightRingStateChange:s},i):a.createElement(a.Fragment,null,i)}));r.d(t,"a",(function(){return g}));var v=Object(d.a)((function(e){var t=e.composeEmailOverride,r=e.isUnauthenticatedSender,v=e.mailBoxType,g=e.personaType,O=e.emailAddress,k=e.clientScenario,y=e.locationToOpen,x=e.focusReturnElement,j=e.tabIndex,w=e.olsPersonaId,P=e.topicId,S=e.name,_=e.disableHover,B=e.ariaLabel,T=e.className,C=e.children,I=e.size,L=e.aadObjectId,R=e.displayPersonaHighlightRing,E=e.mountWithoutWrapperSpan,U=e.disableAccessibilityDefaults,A=Object(n.__read)(a.useState(!1),2),D=A[0],N=A[1];a.useEffect((function(){Object(o.a)(t),Object(s.a)()}),[]);var F,J=a.useMemo((function(){return Object(h.b)(r,v,g,O)}),[r,v,g,O,c.a.brandListLoadState]),z=a.useCallback((function(){return function(e,t,r){if(Object(m.i)("grp-TransferOwnership")){var n=document.getElementById("TransferOwnershipGroupDialog");n&&(i.unmountComponentAtNode(n),document.body.removeChild(n))}e.isBrand&&Object(u.r)(e.personaType===h.a.Brand?"BrandCardDisplayed":"BrandDetectedButNotDisplayed");var a=t||"No Client Scenario",s=r||"LPC";Object(u.r)("LPCRenderedFromHoverTarget",{clientScenario:a,locationToOpen:s})}(J,k,y)}),[J,k,y]),M=a.useCallback((function(){x instanceof HTMLElement?x.focus():(null==x?void 0:x.current)&&x.current.focus()}),[x]),H=a.useCallback((function(e){N(e)}),[N]),G=Object(f.a)({text:S}),q=(F={displayPersonaHighlightRing:R,personaSize:I||b.c.size40,identifiers:{OlsPersonaId:w,TopicId:P,Smtp:O,PersonaType:J.personaType},onPersonaInsightRingStateChange:H},Object(d.a)((function(e){var t=e.children;return Object(m.i)("lpc-isPersonaInsightRingEnabled")&&F.displayPersonaHighlightRing?a.createElement(p,Object(n.__assign)({},F),t):a.createElement(a.Fragment,null,t)})));if(c.a.isLivePersonaCardInitialized){var W=window.LivePersonaCardHoverTargetV2,K=R?a.createElement(q,null,C):C;return a.createElement(W,{tabIndex:j,cardParameters:{disableAccessibilityDefaults:U,externalAppSessionCorrelationId:l.lokiClientCorrelationId,personaInfo:{identifiers:{Smtp:O,PersonaType:J.personaType,OlsPersonaId:w,AadObjectId:L,TopicId:P},isUnauthenticatedSender:r,displayName:S,isTier3Brand:J.isTier3Brand,personaCoinColor:G},behavior:{disableHover:_,onCardOpen:z,onCardClose:M,locationToOpen:y},clientScenario:k,ariaLabel:B,hasPersonaInsightRing:D}},E?K:a.createElement("span",{className:T,"aria-label":B},K))}return a.createElement(a.Fragment,null,C)}));function g(e){return Object(d.a)((function(t){var r=t.children;return c.a.isPersonaCardDisabled?a.createElement(a.Fragment,null,r):a.createElement(v,Object(n.__assign)({},e),r)}))}},999:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(0);function a(e){return Object(n.__assign)({__type:"GetPersonaJsonRequest:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.MailBoot~PeopleExperiences~Search.js.map
self.scriptsLoaded['owa.MailBoot~PeopleExperiences~Search.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~PeopleExperiences~Search.js'] = (new Date()).getTime();