self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~RSVP.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[732],{1273:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=1273},16869:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(2),c=Object(a.action)("parseGetItemResponseAction",(function(e,t){return{items:e,clientItemIds:t}})),i=Object(a.action)("tryPrefetchMeetingMessage",(function(e,t,n){return{mailboxInfo:e,listViewType:t,shouldDelayPrefetch:n}})),o=Object(a.action)("removeMeetingMessagesFromStore",(function(e){return{itemIds:e}})),u=n(9601),b=n(127),O=n(1641),f=n(1647),d=n(7407),s=n(799),l=n(794),j=n(114),m=n(20),y=n(7408),v=[Object(l.a)({FieldURI:"Start"}),Object(l.a)({FieldURI:"End"}),Object(l.a)({FieldURI:"AssociatedCalendarItemId"}),Object(l.a)({FieldURI:"RecurrenceId"}),Object(l.a)({FieldURI:"Recurrence"}),Object(l.a)({FieldURI:"ConflictingMeetings"}),Object(l.a)({FieldURI:"CalendarItemType"}),Object(l.a)({FieldURI:"IsResponseRequested"}),Object(l.a)({FieldURI:"Organizer"}),Object(l.a)({FieldURI:"ItemClass"}),Object(l.a)({FieldURI:"MeetingRequestType"}),Object(l.a)({FieldURI:"ItemParentId"}),Object(l.a)({FieldURI:"Sender"}),Object(l.a)({FieldURI:"ConversationId"}),Object(l.a)({FieldURI:"IsDelegated"}),Object(l.a)({FieldURI:"ReceivedRepresenting"}),Object(l.a)({FieldURI:"ResponseType"})];function I(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i,o,u,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:(a=new b.b("LoadMeetingMessage")).addCustomProperty("count",e.length),i=e.map((function(e){return e.Id})),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(f.e)(i,Object(s.a)({BaseShape:"IdOnly",AdditionalProperties:v}),null)];case 2:return!(o=r.sent())||o instanceof Error?a.endWithError("ServerError"):(u=e.filter((function(e){return o.some((function(t){return t.ItemId.Id===e.Id}))})),c(o,u),a.end()),(o instanceof Error||o.length!==i.length)&&m.g.warn("[loadingmeetingmessage] some items failed in: "+i),[3,4];case 3:return l=r.sent(),a.endWithError("ServerError",Error(l)),m.g.warn("[loadingmeetingmessage] all items failed in: "+i),[3,4];case 4:return function(e,t){t.forEach((function(t){if(1===e){var n=f.u.items.get(t.itemId);if(!n)return;Object(d.a)(t.itemId)&&Object(y.a)(Object(d.a)(t.itemId))||(n.shouldShowRSVP=!1)}else{var r=Object(O.L)(t.rowKey,t.tableViewId);if(!r)return;Object(d.a)(t.itemId)&&Object(y.a)(Object(d.a)(t.itemId))||(r.shouldShowRSVP=!1)}}))}(n,t),[2]}}))}))}Object(a.orchestrator)(i,(function(e){var t=e.listViewType,n=e.mailboxInfo,r=e.shouldDelayPrefetch,a=n.mailboxSmtpAddress,c=u.b(a);if(u.c(a),c&&0!==c.length){var i=c.map((function(e){return{Id:e.itemId,mailboxInfo:n}}));r?Object(j.a)((function(){I(i,c,t)})):I(i,c,t)}})),Object(a.mutator)(c,(function(e){for(var t=e.items,n=e.clientItemIds,a=function(e){var a=t[e],c=n[e],i=Object(O.K)().meetingMessageItems.get(c.Id);if(i){Object.keys(i).forEach((function(e){a[e]&&(i[e]=a[e])}))}else{var o=Object(r.__assign)(Object(r.__assign)({},a),{MailboxInfo:c.mailboxInfo,SmartTimeData:null,SmartTimeExtendedProperty:null,smartPillFeedbackSubmitted:!1});Object(O.K)().meetingMessageItems.set(c.Id,o)}},c=0;c<t.length;c++)a(c)})),Object(a.mutator)(o,(function(e){var t=e.itemIds,n=Object(O.K)();t.forEach((function(e){n.meetingMessageItems.has(e)&&setTimeout((function(){n.meetingMessageItems.delete(e)}),1e3)}))})),n.d(t,"tryPrefetchMeetingMessage",(function(){return i})),n.d(t,"removeMeetingMessagesFromStore",(function(){return o}))},1928:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(968);function a(e){return Object(r.a)("calendarDayOfWeek_"+e)}},2308:function(e,t,n){"use strict";var r=n(70),a=n(968),c=n(4);var i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function o(e){return i.indexOf(e)}var u=n(1928),b=7;function O(e){var t=function(e){if(e&&0!==e.length){if(1===e.length)return e[0];if(2===e.length)return Object(r.a)(Object(a.a)("formatStringTwoItems"),e[0],e[1]);for(var t=Object(r.a)(Object(a.a)("formatStringNItemsStart"),e[0],e[1]),n=2;n<e.length-1;n++)t=Object(r.a)(Object(a.a)("formatStringNItemsMiddle"),t,e[n]);return t=Object(r.a)(Object(a.a)("formatStringNItemsEnd"),t,e[e.length-1])}return""}(e.DaysOfWeek.split(" ").sort(d.bind(null,e.FirstDayOfWeek)).map((function(e){return Object(u.a)(e)})));return 1===e.Interval?Object(r.a)(Object(a.a)("calendarWeekly1FormatString"),t):2===e.Interval?Object(r.a)(Object(a.a)("calendarWeekly2FormatString"),t):Object(r.a)(Object(a.a)("calendarWeeklyNFormatString"),t,e.Interval)}var f={canHandle:function(e){return!!e.DaysOfWeek&&!!e.FirstDayOfWeek&&!!e.Interval},formatRecurrence:O,formatRecurrenceOption:O,getNumberedRecurrenceEndDate:function(e,t,n){var r=function(e){var t=Array(b);return e.forEach((function(e){switch(e){case"Weekday":t[o("Monday")]=!0,t[o("Tuesday")]=!0,t[o("Wednesday")]=!0,t[o("Thursday")]=!0,t[o("Friday")]=!0;break;case"WeekendDay":t[o("Saturday")]=!0,t[o("Sunday")]=!0;break;case"Day":for(var n=0;n<t.length;n++)t[n]=!0;break;default:t[o(e)]=!0}})),t}(e.DaysOfWeek.split(" ")),a=r.reduce((function(e,t){return t?e+1:e}),0),i=function(e,t,n){var r=o(n),a=Object(c.ob)(e),i=0;do{t[a]&&i++,a=s(a+1,b)}while(a!==r);return i}(t,r,e.FirstDayOfWeek);if(n<=i)return l(r,t,n);var u=n-i,O=Math.ceil(u/a),f=Object(c.k)(t,e.Interval*O);return l(r,Object(c.bc)(f,o(e.FirstDayOfWeek)),s(u,a)||a)},formatOptionsForSummary:O};function d(e,t,n){var r={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6,Day:0,Weekday:0,WeekendDay:0},a=r[e];return s(r[t]-a,7)-s(r[n]-a,7)}function s(e,t){return(e%t+t)%t}function l(e,t,n){for(var r=Object(c.ob)(t),a=0;a<n;)e[s(r,b)]&&a++,r++;return r--,Object(c.e)(t,s(r-Object(c.ob)(t),b))}var j=7;function m(e,t,n){var r=Object(c.ac)(e),a=o(t)-Object(c.ob)(r);a<0&&(a+=j);var i=Object(c.e)(r,a);switch(n){case"First":return i;case"Second":return Object(c.k)(i,1);case"Third":return Object(c.k)(i,2);case"Fourth":return Object(c.k)(i,3);case"Last":var u=Object(c.k)(i,4);return Object(c.Kb)(r,u)||(u=Object(c.k)(i,3)),u;default:throw new Error("Invalid DayOfWeekIndexType")}}function y(e){return Object(a.a)("calendarDayOfWeekIndex_"+e)}var v={canHandle:function(e){return!!e.DaysOfWeek&&!!e.DayOfWeekIndex&&!!e.Interval},formatRecurrence:function(e){var t=Object(u.a)(e.DaysOfWeek),n=y(e.DayOfWeekIndex);return 1===e.Interval?Object(r.a)(Object(a.a)("calendarRelativeMonthly1FormatString"),n,t):2===e.Interval?Object(r.a)(Object(a.a)("calendarRelativeMonthly2FormatString"),n,t):Object(r.a)(Object(a.a)("calendarRelativeMonthlyNFormatString"),n,t,e.Interval)},formatRecurrenceOption:function(e){var t=Object(u.a)(e.DaysOfWeek),n=y(e.DayOfWeekIndex);return Object(r.a)(Object(a.a)("calendarRelativeMonthlyOptionFormatString"),n,t)},getNumberedRecurrenceEndDate:function(e,t,n){var r=m(t,e.DaysOfWeek,e.DayOfWeekIndex);return Object(c.Hb)(r,t)&&(r=m(Object(c.i)(r,1),e.DaysOfWeek,e.DayOfWeekIndex)),m(Object(c.i)(r,(n-1)*e.Interval),e.DaysOfWeek,e.DayOfWeekIndex)},formatOptionsForSummary:function(e){var t=Object(u.a)(e.DaysOfWeek),n=y(e.DayOfWeekIndex);return Object(r.a)(Object(a.a)("calendarRelativeMonthlyOptionFormatLowercaseString"),n,t)}};var I={canHandle:function(e){return!!e.DayOfMonth&&!!e.Interval},formatRecurrence:function(e){return 1===e.Interval?Object(r.a)(Object(a.a)("calendarAbsoluteMonthly1FormatString"),e.DayOfMonth):2===e.Interval?Object(r.a)(Object(a.a)("calendarAbsoluteMonthly2FormatString"),e.DayOfMonth):Object(r.a)(Object(a.a)("calendarAbsoluteMonthlyNFormatString"),e.DayOfMonth,e.Interval)},formatRecurrenceOption:function(e){return Object(r.a)(Object(a.a)("calendarAbsoluteMonthlyOptionFormatString"),e.DayOfMonth)},getNumberedRecurrenceEndDate:function(e,t,n){var r=t;return Object(c.mb)(r)!=e.DayOfMonth&&(r=Object(c.Vb)(r,e.DayOfMonth),Object(c.Hb)(r,t)&&(r=Object(c.i)(r,1))),Object(c.i)(r,(n-1)*e.Interval)},formatOptionsForSummary:function(e){return Object(r.a)(Object(a.a)("calendarAbsoluteMonthlyOptionFormatLowercaseString"),e.DayOfMonth)}};function g(e){return Object(a.a)("calendarMonth_"+e)}var h=["January","February","March","April","May","June","July","August","September","October","November","December"];function D(e){return R(Object(a.a)("calendarRelativeYearlyOptionFormatString"),e)}function R(e,t){var n=Object(u.a)(t.DaysOfWeek),a=y(t.DayOfWeekIndex),c=g(t.Month);return Object(r.a)(e,a,n,c)}var p={canHandle:function(e){return!!e.DaysOfWeek&&!!e.Month&&!!e.DayOfWeekIndex},formatRecurrence:function(e){return R(Object(a.a)("calendarRelativeYearlyFormatString"),e)},formatRecurrenceOption:D,getNumberedRecurrenceEndDate:function(e,t,n){var r=t,a=h.indexOf(e.Month);return Object(c.yb)(r)!=a&&(r=Object(c.Wb)(r,a)),r=m(r,e.DaysOfWeek,e.DayOfWeekIndex),Object(c.Hb)(r,t)&&(r=m(Object(c.l)(r,1),e.DaysOfWeek,e.DayOfWeekIndex)),m(Object(c.l)(r,n-1),e.DaysOfWeek,e.DayOfWeekIndex)},formatOptionsForSummary:D},M=["January","February","March","April","May","June","July","August","September","October","November","December"];function F(e){return k(Object(a.a)("calendarAbsoluteYearlyOptionFormatString"),e)}function k(e,t){var n=g(t.Month);return Object(r.a)(e,n,t.DayOfMonth)}var S={canHandle:function(e){return!!e.DayOfMonth&&!!e.Month},formatRecurrence:function(e){return k(Object(a.a)("calendarAbsoluteYearlyFormatString"),e)},formatRecurrenceOption:F,getNumberedRecurrenceEndDate:function(e,t,n){var r=t,a=M.indexOf(e.Month);return Object(c.yb)(r)!=a&&(r=Object(c.Wb)(r,a)),Object(c.mb)(r)!=e.DayOfMonth&&(r=Object(c.Vb)(r,e.DayOfMonth)),Object(c.Hb)(r,t)&&(r=Object(c.l)(r,1)),Object(c.l)(r,n-1)},formatOptionsForSummary:F};function W(e){return 1===e.Interval?Object(a.a)("calendarDaily1Recurrence"):2===e.Interval?Object(a.a)("calendarDaily2Recurrence"):Object(r.a)(Object(a.a)("calendarDailyNRecurrence"),e.Interval)}var w={canHandle:function(e){return("DailyRecurrence:#Exchange"===e.__type||"DailyRecurrence"===e.__typename)&&!!e.Interval},formatRecurrence:W,formatRecurrenceOption:W,getNumberedRecurrenceEndDate:function(e,t,n){return Object(c.e)(t,(n-1)*e.Interval)},formatOptionsForSummary:W};n.d(t,"a",(function(){return T}));var E=[f,v,I,p,S,w];function T(e){for(var t,n=0;n<E.length;n++)if(E[n].canHandle(e)){t=E[n];break}if(!t)throw new Error("Invalid recurrence type");return t}},3924:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(4),a=n(2308);function c(e,t){var n=e.End,c=e.Recurrence;if(c){var i=c.RecurrenceRange,o=i.EndDate;if(o){var u=Object(r.mc)(o);return Object(r.Hb)(u,t)}var b=i,O=b.NumberOfOccurrences,f=b.StartDate;if(O){var d=Object(r.mc)(f);u=Object(a.a)(c.RecurrencePattern).getNumberedRecurrenceEndDate(c.RecurrencePattern,d,O);return Object(r.Hb)(u,t)}return!1}return Object(r.Hb)(Object(r.mc)(n),t)}},614:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("initializeOwaObservableDateTime"),c=Object(r.action)("observableNowChanged"),i=Object(r.action)("observableTodayChanged"),o=n(4),u=n(9),b=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),O=Object(u.computed)((function(){return Object(o.mc)(b().now)})),f=function(){return O.get()},d=Object(u.computed)((function(){return Object(o.mc)(b().today)})),s=function(){return d.get()},l=function(e){return Object(o.Hb)(e,f())},j=function(e){return Object(o.Fb)(e,f())},m=function(e){return v(e,o.Hb)},y=function(e){return v(e,o.Ib)},v=function(e,t){return t(Object(o.Xb)(Object(o.mc)(e)),s())};function I(e){if(!e)return"";var t=Object(o.mc)(e);return function(e,t){var n=Object(o.Xb)(e);if(Object(o.Jb)(n,t))return o.ab;var r=function(e){return Object(o.Nb)(n,Object(o.e)(t,-e),t)};if(r(3))return o.ib;if(r(30))return o.hb;return o.Y}(t,s())(t)}function g(e){if(!e)return"";var t=Object(o.mc)(e);return function(e,t){var n=Object(o.Xb)(e);if(Object(o.Jb)(n,t))return o.T;return o.U}(t,s())(t)}function h(e){return e?function(e,t){var n=Object(o.Xb)(e);return Object(o.Jb)(n,t)?Object(o.ab)(e):D(n,t,2)?Object(o.lb)(e):D(n,t,7)?Object(o.H)(Object(o.bb)(e),Object(o.ab)(e)):Object(o.H)(Object(o.J)(e),Object(o.ab)(e))}(Object(o.mc)(e),s()):""}function D(e,t,n){return Object(o.Nb)(e,Object(o.e)(t,-n),t)}var R=Object(r.action)("updateTimes"),p=Object(r.action)("setNow"),M=Object(r.action)("setToday",(function(e){return{today:e}}));Object(r.mutator)(p,(function(){b().now=Object(o.kc)()})),Object(r.mutator)(M,(function(e){var t=e.today;b().today=t}));var F=n(32),k=n(126),S=!1;Object(r.orchestrator)(a,(function(){if(R(),!S){var e=Object(o.Qb)(),t=Object(o.Zb)(Object(o.h)(e,1)),n=Object(o.w)(t,e);setTimeout((function(){return setInterval(R,F.g)}),n),document&&document.addEventListener("visibilitychange",R),S=!0}})),Object(r.orchestrator)(k.l,(function(){R()})),Object(r.orchestrator)(R,(function(){p();var e=Object(o.Ab)(Object(o.lc)()),t=b().today!=e;t&&M(e),c(),t&&i()})),n.d(t,"d",(function(){return a})),n.d(t,"j",(function(){return c})),n.d(t,"l",(function(){return i})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return j})),n.d(t,"f",(function(){return m})),n.d(t,"h",(function(){return y})),n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return h}))},7407:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1641);function a(e){var t=Object(r.K)().meetingMessageItems.get(e);if(!t)return null;var n=t;return n.Start&&n.End&&n.CalendarItemType?n:null}},7408:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2046),a=n(614),c=n(1668),i=n(3924);function o(e){var t=Object(c.a)(e.ParentFolderId.Id);if("deleteditems"===t||"sentitems"===t)return!1;if(e.IsDelegated&&e.ReceivedRepresenting)return!1;if(!e.AssociatedCalendarItemId)return!1;if(Object(r.q)(e.ItemClass)){var n=e;if("InformationalUpdate"===n.MeetingRequestType)return!1;if("NoResponseReceived"!==e.ResponseType)return!1;if(Object(i.a)(n,Object(a.i)()))return!1}return!0}},968:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r;n(0),n(513);function a(e){if(!r)throw new Error("Localization has not yet been initialized");return r(e)}function c(e){r=e}}}]);
//# sourceMappingURL=owa.MailBoot~RSVP.js.map
self.scriptsLoaded['owa.MailBoot~RSVP.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~RSVP.js'] = (new Date()).getTime();