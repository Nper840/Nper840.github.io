self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SharedFolders.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[764],{13558:function(e){e.exports=JSON.parse('{"a":"Mdc"}')},13559:function(e){e.exports=JSON.parse('{"a":"Kdc"}')},1695:function(e,r,t){"use strict";var n,a;t.d(r,"b",(function(){return n})),t.d(r,"a",(function(){return a})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(a||(a={}))},369:function(e,r,t){"use strict";var n=t(0);function a(e,r){return e?Object(n.__assign)({mailboxInfo:e},r):null!=r?r:void 0}t.d(r,"a",(function(){return a}))},4739:function(e){e.exports=JSON.parse('{"a":"Ldc"}')},4887:function(e,r,t){"use strict";t.d(r,"a",(function(){return o}));var n=t(1644),a=t(71);function o(e){return e||(e=Object(a.b)()),Object(n.u)(e).sharedFolderUserEmails}},5664:function(e,r,t){"use strict";t.d(r,"a",(function(){return o})),t.d(r,"b",(function(){return i}));var n=t(10),a=new n.b((function(){return t.e(907).then(t.bind(null,9177))})),o=new n.c(a,(function(e){return e.FolderHierarchyDocument})),i=new n.c(a,(function(e){return e.PrimaryFolderHierarchyDocument}))},5675:function(e){e.exports=JSON.parse('{"a":"tHa"}')},6158:function(e,r,t){"use strict";t.r(r);var n=t(25),a=t(13558),o=t(4739),i=t(6),s=t(9503),c=t(1),d=t(6766),u=t(0),l=t(13559),b=t(2),f=Object(b.action)("ADD_SHARED_FOLDER_USER_EMAIL",(function(e,r){return{sharedUserMailboxSmtpAddress:e,userIdentity:r}})),O=Object(b.action)("ON_ADD_SHARED_FOLDER_SUCCESS",(function(e,r,t){return{sharedUserMailboxSmtpAddress:e,folder:r,userIdentity:t}})),h=t(30);function p(e,r){return t={displayName:e,primarySMTPAddress:r},Object(h.a)("AddSharedFolders",t,n);var t,n}var S=t(127),j=t(884),v=t(5675),_=t(20),y=t(71);function g(e,r,t,n){return void 0===t&&(t=!1),void 0===n&&(n=Object(y.b)()),Object(u.__awaiter)(this,void 0,void 0,(function(){var a;return Object(u.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t?[3,2]:[4,p(e,r)];case 1:if(!o.sent())return[2];o.label=2;case 2:return[3,4];case 3:return a=o.sent(),Object(j.b)(Object(i.b)(v.a),Object(i.b)(l.a),!1,{hideCancelButton:!0}),_.d("Add shared folder API returned error "+a),[2];case 4:return O(r,{FolderId:{Id:r},DisplayName:e,principalSMTPAddress:r,UnreadCount:0,TotalCount:0,DistinguishedFolderId:void 0,mailboxInfo:{type:"SharedMailbox",userIdentity:n,mailboxSmtpAddress:r}},n),f(r,n),t||Object(S.r)("Triage_SharedFolders_AddFolder"),[2]}}))}))}var m=Object(b.action)("showAddSharedFolderDialog",(function(e){return{showDialogMessageFlag:e}})),M=Object(n.a)((function(){return d.a.showPeoplePickerDialog&&c.createElement(s.a,{title:Object(i.b)(o.a),subTitle:Object(i.b)(a.a),addCallback:x,cancelCallback:A})}));function x(e){g(e.Name,e.EmailAddress)}function A(){m(!1)}var F=Object(b.action)("REMOVE_SHARED_FOLDER_USER",(function(e,r){return r||(r=Object(y.b)()),{sharedUserMailboxSmtpAddress:e,userIdentity:r}})),I=t(4887),R=Object(b.action)("REMOVE_SHARED_FOLDER_USER_EMAIL",(function(e,r){return{sharedUserMailboxSmtpAddress:e,userIdentity:r}})),D=(Object(b.mutator)(R,(function(e){var r=Object(I.a)(e.userIdentity),t=r.indexOf(e.sharedUserMailboxSmtpAddress);-1!==t?r.splice(t,1):_.d("Trying to remove a non-existent shared folder user : "+e.sharedUserMailboxSmtpAddress)})),Object(b.mutator)(f,(function(e){var r=Object(I.a)(e.userIdentity);-1==r.indexOf(e.sharedUserMailboxSmtpAddress)&&r.push(e.sharedUserMailboxSmtpAddress)})),Object(b.mutator)(m,(function(e){Object(d.b)().showPeoplePickerDialog=e.showDialogMessageFlag})),t(1644));Object(b.orchestrator)(O,(function(e){var r={};r[e.sharedUserMailboxSmtpAddress]=e.folder,Object(D.b)(r),Object(D.V)(e.sharedUserMailboxSmtpAddress,e.folder,D.a.Uninitialized,!0,0,e.userIdentity)}));var E=Object(b.action)("ON_SHARED_FOLDER_FETCH_FAILED",(function(e,r){return{sharedUserMailboxSmtpAddress:e,actionSource:r}})),P=t(48),w=t(7384),T=t(1667),U=t(713),C=t(5664),L=Object(b.action)("INITIALIZE_SHARED_FOLDER_RETENTION_POLICY_TAGS",(function(e,r){return{sharedUserMailboxSmtpAddress:e,userIdentity:r}}));Object(b.orchestrator)(w.a,(function(e){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var r,t,n,a,o,i,s,c,d,l,b,f,O;return Object(u.__generator)(this,(function(h){switch(h.label){case 0:if(r=e.userIdentity,t=e.sharedUserMailboxSmtpAddress,n=e.actionSource,a=e.isLoadingMore,(o=Object(D.r)(t,r))===D.a.Loading||o===D.a.Loaded&&!a)return[2];Object(D.W)(t,D.a.Loading,r),s=Object(D.p)(t,r),h.label=1;case 1:return h.trys.push([1,4,,5]),[4,Promise.all([Object(U.a)(),C.a.import()])];case 2:return c=u.__read.apply(void 0,[h.sent(),2]),d=c[0],l=c[1],[4,d.query({query:l,variables:{baseFolderDistinguishedIds:[T.l,"inbox"],indexedPageOffset:s,mailboxInfo:{userIdentity:r,mailboxSmtpAddress:t,type:"SharedMailbox"},shouldPopulateChildFolderIds:!1}})];case 3:return b=h.sent(),i=b.data.folderHierarchy,[3,5];case 4:return f=h.sent(),Object(S.r)("SharedFolders_FetchFailed",[f.ResponseCode,f.diagnosticInfo],{isCore:!0}),E(t,n),Object(D.W)(t,D.a.ErrorLoading,r),[2];case 5:return O=Object(D.y)(t).DisplayName,Object(D.R)(i.RootFolder,i.Folders,T.l,t,O,t,r,i.IncludesLastItemInRange,i.IndexedPagingOffset),0===s&&L(t,r),p=i.TotalItemsInView,Object(S.r)("Triage_SharedFolders_OpenFolder",[Object(P.e)({value:p})]),[2]}var p}))}))}));var N=t(6773),H=t(3125),k=t(3247);function W(e){return r={primarySMTPAddress:e},Object(h.a)("RemoveSharedFolders",r,t);var r,t}Object(b.orchestrator)(E,(function(e){Object(H.i)(Object(i.b)(v.a),Object(i.b)(N.a)),"folderPane"===e.actionSource&&Object(k.a)(e.sharedUserMailboxSmtpAddress,!1)}));Object(b.orchestrator)(F,(function(e){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var r,t,n,a;return Object(u.__generator)(this,(function(o){switch(o.label){case 0:r=e.sharedUserMailboxSmtpAddress,t=e.userIdentity,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,W(r)];case 2:return n=o.sent(),[3,4];case 3:return a=o.sent(),_.d("Remove shared folders server call failed with error "+a),[3,4];case 4:return n?(R(r,t),Object(D.U)(r,t),Object(S.r)("Triage_SharedFolders_RemoveFolder")):_.d("Remove shared folders server call returned false"),[2]}}))}))}));function z(e,r){var t;return void 0===e||e.__type||(t=e,e=Object(u.__assign)({__type:"GetUserRetentionPolicyTagsJsonRequest:#Exchange"},t)),Object(h.a)("GetUserRetentionPolicyTags",e,r)}var J=t(168),V=t(369);var q=Object(b.mutatorAction)("setPolicyTags",(function(e,r){Object(d.b)().retentionPolicyTags.set(e,r)}));function B(){return e={},Object(h.a)("GetOtherMailboxConfiguration",e,r);var e,r}Object(b.orchestrator)(L,(function(e){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var r,t,n,a,o;return Object(u.__generator)(this,(function(i){switch(i.label){case 0:r=e.sharedUserMailboxSmtpAddress,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(s=r,c={type:"SharedMailbox",userIdentity:Object(y.b)(),mailboxSmtpAddress:s},d=Object(V.a)(c),z({Header:Object(J.b)(),Body:{}},d))];case 2:return t=i.sent(),"Success"===(null===(a=null==t?void 0:t.Body)||void 0===a?void 0:a.ResponseClass)?q(r,t.Body.RetentionPolicyTags):_.d("Initialize shared folders policy tags server call failed with error "+(null===(o=null==t?void 0:t.Body)||void 0===o?void 0:o.MessageText)),[3,4];case 3:return n=i.sent(),_.d("Initialize shared folders policy tags server call failed with error "+n),[3,4];case 4:return[2]}var s,c,d}))}))}));var G=t(37),$=Object(G.e)(D.C,"initializeSharedFolderRootsOrchestratorClone",(function(e){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e,r;return Object(u.__generator)(this,(function(t){switch(t.label){case 0:return[4,B()];case 1:return e=t.sent(),(r=null==e?void 0:e.OtherMailboxEntries)?r.length>0&&(r.forEach((function(e){g(e.DisplayName,e.PrincipalSMTPAddress,!0)})),n=r.length,Object(S.r)("Triage_SharedFolders_LoadList",[Object(P.e)({value:n})])):_.d("initializeSharedFolderRoots failed with getOtherMailboxConfiguration response as : "+e),[2]}var n}))}))}));t.d(r,"SharedFolderPeoplePicker",(function(){return M})),t.d(r,"showSharedFolderPeoplePickerDialog",(function(){return m})),t.d(r,"removeSharedFolderUser",(function(){return F})),t.d(r,"initializeSharedFolderRootsOrchestrator",(function(){return $}))},6766:function(e,r,t){"use strict";t.d(r,"b",(function(){return o}));var n=t(2),a={showPeoplePickerDialog:!1,retentionPolicyTags:new(t(9).ObservableMap)({})},o=Object(n.createStore)("sharedFolderState",a),i=o();r.a=i},6773:function(e){e.exports=JSON.parse('{"a":"uHa"}')},7384:function(e,r,t){"use strict";t.d(r,"a",(function(){return o}));var n=t(2),a=t(71),o=Object(n.action)("GET_SHARED_FOLDERS",(function(e,r,t,n){return n||(n=Object(a.b)()),{sharedUserMailboxSmtpAddress:e,actionSource:r,isLoadingMore:t,userIdentity:n}}))},7429:function(e,r,t){"use strict";t.d(r,"b",(function(){return a})),t.d(r,"a",(function(){return o}));var n=t(2),a=Object(n.action)("populateUserMailboxInfo",(function(e){return{userMailboxWrapper:e}})),o=Object(n.action)("ON_DISMISSED")},7430:function(e,r,t){"use strict";t.d(r,"b",(function(){return i}));var n=t(1695),a=t(2),o={userMailboxWrapper:null,findControlViewState:{queryString:"",findResultSet:[],findResultType:n.b.None,isSearching:!1,directorySearchType:n.a.None,findPeopleFeedbackManager:null,numberOfCacheResults:0}},i=Object(a.createStore)("peoplePickerDialogStore",o);r.a=i()},9503:function(e,r,t){"use strict";var n=t(7429),a=t(7430),o=t(1695),i=t(2),s=(Object(i.mutator)(n.b,(function(e){Object(a.b)().userMailboxWrapper=e.userMailboxWrapper})),Object(i.mutator)(n.a,(function(){var e=Object(a.b)();e.userMailboxWrapper=null,e.findControlViewState={queryString:"",findResultSet:[],findResultType:o.b.None,isSearching:!1,directorySearchType:o.a.None,findPeopleFeedbackManager:null,numberOfCacheResults:0}})),t(37));t.d(r,"a",(function(){return d}));var c=new s.c((function(){return Promise.all([t.e(4),t.e(6),t.e(16),t.e(32),t.e(53),t.e(60),t.e(717)]).then(t.bind(null,17649))})),d=Object(s.d)(c,(function(e){return e.PeoplePickerDialog}))}}]);
//# sourceMappingURL=owa.MailBoot~SharedFolders.js.map
self.scriptsLoaded['owa.MailBoot~SharedFolders.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SharedFolders.js'] = (new Date()).getTime();