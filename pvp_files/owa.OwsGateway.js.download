self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OwsGateway.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[914],{1262:function(e,t,n){"use strict";n.r(t);var r=n(2602);function a(e,t,n,a){return Object(r.f)(n,t,a,e)}n.d(t,"makeOwsPrimeRequest",(function(){return r.f})),n.d(t,"makePostRequest",(function(){return r.d})),n.d(t,"makePatchRequest",(function(){return r.c})),n.d(t,"makePutRequest",(function(){return r.e})),n.d(t,"makeGetRequest",(function(){return r.b})),n.d(t,"makeDeleteRequest",(function(){return r.a})),n.d(t,"sendOwsPrimeRequest",(function(){return a}))},165:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(33);function a(){var e=Object(r.a)(),t=e.origin;return t||(t=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")),t}},173:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,a=!1;function o(t){r--,delete e[t]}this.put=function(t,n,a,i){if(void 0!==a&&("number"!=typeof a||isNaN(a)||a<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==i&&"function"!=typeof i)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):r++;var c={value:n,expire:a+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){o(t),i&&i(t,n)}.bind(this),a)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),a&&(t=0,n=0)},this.get=function(o){var i=e[o];if(void 0!==i){if(isNaN(i.expire)||i.expire>=Date.now())return a&&t++,i.value;a&&n++,r--,delete e[o]}else a&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){a=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),a=Date.now(),o=n&&n.skipDuplicates;for(var i in r)if(r.hasOwnProperty(i)){if(o)if(e[i])continue;var u=r[i],c=u.expire-a;if(c<=0){this.del(i);continue}c=c>0?c:void 0,this.put(i,u.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},219:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function o(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function i(e){return r.test(e)}},236:function(e,t,n){"use strict";var r=n(699);n.d(t,"a",(function(){return r.a}))},2494:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return u}));var r=n(36),a=n(33),o=n(71);function i(){var e=Object(r.a)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.a)(t)}function u(){var e,t,n=(e="",(t=Object(a.a)().pathname.split("/").filter((function(e){return e.length}))).length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e);if(0===n.length){var r=Object(o.h)();if(null==r?void 0:r.SessionSettings){var u=r.SessionSettings.ExternalDirectoryTenantGuid,c=r.SessionSettings.UserPuid;c&&u&&(n="PUID:"+c+"@"+u)}}return 0===n.length&&(n=i()),n}},2602:function(e,t,n){"use strict";var r=n(0),a=n(18),o=n(236),i=n(5),u=n(497),c=n(2494),s=n(55),d=n(153),l=n(141),f=n(391),p=n(20),v=n(92),h=n(739),m="owsserver",b="owsapi",O=n(8);n.d(t,"f",(function(){return k})),n.d(t,"d",(function(){return x})),n.d(t,"c",(function(){return y})),n.d(t,"e",(function(){return C})),n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return S}));var j=2048,g=null;function k(e,t,n,o,i,c,s,d,l){var p="object"==typeof n&&n.customHeaders||s,v=p?Object.keys(p).reduce((function(e,t){return e[t.toLowerCase()]=p[t],e}),{}):void 0,h="object"==typeof n?Object(r.__assign)(Object(r.__assign)({},n),{customHeaders:v}):{returnFullResponse:n,correlationId:i,requestObject:c,customHeaders:v,throwServiceError:d,includeCredentials:l};if(!h.customHeaders||!h.customHeaders.authorization){void 0===h.includeCredentials&&(h.includeCredentials=!Object(a.i)("auth-authzHeaderNoCookies"));var m=Object(u.l)(),b=Object(r.__read)(Object(f.getAccessTokenforResourceAsLazy)(m),2),O=b[0],j=b[1];return O?w(e,t,h,o,O):j.then((function(n){return w(e,t,h,o,n)}))}return w(e,t,h,o)}function w(e,t,n,r,f){var k,w=n.returnFullResponse,x=n.correlationId,y=n.requestObject,C=n.customHeaders,T=n.throwServiceError,S=n.sendPayloadAsBody,P=n.includeCredentials,R=new Headers;R.append("X-OWA-CANARY",Object(s.a)()),R.append("X-MS-AppName","owa-react"+Object(u.q)());var H={n:Object(d.a)().toString()};x&&(R.append("client-request-id",x),H.cri=x),C&&Object.keys(C).forEach((function(e){R.append(e,C[e])}));var I=Object(O.a)();I.sessionId&&R.set("X-OWA-SessionId",I.sessionId);var D=Object(v.b)();if(D&&(R.append(v.a,D),H.cv=D),f){if(f.length>0&&"msauth1.0"===(null===(k=null==f?void 0:f.split(" ")[0])||void 0===k?void 0:k.toLowerCase()))R.append("Authorization",f);else{if(Object(a.i)("fwk-devTools")){var A=f.split(".");3==A.length&&0!==A[2].length||p.d("BearerTokenIncomplete "+A.length)}R.append("Authorization","Bearer  "+f)}}if(!C||!C["x-anchormailbox"]){var N=Object(c.a)();N&&N.length>0&&R.append("X-AnchorMailbox",N)}var L={method:t,credentials:!1!==P?"same-origin":"omit"};if(y){R.append("Content-Type","application/json");var E=JSON.stringify(y),F=e.search(/ows\/|owa\//i)>=0;if(Object(a.i)("fwk-emptyPost")&&F&&"POST"==t&&!S){var q=encodeURIComponent(E);q.length<j?R.append("X-OWA-UrlPostData",q):L.body=E}else L.body=E}L.headers=R;var M=function(e,t){var n=function(e,t){var n=Object(u.w)(e,t),r=n.split("/");r.length>0&&("ows"==r[0]||"OutlookGateway"==r[0])&&(r[0]=Object(u.e)(r[0]),n=r.join("/"));return Object(u.a)(n)}(Object(a.i)("fwk-proxyOwsPrime")?"/OutlookGateway/":"/",e),r=Object(u.l)()+n;if(Object(a.i)("fwk-devTools")&&Object(i.d)(m)&&(Object(i.a)(b)==e||!Object(i.d)(b))&&(null==g&&(g=confirm("A query param '"+m+"' is set to redirect some of calls to '"+Object(i.a)(m)+"'.\n\nThose calls contain PII. If this is not intentional, click 'Cancel' below or remove the queryparam and reload the page.")),g)){var o=e.split("/");o.length>0&&"ows"==o.shift()&&(e=o.join("/")),r=Object(i.a)(m)+"/"+e}return Object(u.u)(r,t)}(e,H),U=Object(l.a)(M,L);return Object(h.a)(L,n,U,r,M),U.then((function(n){if(w)return n;if(Object(o.a)(n.status))return n.text().then((function(e){return e?JSON.parse(e):{}}));throw new Error(t+" request to "+e+" failed, http error:"+n.status)})).catch((function(e){if(p.g.warn(e),T)throw{stack:e.stack,message:e.message,correlationVector:D,correlationId:n.correlationId,networkError:!0};return[]}))}function x(e,t,n,r,a,o,i,u,c,s){return k(e,"POST",{returnFullResponse:r,correlationId:n,requestObject:t,customHeaders:a,throwServiceError:o,sendPayloadAsBody:i,includeCredentials:u,datapoint:s},c)}function y(e,t,n,r,a,o,i,u){return k(e,"PATCH",{returnFullResponse:r,correlationId:n,requestObject:t,customHeaders:a,throwServiceError:o,includeCredentials:i},u)}function C(e,t,n,r,a,o,i,u){return k(e,"PUT",r,i,n,t,a,o,u)}function T(e,t,n,r,a,o,i){return k(e,"GET",n,i,t,void 0,r,a,o)}function S(e,t,n,r,a,o,i,u){return k(e,"DELETE",{returnFullResponse:r,correlationId:n,requestObject:t,customHeaders:a,throwServiceError:o,includeCredentials:i},u)}},318:function(e,t,n){"use strict";var r=n(32);t.a=function(e,t){return new Date(+e+t*r.h)}},319:function(e,t,n){"use strict";var r=n(32);t.a=function(e,t){return new Date(+e+t*r.g)}},32:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return u})),n.d(t,"l",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"d",(function(){return v}));var r=6048e5,a=864e5,o=36e5,i=6e4,u=1e3,c=12,s=30,d=365,l=-864e13,f=864e13,p=Date.UTC(1601,0,1),v=Date.UTC(4501,0,1)},321:function(e,t,n){"use strict";var r=n(3),a={showOwaBranding:{default:!0,native:!1},includePartnerIn3SRequest:{default:!1,native:!0},loadThemeFromHostApp:{default:!1,opx:!0},opxDeeplink:{default:!1,opx:!0},authRedirectOnSessionTimeout:{default:!0,native:!1,opx:!1},opxComponentLifecycle:{default:!1,opx:!0},navigateToView:{default:!1,opx:!0},readingPaneModal:{default:!0,teams:!1},readingPaneHeaderTitleAndJoinLink:{default:!0,teams:!1},composeFormSaveCloseHandlers:{default:!1,teams:!0},opxServiceWorker:{default:!1,opx:!0},routeOptionsStaticUrl:{default:!1,opx:!0},scenarioData:{default:!1,opx:!0},teamsChannelOptions:{default:!1,teams:!0},macA11y:{default:!1,macoutlook:!0},teamsCalendarPicker:{default:!1,teams:!0},joinTeamsMeeting:{default:!1,opx:!0},calendarPaneHeaderWeather:{default:!0,teams:!1},use3SPeopleSuggestions:{default:!0,macoutlook:!1},defaultCalendarColor:{default:!1,opx:!0},roomAddedHandler:{default:!1,opx:!0},roomFinderFreeBusyStyles:{default:!1,macoutlook:!0,outlookdesktop:!0},defaultSelectCalendarItemSvg:{default:!0,opx:!1},opxInboxRules:{default:!1,opx:!0},moduleNameFromWindow:{default:!0,opx:!1},showArchiveUnreadCount:{default:!1,native:!0},headerFeedback:{default:!0,opx:!1},spacesTeamsMessage:{default:!1,opx:!0},composeFrom:{default:!1,opx:!0},groupDiscoverCloseButton:{default:!1,opx:!0},updateModalProps:{default:!1,opx:!0},modalOpenedHandler:{default:!1,opx:!0},fullscreenComposeFormPopOut:{default:!1,teams:!0},defaultOutlookThemeColor:{default:!0,opx:!1},yammerDailyDigest:{default:!1,outlookdesktop:!0},yammerDiscovery:{default:!1,outlookdesktop:!0},yammerHostClientType:{default:!1,opx:!0},showMinimumThreeInsights:{default:!1,opx:!0},groupCreatedHandler:{default:!1,opx:!0},groupDeletedHandler:{default:!1,opx:!0},updateSearchAnswerOnQueryChange:{default:!1,opx:!0},insightsCountUpdatedHandler:{default:!1,opx:!0},processMeetingInsightsHandler:{default:!1,opx:!0},todoIsExplicitLogon:{default:!0,opx:!1},timeStreamSharedSpace:{default:!1,opx:!0},focusZoneCicularNavigation:{default:!1,opx:!0},componentTokenProvider:{default:!1,opx:!0,native:!0},calendarOfficeRail:{default:!0,teams:!1},hideCalendarModuleContent:{default:!1,teams:!0},fullComposeFormModal:{default:!0,teams:!1},renderCalendarHeader:{default:!0,teams:!1},weekWeatherIcon:{default:!0,teams:!1},surfacePLTDataPoint:{default:!1,teams:!0},schedulingAssistant:{default:!0,teams:!1},composeFormHeader:{default:!0,teams:!1},saveInFullCompose:{default:!0,teams:!1},discardInFullCompose:{default:!0,teams:!1},addIns:{default:!0,teams:!1},settings:{default:!0,teams:!1},multiAccounts:{default:!0,teams:!1},accountSettingsHx:{default:!1,native:!0},nativeDiagnostics:{default:!1,native:!0},nativeQsp:{default:!1,native:!0},moduleSwitch:{default:!1,native:!0},diagInAppSupport:{default:!1,native:!0},folderHierarchyHx:{default:!1,native:!0},monarchErrorMessage:{default:!1,native:!0},noteFeedSidePanel:{default:!0,native:!1},whatsNew:{default:!0,native:!1},owaBrandingCharm:{default:!0,native:!1},appLauncher:{default:!0,native:!1},incorrectNativeEntryPoint:{default:!1,native:!0},monarchFeedback:{default:!1,native:!0},nativeResolvers:{default:!1,native:!0},managedQueryLink:{default:!1,native:!0},wrongIndex:{default:!1,native:!0},outlookSuiteHeaderStrategy:{default:!1,native:!0},calendarRibbon:{default:!1,native:!0},mailRibbon:{default:!1,native:!0},hxDiagnostics:{default:!1,native:!0},hxForConvListViewLoad:{default:!1,native:!0},initialMailData:{default:!1,native:!0},pauseInbox:{default:!0,native:!1},hxVersionQueryStringParam:{default:!1,native:!0},nativeServiceWorker:{default:!1,native:!0},nativeHostAttachmentHijack:{default:!1,native:!0},useNativeHostRPConversationOption:{default:!1,native:!0}},o=n(171),i=function(e){var t=function(e){return a[e]}(e);if(t){if(window.HxGlobals&&window.nativeHost&&r.d in t)return t[r.d];if(Object(o.b)()&&r.g in t)return t[r.g];var n=Object(r.w)();return n&&n in t?t[n]:!n||n!==r.f&&n!==r.c&&n!==r.b&&n!==r.a&&n!==r.g&&n!==r.e?t.default:t.opx}return!1};n.d(t,"a",(function(){return i}))},360:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r,a=n(0);function o(e){r=e}function i(){var e,t;return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(o=r)?[4,r()]:[3,2];case 1:o=a.sent(),a.label=2;case 2:if((n=o)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},421:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(82);function a(e){return Object(r.a)(e,[r.c])}},439:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();n.d(t,"a",(function(){return r}))},497:function(e,t,n){"use strict";var r=n(421),a=n(29),o=n(82);function i(e){return Object(o.a)(e,[o.b])}var u=n(24),c=n(61);function s(e){return Object(u.b)(Object(u.c)(Object(u.a)(Object(c.a)()||"",e)))}var d,l,f,p=n(503),v=n(620),h=n(166);function m(){return d||(d=Object(a.a)("/calendar")+"/"),d}function b(){return l||(l=Object(a.a)("/mail")+"/"),l}function O(){return f||(f=Object(a.a)("/files")+"/"),f}var j,g,k,w=n(715);function x(e){return j&&g===e||(g=e,j=e?Object(a.a)("/people/group/owner")+"/":Object(a.a)("/people/group/member")+"/"),j}function y(){return k||(k=Object(a.a)("/people/group/deleted")+"/"),k}function C(e){return window.location.origin+m()+"showPeek/item/"+encodeURIComponent(e)}var T=n(276),S=n(578),P=n(5),R=n(526),H=Object(S.a)().split("/").slice(1).join("/")+"deeplink/";function I(e,t,n,r){n&&((r=r||{}).minus="");var a="";if(r){var o=Object(P.b)();Object(R.a)(o),Object.keys(r).filter((function(e){return e})).forEach((function(e){return o[e]=r[e]})),a="?"+Object(P.i)(o)}var i={pathname:"/"+e+"/"+H+t,search:a};return T.format(i)}var D,A,N=n(174),L=n(0),E=n(17),F="https://to-do.microsoft.com";function q(e,t){var n,r,a,o=Object(E.a)(),i=o.UserOptions,u=null===(r=o.SessionSettings)||void 0===r?void 0:r.UserPrincipalName,c=F,s={};if(null===(a=null==i?void 0:i.ReactOptinSettings)||void 0===a?void 0:a.TasksRedirectUrl){var d;c=(n=Object(L.__read)(i.ReactOptinSettings.TasksRedirectUrl.split("?"),2))[0],d=n[1],s=Object(P.g)(d),u&&(s.auth_upn=u)}return e&&(s.utm_source=e),t&&delete s.fromOwa,Object.keys(s).length>0?Object(h.a)(c,s):c}function M(){return D||(D=Object(a.a)("/spaces")+"/"),D}function U(){return A||(A=Object(a.a)("/eventify")+"/"),A}var _=n(165);n.d(t,"i",(function(){return r.a})),n.d(t,"s",(function(){return a.a})),n.d(t,"e",(function(){return i})),n.d(t,"k",(function(){return s})),n.d(t,"r",(function(){return p.a})),n.d(t,"w",(function(){return u.a})),n.d(t,"a",(function(){return u.b})),n.d(t,"n",(function(){return v.a})),n.d(t,"u",(function(){return h.a})),n.d(t,"c",(function(){return m})),n.d(t,"j",(function(){return b})),n.d(t,"f",(function(){return O})),n.d(t,"o",(function(){return w.a})),n.d(t,"h",(function(){return x})),n.d(t,"g",(function(){return y})),n.d(t,"b",(function(){return C})),n.d(t,"p",(function(){return I})),n.d(t,"v",(function(){return N.a})),n.d(t,"t",(function(){return q})),n.d(t,"m",(function(){return M})),n.d(t,"d",(function(){return U})),n.d(t,"l",(function(){return _.a})),n.d(t,"q",(function(){return c.a}))},503:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(5),a=n(526);function o(){var e=Object(r.b)();Object(a.a)(e);var t=Object(r.i)(e);return t.length>0?"?"+t:""}},511:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},526:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=["hostApp","isanonymous","cspoff","frameName","opxInstanceId"];function a(e){e&&Object.keys(e).forEach((function(t){r.includes(t)&&delete e[t]}))}},578:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(61),a=n(29);function o(e){return(Object(a.a)("/"+(e||Object(r.a)()))+"/").replace(/^\//,"")}},620:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(33),a=n(29),o=n(165);function i(e){var t=Object(r.a)(),n=Object(o.a)()+Object(a.a)("/owa")+"/",i=t.search&&t.search.length>0;n+=i?t.search:"?";for(var u=Object.keys(e),c=i,s=0;s<u.length;s++)c?n+="&":c=!0,n+=u[s]+"="+e[u[s]];return n}},699:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},715:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,a=n(29);function o(){return r||(r=Object(a.a)("/people")+"/"),r}}}]);
//# sourceMappingURL=owa.OwsGateway.js.map
self.scriptsLoaded['owa.OwsGateway.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OwsGateway.js'] = (new Date()).getTime();